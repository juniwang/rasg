/*!
  jQuery JavaScript Library v1.6.4
  http://jquery.com/
 
  Copyright 2011, John Resig
  Dual licensed under the MIT or GPL Version 2 licenses.
  http://jquery.org/license
 
  Includes Sizzle.js
  http://sizzlejs.com/
  Copyright 2011, The Dojo Foundation
  Released under the MIT, BSD, and GPL Licenses.
 
  Date: Mon Sep 12 18:54:48 2011 -0400
 */(function(window,undefined){var document=window.document,navigator=window.navigator,location=window.location;var jQuery=(function(){var jQuery=function(selector,context){return new jQuery.fn.init(selector,context,rootjQuery);},_jQuery=window.jQuery,_$=window.$,rootjQuery,quickExpr=/^(?:[^#<]*(<[\w\W]+>)[^>]*$|#([\w\-]*)$)/,rnotwhite=/\S/,trimLeft=/^\s+/,trimRight=/\s+$/,rdigit=/\d/,rsingleTag=/^<(\w+)\s*\/?>(?:<\/\1>)?$/,rvalidchars=/^[\],:{}\s]*$/,rvalidescape=/\\(?:["\\\/bfnrt]|u[0-9a-fA-F]{4})/g,rvalidtokens=/"[^"\\\n\r]*"|true|false|null|-?\d+(?:\.\d*)?(?:[eE][+\-]?\d+)?/g,rvalidbraces=/(?:^|:|,)(?:\s*\[)+/g,rwebkit=/(webkit)[ \/]([\w.]+)/,ropera=/(opera)(?:.*version)?[ \/]([\w.]+)/,rmsie=/(msie) ([\w.]+)/,rmozilla=/(mozilla)(?:.*? rv:([\w.]+))?/,rdashAlpha=/-([a-z]|[0-9])/ig,rmsPrefix=/^-ms-/,fcamelCase=function(all,letter){return(letter+"").toUpperCase();},userAgent=navigator.userAgent,browserMatch,readyList,DOMContentLoaded,toString=Object.prototype.toString,hasOwn=Object.prototype.hasOwnProperty,push=Array.prototype.push,slice=Array.prototype.slice,trim=String.prototype.trim,indexOf=Array.prototype.indexOf,class2type={};jQuery.fn=jQuery.prototype={constructor:jQuery,init:function(selector,context,rootjQuery){var match,elem,ret,doc;if(!selector){return this;}
if(selector.nodeType){this.context=this[0]=selector;this.length=1;return this;}
if(selector==="body"&&!context&&document.body){this.context=document;this[0]=document.body;this.selector=selector;this.length=1;return this;}
if(typeof selector==="string"){if(selector.charAt(0)==="<"&&selector.charAt(selector.length-1)===">"&&selector.length>=3){match=[null,selector,null];}else{match=quickExpr.exec(selector);}
if(match&&(match[1]||!context)){if(match[1]){context=context instanceof jQuery?context[0]:context;doc=(context?context.ownerDocument||context:document);ret=rsingleTag.exec(selector);if(ret){if(jQuery.isPlainObject(context)){selector=[document.createElement(ret[1])];jQuery.fn.attr.call(selector,context,true);}else{selector=[doc.createElement(ret[1])];}}else{ret=jQuery.buildFragment([match[1]],[doc]);selector=(ret.cacheable?jQuery.clone(ret.fragment):ret.fragment).childNodes;}
return jQuery.merge(this,selector);}else{elem=document.getElementById(match[2]);if(elem&&elem.parentNode){if(elem.id!==match[2]){return rootjQuery.find(selector);}
this.length=1;this[0]=elem;}
this.context=document;this.selector=selector;return this;}}else if(!context||context.jquery){return(context||rootjQuery).find(selector);}else{return this.constructor(context).find(selector);}}else if(jQuery.isFunction(selector)){return rootjQuery.ready(selector);}
if(selector.selector!==undefined){this.selector=selector.selector;this.context=selector.context;}
return jQuery.makeArray(selector,this);},selector:"",jquery:"1.6.4",length:0,size:function(){return this.length;},toArray:function(){return slice.call(this,0);},get:function(num){return num==null?this.toArray():(num<0?this[this.length+num]:this[num]);},pushStack:function(elems,name,selector){var ret=this.constructor();if(jQuery.isArray(elems)){push.apply(ret,elems);}else{jQuery.merge(ret,elems);}
ret.prevObject=this;ret.context=this.context;if(name==="find"){ret.selector=this.selector+(this.selector?" ":"")+selector;}else if(name){ret.selector=this.selector+"."+name+"("+selector+")";}
return ret;},each:function(callback,args){return jQuery.each(this,callback,args);},ready:function(fn){jQuery.bindReady();readyList.done(fn);return this;},eq:function(i){return i===-1?this.slice(i):this.slice(i,+i+1);},first:function(){return this.eq(0);},last:function(){return this.eq(-1);},slice:function(){return this.pushStack(slice.apply(this,arguments),"slice",slice.call(arguments).join(","));},map:function(callback){return this.pushStack(jQuery.map(this,function(elem,i){return callback.call(elem,i,elem);}));},end:function(){return this.prevObject||this.constructor(null);},push:push,sort:[].sort,splice:[].splice};jQuery.fn.init.prototype=jQuery.fn;jQuery.extend=jQuery.fn.extend=function(){var options,name,src,copy,copyIsArray,clone,target=arguments[0]||{},i=1,length=arguments.length,deep=false;if(typeof target==="boolean"){deep=target;target=arguments[1]||{};i=2;}
if(typeof target!=="object"&&!jQuery.isFunction(target)){target={};}
if(length===i){target=this;--i;}
for(;i<length;i++){if((options=arguments[i])!=null){for(name in options){src=target[name];copy=options[name];if(target===copy){continue;}
if(deep&&copy&&(jQuery.isPlainObject(copy)||(copyIsArray=jQuery.isArray(copy)))){if(copyIsArray){copyIsArray=false;clone=src&&jQuery.isArray(src)?src:[];}else{clone=src&&jQuery.isPlainObject(src)?src:{};}
target[name]=jQuery.extend(deep,clone,copy);}else if(copy!==undefined){target[name]=copy;}}}}
return target;};jQuery.extend({noConflict:function(deep){if(window.$===jQuery){window.$=_$;}
if(deep&&window.jQuery===jQuery){window.jQuery=_jQuery;}
return jQuery;},isReady:false,readyWait:1,holdReady:function(hold){if(hold){jQuery.readyWait++;}else{jQuery.ready(true);}},ready:function(wait){if((wait===true&&!--jQuery.readyWait)||(wait!==true&&!jQuery.isReady)){if(!document.body){return setTimeout(jQuery.ready,1);}
jQuery.isReady=true;if(wait!==true&&--jQuery.readyWait>0){return;}
readyList.resolveWith(document,[jQuery]);if(jQuery.fn.trigger){jQuery(document).trigger("ready").unbind("ready");}}},bindReady:function(){if(readyList){return;}
readyList=jQuery._Deferred();if(document.readyState==="complete"){return setTimeout(jQuery.ready,1);}
if(document.addEventListener){document.addEventListener("DOMContentLoaded",DOMContentLoaded,false);window.addEventListener("load",jQuery.ready,false);}else if(document.attachEvent){document.attachEvent("onreadystatechange",DOMContentLoaded);window.attachEvent("onload",jQuery.ready);var toplevel=false;try{toplevel=window.frameElement==null;}catch(e){}
if(document.documentElement.doScroll&&toplevel){doScrollCheck();}}},isFunction:function(obj){return jQuery.type(obj)==="function";},isArray:Array.isArray||function(obj){return jQuery.type(obj)==="array";},isWindow:function(obj){return obj&&typeof obj==="object"&&"setInterval"in obj;},isNaN:function(obj){return obj==null||!rdigit.test(obj)||isNaN(obj);},type:function(obj){return obj==null?String(obj):class2type[toString.call(obj)]||"object";},isPlainObject:function(obj){if(!obj||jQuery.type(obj)!=="object"||obj.nodeType||jQuery.isWindow(obj)){return false;}
try{if(obj.constructor&&!hasOwn.call(obj,"constructor")&&!hasOwn.call(obj.constructor.prototype,"isPrototypeOf")){return false;}}catch(e){return false;}
var key;for(key in obj){}
return key===undefined||hasOwn.call(obj,key);},isEmptyObject:function(obj){for(var name in obj){return false;}
return true;},error:function(msg){throw msg;},parseJSON:function(data){if(typeof data!=="string"||!data){return null;}
data=jQuery.trim(data);if(window.JSON&&window.JSON.parse){return window.JSON.parse(data);}
if(rvalidchars.test(data.replace(rvalidescape,"@").replace(rvalidtokens,"]").replace(rvalidbraces,""))){return(new Function("return "+data))();}
jQuery.error("Invalid JSON: "+data);},parseXML:function(data){var xml,tmp;try{if(window.DOMParser){tmp=new DOMParser();xml=tmp.parseFromString(data,"text/xml");}else{xml=new ActiveXObject("Microsoft.XMLDOM");xml.async="false";xml.loadXML(data);}}catch(e){xml=undefined;}
if(!xml||!xml.documentElement||xml.getElementsByTagName("parsererror").length){jQuery.error("Invalid XML: "+data);}
return xml;},noop:function(){},globalEval:function(data){if(data&&rnotwhite.test(data)){(window.execScript||function(data){window["eval"].call(window,data);})(data);}},camelCase:function(string){return string.replace(rmsPrefix,"ms-").replace(rdashAlpha,fcamelCase);},nodeName:function(elem,name){return elem.nodeName&&elem.nodeName.toUpperCase()===name.toUpperCase();},each:function(object,callback,args){var name,i=0,length=object.length,isObj=length===undefined||jQuery.isFunction(object);if(args){if(isObj){for(name in object){if(callback.apply(object[name],args)===false){break;}}}else{for(;i<length;){if(callback.apply(object[i++],args)===false){break;}}}}else{if(isObj){for(name in object){if(callback.call(object[name],name,object[name])===false){break;}}}else{for(;i<length;){if(callback.call(object[i],i,object[i++])===false){break;}}}}
return object;},trim:trim?function(text){return text==null?"":trim.call(text);}:function(text){return text==null?"":text.toString().replace(trimLeft,"").replace(trimRight,"");},makeArray:function(array,results){var ret=results||[];if(array!=null){var type=jQuery.type(array);if(array.length==null||type==="string"||type==="function"||type==="regexp"||jQuery.isWindow(array)){push.call(ret,array);}else{jQuery.merge(ret,array);}}
return ret;},inArray:function(elem,array){if(!array){return-1;}
if(indexOf){return indexOf.call(array,elem);}
for(var i=0,length=array.length;i<length;i++){if(array[i]===elem){return i;}}
return-1;},merge:function(first,second){var i=first.length,j=0;if(typeof second.length==="number"){for(var l=second.length;j<l;j++){first[i++]=second[j];}}else{while(second[j]!==undefined){first[i++]=second[j++];}}
first.length=i;return first;},grep:function(elems,callback,inv){var ret=[],retVal;inv=!!inv;for(var i=0,length=elems.length;i<length;i++){retVal=!!callback(elems[i],i);if(inv!==retVal){ret.push(elems[i]);}}
return ret;},map:function(elems,callback,arg){var value,key,ret=[],i=0,length=elems.length,isArray=elems instanceof jQuery||length!==undefined&&typeof length==="number"&&((length>0&&elems[0]&&elems[length-1])||length===0||jQuery.isArray(elems));if(isArray){for(;i<length;i++){value=callback(elems[i],i,arg);if(value!=null){ret[ret.length]=value;}}}else{for(key in elems){value=callback(elems[key],key,arg);if(value!=null){ret[ret.length]=value;}}}
return ret.concat.apply([],ret);},guid:1,proxy:function(fn,context){if(typeof context==="string"){var tmp=fn[context];context=fn;fn=tmp;}
if(!jQuery.isFunction(fn)){return undefined;}
var args=slice.call(arguments,2),proxy=function(){return fn.apply(context,args.concat(slice.call(arguments)));};proxy.guid=fn.guid=fn.guid||proxy.guid||jQuery.guid++;return proxy;},access:function(elems,key,value,exec,fn,pass){var length=elems.length;if(typeof key==="object"){for(var k in key){jQuery.access(elems,k,key[k],exec,fn,value);}
return elems;}
if(value!==undefined){exec=!pass&&exec&&jQuery.isFunction(value);for(var i=0;i<length;i++){fn(elems[i],key,exec?value.call(elems[i],i,fn(elems[i],key)):value,pass);}
return elems;}
return length?fn(elems[0],key):undefined;},now:function(){return(new Date()).getTime();},uaMatch:function(ua){ua=ua.toLowerCase();var match=rwebkit.exec(ua)||ropera.exec(ua)||rmsie.exec(ua)||ua.indexOf("compatible")<0&&rmozilla.exec(ua)||[];return{browser:match[1]||"",version:match[2]||"0"};},sub:function(){function jQuerySub(selector,context){return new jQuerySub.fn.init(selector,context);}
jQuery.extend(true,jQuerySub,this);jQuerySub.superclass=this;jQuerySub.fn=jQuerySub.prototype=this();jQuerySub.fn.constructor=jQuerySub;jQuerySub.sub=this.sub;jQuerySub.fn.init=function init(selector,context){if(context&&context instanceof jQuery&&!(context instanceof jQuerySub)){context=jQuerySub(context);}
return jQuery.fn.init.call(this,selector,context,rootjQuerySub);};jQuerySub.fn.init.prototype=jQuerySub.fn;var rootjQuerySub=jQuerySub(document);return jQuerySub;},browser:{}});jQuery.each("Boolean Number String Function Array Date RegExp Object".split(" "),function(i,name){class2type["[object "+name+"]"]=name.toLowerCase();});browserMatch=jQuery.uaMatch(userAgent);if(browserMatch.browser){jQuery.browser[browserMatch.browser]=true;jQuery.browser.version=browserMatch.version;}
if(jQuery.browser.webkit){jQuery.browser.safari=true;}
if(rnotwhite.test("\xA0")){trimLeft=/^[\s\xA0]+/;trimRight=/[\s\xA0]+$/;}
rootjQuery=jQuery(document);if(document.addEventListener){DOMContentLoaded=function(){document.removeEventListener("DOMContentLoaded",DOMContentLoaded,false);jQuery.ready();};}else if(document.attachEvent){DOMContentLoaded=function(){if(document.readyState==="complete"){document.detachEvent("onreadystatechange",DOMContentLoaded);jQuery.ready();}};}
function doScrollCheck(){if(jQuery.isReady){return;}
try{document.documentElement.doScroll("left");}catch(e){setTimeout(doScrollCheck,1);return;}
jQuery.ready();}
return jQuery;})();var
promiseMethods="done fail isResolved isRejected promise then always pipe".split(" "),sliceDeferred=[].slice;jQuery.extend({_Deferred:function(){var
callbacks=[],fired,firing,cancelled,deferred={done:function(){if(!cancelled){var args=arguments,i,length,elem,type,_fired;if(fired){_fired=fired;fired=0;}
for(i=0,length=args.length;i<length;i++){elem=args[i];type=jQuery.type(elem);if(type==="array"){deferred.done.apply(deferred,elem);}else if(type==="function"){callbacks.push(elem);}}
if(_fired){deferred.resolveWith(_fired[0],_fired[1]);}}
return this;},resolveWith:function(context,args){if(!cancelled&&!fired&&!firing){args=args||[];firing=1;try{while(callbacks[0]){callbacks.shift().apply(context,args);}}finally{fired=[context,args];firing=0;}}
return this;},resolve:function(){deferred.resolveWith(this,arguments);return this;},isResolved:function(){return!!(firing||fired);},cancel:function(){cancelled=1;callbacks=[];return this;}};return deferred;},Deferred:function(func){var deferred=jQuery._Deferred(),failDeferred=jQuery._Deferred(),promise;jQuery.extend(deferred,{then:function(doneCallbacks,failCallbacks){deferred.done(doneCallbacks).fail(failCallbacks);return this;},always:function(){return deferred.done.apply(deferred,arguments).fail.apply(this,arguments);},fail:failDeferred.done,rejectWith:failDeferred.resolveWith,reject:failDeferred.resolve,isRejected:failDeferred.isResolved,pipe:function(fnDone,fnFail){return jQuery.Deferred(function(newDefer){jQuery.each({done:[fnDone,"resolve"],fail:[fnFail,"reject"]},function(handler,data){var fn=data[0],action=data[1],returned;if(jQuery.isFunction(fn)){deferred[handler](function(){returned=fn.apply(this,arguments);if(returned&&jQuery.isFunction(returned.promise)){returned.promise().then(newDefer.resolve,newDefer.reject);}else{newDefer[action+"With"](this===deferred?newDefer:this,[returned]);}});}else{deferred[handler](newDefer[action]);}});}).promise();},promise:function(obj){if(obj==null){if(promise){return promise;}
promise=obj={};}
var i=promiseMethods.length;while(i--){obj[promiseMethods[i]]=deferred[promiseMethods[i]];}
return obj;}});deferred.done(failDeferred.cancel).fail(deferred.cancel);delete deferred.cancel;if(func){func.call(deferred,deferred);}
return deferred;},when:function(firstParam){var args=arguments,i=0,length=args.length,count=length,deferred=length<=1&&firstParam&&jQuery.isFunction(firstParam.promise)?firstParam:jQuery.Deferred();function resolveFunc(i){return function(value){args[i]=arguments.length>1?sliceDeferred.call(arguments,0):value;if(!(--count)){deferred.resolveWith(deferred,sliceDeferred.call(args,0));}};}
if(length>1){for(;i<length;i++){if(args[i]&&jQuery.isFunction(args[i].promise)){args[i].promise().then(resolveFunc(i),deferred.reject);}else{--count;}}
if(!count){deferred.resolveWith(deferred,args);}}else if(deferred!==firstParam){deferred.resolveWith(deferred,length?[firstParam]:[]);}
return deferred.promise();}});jQuery.support=(function(){var div=document.createElement("div"),documentElement=document.documentElement,all,a,select,opt,input,marginDiv,support,fragment,body,testElementParent,testElement,testElementStyle,tds,events,eventName,i,isSupported;div.setAttribute("className","t");div.innerHTML="   <link/><table></table><a href='/a' style='top:1px;float:left;opacity:.55;'>a</a><input type='checkbox'/>";all=div.getElementsByTagName("*");a=div.getElementsByTagName("a")[0];if(!all||!all.length||!a){return{};}
select=document.createElement("select");opt=select.appendChild(document.createElement("option"));input=div.getElementsByTagName("input")[0];support={leadingWhitespace:(div.firstChild.nodeType===3),tbody:!div.getElementsByTagName("tbody").length,htmlSerialize:!!div.getElementsByTagName("link").length,style:/top/.test(a.getAttribute("style")),hrefNormalized:(a.getAttribute("href")==="/a"),opacity:/^0.55$/.test(a.style.opacity),cssFloat:!!a.style.cssFloat,checkOn:(input.value==="on"),optSelected:opt.selected,getSetAttribute:div.className!=="t",submitBubbles:true,changeBubbles:true,focusinBubbles:false,deleteExpando:true,noCloneEvent:true,inlineBlockNeedsLayout:false,shrinkWrapBlocks:false,reliableMarginRight:true};input.checked=true;support.noCloneChecked=input.cloneNode(true).checked;select.disabled=true;support.optDisabled=!opt.disabled;try{delete div.test;}catch(e){support.deleteExpando=false;}
if(!div.addEventListener&&div.attachEvent&&div.fireEvent){div.attachEvent("onclick",function(){support.noCloneEvent=false;});div.cloneNode(true).fireEvent("onclick");}
input=document.createElement("input");input.value="t";input.setAttribute("type","radio");support.radioValue=input.value==="t";input.setAttribute("checked","checked");div.appendChild(input);fragment=document.createDocumentFragment();fragment.appendChild(div.firstChild);support.checkClone=fragment.cloneNode(true).cloneNode(true).lastChild.checked;div.innerHTML="";div.style.width=div.style.paddingLeft="1px";body=document.getElementsByTagName("body")[0];testElement=document.createElement(body?"div":"body");testElementStyle={visibility:"hidden",width:0,height:0,border:0,margin:0,background:"none"};if(body){jQuery.extend(testElementStyle,{position:"absolute",left:"-1000px",top:"-1000px"});}
for(i in testElementStyle){testElement.style[i]=testElementStyle[i];}
testElement.appendChild(div);testElementParent=body||documentElement;testElementParent.insertBefore(testElement,testElementParent.firstChild);support.appendChecked=input.checked;support.boxModel=div.offsetWidth===2;if("zoom"in div.style){div.style.display="inline";div.style.zoom=1;support.inlineBlockNeedsLayout=(div.offsetWidth===2);div.style.display="";div.innerHTML="<div style='width:4px;'></div>";support.shrinkWrapBlocks=(div.offsetWidth!==2);}
div.innerHTML="<table><tr><td style='padding:0;border:0;display:none'></td><td>t</td></tr></table>";tds=div.getElementsByTagName("td");isSupported=(tds[0].offsetHeight===0);tds[0].style.display="";tds[1].style.display="none";support.reliableHiddenOffsets=isSupported&&(tds[0].offsetHeight===0);div.innerHTML="";if(document.defaultView&&document.defaultView.getComputedStyle){marginDiv=document.createElement("div");marginDiv.style.width="0";marginDiv.style.marginRight="0";div.appendChild(marginDiv);support.reliableMarginRight=(parseInt((document.defaultView.getComputedStyle(marginDiv,null)||{marginRight:0}).marginRight,10)||0)===0;}
testElement.innerHTML="";testElementParent.removeChild(testElement);if(div.attachEvent){for(i in{submit:1,change:1,focusin:1}){eventName="on"+i;isSupported=(eventName in div);if(!isSupported){div.setAttribute(eventName,"return;");isSupported=(typeof div[eventName]==="function");}
support[i+"Bubbles"]=isSupported;}}
testElement=fragment=select=opt=body=marginDiv=div=input=null;return support;})();jQuery.boxModel=jQuery.support.boxModel;var rbrace=/^(?:\{.*\}|\[.*\])$/,rmultiDash=/([A-Z])/g;jQuery.extend({cache:{},uuid:0,expando:"jQuery"+(jQuery.fn.jquery+Math.random()).replace(/\D/g,""),noData:{"embed":true,"object":"clsid:D27CDB6E-AE6D-11cf-96B8-444553540000","applet":true},hasData:function(elem){elem=elem.nodeType?jQuery.cache[elem[jQuery.expando]]:elem[jQuery.expando];return!!elem&&!isEmptyDataObject(elem);},data:function(elem,name,data,pvt){if(!jQuery.acceptData(elem)){return;}
var thisCache,ret,internalKey=jQuery.expando,getByName=typeof name==="string",isNode=elem.nodeType,cache=isNode?jQuery.cache:elem,id=isNode?elem[jQuery.expando]:elem[jQuery.expando]&&jQuery.expando;if((!id||(pvt&&id&&(cache[id]&&!cache[id][internalKey])))&&getByName&&data===undefined){return;}
if(!id){if(isNode){elem[jQuery.expando]=id=++jQuery.uuid;}else{id=jQuery.expando;}}
if(!cache[id]){cache[id]={};if(!isNode){cache[id].toJSON=jQuery.noop;}}
if(typeof name==="object"||typeof name==="function"){if(pvt){cache[id][internalKey]=jQuery.extend(cache[id][internalKey],name);}else{cache[id]=jQuery.extend(cache[id],name);}}
thisCache=cache[id];if(pvt){if(!thisCache[internalKey]){thisCache[internalKey]={};}
thisCache=thisCache[internalKey];}
if(data!==undefined){thisCache[jQuery.camelCase(name)]=data;}
if(name==="events"&&!thisCache[name]){return thisCache[internalKey]&&thisCache[internalKey].events;}
if(getByName){ret=thisCache[name];if(ret==null){ret=thisCache[jQuery.camelCase(name)];}}else{ret=thisCache;}
return ret;},removeData:function(elem,name,pvt){if(!jQuery.acceptData(elem)){return;}
var thisCache,internalKey=jQuery.expando,isNode=elem.nodeType,cache=isNode?jQuery.cache:elem,id=isNode?elem[jQuery.expando]:jQuery.expando;if(!cache[id]){return;}
if(name){thisCache=pvt?cache[id][internalKey]:cache[id];if(thisCache){if(!thisCache[name]){name=jQuery.camelCase(name);}
delete thisCache[name];if(!isEmptyDataObject(thisCache)){return;}}}
if(pvt){delete cache[id][internalKey];if(!isEmptyDataObject(cache[id])){return;}}
var internalCache=cache[id][internalKey];if(jQuery.support.deleteExpando||!cache.setInterval){delete cache[id];}else{cache[id]=null;}
if(internalCache){cache[id]={};if(!isNode){cache[id].toJSON=jQuery.noop;}
cache[id][internalKey]=internalCache;}else if(isNode){if(jQuery.support.deleteExpando){delete elem[jQuery.expando];}else if(elem.removeAttribute){elem.removeAttribute(jQuery.expando);}else{elem[jQuery.expando]=null;}}},_data:function(elem,name,data){return jQuery.data(elem,name,data,true);},acceptData:function(elem){if(elem.nodeName){var match=jQuery.noData[elem.nodeName.toLowerCase()];if(match){return!(match===true||elem.getAttribute("classid")!==match);}}
return true;}});jQuery.fn.extend({data:function(key,value){var data=null;if(typeof key==="undefined"){if(this.length){data=jQuery.data(this[0]);if(this[0].nodeType===1){var attr=this[0].attributes,name;for(var i=0,l=attr.length;i<l;i++){name=attr[i].name;if(name.indexOf("data-")===0){name=jQuery.camelCase(name.substring(5));dataAttr(this[0],name,data[name]);}}}}
return data;}else if(typeof key==="object"){return this.each(function(){jQuery.data(this,key);});}
var parts=key.split(".");parts[1]=parts[1]?"."+parts[1]:"";if(value===undefined){data=this.triggerHandler("getData"+parts[1]+"!",[parts[0]]);if(data===undefined&&this.length){data=jQuery.data(this[0],key);data=dataAttr(this[0],key,data);}
return data===undefined&&parts[1]?this.data(parts[0]):data;}else{return this.each(function(){var $this=jQuery(this),args=[parts[0],value];$this.triggerHandler("setData"+parts[1]+"!",args);jQuery.data(this,key,value);$this.triggerHandler("changeData"+parts[1]+"!",args);});}},removeData:function(key){return this.each(function(){jQuery.removeData(this,key);});}});function dataAttr(elem,key,data){if(data===undefined&&elem.nodeType===1){var name="data-"+key.replace(rmultiDash,"-$1").toLowerCase();data=elem.getAttribute(name);if(typeof data==="string"){try{data=data==="true"?true:data==="false"?false:data==="null"?null:!jQuery.isNaN(data)?parseFloat(data):rbrace.test(data)?jQuery.parseJSON(data):data;}catch(e){}
jQuery.data(elem,key,data);}else{data=undefined;}}
return data;}
function isEmptyDataObject(obj){for(var name in obj){if(name!=="toJSON"){return false;}}
return true;}
function handleQueueMarkDefer(elem,type,src){var deferDataKey=type+"defer",queueDataKey=type+"queue",markDataKey=type+"mark",defer=jQuery.data(elem,deferDataKey,undefined,true);if(defer&&(src==="queue"||!jQuery.data(elem,queueDataKey,undefined,true))&&(src==="mark"||!jQuery.data(elem,markDataKey,undefined,true))){setTimeout(function(){if(!jQuery.data(elem,queueDataKey,undefined,true)&&!jQuery.data(elem,markDataKey,undefined,true)){jQuery.removeData(elem,deferDataKey,true);defer.resolve();}},0);}}
jQuery.extend({_mark:function(elem,type){if(elem){type=(type||"fx")+"mark";jQuery.data(elem,type,(jQuery.data(elem,type,undefined,true)||0)+1,true);}},_unmark:function(force,elem,type){if(force!==true){type=elem;elem=force;force=false;}
if(elem){type=type||"fx";var key=type+"mark",count=force?0:((jQuery.data(elem,key,undefined,true)||1)-1);if(count){jQuery.data(elem,key,count,true);}else{jQuery.removeData(elem,key,true);handleQueueMarkDefer(elem,type,"mark");}}},queue:function(elem,type,data){if(elem){type=(type||"fx")+"queue";var q=jQuery.data(elem,type,undefined,true);if(data){if(!q||jQuery.isArray(data)){q=jQuery.data(elem,type,jQuery.makeArray(data),true);}else{q.push(data);}}
return q||[];}},dequeue:function(elem,type){type=type||"fx";var queue=jQuery.queue(elem,type),fn=queue.shift(),defer;if(fn==="inprogress"){fn=queue.shift();}
if(fn){if(type==="fx"){queue.unshift("inprogress");}
fn.call(elem,function(){jQuery.dequeue(elem,type);});}
if(!queue.length){jQuery.removeData(elem,type+"queue",true);handleQueueMarkDefer(elem,type,"queue");}}});jQuery.fn.extend({queue:function(type,data){if(typeof type!=="string"){data=type;type="fx";}
if(data===undefined){return jQuery.queue(this[0],type);}
return this.each(function(){var queue=jQuery.queue(this,type,data);if(type==="fx"&&queue[0]!=="inprogress"){jQuery.dequeue(this,type);}});},dequeue:function(type){return this.each(function(){jQuery.dequeue(this,type);});},delay:function(time,type){time=jQuery.fx?jQuery.fx.speeds[time]||time:time;type=type||"fx";return this.queue(type,function(){var elem=this;setTimeout(function(){jQuery.dequeue(elem,type);},time);});},clearQueue:function(type){return this.queue(type||"fx",[]);},promise:function(type,object){if(typeof type!=="string"){object=type;type=undefined;}
type=type||"fx";var defer=jQuery.Deferred(),elements=this,i=elements.length,count=1,deferDataKey=type+"defer",queueDataKey=type+"queue",markDataKey=type+"mark",tmp;function resolve(){if(!(--count)){defer.resolveWith(elements,[elements]);}}
while(i--){if((tmp=jQuery.data(elements[i],deferDataKey,undefined,true)||(jQuery.data(elements[i],queueDataKey,undefined,true)||jQuery.data(elements[i],markDataKey,undefined,true))&&jQuery.data(elements[i],deferDataKey,jQuery._Deferred(),true))){count++;tmp.done(resolve);}}
resolve();return defer.promise();}});var rclass=/[\n\t\r]/g,rspace=/\s+/,rreturn=/\r/g,rtype=/^(?:button|input)$/i,rfocusable=/^(?:button|input|object|select|textarea)$/i,rclickable=/^a(?:rea)?$/i,rboolean=/^(?:autofocus|autoplay|async|checked|controls|defer|disabled|hidden|loop|multiple|open|readonly|required|scoped|selected)$/i,nodeHook,boolHook;jQuery.fn.extend({attr:function(name,value){return jQuery.access(this,name,value,true,jQuery.attr);},removeAttr:function(name){return this.each(function(){jQuery.removeAttr(this,name);});},prop:function(name,value){return jQuery.access(this,name,value,true,jQuery.prop);},removeProp:function(name){name=jQuery.propFix[name]||name;return this.each(function(){try{this[name]=undefined;delete this[name];}catch(e){}});},addClass:function(value){var classNames,i,l,elem,setClass,c,cl;if(jQuery.isFunction(value)){return this.each(function(j){jQuery(this).addClass(value.call(this,j,this.className));});}
if(value&&typeof value==="string"){classNames=value.split(rspace);for(i=0,l=this.length;i<l;i++){elem=this[i];if(elem.nodeType===1){if(!elem.className&&classNames.length===1){elem.className=value;}else{setClass=" "+elem.className+" ";for(c=0,cl=classNames.length;c<cl;c++){if(!~setClass.indexOf(" "+classNames[c]+" ")){setClass+=classNames[c]+" ";}}
elem.className=jQuery.trim(setClass);}}}}
return this;},removeClass:function(value){var classNames,i,l,elem,className,c,cl;if(jQuery.isFunction(value)){return this.each(function(j){jQuery(this).removeClass(value.call(this,j,this.className));});}
if((value&&typeof value==="string")||value===undefined){classNames=(value||"").split(rspace);for(i=0,l=this.length;i<l;i++){elem=this[i];if(elem.nodeType===1&&elem.className){if(value){className=(" "+elem.className+" ").replace(rclass," ");for(c=0,cl=classNames.length;c<cl;c++){className=className.replace(" "+classNames[c]+" "," ");}
elem.className=jQuery.trim(className);}else{elem.className="";}}}}
return this;},toggleClass:function(value,stateVal){var type=typeof value,isBool=typeof stateVal==="boolean";if(jQuery.isFunction(value)){return this.each(function(i){jQuery(this).toggleClass(value.call(this,i,this.className,stateVal),stateVal);});}
return this.each(function(){if(type==="string"){var className,i=0,self=jQuery(this),state=stateVal,classNames=value.split(rspace);while((className=classNames[i++])){state=isBool?state:!self.hasClass(className);self[state?"addClass":"removeClass"](className);}}else if(type==="undefined"||type==="boolean"){if(this.className){jQuery._data(this,"__className__",this.className);}
this.className=this.className||value===false?"":jQuery._data(this,"__className__")||"";}});},hasClass:function(selector){var className=" "+selector+" ";for(var i=0,l=this.length;i<l;i++){if(this[i].nodeType===1&&(" "+this[i].className+" ").replace(rclass," ").indexOf(className)>-1){return true;}}
return false;},val:function(value){var hooks,ret,elem=this[0];if(!arguments.length){if(elem){hooks=jQuery.valHooks[elem.nodeName.toLowerCase()]||jQuery.valHooks[elem.type];if(hooks&&"get"in hooks&&(ret=hooks.get(elem,"value"))!==undefined){return ret;}
ret=elem.value;return typeof ret==="string"?ret.replace(rreturn,""):ret==null?"":ret;}
return undefined;}
var isFunction=jQuery.isFunction(value);return this.each(function(i){var self=jQuery(this),val;if(this.nodeType!==1){return;}
if(isFunction){val=value.call(this,i,self.val());}else{val=value;}
if(val==null){val="";}else if(typeof val==="number"){val+="";}else if(jQuery.isArray(val)){val=jQuery.map(val,function(value){return value==null?"":value+"";});}
hooks=jQuery.valHooks[this.nodeName.toLowerCase()]||jQuery.valHooks[this.type];if(!hooks||!("set"in hooks)||hooks.set(this,val,"value")===undefined){this.value=val;}});}});jQuery.extend({valHooks:{option:{get:function(elem){var val=elem.attributes.value;return!val||val.specified?elem.value:elem.text;}},select:{get:function(elem){var value,index=elem.selectedIndex,values=[],options=elem.options,one=elem.type==="select-one";if(index<0){return null;}
for(var i=one?index:0,max=one?index+1:options.length;i<max;i++){var option=options[i];if(option.selected&&(jQuery.support.optDisabled?!option.disabled:option.getAttribute("disabled")===null)&&(!option.parentNode.disabled||!jQuery.nodeName(option.parentNode,"optgroup"))){value=jQuery(option).val();if(one){return value;}
values.push(value);}}
if(one&&!values.length&&options.length){return jQuery(options[index]).val();}
return values;},set:function(elem,value){var values=jQuery.makeArray(value);jQuery(elem).find("option").each(function(){this.selected=jQuery.inArray(jQuery(this).val(),values)>=0;});if(!values.length){elem.selectedIndex=-1;}
return values;}}},attrFn:{val:true,css:true,html:true,text:true,data:true,width:true,height:true,offset:true},attrFix:{tabindex:"tabIndex"},attr:function(elem,name,value,pass){var nType=elem.nodeType;if(!elem||nType===3||nType===8||nType===2){return undefined;}
if(pass&&name in jQuery.attrFn){return jQuery(elem)[name](value);}
if(!("getAttribute"in elem)){return jQuery.prop(elem,name,value);}
var ret,hooks,notxml=nType!==1||!jQuery.isXMLDoc(elem);if(notxml){name=jQuery.attrFix[name]||name;hooks=jQuery.attrHooks[name];if(!hooks){if(rboolean.test(name)){hooks=boolHook;}else if(nodeHook){hooks=nodeHook;}}}
if(value!==undefined){if(value===null){jQuery.removeAttr(elem,name);return undefined;}else if(hooks&&"set"in hooks&&notxml&&(ret=hooks.set(elem,value,name))!==undefined){return ret;}else{elem.setAttribute(name,""+value);return value;}}else if(hooks&&"get"in hooks&&notxml&&(ret=hooks.get(elem,name))!==null){return ret;}else{ret=elem.getAttribute(name);return ret===null?undefined:ret;}},removeAttr:function(elem,name){var propName;if(elem.nodeType===1){name=jQuery.attrFix[name]||name;jQuery.attr(elem,name,"");elem.removeAttribute(name);if(rboolean.test(name)&&(propName=jQuery.propFix[name]||name)in elem){elem[propName]=false;}}},attrHooks:{type:{set:function(elem,value){if(rtype.test(elem.nodeName)&&elem.parentNode){jQuery.error("type property can't be changed");}else if(!jQuery.support.radioValue&&value==="radio"&&jQuery.nodeName(elem,"input")){var val=elem.value;elem.setAttribute("type",value);if(val){elem.value=val;}
return value;}}},value:{get:function(elem,name){if(nodeHook&&jQuery.nodeName(elem,"button")){return nodeHook.get(elem,name);}
return name in elem?elem.value:null;},set:function(elem,value,name){if(nodeHook&&jQuery.nodeName(elem,"button")){return nodeHook.set(elem,value,name);}
elem.value=value;}}},propFix:{tabindex:"tabIndex",readonly:"readOnly","for":"htmlFor","class":"className",maxlength:"maxLength",cellspacing:"cellSpacing",cellpadding:"cellPadding",rowspan:"rowSpan",colspan:"colSpan",usemap:"useMap",frameborder:"frameBorder",contenteditable:"contentEditable"},prop:function(elem,name,value){var nType=elem.nodeType;if(!elem||nType===3||nType===8||nType===2){return undefined;}
var ret,hooks,notxml=nType!==1||!jQuery.isXMLDoc(elem);if(notxml){name=jQuery.propFix[name]||name;hooks=jQuery.propHooks[name];}
if(value!==undefined){if(hooks&&"set"in hooks&&(ret=hooks.set(elem,value,name))!==undefined){return ret;}else{return(elem[name]=value);}}else{if(hooks&&"get"in hooks&&(ret=hooks.get(elem,name))!==null){return ret;}else{return elem[name];}}},propHooks:{tabIndex:{get:function(elem){var attributeNode=elem.getAttributeNode("tabindex");return attributeNode&&attributeNode.specified?parseInt(attributeNode.value,10):rfocusable.test(elem.nodeName)||rclickable.test(elem.nodeName)&&elem.href?0:undefined;}}}});jQuery.attrHooks.tabIndex=jQuery.propHooks.tabIndex;boolHook={get:function(elem,name){var attrNode;return jQuery.prop(elem,name)===true||(attrNode=elem.getAttributeNode(name))&&attrNode.nodeValue!==false?name.toLowerCase():undefined;},set:function(elem,value,name){var propName;if(value===false){jQuery.removeAttr(elem,name);}else{propName=jQuery.propFix[name]||name;if(propName in elem){elem[propName]=true;}
elem.setAttribute(name,name.toLowerCase());}
return name;}};if(!jQuery.support.getSetAttribute){nodeHook=jQuery.valHooks.button={get:function(elem,name){var ret;ret=elem.getAttributeNode(name);return ret&&ret.nodeValue!==""?ret.nodeValue:undefined;},set:function(elem,value,name){var ret=elem.getAttributeNode(name);if(!ret){ret=document.createAttribute(name);elem.setAttributeNode(ret);}
return(ret.nodeValue=value+"");}};jQuery.each(["width","height"],function(i,name){jQuery.attrHooks[name]=jQuery.extend(jQuery.attrHooks[name],{set:function(elem,value){if(value===""){elem.setAttribute(name,"auto");return value;}}});});}
if(!jQuery.support.hrefNormalized){jQuery.each(["href","src","width","height"],function(i,name){jQuery.attrHooks[name]=jQuery.extend(jQuery.attrHooks[name],{get:function(elem){var ret=elem.getAttribute(name,2);return ret===null?undefined:ret;}});});}
if(!jQuery.support.style){jQuery.attrHooks.style={get:function(elem){return elem.style.cssText.toLowerCase()||undefined;},set:function(elem,value){return(elem.style.cssText=""+value);}};}
if(!jQuery.support.optSelected){jQuery.propHooks.selected=jQuery.extend(jQuery.propHooks.selected,{get:function(elem){var parent=elem.parentNode;if(parent){parent.selectedIndex;if(parent.parentNode){parent.parentNode.selectedIndex;}}
return null;}});}
if(!jQuery.support.checkOn){jQuery.each(["radio","checkbox"],function(){jQuery.valHooks[this]={get:function(elem){return elem.getAttribute("value")===null?"on":elem.value;}};});}
jQuery.each(["radio","checkbox"],function(){jQuery.valHooks[this]=jQuery.extend(jQuery.valHooks[this],{set:function(elem,value){if(jQuery.isArray(value)){return(elem.checked=jQuery.inArray(jQuery(elem).val(),value)>=0);}}});});var rnamespaces=/\.(.*)$/,rformElems=/^(?:textarea|input|select)$/i,rperiod=/\./g,rspaces=/ /g,rescape=/[^\w\s.|`]/g,fcleanup=function(nm){return nm.replace(rescape,"\\$&");};jQuery.event={add:function(elem,types,handler,data){if(elem.nodeType===3||elem.nodeType===8){return;}
if(handler===false){handler=returnFalse;}else if(!handler){return;}
var handleObjIn,handleObj;if(handler.handler){handleObjIn=handler;handler=handleObjIn.handler;}
if(!handler.guid){handler.guid=jQuery.guid++;}
var elemData=jQuery._data(elem);if(!elemData){return;}
var events=elemData.events,eventHandle=elemData.handle;if(!events){elemData.events=events={};}
if(!eventHandle){elemData.handle=eventHandle=function(e){return typeof jQuery!=="undefined"&&(!e||jQuery.event.triggered!==e.type)?jQuery.event.handle.apply(eventHandle.elem,arguments):undefined;};}
eventHandle.elem=elem;types=types.split(" ");var type,i=0,namespaces;while((type=types[i++])){handleObj=handleObjIn?jQuery.extend({},handleObjIn):{handler:handler,data:data};if(type.indexOf(".")>-1){namespaces=type.split(".");type=namespaces.shift();handleObj.namespace=namespaces.slice(0).sort().join(".");}else{namespaces=[];handleObj.namespace="";}
handleObj.type=type;if(!handleObj.guid){handleObj.guid=handler.guid;}
var handlers=events[type],special=jQuery.event.special[type]||{};if(!handlers){handlers=events[type]=[];if(!special.setup||special.setup.call(elem,data,namespaces,eventHandle)===false){if(elem.addEventListener){elem.addEventListener(type,eventHandle,false);}else if(elem.attachEvent){elem.attachEvent("on"+type,eventHandle);}}}
if(special.add){special.add.call(elem,handleObj);if(!handleObj.handler.guid){handleObj.handler.guid=handler.guid;}}
handlers.push(handleObj);jQuery.event.global[type]=true;}
elem=null;},global:{},remove:function(elem,types,handler,pos){if(elem.nodeType===3||elem.nodeType===8){return;}
if(handler===false){handler=returnFalse;}
var ret,type,fn,j,i=0,all,namespaces,namespace,special,eventType,handleObj,origType,elemData=jQuery.hasData(elem)&&jQuery._data(elem),events=elemData&&elemData.events;if(!elemData||!events){return;}
if(types&&types.type){handler=types.handler;types=types.type;}
if(!types||typeof types==="string"&&types.charAt(0)==="."){types=types||"";for(type in events){jQuery.event.remove(elem,type+types);}
return;}
types=types.split(" ");while((type=types[i++])){origType=type;handleObj=null;all=type.indexOf(".")<0;namespaces=[];if(!all){namespaces=type.split(".");type=namespaces.shift();namespace=new RegExp("(^|\\.)"+
jQuery.map(namespaces.slice(0).sort(),fcleanup).join("\\.(?:.*\\.)?")+"(\\.|$)");}
eventType=events[type];if(!eventType){continue;}
if(!handler){for(j=0;j<eventType.length;j++){handleObj=eventType[j];if(all||namespace.test(handleObj.namespace)){jQuery.event.remove(elem,origType,handleObj.handler,j);eventType.splice(j--,1);}}
continue;}
special=jQuery.event.special[type]||{};for(j=pos||0;j<eventType.length;j++){handleObj=eventType[j];if(handler.guid===handleObj.guid){if(all||namespace.test(handleObj.namespace)){if(pos==null){eventType.splice(j--,1);}
if(special.remove){special.remove.call(elem,handleObj);}}
if(pos!=null){break;}}}
if(eventType.length===0||pos!=null&&eventType.length===1){if(!special.teardown||special.teardown.call(elem,namespaces)===false){jQuery.removeEvent(elem,type,elemData.handle);}
ret=null;delete events[type];}}
if(jQuery.isEmptyObject(events)){var handle=elemData.handle;if(handle){handle.elem=null;}
delete elemData.events;delete elemData.handle;if(jQuery.isEmptyObject(elemData)){jQuery.removeData(elem,undefined,true);}}},customEvent:{"getData":true,"setData":true,"changeData":true},trigger:function(event,data,elem,onlyHandlers){var type=event.type||event,namespaces=[],exclusive;if(type.indexOf("!")>=0){type=type.slice(0,-1);exclusive=true;}
if(type.indexOf(".")>=0){namespaces=type.split(".");type=namespaces.shift();namespaces.sort();}
if((!elem||jQuery.event.customEvent[type])&&!jQuery.event.global[type]){return;}
event=typeof event==="object"?event[jQuery.expando]?event:new jQuery.Event(type,event):new jQuery.Event(type);event.type=type;event.exclusive=exclusive;event.namespace=namespaces.join(".");event.namespace_re=new RegExp("(^|\\.)"+namespaces.join("\\.(?:.*\\.)?")+"(\\.|$)");if(onlyHandlers||!elem){event.preventDefault();event.stopPropagation();}
if(!elem){jQuery.each(jQuery.cache,function(){var internalKey=jQuery.expando,internalCache=this[internalKey];if(internalCache&&internalCache.events&&internalCache.events[type]){jQuery.event.trigger(event,data,internalCache.handle.elem);}});return;}
if(elem.nodeType===3||elem.nodeType===8){return;}
event.result=undefined;event.target=elem;data=data!=null?jQuery.makeArray(data):[];data.unshift(event);var cur=elem,ontype=type.indexOf(":")<0?"on"+type:"";do{var handle=jQuery._data(cur,"handle");event.currentTarget=cur;if(handle){handle.apply(cur,data);}
if(ontype&&jQuery.acceptData(cur)&&cur[ontype]&&cur[ontype].apply(cur,data)===false){event.result=false;event.preventDefault();}
cur=cur.parentNode||cur.ownerDocument||cur===event.target.ownerDocument&&window;}while(cur&&!event.isPropagationStopped());if(!event.isDefaultPrevented()){var old,special=jQuery.event.special[type]||{};if((!special._default||special._default.call(elem.ownerDocument,event)===false)&&!(type==="click"&&jQuery.nodeName(elem,"a"))&&jQuery.acceptData(elem)){try{if(ontype&&elem[type]){old=elem[ontype];if(old){elem[ontype]=null;}
jQuery.event.triggered=type;elem[type]();}}catch(ieError){}
if(old){elem[ontype]=old;}
jQuery.event.triggered=undefined;}}
return event.result;},handle:function(event){event=jQuery.event.fix(event||window.event);var handlers=((jQuery._data(this,"events")||{})[event.type]||[]).slice(0),run_all=!event.exclusive&&!event.namespace,args=Array.prototype.slice.call(arguments,0);args[0]=event;event.currentTarget=this;for(var j=0,l=handlers.length;j<l;j++){var handleObj=handlers[j];if(run_all||event.namespace_re.test(handleObj.namespace)){event.handler=handleObj.handler;event.data=handleObj.data;event.handleObj=handleObj;var ret=handleObj.handler.apply(this,args);if(ret!==undefined){event.result=ret;if(ret===false){event.preventDefault();event.stopPropagation();}}
if(event.isImmediatePropagationStopped()){break;}}}
return event.result;},props:"altKey attrChange attrName bubbles button cancelable charCode clientX clientY ctrlKey currentTarget data detail eventPhase fromElement handler keyCode layerX layerY metaKey newValue offsetX offsetY pageX pageY prevValue relatedNode relatedTarget screenX screenY shiftKey srcElement target toElement view wheelDelta which".split(" "),fix:function(event){if(event[jQuery.expando]){return event;}
var originalEvent=event;event=jQuery.Event(originalEvent);for(var i=this.props.length,prop;i;){prop=this.props[--i];event[prop]=originalEvent[prop];}
if(!event.target){event.target=event.srcElement||document;}
if(event.target.nodeType===3){event.target=event.target.parentNode;}
if(!event.relatedTarget&&event.fromElement){event.relatedTarget=event.fromElement===event.target?event.toElement:event.fromElement;}
if(event.pageX==null&&event.clientX!=null){var eventDocument=event.target.ownerDocument||document,doc=eventDocument.documentElement,body=eventDocument.body;event.pageX=event.clientX+(doc&&doc.scrollLeft||body&&body.scrollLeft||0)-(doc&&doc.clientLeft||body&&body.clientLeft||0);event.pageY=event.clientY+(doc&&doc.scrollTop||body&&body.scrollTop||0)-(doc&&doc.clientTop||body&&body.clientTop||0);}
if(event.which==null&&(event.charCode!=null||event.keyCode!=null)){event.which=event.charCode!=null?event.charCode:event.keyCode;}
if(!event.metaKey&&event.ctrlKey){event.metaKey=event.ctrlKey;}
if(!event.which&&event.button!==undefined){event.which=(event.button&1?1:(event.button&2?3:(event.button&4?2:0)));}
return event;},guid:1E8,proxy:jQuery.proxy,special:{ready:{setup:jQuery.bindReady,teardown:jQuery.noop},live:{add:function(handleObj){jQuery.event.add(this,liveConvert(handleObj.origType,handleObj.selector),jQuery.extend({},handleObj,{handler:liveHandler,guid:handleObj.handler.guid}));},remove:function(handleObj){jQuery.event.remove(this,liveConvert(handleObj.origType,handleObj.selector),handleObj);}},beforeunload:{setup:function(data,namespaces,eventHandle){if(jQuery.isWindow(this)){this.onbeforeunload=eventHandle;}},teardown:function(namespaces,eventHandle){if(this.onbeforeunload===eventHandle){this.onbeforeunload=null;}}}}};jQuery.removeEvent=document.removeEventListener?function(elem,type,handle){if(elem.removeEventListener){elem.removeEventListener(type,handle,false);}}:function(elem,type,handle){if(elem.detachEvent){elem.detachEvent("on"+type,handle);}};jQuery.Event=function(src,props){if(!this.preventDefault){return new jQuery.Event(src,props);}
if(src&&src.type){this.originalEvent=src;this.type=src.type;this.isDefaultPrevented=(src.defaultPrevented||src.returnValue===false||src.getPreventDefault&&src.getPreventDefault())?returnTrue:returnFalse;}else{this.type=src;}
if(props){jQuery.extend(this,props);}
this.timeStamp=jQuery.now();this[jQuery.expando]=true;};function returnFalse(){return false;}
function returnTrue(){return true;}
jQuery.Event.prototype={preventDefault:function(){this.isDefaultPrevented=returnTrue;var e=this.originalEvent;if(!e){return;}
if(e.preventDefault){e.preventDefault();}else{e.returnValue=false;}},stopPropagation:function(){this.isPropagationStopped=returnTrue;var e=this.originalEvent;if(!e){return;}
if(e.stopPropagation){e.stopPropagation();}
e.cancelBubble=true;},stopImmediatePropagation:function(){this.isImmediatePropagationStopped=returnTrue;this.stopPropagation();},isDefaultPrevented:returnFalse,isPropagationStopped:returnFalse,isImmediatePropagationStopped:returnFalse};var withinElement=function(event){var related=event.relatedTarget,inside=false,eventType=event.type;event.type=event.data;if(related!==this){if(related){inside=jQuery.contains(this,related);}
if(!inside){jQuery.event.handle.apply(this,arguments);event.type=eventType;}}},delegate=function(event){event.type=event.data;jQuery.event.handle.apply(this,arguments);};jQuery.each({mouseenter:"mouseover",mouseleave:"mouseout"},function(orig,fix){jQuery.event.special[orig]={setup:function(data){jQuery.event.add(this,fix,data&&data.selector?delegate:withinElement,orig);},teardown:function(data){jQuery.event.remove(this,fix,data&&data.selector?delegate:withinElement);}};});if(!jQuery.support.submitBubbles){jQuery.event.special.submit={setup:function(data,namespaces){if(!jQuery.nodeName(this,"form")){jQuery.event.add(this,"click.specialSubmit",function(e){var elem=e.target,type=jQuery.nodeName(elem,"input")||jQuery.nodeName(elem,"button")?elem.type:"";if((type==="submit"||type==="image")&&jQuery(elem).closest("form").length){trigger("submit",this,arguments);}});jQuery.event.add(this,"keypress.specialSubmit",function(e){var elem=e.target,type=jQuery.nodeName(elem,"input")||jQuery.nodeName(elem,"button")?elem.type:"";if((type==="text"||type==="password")&&jQuery(elem).closest("form").length&&e.keyCode===13){trigger("submit",this,arguments);}});}else{return false;}},teardown:function(namespaces){jQuery.event.remove(this,".specialSubmit");}};}
if(!jQuery.support.changeBubbles){var changeFilters,getVal=function(elem){var type=jQuery.nodeName(elem,"input")?elem.type:"",val=elem.value;if(type==="radio"||type==="checkbox"){val=elem.checked;}else if(type==="select-multiple"){val=elem.selectedIndex>-1?jQuery.map(elem.options,function(elem){return elem.selected;}).join("-"):"";}else if(jQuery.nodeName(elem,"select")){val=elem.selectedIndex;}
return val;},testChange=function testChange(e){var elem=e.target,data,val;if(!rformElems.test(elem.nodeName)||elem.readOnly){return;}
data=jQuery._data(elem,"_change_data");val=getVal(elem);if(e.type!=="focusout"||elem.type!=="radio"){jQuery._data(elem,"_change_data",val);}
if(data===undefined||val===data){return;}
if(data!=null||val){e.type="change";e.liveFired=undefined;jQuery.event.trigger(e,arguments[1],elem);}};jQuery.event.special.change={filters:{focusout:testChange,beforedeactivate:testChange,click:function(e){var elem=e.target,type=jQuery.nodeName(elem,"input")?elem.type:"";if(type==="radio"||type==="checkbox"||jQuery.nodeName(elem,"select")){testChange.call(this,e);}},keydown:function(e){var elem=e.target,type=jQuery.nodeName(elem,"input")?elem.type:"";if((e.keyCode===13&&!jQuery.nodeName(elem,"textarea"))||(e.keyCode===32&&(type==="checkbox"||type==="radio"))||type==="select-multiple"){testChange.call(this,e);}},beforeactivate:function(e){var elem=e.target;jQuery._data(elem,"_change_data",getVal(elem));}},setup:function(data,namespaces){if(this.type==="file"){return false;}
for(var type in changeFilters){jQuery.event.add(this,type+".specialChange",changeFilters[type]);}
return rformElems.test(this.nodeName);},teardown:function(namespaces){jQuery.event.remove(this,".specialChange");return rformElems.test(this.nodeName);}};changeFilters=jQuery.event.special.change.filters;changeFilters.focus=changeFilters.beforeactivate;}
function trigger(type,elem,args){var event=jQuery.extend({},args[0]);event.type=type;event.originalEvent={};event.liveFired=undefined;jQuery.event.handle.call(elem,event);if(event.isDefaultPrevented()){args[0].preventDefault();}}
if(!jQuery.support.focusinBubbles){jQuery.each({focus:"focusin",blur:"focusout"},function(orig,fix){var attaches=0;jQuery.event.special[fix]={setup:function(){if(attaches++===0){document.addEventListener(orig,handler,true);}},teardown:function(){if(--attaches===0){document.removeEventListener(orig,handler,true);}}};function handler(donor){var e=jQuery.event.fix(donor);e.type=fix;e.originalEvent={};jQuery.event.trigger(e,null,e.target);if(e.isDefaultPrevented()){donor.preventDefault();}}});}
jQuery.each(["bind","one"],function(i,name){jQuery.fn[name]=function(type,data,fn){var handler;if(typeof type==="object"){for(var key in type){this[name](key,data,type[key],fn);}
return this;}
if(arguments.length===2||data===false){fn=data;data=undefined;}
if(name==="one"){handler=function(event){jQuery(this).unbind(event,handler);return fn.apply(this,arguments);};handler.guid=fn.guid||jQuery.guid++;}else{handler=fn;}
if(type==="unload"&&name!=="one"){this.one(type,data,fn);}else{for(var i=0,l=this.length;i<l;i++){jQuery.event.add(this[i],type,handler,data);}}
return this;};});jQuery.fn.extend({unbind:function(type,fn){if(typeof type==="object"&&!type.preventDefault){for(var key in type){this.unbind(key,type[key]);}}else{for(var i=0,l=this.length;i<l;i++){jQuery.event.remove(this[i],type,fn);}}
return this;},delegate:function(selector,types,data,fn){return this.live(types,data,fn,selector);},undelegate:function(selector,types,fn){if(arguments.length===0){return this.unbind("live");}else{return this.die(types,null,fn,selector);}},trigger:function(type,data){return this.each(function(){jQuery.event.trigger(type,data,this);});},triggerHandler:function(type,data){if(this[0]){return jQuery.event.trigger(type,data,this[0],true);}},toggle:function(fn){var args=arguments,guid=fn.guid||jQuery.guid++,i=0,toggler=function(event){var lastToggle=(jQuery.data(this,"lastToggle"+fn.guid)||0)%i;jQuery.data(this,"lastToggle"+fn.guid,lastToggle+1);event.preventDefault();return args[lastToggle].apply(this,arguments)||false;};toggler.guid=guid;while(i<args.length){args[i++].guid=guid;}
return this.click(toggler);},hover:function(fnOver,fnOut){return this.mouseenter(fnOver).mouseleave(fnOut||fnOver);}});var liveMap={focus:"focusin",blur:"focusout",mouseenter:"mouseover",mouseleave:"mouseout"};jQuery.each(["live","die"],function(i,name){jQuery.fn[name]=function(types,data,fn,origSelector){var type,i=0,match,namespaces,preType,selector=origSelector||this.selector,context=origSelector?this:jQuery(this.context);if(typeof types==="object"&&!types.preventDefault){for(var key in types){context[name](key,data,types[key],selector);}
return this;}
if(name==="die"&&!types&&origSelector&&origSelector.charAt(0)==="."){context.unbind(origSelector);return this;}
if(data===false||jQuery.isFunction(data)){fn=data||returnFalse;data=undefined;}
types=(types||"").split(" ");while((type=types[i++])!=null){match=rnamespaces.exec(type);namespaces="";if(match){namespaces=match[0];type=type.replace(rnamespaces,"");}
if(type==="hover"){types.push("mouseenter"+namespaces,"mouseleave"+namespaces);continue;}
preType=type;if(liveMap[type]){types.push(liveMap[type]+namespaces);type=type+namespaces;}else{type=(liveMap[type]||type)+namespaces;}
if(name==="live"){for(var j=0,l=context.length;j<l;j++){jQuery.event.add(context[j],"live."+liveConvert(type,selector),{data:data,selector:selector,handler:fn,origType:type,origHandler:fn,preType:preType});}}else{context.unbind("live."+liveConvert(type,selector),fn);}}
return this;};});function liveHandler(event){var stop,maxLevel,related,match,handleObj,elem,j,i,l,data,close,namespace,ret,elems=[],selectors=[],events=jQuery._data(this,"events");if(event.liveFired===this||!events||!events.live||event.target.disabled||event.button&&event.type==="click"){return;}
if(event.namespace){namespace=new RegExp("(^|\\.)"+event.namespace.split(".").join("\\.(?:.*\\.)?")+"(\\.|$)");}
event.liveFired=this;var live=events.live.slice(0);for(j=0;j<live.length;j++){handleObj=live[j];if(handleObj.origType.replace(rnamespaces,"")===event.type){selectors.push(handleObj.selector);}else{live.splice(j--,1);}}
match=jQuery(event.target).closest(selectors,event.currentTarget);for(i=0,l=match.length;i<l;i++){close=match[i];for(j=0;j<live.length;j++){handleObj=live[j];if(close.selector===handleObj.selector&&(!namespace||namespace.test(handleObj.namespace))&&!close.elem.disabled){elem=close.elem;related=null;if(handleObj.preType==="mouseenter"||handleObj.preType==="mouseleave"){event.type=handleObj.preType;related=jQuery(event.relatedTarget).closest(handleObj.selector)[0];if(related&&jQuery.contains(elem,related)){related=elem;}}
if(!related||related!==elem){elems.push({elem:elem,handleObj:handleObj,level:close.level});}}}}
for(i=0,l=elems.length;i<l;i++){match=elems[i];if(maxLevel&&match.level>maxLevel){break;}
event.currentTarget=match.elem;event.data=match.handleObj.data;event.handleObj=match.handleObj;ret=match.handleObj.origHandler.apply(match.elem,arguments);if(ret===false||event.isPropagationStopped()){maxLevel=match.level;if(ret===false){stop=false;}
if(event.isImmediatePropagationStopped()){break;}}}
return stop;}
function liveConvert(type,selector){return(type&&type!=="*"?type+".":"")+selector.replace(rperiod,"`").replace(rspaces,"&");}
jQuery.each(("blur focus focusin focusout load resize scroll unload click dblclick "+"mousedown mouseup mousemove mouseover mouseout mouseenter mouseleave "+"change select submit keydown keypress keyup error").split(" "),function(i,name){jQuery.fn[name]=function(data,fn){if(fn==null){fn=data;data=null;}
return arguments.length>0?this.bind(name,data,fn):this.trigger(name);};if(jQuery.attrFn){jQuery.attrFn[name]=true;}});/*!
      Sizzle CSS Selector Engine
       Copyright 2011, The Dojo Foundation
       Released under the MIT, BSD, and GPL Licenses.
       More information: http://sizzlejs.com/
     */(function(){var chunker=/((?:\((?:\([^()]+\)|[^()]+)+\)|\[(?:\[[^\[\]]*\]|['"][^'"]*['"]|[^\[\]'"]+)+\]|\\.|[^ >+~,(\[\\]+)+|[>+~])(\s*,\s*)?((?:.|\r|\n)*)/g,done=0,toString=Object.prototype.toString,hasDuplicate=false,baseHasDuplicate=true,rBackslash=/\\/g,rNonWord=/\W/;[0,0].sort(function(){baseHasDuplicate=false;return 0;});var Sizzle=function(selector,context,results,seed){results=results||[];context=context||document;var origContext=context;if(context.nodeType!==1&&context.nodeType!==9){return[];}
if(!selector||typeof selector!=="string"){return results;}
var m,set,checkSet,extra,ret,cur,pop,i,prune=true,contextXML=Sizzle.isXML(context),parts=[],soFar=selector;do{chunker.exec("");m=chunker.exec(soFar);if(m){soFar=m[3];parts.push(m[1]);if(m[2]){extra=m[3];break;}}}while(m);if(parts.length>1&&origPOS.exec(selector)){if(parts.length===2&&Expr.relative[parts[0]]){set=posProcess(parts[0]+parts[1],context);}else{set=Expr.relative[parts[0]]?[context]:Sizzle(parts.shift(),context);while(parts.length){selector=parts.shift();if(Expr.relative[selector]){selector+=parts.shift();}
set=posProcess(selector,set);}}}else{if(!seed&&parts.length>1&&context.nodeType===9&&!contextXML&&Expr.match.ID.test(parts[0])&&!Expr.match.ID.test(parts[parts.length-1])){ret=Sizzle.find(parts.shift(),context,contextXML);context=ret.expr?Sizzle.filter(ret.expr,ret.set)[0]:ret.set[0];}
if(context){ret=seed?{expr:parts.pop(),set:makeArray(seed)}:Sizzle.find(parts.pop(),parts.length===1&&(parts[0]==="~"||parts[0]==="+")&&context.parentNode?context.parentNode:context,contextXML);set=ret.expr?Sizzle.filter(ret.expr,ret.set):ret.set;if(parts.length>0){checkSet=makeArray(set);}else{prune=false;}
while(parts.length){cur=parts.pop();pop=cur;if(!Expr.relative[cur]){cur="";}else{pop=parts.pop();}
if(pop==null){pop=context;}
Expr.relative[cur](checkSet,pop,contextXML);}}else{checkSet=parts=[];}}
if(!checkSet){checkSet=set;}
if(!checkSet){Sizzle.error(cur||selector);}
if(toString.call(checkSet)==="[object Array]"){if(!prune){results.push.apply(results,checkSet);}else if(context&&context.nodeType===1){for(i=0;checkSet[i]!=null;i++){if(checkSet[i]&&(checkSet[i]===true||checkSet[i].nodeType===1&&Sizzle.contains(context,checkSet[i]))){results.push(set[i]);}}}else{for(i=0;checkSet[i]!=null;i++){if(checkSet[i]&&checkSet[i].nodeType===1){results.push(set[i]);}}}}else{makeArray(checkSet,results);}
if(extra){Sizzle(extra,origContext,results,seed);Sizzle.uniqueSort(results);}
return results;};Sizzle.uniqueSort=function(results){if(sortOrder){hasDuplicate=baseHasDuplicate;results.sort(sortOrder);if(hasDuplicate){for(var i=1;i<results.length;i++){if(results[i]===results[i-1]){results.splice(i--,1);}}}}
return results;};Sizzle.matches=function(expr,set){return Sizzle(expr,null,null,set);};Sizzle.matchesSelector=function(node,expr){return Sizzle(expr,null,null,[node]).length>0;};Sizzle.find=function(expr,context,isXML){var set;if(!expr){return[];}
for(var i=0,l=Expr.order.length;i<l;i++){var match,type=Expr.order[i];if((match=Expr.leftMatch[type].exec(expr))){var left=match[1];match.splice(1,1);if(left.substr(left.length-1)!=="\\"){match[1]=(match[1]||"").replace(rBackslash,"");set=Expr.find[type](match,context,isXML);if(set!=null){expr=expr.replace(Expr.match[type],"");break;}}}}
if(!set){set=typeof context.getElementsByTagName!=="undefined"?context.getElementsByTagName("*"):[];}
return{set:set,expr:expr};};Sizzle.filter=function(expr,set,inplace,not){var match,anyFound,old=expr,result=[],curLoop=set,isXMLFilter=set&&set[0]&&Sizzle.isXML(set[0]);while(expr&&set.length){for(var type in Expr.filter){if((match=Expr.leftMatch[type].exec(expr))!=null&&match[2]){var found,item,filter=Expr.filter[type],left=match[1];anyFound=false;match.splice(1,1);if(left.substr(left.length-1)==="\\"){continue;}
if(curLoop===result){result=[];}
if(Expr.preFilter[type]){match=Expr.preFilter[type](match,curLoop,inplace,result,not,isXMLFilter);if(!match){anyFound=found=true;}else if(match===true){continue;}}
if(match){for(var i=0;(item=curLoop[i])!=null;i++){if(item){found=filter(item,match,i,curLoop);var pass=not^!!found;if(inplace&&found!=null){if(pass){anyFound=true;}else{curLoop[i]=false;}}else if(pass){result.push(item);anyFound=true;}}}}
if(found!==undefined){if(!inplace){curLoop=result;}
expr=expr.replace(Expr.match[type],"");if(!anyFound){return[];}
break;}}}
if(expr===old){if(anyFound==null){Sizzle.error(expr);}else{break;}}
old=expr;}
return curLoop;};Sizzle.error=function(msg){throw"Syntax error, unrecognized expression: "+msg;};var Expr=Sizzle.selectors={order:["ID","NAME","TAG"],match:{ID:/#((?:[\w\u00c0-\uFFFF\-]|\\.)+)/,CLASS:/\.((?:[\w\u00c0-\uFFFF\-]|\\.)+)/,NAME:/\[name=['"]*((?:[\w\u00c0-\uFFFF\-]|\\.)+)['"]*\]/,ATTR:/\[\s*((?:[\w\u00c0-\uFFFF\-]|\\.)+)\s*(?:(\S?=)\s*(?:(['"])(.*?)\3|(#?(?:[\w\u00c0-\uFFFF\-]|\\.)*)|)|)\s*\]/,TAG:/^((?:[\w\u00c0-\uFFFF\*\-]|\\.)+)/,CHILD:/:(only|nth|last|first)-child(?:\(\s*(even|odd|(?:[+\-]?\d+|(?:[+\-]?\d*)?n\s*(?:[+\-]\s*\d+)?))\s*\))?/,POS:/:(nth|eq|gt|lt|first|last|even|odd)(?:\((\d*)\))?(?=[^\-]|$)/,PSEUDO:/:((?:[\w\u00c0-\uFFFF\-]|\\.)+)(?:\((['"]?)((?:\([^\)]+\)|[^\(\)]*)+)\2\))?/},leftMatch:{},attrMap:{"class":"className","for":"htmlFor"},attrHandle:{href:function(elem){return elem.getAttribute("href");},type:function(elem){return elem.getAttribute("type");}},relative:{"+":function(checkSet,part){var isPartStr=typeof part==="string",isTag=isPartStr&&!rNonWord.test(part),isPartStrNotTag=isPartStr&&!isTag;if(isTag){part=part.toLowerCase();}
for(var i=0,l=checkSet.length,elem;i<l;i++){if((elem=checkSet[i])){while((elem=elem.previousSibling)&&elem.nodeType!==1){}
checkSet[i]=isPartStrNotTag||elem&&elem.nodeName.toLowerCase()===part?elem||false:elem===part;}}
if(isPartStrNotTag){Sizzle.filter(part,checkSet,true);}},">":function(checkSet,part){var elem,isPartStr=typeof part==="string",i=0,l=checkSet.length;if(isPartStr&&!rNonWord.test(part)){part=part.toLowerCase();for(;i<l;i++){elem=checkSet[i];if(elem){var parent=elem.parentNode;checkSet[i]=parent.nodeName.toLowerCase()===part?parent:false;}}}else{for(;i<l;i++){elem=checkSet[i];if(elem){checkSet[i]=isPartStr?elem.parentNode:elem.parentNode===part;}}
if(isPartStr){Sizzle.filter(part,checkSet,true);}}},"":function(checkSet,part,isXML){var nodeCheck,doneName=done++,checkFn=dirCheck;if(typeof part==="string"&&!rNonWord.test(part)){part=part.toLowerCase();nodeCheck=part;checkFn=dirNodeCheck;}
checkFn("parentNode",part,doneName,checkSet,nodeCheck,isXML);},"~":function(checkSet,part,isXML){var nodeCheck,doneName=done++,checkFn=dirCheck;if(typeof part==="string"&&!rNonWord.test(part)){part=part.toLowerCase();nodeCheck=part;checkFn=dirNodeCheck;}
checkFn("previousSibling",part,doneName,checkSet,nodeCheck,isXML);}},find:{ID:function(match,context,isXML){if(typeof context.getElementById!=="undefined"&&!isXML){var m=context.getElementById(match[1]);return m&&m.parentNode?[m]:[];}},NAME:function(match,context){if(typeof context.getElementsByName!=="undefined"){var ret=[],results=context.getElementsByName(match[1]);for(var i=0,l=results.length;i<l;i++){if(results[i].getAttribute("name")===match[1]){ret.push(results[i]);}}
return ret.length===0?null:ret;}},TAG:function(match,context){if(typeof context.getElementsByTagName!=="undefined"){return context.getElementsByTagName(match[1]);}}},preFilter:{CLASS:function(match,curLoop,inplace,result,not,isXML){match=" "+match[1].replace(rBackslash,"")+" ";if(isXML){return match;}
for(var i=0,elem;(elem=curLoop[i])!=null;i++){if(elem){if(not^(elem.className&&(" "+elem.className+" ").replace(/[\t\n\r]/g," ").indexOf(match)>=0)){if(!inplace){result.push(elem);}}else if(inplace){curLoop[i]=false;}}}
return false;},ID:function(match){return match[1].replace(rBackslash,"");},TAG:function(match,curLoop){return match[1].replace(rBackslash,"").toLowerCase();},CHILD:function(match){if(match[1]==="nth"){if(!match[2]){Sizzle.error(match[0]);}
match[2]=match[2].replace(/^\+|\s*/g,'');var test=/(-?)(\d*)(?:n([+\-]?\d*))?/.exec(match[2]==="even"&&"2n"||match[2]==="odd"&&"2n+1"||!/\D/.test(match[2])&&"0n+"+match[2]||match[2]);match[2]=(test[1]+(test[2]||1))-0;match[3]=test[3]-0;}else if(match[2]){Sizzle.error(match[0]);}
match[0]=done++;return match;},ATTR:function(match,curLoop,inplace,result,not,isXML){var name=match[1]=match[1].replace(rBackslash,"");if(!isXML&&Expr.attrMap[name]){match[1]=Expr.attrMap[name];}
match[4]=(match[4]||match[5]||"").replace(rBackslash,"");if(match[2]==="~="){match[4]=" "+match[4]+" ";}
return match;},PSEUDO:function(match,curLoop,inplace,result,not){if(match[1]==="not"){if((chunker.exec(match[3])||"").length>1||/^\w/.test(match[3])){match[3]=Sizzle(match[3],null,null,curLoop);}else{var ret=Sizzle.filter(match[3],curLoop,inplace,true^not);if(!inplace){result.push.apply(result,ret);}
return false;}}else if(Expr.match.POS.test(match[0])||Expr.match.CHILD.test(match[0])){return true;}
return match;},POS:function(match){match.unshift(true);return match;}},filters:{enabled:function(elem){return elem.disabled===false&&elem.type!=="hidden";},disabled:function(elem){return elem.disabled===true;},checked:function(elem){return elem.checked===true;},selected:function(elem){if(elem.parentNode){elem.parentNode.selectedIndex;}
return elem.selected===true;},parent:function(elem){return!!elem.firstChild;},empty:function(elem){return!elem.firstChild;},has:function(elem,i,match){return!!Sizzle(match[3],elem).length;},header:function(elem){return(/h\d/i).test(elem.nodeName);},text:function(elem){var attr=elem.getAttribute("type"),type=elem.type;return elem.nodeName.toLowerCase()==="input"&&"text"===type&&(attr===type||attr===null);},radio:function(elem){return elem.nodeName.toLowerCase()==="input"&&"radio"===elem.type;},checkbox:function(elem){return elem.nodeName.toLowerCase()==="input"&&"checkbox"===elem.type;},file:function(elem){return elem.nodeName.toLowerCase()==="input"&&"file"===elem.type;},password:function(elem){return elem.nodeName.toLowerCase()==="input"&&"password"===elem.type;},submit:function(elem){var name=elem.nodeName.toLowerCase();return(name==="input"||name==="button")&&"submit"===elem.type;},image:function(elem){return elem.nodeName.toLowerCase()==="input"&&"image"===elem.type;},reset:function(elem){var name=elem.nodeName.toLowerCase();return(name==="input"||name==="button")&&"reset"===elem.type;},button:function(elem){var name=elem.nodeName.toLowerCase();return name==="input"&&"button"===elem.type||name==="button";},input:function(elem){return(/input|select|textarea|button/i).test(elem.nodeName);},focus:function(elem){return elem===elem.ownerDocument.activeElement;}},setFilters:{first:function(elem,i){return i===0;},last:function(elem,i,match,array){return i===array.length-1;},even:function(elem,i){return i%2===0;},odd:function(elem,i){return i%2===1;},lt:function(elem,i,match){return i<match[3]-0;},gt:function(elem,i,match){return i>match[3]-0;},nth:function(elem,i,match){return match[3]-0===i;},eq:function(elem,i,match){return match[3]-0===i;}},filter:{PSEUDO:function(elem,match,i,array){var name=match[1],filter=Expr.filters[name];if(filter){return filter(elem,i,match,array);}else if(name==="contains"){return(elem.textContent||elem.innerText||Sizzle.getText([elem])||"").indexOf(match[3])>=0;}else if(name==="not"){var not=match[3];for(var j=0,l=not.length;j<l;j++){if(not[j]===elem){return false;}}
return true;}else{Sizzle.error(name);}},CHILD:function(elem,match){var type=match[1],node=elem;switch(type){case"only":case"first":while((node=node.previousSibling)){if(node.nodeType===1){return false;}}
if(type==="first"){return true;}
node=elem;case"last":while((node=node.nextSibling)){if(node.nodeType===1){return false;}}
return true;case"nth":var first=match[2],last=match[3];if(first===1&&last===0){return true;}
var doneName=match[0],parent=elem.parentNode;if(parent&&(parent.sizcache!==doneName||!elem.nodeIndex)){var count=0;for(node=parent.firstChild;node;node=node.nextSibling){if(node.nodeType===1){node.nodeIndex=++count;}}
parent.sizcache=doneName;}
var diff=elem.nodeIndex-last;if(first===0){return diff===0;}else{return(diff%first===0&&diff/first>=0);}}},ID:function(elem,match){return elem.nodeType===1&&elem.getAttribute("id")===match;},TAG:function(elem,match){return(match==="*"&&elem.nodeType===1)||elem.nodeName.toLowerCase()===match;},CLASS:function(elem,match){return(" "+(elem.className||elem.getAttribute("class"))+" ").indexOf(match)>-1;},ATTR:function(elem,match){var name=match[1],result=Expr.attrHandle[name]?Expr.attrHandle[name](elem):elem[name]!=null?elem[name]:elem.getAttribute(name),value=result+"",type=match[2],check=match[4];return result==null?type==="!=":type==="="?value===check:type==="*="?value.indexOf(check)>=0:type==="~="?(" "+value+" ").indexOf(check)>=0:!check?value&&result!==false:type==="!="?value!==check:type==="^="?value.indexOf(check)===0:type==="$="?value.substr(value.length-check.length)===check:type==="|="?value===check||value.substr(0,check.length+1)===check+"-":false;},POS:function(elem,match,i,array){var name=match[2],filter=Expr.setFilters[name];if(filter){return filter(elem,i,match,array);}}}};var origPOS=Expr.match.POS,fescape=function(all,num){return"\\"+(num-0+1);};for(var type in Expr.match){Expr.match[type]=new RegExp(Expr.match[type].source+(/(?![^\[]*\])(?![^\(]*\))/.source));Expr.leftMatch[type]=new RegExp(/(^(?:.|\r|\n)*?)/.source+Expr.match[type].source.replace(/\\(\d+)/g,fescape));}
var makeArray=function(array,results){array=Array.prototype.slice.call(array,0);if(results){results.push.apply(results,array);return results;}
return array;};try{Array.prototype.slice.call(document.documentElement.childNodes,0)[0].nodeType;}catch(e){makeArray=function(array,results){var i=0,ret=results||[];if(toString.call(array)==="[object Array]"){Array.prototype.push.apply(ret,array);}else{if(typeof array.length==="number"){for(var l=array.length;i<l;i++){ret.push(array[i]);}}else{for(;array[i];i++){ret.push(array[i]);}}}
return ret;};}
var sortOrder,siblingCheck;if(document.documentElement.compareDocumentPosition){sortOrder=function(a,b){if(a===b){hasDuplicate=true;return 0;}
if(!a.compareDocumentPosition||!b.compareDocumentPosition){return a.compareDocumentPosition?-1:1;}
return a.compareDocumentPosition(b)&4?-1:1;};}else{sortOrder=function(a,b){if(a===b){hasDuplicate=true;return 0;}else if(a.sourceIndex&&b.sourceIndex){return a.sourceIndex-b.sourceIndex;}
var al,bl,ap=[],bp=[],aup=a.parentNode,bup=b.parentNode,cur=aup;if(aup===bup){return siblingCheck(a,b);}else if(!aup){return-1;}else if(!bup){return 1;}
while(cur){ap.unshift(cur);cur=cur.parentNode;}
cur=bup;while(cur){bp.unshift(cur);cur=cur.parentNode;}
al=ap.length;bl=bp.length;for(var i=0;i<al&&i<bl;i++){if(ap[i]!==bp[i]){return siblingCheck(ap[i],bp[i]);}}
return i===al?siblingCheck(a,bp[i],-1):siblingCheck(ap[i],b,1);};siblingCheck=function(a,b,ret){if(a===b){return ret;}
var cur=a.nextSibling;while(cur){if(cur===b){return-1;}
cur=cur.nextSibling;}
return 1;};}
Sizzle.getText=function(elems){var ret="",elem;for(var i=0;elems[i];i++){elem=elems[i];if(elem.nodeType===3||elem.nodeType===4){ret+=elem.nodeValue;}else if(elem.nodeType!==8){ret+=Sizzle.getText(elem.childNodes);}}
return ret;};(function(){var form=document.createElement("div"),id="script"+(new Date()).getTime(),root=document.documentElement;form.innerHTML="<a name='"+id+"'/>";root.insertBefore(form,root.firstChild);if(document.getElementById(id)){Expr.find.ID=function(match,context,isXML){if(typeof context.getElementById!=="undefined"&&!isXML){var m=context.getElementById(match[1]);return m?m.id===match[1]||typeof m.getAttributeNode!=="undefined"&&m.getAttributeNode("id").nodeValue===match[1]?[m]:undefined:[];}};Expr.filter.ID=function(elem,match){var node=typeof elem.getAttributeNode!=="undefined"&&elem.getAttributeNode("id");return elem.nodeType===1&&node&&node.nodeValue===match;};}
root.removeChild(form);root=form=null;})();(function(){var div=document.createElement("div");div.appendChild(document.createComment(""));if(div.getElementsByTagName("*").length>0){Expr.find.TAG=function(match,context){var results=context.getElementsByTagName(match[1]);if(match[1]==="*"){var tmp=[];for(var i=0;results[i];i++){if(results[i].nodeType===1){tmp.push(results[i]);}}
results=tmp;}
return results;};}
div.innerHTML="<a href='#'></a>";if(div.firstChild&&typeof div.firstChild.getAttribute!=="undefined"&&div.firstChild.getAttribute("href")!=="#"){Expr.attrHandle.href=function(elem){return elem.getAttribute("href",2);};}
div=null;})();if(document.querySelectorAll){(function(){var oldSizzle=Sizzle,div=document.createElement("div"),id="__sizzle__";div.innerHTML="<p class='TEST'></p>";if(div.querySelectorAll&&div.querySelectorAll(".TEST").length===0){return;}
Sizzle=function(query,context,extra,seed){context=context||document;if(!seed&&!Sizzle.isXML(context)){var match=/^(\w+$)|^\.([\w\-]+$)|^#([\w\-]+$)/.exec(query);if(match&&(context.nodeType===1||context.nodeType===9)){if(match[1]){return makeArray(context.getElementsByTagName(query),extra);}else if(match[2]&&Expr.find.CLASS&&context.getElementsByClassName){return makeArray(context.getElementsByClassName(match[2]),extra);}}
if(context.nodeType===9){if(query==="body"&&context.body){return makeArray([context.body],extra);}else if(match&&match[3]){var elem=context.getElementById(match[3]);if(elem&&elem.parentNode){if(elem.id===match[3]){return makeArray([elem],extra);}}else{return makeArray([],extra);}}
try{return makeArray(context.querySelectorAll(query),extra);}catch(qsaError){}}else if(context.nodeType===1&&context.nodeName.toLowerCase()!=="object"){var oldContext=context,old=context.getAttribute("id"),nid=old||id,hasParent=context.parentNode,relativeHierarchySelector=/^\s*[+~]/.test(query);if(!old){context.setAttribute("id",nid);}else{nid=nid.replace(/'/g,"\\$&");}
if(relativeHierarchySelector&&hasParent){context=context.parentNode;}
try{if(!relativeHierarchySelector||hasParent){return makeArray(context.querySelectorAll("[id='"+nid+"'] "+query),extra);}}catch(pseudoError){}finally{if(!old){oldContext.removeAttribute("id");}}}}
return oldSizzle(query,context,extra,seed);};for(var prop in oldSizzle){Sizzle[prop]=oldSizzle[prop];}
div=null;})();}
(function(){var html=document.documentElement,matches=html.matchesSelector||html.mozMatchesSelector||html.webkitMatchesSelector||html.msMatchesSelector;if(matches){var disconnectedMatch=!matches.call(document.createElement("div"),"div"),pseudoWorks=false;try{matches.call(document.documentElement,"[test!='']:sizzle");}catch(pseudoError){pseudoWorks=true;}
Sizzle.matchesSelector=function(node,expr){expr=expr.replace(/\=\s*([^'"\]]*)\s*\]/g,"='$1']");if(!Sizzle.isXML(node)){try{if(pseudoWorks||!Expr.match.PSEUDO.test(expr)&&!/!=/.test(expr)){var ret=matches.call(node,expr);if(ret||!disconnectedMatch||node.document&&node.document.nodeType!==11){return ret;}}}catch(e){}}
return Sizzle(expr,null,null,[node]).length>0;};}})();(function(){var div=document.createElement("div");div.innerHTML="<div class='test e'></div><div class='test'></div>";if(!div.getElementsByClassName||div.getElementsByClassName("e").length===0){return;}
div.lastChild.className="e";if(div.getElementsByClassName("e").length===1){return;}
Expr.order.splice(1,0,"CLASS");Expr.find.CLASS=function(match,context,isXML){if(typeof context.getElementsByClassName!=="undefined"&&!isXML){return context.getElementsByClassName(match[1]);}};div=null;})();function dirNodeCheck(dir,cur,doneName,checkSet,nodeCheck,isXML){for(var i=0,l=checkSet.length;i<l;i++){var elem=checkSet[i];if(elem){var match=false;elem=elem[dir];while(elem){if(elem.sizcache===doneName){match=checkSet[elem.sizset];break;}
if(elem.nodeType===1&&!isXML){elem.sizcache=doneName;elem.sizset=i;}
if(elem.nodeName.toLowerCase()===cur){match=elem;break;}
elem=elem[dir];}
checkSet[i]=match;}}}
function dirCheck(dir,cur,doneName,checkSet,nodeCheck,isXML){for(var i=0,l=checkSet.length;i<l;i++){var elem=checkSet[i];if(elem){var match=false;elem=elem[dir];while(elem){if(elem.sizcache===doneName){match=checkSet[elem.sizset];break;}
if(elem.nodeType===1){if(!isXML){elem.sizcache=doneName;elem.sizset=i;}
if(typeof cur!=="string"){if(elem===cur){match=true;break;}}else if(Sizzle.filter(cur,[elem]).length>0){match=elem;break;}}
elem=elem[dir];}
checkSet[i]=match;}}}
if(document.documentElement.contains){Sizzle.contains=function(a,b){return a!==b&&(a.contains?a.contains(b):true);};}else if(document.documentElement.compareDocumentPosition){Sizzle.contains=function(a,b){return!!(a.compareDocumentPosition(b)&16);};}else{Sizzle.contains=function(){return false;};}
Sizzle.isXML=function(elem){var documentElement=(elem?elem.ownerDocument||elem:0).documentElement;return documentElement?documentElement.nodeName!=="HTML":false;};var posProcess=function(selector,context){var match,tmpSet=[],later="",root=context.nodeType?[context]:context;while((match=Expr.match.PSEUDO.exec(selector))){later+=match[0];selector=selector.replace(Expr.match.PSEUDO,"");}
selector=Expr.relative[selector]?selector+"*":selector;for(var i=0,l=root.length;i<l;i++){Sizzle(selector,root[i],tmpSet);}
return Sizzle.filter(later,tmpSet);};jQuery.find=Sizzle;jQuery.expr=Sizzle.selectors;jQuery.expr[":"]=jQuery.expr.filters;jQuery.unique=Sizzle.uniqueSort;jQuery.text=Sizzle.getText;jQuery.isXMLDoc=Sizzle.isXML;jQuery.contains=Sizzle.contains;})();var runtil=/Until$/,rparentsprev=/^(?:parents|prevUntil|prevAll)/,rmultiselector=/,/,isSimple=/^.[^:#\[\.,]*$/,slice=Array.prototype.slice,POS=jQuery.expr.match.POS,guaranteedUnique={children:true,contents:true,next:true,prev:true};jQuery.fn.extend({find:function(selector){var self=this,i,l;if(typeof selector!=="string"){return jQuery(selector).filter(function(){for(i=0,l=self.length;i<l;i++){if(jQuery.contains(self[i],this)){return true;}}});}
var ret=this.pushStack("","find",selector),length,n,r;for(i=0,l=this.length;i<l;i++){length=ret.length;jQuery.find(selector,this[i],ret);if(i>0){for(n=length;n<ret.length;n++){for(r=0;r<length;r++){if(ret[r]===ret[n]){ret.splice(n--,1);break;}}}}}
return ret;},has:function(target){var targets=jQuery(target);return this.filter(function(){for(var i=0,l=targets.length;i<l;i++){if(jQuery.contains(this,targets[i])){return true;}}});},not:function(selector){return this.pushStack(winnow(this,selector,false),"not",selector);},filter:function(selector){return this.pushStack(winnow(this,selector,true),"filter",selector);},is:function(selector){return!!selector&&(typeof selector==="string"?jQuery.filter(selector,this).length>0:this.filter(selector).length>0);},closest:function(selectors,context){var ret=[],i,l,cur=this[0];if(jQuery.isArray(selectors)){var match,selector,matches={},level=1;if(cur&&selectors.length){for(i=0,l=selectors.length;i<l;i++){selector=selectors[i];if(!matches[selector]){matches[selector]=POS.test(selector)?jQuery(selector,context||this.context):selector;}}
while(cur&&cur.ownerDocument&&cur!==context){for(selector in matches){match=matches[selector];if(match.jquery?match.index(cur)>-1:jQuery(cur).is(match)){ret.push({selector:selector,elem:cur,level:level});}}
cur=cur.parentNode;level++;}}
return ret;}
var pos=POS.test(selectors)||typeof selectors!=="string"?jQuery(selectors,context||this.context):0;for(i=0,l=this.length;i<l;i++){cur=this[i];while(cur){if(pos?pos.index(cur)>-1:jQuery.find.matchesSelector(cur,selectors)){ret.push(cur);break;}else{cur=cur.parentNode;if(!cur||!cur.ownerDocument||cur===context||cur.nodeType===11){break;}}}}
ret=ret.length>1?jQuery.unique(ret):ret;return this.pushStack(ret,"closest",selectors);},index:function(elem){if(!elem){return(this[0]&&this[0].parentNode)?this.prevAll().length:-1;}
if(typeof elem==="string"){return jQuery.inArray(this[0],jQuery(elem));}
return jQuery.inArray(elem.jquery?elem[0]:elem,this);},add:function(selector,context){var set=typeof selector==="string"?jQuery(selector,context):jQuery.makeArray(selector&&selector.nodeType?[selector]:selector),all=jQuery.merge(this.get(),set);return this.pushStack(isDisconnected(set[0])||isDisconnected(all[0])?all:jQuery.unique(all));},andSelf:function(){return this.add(this.prevObject);}});function isDisconnected(node){return!node||!node.parentNode||node.parentNode.nodeType===11;}
jQuery.each({parent:function(elem){var parent=elem.parentNode;return parent&&parent.nodeType!==11?parent:null;},parents:function(elem){return jQuery.dir(elem,"parentNode");},parentsUntil:function(elem,i,until){return jQuery.dir(elem,"parentNode",until);},next:function(elem){return jQuery.nth(elem,2,"nextSibling");},prev:function(elem){return jQuery.nth(elem,2,"previousSibling");},nextAll:function(elem){return jQuery.dir(elem,"nextSibling");},prevAll:function(elem){return jQuery.dir(elem,"previousSibling");},nextUntil:function(elem,i,until){return jQuery.dir(elem,"nextSibling",until);},prevUntil:function(elem,i,until){return jQuery.dir(elem,"previousSibling",until);},siblings:function(elem){return jQuery.sibling(elem.parentNode.firstChild,elem);},children:function(elem){return jQuery.sibling(elem.firstChild);},contents:function(elem){return jQuery.nodeName(elem,"iframe")?elem.contentDocument||elem.contentWindow.document:jQuery.makeArray(elem.childNodes);}},function(name,fn){jQuery.fn[name]=function(until,selector){var ret=jQuery.map(this,fn,until),args=slice.call(arguments);if(!runtil.test(name)){selector=until;}
if(selector&&typeof selector==="string"){ret=jQuery.filter(selector,ret);}
ret=this.length>1&&!guaranteedUnique[name]?jQuery.unique(ret):ret;if((this.length>1||rmultiselector.test(selector))&&rparentsprev.test(name)){ret=ret.reverse();}
return this.pushStack(ret,name,args.join(","));};});jQuery.extend({filter:function(expr,elems,not){if(not){expr=":not("+expr+")";}
return elems.length===1?jQuery.find.matchesSelector(elems[0],expr)?[elems[0]]:[]:jQuery.find.matches(expr,elems);},dir:function(elem,dir,until){var matched=[],cur=elem[dir];while(cur&&cur.nodeType!==9&&(until===undefined||cur.nodeType!==1||!jQuery(cur).is(until))){if(cur.nodeType===1){matched.push(cur);}
cur=cur[dir];}
return matched;},nth:function(cur,result,dir,elem){result=result||1;var num=0;for(;cur;cur=cur[dir]){if(cur.nodeType===1&&++num===result){break;}}
return cur;},sibling:function(n,elem){var r=[];for(;n;n=n.nextSibling){if(n.nodeType===1&&n!==elem){r.push(n);}}
return r;}});function winnow(elements,qualifier,keep){qualifier=qualifier||0;if(jQuery.isFunction(qualifier)){return jQuery.grep(elements,function(elem,i){var retVal=!!qualifier.call(elem,i,elem);return retVal===keep;});}else if(qualifier.nodeType){return jQuery.grep(elements,function(elem,i){return(elem===qualifier)===keep;});}else if(typeof qualifier==="string"){var filtered=jQuery.grep(elements,function(elem){return elem.nodeType===1;});if(isSimple.test(qualifier)){return jQuery.filter(qualifier,filtered,!keep);}else{qualifier=jQuery.filter(qualifier,filtered);}}
return jQuery.grep(elements,function(elem,i){return(jQuery.inArray(elem,qualifier)>=0)===keep;});}
var rinlinejQuery=/ jQuery\d+="(?:\d+|null)"/g,rleadingWhitespace=/^\s+/,rxhtmlTag=/<(?!area|br|col|embed|hr|img|input|link|meta|param)(([\w:]+)[^>]*)\/>/ig,rtagName=/<([\w:]+)/,rtbody=/<tbody/i,rhtml=/<|&#?\w+;/,rnocache=/<(?:script|object|embed|option|style)/i,rchecked=/checked\s*(?:[^=]|=\s*.checked.)/i,rscriptType=/\/(java|ecma)script/i,rcleanScript=/^\s*<!(?:\[CDATA\[|\-\-)/,wrapMap={option:[1,"<select multiple='multiple'>","</select>"],legend:[1,"<fieldset>","</fieldset>"],thead:[1,"<table>","</table>"],tr:[2,"<table><tbody>","</tbody></table>"],td:[3,"<table><tbody><tr>","</tr></tbody></table>"],col:[2,"<table><tbody></tbody><colgroup>","</colgroup></table>"],area:[1,"<map>","</map>"],_default:[0,"",""]};wrapMap.optgroup=wrapMap.option;wrapMap.tbody=wrapMap.tfoot=wrapMap.colgroup=wrapMap.caption=wrapMap.thead;wrapMap.th=wrapMap.td;if(!jQuery.support.htmlSerialize){wrapMap._default=[1,"div<div>","</div>"];}
jQuery.fn.extend({text:function(text){if(jQuery.isFunction(text)){return this.each(function(i){var self=jQuery(this);self.text(text.call(this,i,self.text()));});}
if(typeof text!=="object"&&text!==undefined){return this.empty().append((this[0]&&this[0].ownerDocument||document).createTextNode(text));}
return jQuery.text(this);},wrapAll:function(html){if(jQuery.isFunction(html)){return this.each(function(i){jQuery(this).wrapAll(html.call(this,i));});}
if(this[0]){var wrap=jQuery(html,this[0].ownerDocument).eq(0).clone(true);if(this[0].parentNode){wrap.insertBefore(this[0]);}
wrap.map(function(){var elem=this;while(elem.firstChild&&elem.firstChild.nodeType===1){elem=elem.firstChild;}
return elem;}).append(this);}
return this;},wrapInner:function(html){if(jQuery.isFunction(html)){return this.each(function(i){jQuery(this).wrapInner(html.call(this,i));});}
return this.each(function(){var self=jQuery(this),contents=self.contents();if(contents.length){contents.wrapAll(html);}else{self.append(html);}});},wrap:function(html){return this.each(function(){jQuery(this).wrapAll(html);});},unwrap:function(){return this.parent().each(function(){if(!jQuery.nodeName(this,"body")){jQuery(this).replaceWith(this.childNodes);}}).end();},append:function(){return this.domManip(arguments,true,function(elem){if(this.nodeType===1){this.appendChild(elem);}});},prepend:function(){return this.domManip(arguments,true,function(elem){if(this.nodeType===1){this.insertBefore(elem,this.firstChild);}});},before:function(){if(this[0]&&this[0].parentNode){return this.domManip(arguments,false,function(elem){this.parentNode.insertBefore(elem,this);});}else if(arguments.length){var set=jQuery(arguments[0]);set.push.apply(set,this.toArray());return this.pushStack(set,"before",arguments);}},after:function(){if(this[0]&&this[0].parentNode){return this.domManip(arguments,false,function(elem){this.parentNode.insertBefore(elem,this.nextSibling);});}else if(arguments.length){var set=this.pushStack(this,"after",arguments);set.push.apply(set,jQuery(arguments[0]).toArray());return set;}},remove:function(selector,keepData){for(var i=0,elem;(elem=this[i])!=null;i++){if(!selector||jQuery.filter(selector,[elem]).length){if(!keepData&&elem.nodeType===1){jQuery.cleanData(elem.getElementsByTagName("*"));jQuery.cleanData([elem]);}
if(elem.parentNode){elem.parentNode.removeChild(elem);}}}
return this;},empty:function(){for(var i=0,elem;(elem=this[i])!=null;i++){if(elem.nodeType===1){jQuery.cleanData(elem.getElementsByTagName("*"));}
while(elem.firstChild){elem.removeChild(elem.firstChild);}}
return this;},clone:function(dataAndEvents,deepDataAndEvents){dataAndEvents=dataAndEvents==null?false:dataAndEvents;deepDataAndEvents=deepDataAndEvents==null?dataAndEvents:deepDataAndEvents;return this.map(function(){return jQuery.clone(this,dataAndEvents,deepDataAndEvents);});},html:function(value){if(value===undefined){return this[0]&&this[0].nodeType===1?this[0].innerHTML.replace(rinlinejQuery,""):null;}else if(typeof value==="string"&&!rnocache.test(value)&&(jQuery.support.leadingWhitespace||!rleadingWhitespace.test(value))&&!wrapMap[(rtagName.exec(value)||["",""])[1].toLowerCase()]){value=value.replace(rxhtmlTag,"<$1></$2>");try{for(var i=0,l=this.length;i<l;i++){if(this[i].nodeType===1){jQuery.cleanData(this[i].getElementsByTagName("*"));this[i].innerHTML=value;}}}catch(e){this.empty().append(value);}}else if(jQuery.isFunction(value)){this.each(function(i){var self=jQuery(this);self.html(value.call(this,i,self.html()));});}else{this.empty().append(value);}
return this;},replaceWith:function(value){if(this[0]&&this[0].parentNode){if(jQuery.isFunction(value)){return this.each(function(i){var self=jQuery(this),old=self.html();self.replaceWith(value.call(this,i,old));});}
if(typeof value!=="string"){value=jQuery(value).detach();}
return this.each(function(){var next=this.nextSibling,parent=this.parentNode;jQuery(this).remove();if(next){jQuery(next).before(value);}else{jQuery(parent).append(value);}});}else{return this.length?this.pushStack(jQuery(jQuery.isFunction(value)?value():value),"replaceWith",value):this;}},detach:function(selector){return this.remove(selector,true);},domManip:function(args,table,callback){var results,first,fragment,parent,value=args[0],scripts=[];if(!jQuery.support.checkClone&&arguments.length===3&&typeof value==="string"&&rchecked.test(value)){return this.each(function(){jQuery(this).domManip(args,table,callback,true);});}
if(jQuery.isFunction(value)){return this.each(function(i){var self=jQuery(this);args[0]=value.call(this,i,table?self.html():undefined);self.domManip(args,table,callback);});}
if(this[0]){parent=value&&value.parentNode;if(jQuery.support.parentNode&&parent&&parent.nodeType===11&&parent.childNodes.length===this.length){results={fragment:parent};}else{results=jQuery.buildFragment(args,this,scripts);}
fragment=results.fragment;if(fragment.childNodes.length===1){first=fragment=fragment.firstChild;}else{first=fragment.firstChild;}
if(first){table=table&&jQuery.nodeName(first,"tr");for(var i=0,l=this.length,lastIndex=l-1;i<l;i++){callback.call(table?root(this[i],first):this[i],results.cacheable||(l>1&&i<lastIndex)?jQuery.clone(fragment,true,true):fragment);}}
if(scripts.length){jQuery.each(scripts,evalScript);}}
return this;}});function root(elem,cur){return jQuery.nodeName(elem,"table")?(elem.getElementsByTagName("tbody")[0]||elem.appendChild(elem.ownerDocument.createElement("tbody"))):elem;}
function cloneCopyEvent(src,dest){if(dest.nodeType!==1||!jQuery.hasData(src)){return;}
var internalKey=jQuery.expando,oldData=jQuery.data(src),curData=jQuery.data(dest,oldData);if((oldData=oldData[internalKey])){var events=oldData.events;curData=curData[internalKey]=jQuery.extend({},oldData);if(events){delete curData.handle;curData.events={};for(var type in events){for(var i=0,l=events[type].length;i<l;i++){jQuery.event.add(dest,type+(events[type][i].namespace?".":"")+events[type][i].namespace,events[type][i],events[type][i].data);}}}}}
function cloneFixAttributes(src,dest){var nodeName;if(dest.nodeType!==1){return;}
if(dest.clearAttributes){dest.clearAttributes();}
if(dest.mergeAttributes){dest.mergeAttributes(src);}
nodeName=dest.nodeName.toLowerCase();if(nodeName==="object"){dest.outerHTML=src.outerHTML;}else if(nodeName==="input"&&(src.type==="checkbox"||src.type==="radio")){if(src.checked){dest.defaultChecked=dest.checked=src.checked;}
if(dest.value!==src.value){dest.value=src.value;}}else if(nodeName==="option"){dest.selected=src.defaultSelected;}else if(nodeName==="input"||nodeName==="textarea"){dest.defaultValue=src.defaultValue;}
dest.removeAttribute(jQuery.expando);}
jQuery.buildFragment=function(args,nodes,scripts){var fragment,cacheable,cacheresults,doc;if(nodes&&nodes[0]){doc=nodes[0].ownerDocument||nodes[0];}
if(!doc.createDocumentFragment){doc=document;}
if(args.length===1&&typeof args[0]==="string"&&args[0].length<512&&doc===document&&args[0].charAt(0)==="<"&&!rnocache.test(args[0])&&(jQuery.support.checkClone||!rchecked.test(args[0]))){cacheable=true;cacheresults=jQuery.fragments[args[0]];if(cacheresults&&cacheresults!==1){fragment=cacheresults;}}
if(!fragment){fragment=doc.createDocumentFragment();jQuery.clean(args,doc,fragment,scripts);}
if(cacheable){jQuery.fragments[args[0]]=cacheresults?fragment:1;}
return{fragment:fragment,cacheable:cacheable};};jQuery.fragments={};jQuery.each({appendTo:"append",prependTo:"prepend",insertBefore:"before",insertAfter:"after",replaceAll:"replaceWith"},function(name,original){jQuery.fn[name]=function(selector){var ret=[],insert=jQuery(selector),parent=this.length===1&&this[0].parentNode;if(parent&&parent.nodeType===11&&parent.childNodes.length===1&&insert.length===1){insert[original](this[0]);return this;}else{for(var i=0,l=insert.length;i<l;i++){var elems=(i>0?this.clone(true):this).get();jQuery(insert[i])[original](elems);ret=ret.concat(elems);}
return this.pushStack(ret,name,insert.selector);}};});function getAll(elem){if("getElementsByTagName"in elem){return elem.getElementsByTagName("*");}else if("querySelectorAll"in elem){return elem.querySelectorAll("*");}else{return[];}}
function fixDefaultChecked(elem){if(elem.type==="checkbox"||elem.type==="radio"){elem.defaultChecked=elem.checked;}}
function findInputs(elem){if(jQuery.nodeName(elem,"input")){fixDefaultChecked(elem);}else if("getElementsByTagName"in elem){jQuery.grep(elem.getElementsByTagName("input"),fixDefaultChecked);}}
jQuery.extend({clone:function(elem,dataAndEvents,deepDataAndEvents){var clone=elem.cloneNode(true),srcElements,destElements,i;if((!jQuery.support.noCloneEvent||!jQuery.support.noCloneChecked)&&(elem.nodeType===1||elem.nodeType===11)&&!jQuery.isXMLDoc(elem)){cloneFixAttributes(elem,clone);srcElements=getAll(elem);destElements=getAll(clone);for(i=0;srcElements[i];++i){if(destElements[i]){cloneFixAttributes(srcElements[i],destElements[i]);}}}
if(dataAndEvents){cloneCopyEvent(elem,clone);if(deepDataAndEvents){srcElements=getAll(elem);destElements=getAll(clone);for(i=0;srcElements[i];++i){cloneCopyEvent(srcElements[i],destElements[i]);}}}
srcElements=destElements=null;return clone;},clean:function(elems,context,fragment,scripts){var checkScriptType;context=context||document;if(typeof context.createElement==="undefined"){context=context.ownerDocument||context[0]&&context[0].ownerDocument||document;}
var ret=[],j;for(var i=0,elem;(elem=elems[i])!=null;i++){if(typeof elem==="number"){elem+="";}
if(!elem){continue;}
if(typeof elem==="string"){if(!rhtml.test(elem)){elem=context.createTextNode(elem);}else{elem=elem.replace(rxhtmlTag,"<$1></$2>");var tag=(rtagName.exec(elem)||["",""])[1].toLowerCase(),wrap=wrapMap[tag]||wrapMap._default,depth=wrap[0],div=context.createElement("div");div.innerHTML=wrap[1]+elem+wrap[2];while(depth--){div=div.lastChild;}
if(!jQuery.support.tbody){var hasBody=rtbody.test(elem),tbody=tag==="table"&&!hasBody?div.firstChild&&div.firstChild.childNodes:wrap[1]==="<table>"&&!hasBody?div.childNodes:[];for(j=tbody.length-1;j>=0;--j){if(jQuery.nodeName(tbody[j],"tbody")&&!tbody[j].childNodes.length){tbody[j].parentNode.removeChild(tbody[j]);}}}
if(!jQuery.support.leadingWhitespace&&rleadingWhitespace.test(elem)){div.insertBefore(context.createTextNode(rleadingWhitespace.exec(elem)[0]),div.firstChild);}
elem=div.childNodes;}}
var len;if(!jQuery.support.appendChecked){if(elem[0]&&typeof(len=elem.length)==="number"){for(j=0;j<len;j++){findInputs(elem[j]);}}else{findInputs(elem);}}
if(elem.nodeType){ret.push(elem);}else{ret=jQuery.merge(ret,elem);}}
if(fragment){checkScriptType=function(elem){return!elem.type||rscriptType.test(elem.type);};for(i=0;ret[i];i++){if(scripts&&jQuery.nodeName(ret[i],"script")&&(!ret[i].type||ret[i].type.toLowerCase()==="text/javascript")){scripts.push(ret[i].parentNode?ret[i].parentNode.removeChild(ret[i]):ret[i]);}else{if(ret[i].nodeType===1){var jsTags=jQuery.grep(ret[i].getElementsByTagName("script"),checkScriptType);ret.splice.apply(ret,[i+1,0].concat(jsTags));}
fragment.appendChild(ret[i]);}}}
return ret;},cleanData:function(elems){var data,id,cache=jQuery.cache,internalKey=jQuery.expando,special=jQuery.event.special,deleteExpando=jQuery.support.deleteExpando;for(var i=0,elem;(elem=elems[i])!=null;i++){if(elem.nodeName&&jQuery.noData[elem.nodeName.toLowerCase()]){continue;}
id=elem[jQuery.expando];if(id){data=cache[id]&&cache[id][internalKey];if(data&&data.events){for(var type in data.events){if(special[type]){jQuery.event.remove(elem,type);}else{jQuery.removeEvent(elem,type,data.handle);}}
if(data.handle){data.handle.elem=null;}}
if(deleteExpando){delete elem[jQuery.expando];}else if(elem.removeAttribute){elem.removeAttribute(jQuery.expando);}
delete cache[id];}}}});function evalScript(i,elem){if(elem.src){jQuery.ajax({url:elem.src,async:false,dataType:"script"});}else{jQuery.globalEval((elem.text||elem.textContent||elem.innerHTML||"").replace(rcleanScript,"/*$0*/"));}
if(elem.parentNode){elem.parentNode.removeChild(elem);}}
var ralpha=/alpha\([^)]*\)/i,ropacity=/opacity=([^)]*)/,rupper=/([A-Z]|^ms)/g,rnumpx=/^-?\d+(?:px)?$/i,rnum=/^-?\d/,rrelNum=/^([\-+])=([\-+.\de]+)/,cssShow={position:"absolute",visibility:"hidden",display:"block"},cssWidth=["Left","Right"],cssHeight=["Top","Bottom"],curCSS,getComputedStyle,currentStyle;jQuery.fn.css=function(name,value){if(arguments.length===2&&value===undefined){return this;}
return jQuery.access(this,name,value,true,function(elem,name,value){return value!==undefined?jQuery.style(elem,name,value):jQuery.css(elem,name);});};jQuery.extend({cssHooks:{opacity:{get:function(elem,computed){if(computed){var ret=curCSS(elem,"opacity","opacity");return ret===""?"1":ret;}else{return elem.style.opacity;}}}},cssNumber:{"fillOpacity":true,"fontWeight":true,"lineHeight":true,"opacity":true,"orphans":true,"widows":true,"zIndex":true,"zoom":true},cssProps:{"float":jQuery.support.cssFloat?"cssFloat":"styleFloat"},style:function(elem,name,value,extra){if(!elem||elem.nodeType===3||elem.nodeType===8||!elem.style){return;}
var ret,type,origName=jQuery.camelCase(name),style=elem.style,hooks=jQuery.cssHooks[origName];name=jQuery.cssProps[origName]||origName;if(value!==undefined){type=typeof value;if(type==="string"&&(ret=rrelNum.exec(value))){value=(+(ret[1]+1)*+ret[2])+parseFloat(jQuery.css(elem,name));type="number";}
if(value==null||type==="number"&&isNaN(value)){return;}
if(type==="number"&&!jQuery.cssNumber[origName]){value+="px";}
if(!hooks||!("set"in hooks)||(value=hooks.set(elem,value))!==undefined){try{style[name]=value;}catch(e){}}}else{if(hooks&&"get"in hooks&&(ret=hooks.get(elem,false,extra))!==undefined){return ret;}
return style[name];}},css:function(elem,name,extra){var ret,hooks;name=jQuery.camelCase(name);hooks=jQuery.cssHooks[name];name=jQuery.cssProps[name]||name;if(name==="cssFloat"){name="float";}
if(hooks&&"get"in hooks&&(ret=hooks.get(elem,true,extra))!==undefined){return ret;}else if(curCSS){return curCSS(elem,name);}},swap:function(elem,options,callback){var old={};for(var name in options){old[name]=elem.style[name];elem.style[name]=options[name];}
callback.call(elem);for(name in options){elem.style[name]=old[name];}}});jQuery.curCSS=jQuery.css;jQuery.each(["height","width"],function(i,name){jQuery.cssHooks[name]={get:function(elem,computed,extra){var val;if(computed){if(elem.offsetWidth!==0){return getWH(elem,name,extra);}else{jQuery.swap(elem,cssShow,function(){val=getWH(elem,name,extra);});}
return val;}},set:function(elem,value){if(rnumpx.test(value)){value=parseFloat(value);if(value>=0){return value+"px";}}else{return value;}}};});if(!jQuery.support.opacity){jQuery.cssHooks.opacity={get:function(elem,computed){return ropacity.test((computed&&elem.currentStyle?elem.currentStyle.filter:elem.style.filter)||"")?(parseFloat(RegExp.$1)/100)+"":computed?"1":"";},set:function(elem,value){var style=elem.style,currentStyle=elem.currentStyle,opacity=jQuery.isNaN(value)?"":"alpha(opacity="+value*100+")",filter=currentStyle&&currentStyle.filter||style.filter||"";style.zoom=1;if(value>=1&&jQuery.trim(filter.replace(ralpha,""))===""){style.removeAttribute("filter");if(currentStyle&&!currentStyle.filter){return;}}
style.filter=ralpha.test(filter)?filter.replace(ralpha,opacity):filter+" "+opacity;}};}
jQuery(function(){if(!jQuery.support.reliableMarginRight){jQuery.cssHooks.marginRight={get:function(elem,computed){var ret;jQuery.swap(elem,{"display":"inline-block"},function(){if(computed){ret=curCSS(elem,"margin-right","marginRight");}else{ret=elem.style.marginRight;}});return ret;}};}});if(document.defaultView&&document.defaultView.getComputedStyle){getComputedStyle=function(elem,name){var ret,defaultView,computedStyle;name=name.replace(rupper,"-$1").toLowerCase();if(!(defaultView=elem.ownerDocument.defaultView)){return undefined;}
if((computedStyle=defaultView.getComputedStyle(elem,null))){ret=computedStyle.getPropertyValue(name);if(ret===""&&!jQuery.contains(elem.ownerDocument.documentElement,elem)){ret=jQuery.style(elem,name);}}
return ret;};}
if(document.documentElement.currentStyle){currentStyle=function(elem,name){var left,ret=elem.currentStyle&&elem.currentStyle[name],rsLeft=elem.runtimeStyle&&elem.runtimeStyle[name],style=elem.style;if(!rnumpx.test(ret)&&rnum.test(ret)){left=style.left;if(rsLeft){elem.runtimeStyle.left=elem.currentStyle.left;}
style.left=name==="fontSize"?"1em":(ret||0);ret=style.pixelLeft+"px";style.left=left;if(rsLeft){elem.runtimeStyle.left=rsLeft;}}
return ret===""?"auto":ret;};}
curCSS=getComputedStyle||currentStyle;function getWH(elem,name,extra){var val=name==="width"?elem.offsetWidth:elem.offsetHeight,which=name==="width"?cssWidth:cssHeight;if(val>0){if(extra!=="border"){jQuery.each(which,function(){if(!extra){val-=parseFloat(jQuery.css(elem,"padding"+this))||0;}
if(extra==="margin"){val+=parseFloat(jQuery.css(elem,extra+this))||0;}else{val-=parseFloat(jQuery.css(elem,"border"+this+"Width"))||0;}});}
return val+"px";}
val=curCSS(elem,name,name);if(val<0||val==null){val=elem.style[name]||0;}
val=parseFloat(val)||0;if(extra){jQuery.each(which,function(){val+=parseFloat(jQuery.css(elem,"padding"+this))||0;if(extra!=="padding"){val+=parseFloat(jQuery.css(elem,"border"+this+"Width"))||0;}
if(extra==="margin"){val+=parseFloat(jQuery.css(elem,extra+this))||0;}});}
return val+"px";}
if(jQuery.expr&&jQuery.expr.filters){jQuery.expr.filters.hidden=function(elem){var width=elem.offsetWidth,height=elem.offsetHeight;return(width===0&&height===0)||(!jQuery.support.reliableHiddenOffsets&&(elem.style.display||jQuery.css(elem,"display"))==="none");};jQuery.expr.filters.visible=function(elem){return!jQuery.expr.filters.hidden(elem);};}
var r20=/%20/g,rbracket=/\[\]$/,rCRLF=/\r?\n/g,rhash=/#.*$/,rheaders=/^(.*?):[ \t]*([^\r\n]*)\r?$/mg,rinput=/^(?:color|date|datetime|datetime-local|email|hidden|month|number|password|range|search|tel|text|time|url|week)$/i,rlocalProtocol=/^(?:about|app|app\-storage|.+\-extension|file|res|widget):$/,rnoContent=/^(?:GET|HEAD)$/,rprotocol=/^\/\//,rquery=/\?/,rscript=/<script\b[^<]*(?:(?!<\/script>)<[^<]*)*<\/script>/gi,rselectTextarea=/^(?:select|textarea)/i,rspacesAjax=/\s+/,rts=/([?&])_=[^&]*/,rurl=/^([\w\+\.\-]+:)(?:\/\/([^\/?#:]*)(?::(\d+))?)?/,_load=jQuery.fn.load,prefilters={},transports={},ajaxLocation,ajaxLocParts,allTypes=["*/"]+["*"];try{ajaxLocation=location.href;}catch(e){ajaxLocation=document.createElement("a");ajaxLocation.href="";ajaxLocation=ajaxLocation.href;}
ajaxLocParts=rurl.exec(ajaxLocation.toLowerCase())||[];function addToPrefiltersOrTransports(structure){return function(dataTypeExpression,func){if(typeof dataTypeExpression!=="string"){func=dataTypeExpression;dataTypeExpression="*";}
if(jQuery.isFunction(func)){var dataTypes=dataTypeExpression.toLowerCase().split(rspacesAjax),i=0,length=dataTypes.length,dataType,list,placeBefore;for(;i<length;i++){dataType=dataTypes[i];placeBefore=/^\+/.test(dataType);if(placeBefore){dataType=dataType.substr(1)||"*";}
list=structure[dataType]=structure[dataType]||[];list[placeBefore?"unshift":"push"](func);}}};}
function inspectPrefiltersOrTransports(structure,options,originalOptions,jqXHR,dataType,inspected){dataType=dataType||options.dataTypes[0];inspected=inspected||{};inspected[dataType]=true;var list=structure[dataType],i=0,length=list?list.length:0,executeOnly=(structure===prefilters),selection;for(;i<length&&(executeOnly||!selection);i++){selection=list[i](options,originalOptions,jqXHR);if(typeof selection==="string"){if(!executeOnly||inspected[selection]){selection=undefined;}else{options.dataTypes.unshift(selection);selection=inspectPrefiltersOrTransports(structure,options,originalOptions,jqXHR,selection,inspected);}}}
if((executeOnly||!selection)&&!inspected["*"]){selection=inspectPrefiltersOrTransports(structure,options,originalOptions,jqXHR,"*",inspected);}
return selection;}
function ajaxExtend(target,src){var key,deep,flatOptions=jQuery.ajaxSettings.flatOptions||{};for(key in src){if(src[key]!==undefined){(flatOptions[key]?target:(deep||(deep={})))[key]=src[key];}}
if(deep){jQuery.extend(true,target,deep);}}
jQuery.fn.extend({load:function(url,params,callback){if(typeof url!=="string"&&_load){return _load.apply(this,arguments);}else if(!this.length){return this;}
var off=url.indexOf(" ");if(off>=0){var selector=url.slice(off,url.length);url=url.slice(0,off);}
var type="GET";if(params){if(jQuery.isFunction(params)){callback=params;params=undefined;}else if(typeof params==="object"){params=jQuery.param(params,jQuery.ajaxSettings.traditional);type="POST";}}
var self=this;jQuery.ajax({url:url,type:type,dataType:"html",data:params,complete:function(jqXHR,status,responseText){responseText=jqXHR.responseText;if(jqXHR.isResolved()){jqXHR.done(function(r){responseText=r;});self.html(selector?jQuery("<div>").append(responseText.replace(rscript,"")).find(selector):responseText);}
if(callback){self.each(callback,[responseText,status,jqXHR]);}}});return this;},serialize:function(){return jQuery.param(this.serializeArray());},serializeArray:function(){return this.map(function(){return this.elements?jQuery.makeArray(this.elements):this;}).filter(function(){return this.name&&!this.disabled&&(this.checked||rselectTextarea.test(this.nodeName)||rinput.test(this.type));}).map(function(i,elem){var val=jQuery(this).val();return val==null?null:jQuery.isArray(val)?jQuery.map(val,function(val,i){return{name:elem.name,value:val.replace(rCRLF,"\r\n")};}):{name:elem.name,value:val.replace(rCRLF,"\r\n")};}).get();}});jQuery.each("ajaxStart ajaxStop ajaxComplete ajaxError ajaxSuccess ajaxSend".split(" "),function(i,o){jQuery.fn[o]=function(f){return this.bind(o,f);};});jQuery.each(["get","post"],function(i,method){jQuery[method]=function(url,data,callback,type){if(jQuery.isFunction(data)){type=type||callback;callback=data;data=undefined;}
return jQuery.ajax({type:method,url:url,data:data,success:callback,dataType:type});};});jQuery.extend({getScript:function(url,callback){return jQuery.get(url,undefined,callback,"script");},getJSON:function(url,data,callback){return jQuery.get(url,data,callback,"json");},ajaxSetup:function(target,settings){if(settings){ajaxExtend(target,jQuery.ajaxSettings);}else{settings=target;target=jQuery.ajaxSettings;}
ajaxExtend(target,settings);return target;},ajaxSettings:{url:ajaxLocation,isLocal:rlocalProtocol.test(ajaxLocParts[1]),global:true,type:"GET",contentType:"application/x-www-form-urlencoded",processData:true,async:true,accepts:{xml:"application/xml, text/xml",html:"text/html",text:"text/plain",json:"application/json, text/javascript","*":allTypes},contents:{xml:/xml/,html:/html/,json:/json/},responseFields:{xml:"responseXML",text:"responseText"},converters:{"* text":window.String,"text html":true,"text json":jQuery.parseJSON,"text xml":jQuery.parseXML},flatOptions:{context:true,url:true}},ajaxPrefilter:addToPrefiltersOrTransports(prefilters),ajaxTransport:addToPrefiltersOrTransports(transports),ajax:function(url,options){if(typeof url==="object"){options=url;url=undefined;}
options=options||{};var
s=jQuery.ajaxSetup({},options),callbackContext=s.context||s,globalEventContext=callbackContext!==s&&(callbackContext.nodeType||callbackContext instanceof jQuery)?jQuery(callbackContext):jQuery.event,deferred=jQuery.Deferred(),completeDeferred=jQuery._Deferred(),statusCode=s.statusCode||{},ifModifiedKey,requestHeaders={},requestHeadersNames={},responseHeadersString,responseHeaders,transport,timeoutTimer,parts,state=0,fireGlobals,i,jqXHR={readyState:0,setRequestHeader:function(name,value){if(!state){var lname=name.toLowerCase();name=requestHeadersNames[lname]=requestHeadersNames[lname]||name;requestHeaders[name]=value;}
return this;},getAllResponseHeaders:function(){return state===2?responseHeadersString:null;},getResponseHeader:function(key){var match;if(state===2){if(!responseHeaders){responseHeaders={};while((match=rheaders.exec(responseHeadersString))){responseHeaders[match[1].toLowerCase()]=match[2];}}
match=responseHeaders[key.toLowerCase()];}
return match===undefined?null:match;},overrideMimeType:function(type){if(!state){s.mimeType=type;}
return this;},abort:function(statusText){statusText=statusText||"abort";if(transport){transport.abort(statusText);}
done(0,statusText);return this;}};function done(status,nativeStatusText,responses,headers){if(state===2){return;}
state=2;if(timeoutTimer){clearTimeout(timeoutTimer);}
transport=undefined;responseHeadersString=headers||"";jqXHR.readyState=status>0?4:0;var isSuccess,success,error,statusText=nativeStatusText,response=responses?ajaxHandleResponses(s,jqXHR,responses):undefined,lastModified,etag;if(status>=200&&status<300||status===304){if(s.ifModified){if((lastModified=jqXHR.getResponseHeader("Last-Modified"))){jQuery.lastModified[ifModifiedKey]=lastModified;}
if((etag=jqXHR.getResponseHeader("Etag"))){jQuery.etag[ifModifiedKey]=etag;}}
if(status===304){statusText="notmodified";isSuccess=true;}else{try{success=ajaxConvert(s,response);statusText="success";isSuccess=true;}catch(e){statusText="parsererror";error=e;}}}else{error=statusText;if(!statusText||status){statusText="error";if(status<0){status=0;}}}
jqXHR.status=status;jqXHR.statusText=""+(nativeStatusText||statusText);if(isSuccess){deferred.resolveWith(callbackContext,[success,statusText,jqXHR]);}else{deferred.rejectWith(callbackContext,[jqXHR,statusText,error]);}
jqXHR.statusCode(statusCode);statusCode=undefined;if(fireGlobals){globalEventContext.trigger("ajax"+(isSuccess?"Success":"Error"),[jqXHR,s,isSuccess?success:error]);}
completeDeferred.resolveWith(callbackContext,[jqXHR,statusText]);if(fireGlobals){globalEventContext.trigger("ajaxComplete",[jqXHR,s]);if(!(--jQuery.active)){jQuery.event.trigger("ajaxStop");}}}
deferred.promise(jqXHR);jqXHR.success=jqXHR.done;jqXHR.error=jqXHR.fail;jqXHR.complete=completeDeferred.done;jqXHR.statusCode=function(map){if(map){var tmp;if(state<2){for(tmp in map){statusCode[tmp]=[statusCode[tmp],map[tmp]];}}else{tmp=map[jqXHR.status];jqXHR.then(tmp,tmp);}}
return this;};s.url=((url||s.url)+"").replace(rhash,"").replace(rprotocol,ajaxLocParts[1]+"//");s.dataTypes=jQuery.trim(s.dataType||"*").toLowerCase().split(rspacesAjax);if(s.crossDomain==null){parts=rurl.exec(s.url.toLowerCase());s.crossDomain=!!(parts&&(parts[1]!=ajaxLocParts[1]||parts[2]!=ajaxLocParts[2]||(parts[3]||(parts[1]==="http:"?80:443))!=(ajaxLocParts[3]||(ajaxLocParts[1]==="http:"?80:443))));}
if(s.data&&s.processData&&typeof s.data!=="string"){s.data=jQuery.param(s.data,s.traditional);}
inspectPrefiltersOrTransports(prefilters,s,options,jqXHR);if(state===2){return false;}
fireGlobals=s.global;s.type=s.type.toUpperCase();s.hasContent=!rnoContent.test(s.type);if(fireGlobals&&jQuery.active++===0){jQuery.event.trigger("ajaxStart");}
if(!s.hasContent){if(s.data){s.url+=(rquery.test(s.url)?"&":"?")+s.data;delete s.data;}
ifModifiedKey=s.url;if(s.cache===false){var ts=jQuery.now(),ret=s.url.replace(rts,"$1_="+ts);s.url=ret+((ret===s.url)?(rquery.test(s.url)?"&":"?")+"_="+ts:"");}}
if(s.data&&s.hasContent&&s.contentType!==false||options.contentType){jqXHR.setRequestHeader("Content-Type",s.contentType);}
if(s.ifModified){ifModifiedKey=ifModifiedKey||s.url;if(jQuery.lastModified[ifModifiedKey]){jqXHR.setRequestHeader("If-Modified-Since",jQuery.lastModified[ifModifiedKey]);}
if(jQuery.etag[ifModifiedKey]){jqXHR.setRequestHeader("If-None-Match",jQuery.etag[ifModifiedKey]);}}
jqXHR.setRequestHeader("Accept",s.dataTypes[0]&&s.accepts[s.dataTypes[0]]?s.accepts[s.dataTypes[0]]+(s.dataTypes[0]!=="*"?", "+allTypes+"; q=0.01":""):s.accepts["*"]);for(i in s.headers){jqXHR.setRequestHeader(i,s.headers[i]);}
if(s.beforeSend&&(s.beforeSend.call(callbackContext,jqXHR,s)===false||state===2)){jqXHR.abort();return false;}
for(i in{success:1,error:1,complete:1}){jqXHR[i](s[i]);}
transport=inspectPrefiltersOrTransports(transports,s,options,jqXHR);if(!transport){done(-1,"No Transport");}else{jqXHR.readyState=1;if(fireGlobals){globalEventContext.trigger("ajaxSend",[jqXHR,s]);}
if(s.async&&s.timeout>0){timeoutTimer=setTimeout(function(){jqXHR.abort("timeout");},s.timeout);}
try{state=1;transport.send(requestHeaders,done);}catch(e){if(state<2){done(-1,e);}else{jQuery.error(e);}}}
return jqXHR;},param:function(a,traditional){var s=[],add=function(key,value){value=jQuery.isFunction(value)?value():value;s[s.length]=encodeURIComponent(key)+"="+encodeURIComponent(value);};if(traditional===undefined){traditional=jQuery.ajaxSettings.traditional;}
if(jQuery.isArray(a)||(a.jquery&&!jQuery.isPlainObject(a))){jQuery.each(a,function(){add(this.name,this.value);});}else{for(var prefix in a){buildParams(prefix,a[prefix],traditional,add);}}
return s.join("&").replace(r20,"+");}});function buildParams(prefix,obj,traditional,add){if(jQuery.isArray(obj)){jQuery.each(obj,function(i,v){if(traditional||rbracket.test(prefix)){add(prefix,v);}else{buildParams(prefix+"["+(typeof v==="object"||jQuery.isArray(v)?i:"")+"]",v,traditional,add);}});}else if(!traditional&&obj!=null&&typeof obj==="object"){for(var name in obj){buildParams(prefix+"["+name+"]",obj[name],traditional,add);}}else{add(prefix,obj);}}
jQuery.extend({active:0,lastModified:{},etag:{}});function ajaxHandleResponses(s,jqXHR,responses){var contents=s.contents,dataTypes=s.dataTypes,responseFields=s.responseFields,ct,type,finalDataType,firstDataType;for(type in responseFields){if(type in responses){jqXHR[responseFields[type]]=responses[type];}}
while(dataTypes[0]==="*"){dataTypes.shift();if(ct===undefined){ct=s.mimeType||jqXHR.getResponseHeader("content-type");}}
if(ct){for(type in contents){if(contents[type]&&contents[type].test(ct)){dataTypes.unshift(type);break;}}}
if(dataTypes[0]in responses){finalDataType=dataTypes[0];}else{for(type in responses){if(!dataTypes[0]||s.converters[type+" "+dataTypes[0]]){finalDataType=type;break;}
if(!firstDataType){firstDataType=type;}}
finalDataType=finalDataType||firstDataType;}
if(finalDataType){if(finalDataType!==dataTypes[0]){dataTypes.unshift(finalDataType);}
return responses[finalDataType];}}
function ajaxConvert(s,response){if(s.dataFilter){response=s.dataFilter(response,s.dataType);}
var dataTypes=s.dataTypes,converters={},i,key,length=dataTypes.length,tmp,current=dataTypes[0],prev,conversion,conv,conv1,conv2;for(i=1;i<length;i++){if(i===1){for(key in s.converters){if(typeof key==="string"){converters[key.toLowerCase()]=s.converters[key];}}}
prev=current;current=dataTypes[i];if(current==="*"){current=prev;}else if(prev!=="*"&&prev!==current){conversion=prev+" "+current;conv=converters[conversion]||converters["* "+current];if(!conv){conv2=undefined;for(conv1 in converters){tmp=conv1.split(" ");if(tmp[0]===prev||tmp[0]==="*"){conv2=converters[tmp[1]+" "+current];if(conv2){conv1=converters[conv1];if(conv1===true){conv=conv2;}else if(conv2===true){conv=conv1;}
break;}}}}
if(!(conv||conv2)){jQuery.error("No conversion from "+conversion.replace(" "," to "));}
if(conv!==true){response=conv?conv(response):conv2(conv1(response));}}}
return response;}
var jsc=jQuery.now(),jsre=/(\=)\?(&|$)|\?\?/i;jQuery.ajaxSetup({jsonp:"callback",jsonpCallback:function(){return jQuery.expando+"_"+(jsc++);}});jQuery.ajaxPrefilter("json jsonp",function(s,originalSettings,jqXHR){var inspectData=s.contentType==="application/x-www-form-urlencoded"&&(typeof s.data==="string");if(s.dataTypes[0]==="jsonp"||s.jsonp!==false&&(jsre.test(s.url)||inspectData&&jsre.test(s.data))){var responseContainer,jsonpCallback=s.jsonpCallback=jQuery.isFunction(s.jsonpCallback)?s.jsonpCallback():s.jsonpCallback,previous=window[jsonpCallback],url=s.url,data=s.data,replace="$1"+jsonpCallback+"$2";if(s.jsonp!==false){url=url.replace(jsre,replace);if(s.url===url){if(inspectData){data=data.replace(jsre,replace);}
if(s.data===data){url+=(/\?/.test(url)?"&":"?")+s.jsonp+"="+jsonpCallback;}}}
s.url=url;s.data=data;window[jsonpCallback]=function(response){responseContainer=[response];};jqXHR.always(function(){window[jsonpCallback]=previous;if(responseContainer&&jQuery.isFunction(previous)){window[jsonpCallback](responseContainer[0]);}});s.converters["script json"]=function(){if(!responseContainer){jQuery.error(jsonpCallback+" was not called");}
return responseContainer[0];};s.dataTypes[0]="json";return"script";}});jQuery.ajaxSetup({accepts:{script:"text/javascript, application/javascript, application/ecmascript, application/x-ecmascript"},contents:{script:/javascript|ecmascript/},converters:{"text script":function(text){jQuery.globalEval(text);return text;}}});jQuery.ajaxPrefilter("script",function(s){if(s.cache===undefined){s.cache=false;}
if(s.crossDomain){s.type="GET";s.global=false;}});jQuery.ajaxTransport("script",function(s){if(s.crossDomain){var script,head=document.head||document.getElementsByTagName("head")[0]||document.documentElement;return{send:function(_,callback){script=document.createElement("script");script.async="async";if(s.scriptCharset){script.charset=s.scriptCharset;}
script.src=s.url;script.onload=script.onreadystatechange=function(_,isAbort){if(isAbort||!script.readyState||/loaded|complete/.test(script.readyState)){script.onload=script.onreadystatechange=null;if(head&&script.parentNode){head.removeChild(script);}
script=undefined;if(!isAbort){callback(200,"success");}}};head.insertBefore(script,head.firstChild);},abort:function(){if(script){script.onload(0,1);}}};}});var
xhrOnUnloadAbort=window.ActiveXObject?function(){for(var key in xhrCallbacks){xhrCallbacks[key](0,1);}}:false,xhrId=0,xhrCallbacks;function createStandardXHR(){try{return new window.XMLHttpRequest();}catch(e){}}
function createActiveXHR(){try{return new window.ActiveXObject("Microsoft.XMLHTTP");}catch(e){}}
jQuery.ajaxSettings.xhr=window.ActiveXObject?function(){return!this.isLocal&&createStandardXHR()||createActiveXHR();}:createStandardXHR;(function(xhr){jQuery.extend(jQuery.support,{ajax:!!xhr,cors:!!xhr&&("withCredentials"in xhr)});})(jQuery.ajaxSettings.xhr());if(jQuery.support.ajax){jQuery.ajaxTransport(function(s){if(!s.crossDomain||jQuery.support.cors){var callback;return{send:function(headers,complete){var xhr=s.xhr(),handle,i;if(s.username){xhr.open(s.type,s.url,s.async,s.username,s.password);}else{xhr.open(s.type,s.url,s.async);}
if(s.xhrFields){for(i in s.xhrFields){xhr[i]=s.xhrFields[i];}}
if(s.mimeType&&xhr.overrideMimeType){xhr.overrideMimeType(s.mimeType);}
if(!s.crossDomain&&!headers["X-Requested-With"]){headers["X-Requested-With"]="XMLHttpRequest";}
try{for(i in headers){xhr.setRequestHeader(i,headers[i]);}}catch(_){}
xhr.send((s.hasContent&&s.data)||null);callback=function(_,isAbort){var status,statusText,responseHeaders,responses,xml;try{if(callback&&(isAbort||xhr.readyState===4)){callback=undefined;if(handle){xhr.onreadystatechange=jQuery.noop;if(xhrOnUnloadAbort){delete xhrCallbacks[handle];}}
if(isAbort){if(xhr.readyState!==4){xhr.abort();}}else{status=xhr.status;responseHeaders=xhr.getAllResponseHeaders();responses={};xml=xhr.responseXML;if(xml&&xml.documentElement){responses.xml=xml;}
responses.text=xhr.responseText;try{statusText=xhr.statusText;}catch(e){statusText="";}
if(!status&&s.isLocal&&!s.crossDomain){status=responses.text?200:404;}else if(status===1223){status=204;}}}}catch(firefoxAccessException){if(!isAbort){complete(-1,firefoxAccessException);}}
if(responses){complete(status,statusText,responses,responseHeaders);}};if(!s.async||xhr.readyState===4){callback();}else{handle=++xhrId;if(xhrOnUnloadAbort){if(!xhrCallbacks){xhrCallbacks={};jQuery(window).unload(xhrOnUnloadAbort);}
xhrCallbacks[handle]=callback;}
xhr.onreadystatechange=callback;}},abort:function(){if(callback){callback(0,1);}}};}});}
var elemdisplay={},iframe,iframeDoc,rfxtypes=/^(?:toggle|show|hide)$/,rfxnum=/^([+\-]=)?([\d+.\-]+)([a-z%]*)$/i,timerId,fxAttrs=[["height","marginTop","marginBottom","paddingTop","paddingBottom"],["width","marginLeft","marginRight","paddingLeft","paddingRight"],["opacity"]],fxNow;jQuery.fn.extend({show:function(speed,easing,callback){var elem,display;if(speed||speed===0){return this.animate(genFx("show",3),speed,easing,callback);}else{for(var i=0,j=this.length;i<j;i++){elem=this[i];if(elem.style){display=elem.style.display;if(!jQuery._data(elem,"olddisplay")&&display==="none"){display=elem.style.display="";}
if(display===""&&jQuery.css(elem,"display")==="none"){jQuery._data(elem,"olddisplay",defaultDisplay(elem.nodeName));}}}
for(i=0;i<j;i++){elem=this[i];if(elem.style){display=elem.style.display;if(display===""||display==="none"){elem.style.display=jQuery._data(elem,"olddisplay")||"";}}}
return this;}},hide:function(speed,easing,callback){if(speed||speed===0){return this.animate(genFx("hide",3),speed,easing,callback);}else{for(var i=0,j=this.length;i<j;i++){if(this[i].style){var display=jQuery.css(this[i],"display");if(display!=="none"&&!jQuery._data(this[i],"olddisplay")){jQuery._data(this[i],"olddisplay",display);}}}
for(i=0;i<j;i++){if(this[i].style){this[i].style.display="none";}}
return this;}},_toggle:jQuery.fn.toggle,toggle:function(fn,fn2,callback){var bool=typeof fn==="boolean";if(jQuery.isFunction(fn)&&jQuery.isFunction(fn2)){this._toggle.apply(this,arguments);}else if(fn==null||bool){this.each(function(){var state=bool?fn:jQuery(this).is(":hidden");jQuery(this)[state?"show":"hide"]();});}else{this.animate(genFx("toggle",3),fn,fn2,callback);}
return this;},fadeTo:function(speed,to,easing,callback){return this.filter(":hidden").css("opacity",0).show().end().animate({opacity:to},speed,easing,callback);},animate:function(prop,speed,easing,callback){var optall=jQuery.speed(speed,easing,callback);if(jQuery.isEmptyObject(prop)){return this.each(optall.complete,[false]);}
prop=jQuery.extend({},prop);return this[optall.queue===false?"each":"queue"](function(){if(optall.queue===false){jQuery._mark(this);}
var opt=jQuery.extend({},optall),isElement=this.nodeType===1,hidden=isElement&&jQuery(this).is(":hidden"),name,val,p,display,e,parts,start,end,unit;opt.animatedProperties={};for(p in prop){name=jQuery.camelCase(p);if(p!==name){prop[name]=prop[p];delete prop[p];}
val=prop[name];if(jQuery.isArray(val)){opt.animatedProperties[name]=val[1];val=prop[name]=val[0];}else{opt.animatedProperties[name]=opt.specialEasing&&opt.specialEasing[name]||opt.easing||'swing';}
if(val==="hide"&&hidden||val==="show"&&!hidden){return opt.complete.call(this);}
if(isElement&&(name==="height"||name==="width")){opt.overflow=[this.style.overflow,this.style.overflowX,this.style.overflowY];if(jQuery.css(this,"display")==="inline"&&jQuery.css(this,"float")==="none"){if(!jQuery.support.inlineBlockNeedsLayout){this.style.display="inline-block";}else{display=defaultDisplay(this.nodeName);if(display==="inline"){this.style.display="inline-block";}else{this.style.display="inline";this.style.zoom=1;}}}}}
if(opt.overflow!=null){this.style.overflow="hidden";}
for(p in prop){e=new jQuery.fx(this,opt,p);val=prop[p];if(rfxtypes.test(val)){e[val==="toggle"?hidden?"show":"hide":val]();}else{parts=rfxnum.exec(val);start=e.cur();if(parts){end=parseFloat(parts[2]);unit=parts[3]||(jQuery.cssNumber[p]?"":"px");if(unit!=="px"){jQuery.style(this,p,(end||1)+unit);start=((end||1)/e.cur())*start;jQuery.style(this,p,start+unit);}
if(parts[1]){end=((parts[1]==="-="?-1:1)*end)+start;}
e.custom(start,end,unit);}else{e.custom(start,val,"");}}}
return true;});},stop:function(clearQueue,gotoEnd){if(clearQueue){this.queue([]);}
this.each(function(){var timers=jQuery.timers,i=timers.length;if(!gotoEnd){jQuery._unmark(true,this);}
while(i--){if(timers[i].elem===this){if(gotoEnd){timers[i](true);}
timers.splice(i,1);}}});if(!gotoEnd){this.dequeue();}
return this;}});function createFxNow(){setTimeout(clearFxNow,0);return(fxNow=jQuery.now());}
function clearFxNow(){fxNow=undefined;}
function genFx(type,num){var obj={};jQuery.each(fxAttrs.concat.apply([],fxAttrs.slice(0,num)),function(){obj[this]=type;});return obj;}
jQuery.each({slideDown:genFx("show",1),slideUp:genFx("hide",1),slideToggle:genFx("toggle",1),fadeIn:{opacity:"show"},fadeOut:{opacity:"hide"},fadeToggle:{opacity:"toggle"}},function(name,props){jQuery.fn[name]=function(speed,easing,callback){return this.animate(props,speed,easing,callback);};});jQuery.extend({speed:function(speed,easing,fn){var opt=speed&&typeof speed==="object"?jQuery.extend({},speed):{complete:fn||!fn&&easing||jQuery.isFunction(speed)&&speed,duration:speed,easing:fn&&easing||easing&&!jQuery.isFunction(easing)&&easing};opt.duration=jQuery.fx.off?0:typeof opt.duration==="number"?opt.duration:opt.duration in jQuery.fx.speeds?jQuery.fx.speeds[opt.duration]:jQuery.fx.speeds._default;opt.old=opt.complete;opt.complete=function(noUnmark){if(jQuery.isFunction(opt.old)){opt.old.call(this);}
if(opt.queue!==false){jQuery.dequeue(this);}else if(noUnmark!==false){jQuery._unmark(this);}};return opt;},easing:{linear:function(p,n,firstNum,diff){return firstNum+diff*p;},swing:function(p,n,firstNum,diff){return((-Math.cos(p*Math.PI)/2)+0.5)*diff+firstNum;}},timers:[],fx:function(elem,options,prop){this.options=options;this.elem=elem;this.prop=prop;options.orig=options.orig||{};}});jQuery.fx.prototype={update:function(){if(this.options.step){this.options.step.call(this.elem,this.now,this);}
(jQuery.fx.step[this.prop]||jQuery.fx.step._default)(this);},cur:function(){if(this.elem[this.prop]!=null&&(!this.elem.style||this.elem.style[this.prop]==null)){return this.elem[this.prop];}
var parsed,r=jQuery.css(this.elem,this.prop);return isNaN(parsed=parseFloat(r))?!r||r==="auto"?0:r:parsed;},custom:function(from,to,unit){var self=this,fx=jQuery.fx;this.startTime=fxNow||createFxNow();this.start=from;this.end=to;this.unit=unit||this.unit||(jQuery.cssNumber[this.prop]?"":"px");this.now=this.start;this.pos=this.state=0;function t(gotoEnd){return self.step(gotoEnd);}
t.elem=this.elem;if(t()&&jQuery.timers.push(t)&&!timerId){timerId=setInterval(fx.tick,fx.interval);}},show:function(){this.options.orig[this.prop]=jQuery.style(this.elem,this.prop);this.options.show=true;this.custom(this.prop==="width"||this.prop==="height"?1:0,this.cur());jQuery(this.elem).show();},hide:function(){this.options.orig[this.prop]=jQuery.style(this.elem,this.prop);this.options.hide=true;this.custom(this.cur(),0);},step:function(gotoEnd){var t=fxNow||createFxNow(),done=true,elem=this.elem,options=this.options,i,n;if(gotoEnd||t>=options.duration+this.startTime){this.now=this.end;this.pos=this.state=1;this.update();options.animatedProperties[this.prop]=true;for(i in options.animatedProperties){if(options.animatedProperties[i]!==true){done=false;}}
if(done){if(options.overflow!=null&&!jQuery.support.shrinkWrapBlocks){jQuery.each(["","X","Y"],function(index,value){elem.style["overflow"+value]=options.overflow[index];});}
if(options.hide){jQuery(elem).hide();}
if(options.hide||options.show){for(var p in options.animatedProperties){jQuery.style(elem,p,options.orig[p]);}}
options.complete.call(elem);}
return false;}else{if(options.duration==Infinity){this.now=t;}else{n=t-this.startTime;this.state=n/options.duration;this.pos=jQuery.easing[options.animatedProperties[this.prop]](this.state,n,0,1,options.duration);this.now=this.start+((this.end-this.start)*this.pos);}
this.update();}
return true;}};jQuery.extend(jQuery.fx,{tick:function(){for(var timers=jQuery.timers,i=0;i<timers.length;++i){if(!timers[i]()){timers.splice(i--,1);}}
if(!timers.length){jQuery.fx.stop();}},interval:13,stop:function(){clearInterval(timerId);timerId=null;},speeds:{slow:600,fast:200,_default:400},step:{opacity:function(fx){jQuery.style(fx.elem,"opacity",fx.now);},_default:function(fx){if(fx.elem.style&&fx.elem.style[fx.prop]!=null){fx.elem.style[fx.prop]=(fx.prop==="width"||fx.prop==="height"?Math.max(0,fx.now):fx.now)+fx.unit;}else{fx.elem[fx.prop]=fx.now;}}}});if(jQuery.expr&&jQuery.expr.filters){jQuery.expr.filters.animated=function(elem){return jQuery.grep(jQuery.timers,function(fn){return elem===fn.elem;}).length;};}
function defaultDisplay(nodeName){if(!elemdisplay[nodeName]){var body=document.body,elem=jQuery("<"+nodeName+">").appendTo(body),display=elem.css("display");elem.remove();if(display==="none"||display===""){if(!iframe){iframe=document.createElement("iframe");iframe.frameBorder=iframe.width=iframe.height=0;}
body.appendChild(iframe);if(!iframeDoc||!iframe.createElement){iframeDoc=(iframe.contentWindow||iframe.contentDocument).document;iframeDoc.write((document.compatMode==="CSS1Compat"?"<!doctype html>":"")+"<html><body>");iframeDoc.close();}
elem=iframeDoc.createElement(nodeName);iframeDoc.body.appendChild(elem);display=jQuery.css(elem,"display");body.removeChild(iframe);}
elemdisplay[nodeName]=display;}
return elemdisplay[nodeName];}
var rtable=/^t(?:able|d|h)$/i,rroot=/^(?:body|html)$/i;if("getBoundingClientRect"in document.documentElement){jQuery.fn.offset=function(options){var elem=this[0],box;if(options){return this.each(function(i){jQuery.offset.setOffset(this,options,i);});}
if(!elem||!elem.ownerDocument){return null;}
if(elem===elem.ownerDocument.body){return jQuery.offset.bodyOffset(elem);}
try{box=elem.getBoundingClientRect();}catch(e){}
var doc=elem.ownerDocument,docElem=doc.documentElement;if(!box||!jQuery.contains(docElem,elem)){return box?{top:box.top,left:box.left}:{top:0,left:0};}
var body=doc.body,win=getWindow(doc),clientTop=docElem.clientTop||body.clientTop||0,clientLeft=docElem.clientLeft||body.clientLeft||0,scrollTop=win.pageYOffset||jQuery.support.boxModel&&docElem.scrollTop||body.scrollTop,scrollLeft=win.pageXOffset||jQuery.support.boxModel&&docElem.scrollLeft||body.scrollLeft,top=box.top+scrollTop-clientTop,left=box.left+scrollLeft-clientLeft;return{top:top,left:left};};}else{jQuery.fn.offset=function(options){var elem=this[0];if(options){return this.each(function(i){jQuery.offset.setOffset(this,options,i);});}
if(!elem||!elem.ownerDocument){return null;}
if(elem===elem.ownerDocument.body){return jQuery.offset.bodyOffset(elem);}
jQuery.offset.initialize();var computedStyle,offsetParent=elem.offsetParent,prevOffsetParent=elem,doc=elem.ownerDocument,docElem=doc.documentElement,body=doc.body,defaultView=doc.defaultView,prevComputedStyle=defaultView?defaultView.getComputedStyle(elem,null):elem.currentStyle,top=elem.offsetTop,left=elem.offsetLeft;while((elem=elem.parentNode)&&elem!==body&&elem!==docElem){if(jQuery.offset.supportsFixedPosition&&prevComputedStyle.position==="fixed"){break;}
computedStyle=defaultView?defaultView.getComputedStyle(elem,null):elem.currentStyle;top-=elem.scrollTop;left-=elem.scrollLeft;if(elem===offsetParent){top+=elem.offsetTop;left+=elem.offsetLeft;if(jQuery.offset.doesNotAddBorder&&!(jQuery.offset.doesAddBorderForTableAndCells&&rtable.test(elem.nodeName))){top+=parseFloat(computedStyle.borderTopWidth)||0;left+=parseFloat(computedStyle.borderLeftWidth)||0;}
prevOffsetParent=offsetParent;offsetParent=elem.offsetParent;}
if(jQuery.offset.subtractsBorderForOverflowNotVisible&&computedStyle.overflow!=="visible"){top+=parseFloat(computedStyle.borderTopWidth)||0;left+=parseFloat(computedStyle.borderLeftWidth)||0;}
prevComputedStyle=computedStyle;}
if(prevComputedStyle.position==="relative"||prevComputedStyle.position==="static"){top+=body.offsetTop;left+=body.offsetLeft;}
if(jQuery.offset.supportsFixedPosition&&prevComputedStyle.position==="fixed"){top+=Math.max(docElem.scrollTop,body.scrollTop);left+=Math.max(docElem.scrollLeft,body.scrollLeft);}
return{top:top,left:left};};}
jQuery.offset={initialize:function(){var body=document.body,container=document.createElement("div"),innerDiv,checkDiv,table,td,bodyMarginTop=parseFloat(jQuery.css(body,"marginTop"))||0,html="<div style='position:absolute;top:0;left:0;margin:0;border:5px solid #000;padding:0;width:1px;height:1px;'><div></div></div><table style='position:absolute;top:0;left:0;margin:0;border:5px solid #000;padding:0;width:1px;height:1px;' cellpadding='0' cellspacing='0'><tr><td></td></tr></table>";jQuery.extend(container.style,{position:"absolute",top:0,left:0,margin:0,border:0,width:"1px",height:"1px",visibility:"hidden"});container.innerHTML=html;body.insertBefore(container,body.firstChild);innerDiv=container.firstChild;checkDiv=innerDiv.firstChild;td=innerDiv.nextSibling.firstChild.firstChild;this.doesNotAddBorder=(checkDiv.offsetTop!==5);this.doesAddBorderForTableAndCells=(td.offsetTop===5);checkDiv.style.position="fixed";checkDiv.style.top="20px";this.supportsFixedPosition=(checkDiv.offsetTop===20||checkDiv.offsetTop===15);checkDiv.style.position=checkDiv.style.top="";innerDiv.style.overflow="hidden";innerDiv.style.position="relative";this.subtractsBorderForOverflowNotVisible=(checkDiv.offsetTop===-5);this.doesNotIncludeMarginInBodyOffset=(body.offsetTop!==bodyMarginTop);body.removeChild(container);jQuery.offset.initialize=jQuery.noop;},bodyOffset:function(body){var top=body.offsetTop,left=body.offsetLeft;jQuery.offset.initialize();if(jQuery.offset.doesNotIncludeMarginInBodyOffset){top+=parseFloat(jQuery.css(body,"marginTop"))||0;left+=parseFloat(jQuery.css(body,"marginLeft"))||0;}
return{top:top,left:left};},setOffset:function(elem,options,i){var position=jQuery.css(elem,"position");if(position==="static"){elem.style.position="relative";}
var curElem=jQuery(elem),curOffset=curElem.offset(),curCSSTop=jQuery.css(elem,"top"),curCSSLeft=jQuery.css(elem,"left"),calculatePosition=(position==="absolute"||position==="fixed")&&jQuery.inArray("auto",[curCSSTop,curCSSLeft])>-1,props={},curPosition={},curTop,curLeft;if(calculatePosition){curPosition=curElem.position();curTop=curPosition.top;curLeft=curPosition.left;}else{curTop=parseFloat(curCSSTop)||0;curLeft=parseFloat(curCSSLeft)||0;}
if(jQuery.isFunction(options)){options=options.call(elem,i,curOffset);}
if(options.top!=null){props.top=(options.top-curOffset.top)+curTop;}
if(options.left!=null){props.left=(options.left-curOffset.left)+curLeft;}
if("using"in options){options.using.call(elem,props);}else{curElem.css(props);}}};jQuery.fn.extend({position:function(){if(!this[0]){return null;}
var elem=this[0],offsetParent=this.offsetParent(),offset=this.offset(),parentOffset=rroot.test(offsetParent[0].nodeName)?{top:0,left:0}:offsetParent.offset();offset.top-=parseFloat(jQuery.css(elem,"marginTop"))||0;offset.left-=parseFloat(jQuery.css(elem,"marginLeft"))||0;parentOffset.top+=parseFloat(jQuery.css(offsetParent[0],"borderTopWidth"))||0;parentOffset.left+=parseFloat(jQuery.css(offsetParent[0],"borderLeftWidth"))||0;return{top:offset.top-parentOffset.top,left:offset.left-parentOffset.left};},offsetParent:function(){return this.map(function(){var offsetParent=this.offsetParent||document.body;while(offsetParent&&(!rroot.test(offsetParent.nodeName)&&jQuery.css(offsetParent,"position")==="static")){offsetParent=offsetParent.offsetParent;}
return offsetParent;});}});jQuery.each(["Left","Top"],function(i,name){var method="scroll"+name;jQuery.fn[method]=function(val){var elem,win;if(val===undefined){elem=this[0];if(!elem){return null;}
win=getWindow(elem);return win?("pageXOffset"in win)?win[i?"pageYOffset":"pageXOffset"]:jQuery.support.boxModel&&win.document.documentElement[method]||win.document.body[method]:elem[method];}
return this.each(function(){win=getWindow(this);if(win){win.scrollTo(!i?val:jQuery(win).scrollLeft(),i?val:jQuery(win).scrollTop());}else{this[method]=val;}});};});function getWindow(elem){return jQuery.isWindow(elem)?elem:elem.nodeType===9?elem.defaultView||elem.parentWindow:false;}
jQuery.each(["Height","Width"],function(i,name){var type=name.toLowerCase();jQuery.fn["inner"+name]=function(){var elem=this[0];return elem&&elem.style?parseFloat(jQuery.css(elem,type,"padding")):null;};jQuery.fn["outer"+name]=function(margin){var elem=this[0];return elem&&elem.style?parseFloat(jQuery.css(elem,type,margin?"margin":"border")):null;};jQuery.fn[type]=function(size){var elem=this[0];if(!elem){return size==null?null:this;}
if(jQuery.isFunction(size)){return this.each(function(i){var self=jQuery(this);self[type](size.call(this,i,self[type]()));});}
if(jQuery.isWindow(elem)){var docElemProp=elem.document.documentElement["client"+name],body=elem.document.body;return elem.document.compatMode==="CSS1Compat"&&docElemProp||body&&body["client"+name]||docElemProp;}else if(elem.nodeType===9){return Math.max(elem.documentElement["client"+name],elem.body["scroll"+name],elem.documentElement["scroll"+name],elem.body["offset"+name],elem.documentElement["offset"+name]);}else if(size===undefined){var orig=jQuery.css(elem,type),ret=parseFloat(orig);return jQuery.isNaN(ret)?orig:ret;}else{return this.css(type,typeof size==="string"?size:size+"px");}};});window.jQuery=window.$=jQuery;})(window);;(function($){if(!document.defaultView||!document.defaultView.getComputedStyle){var oldCurCSS=$.curCSS;$.curCSS=function(elem,name,force){if(name==='background-position'){name='backgroundPosition';}
if(name!=='backgroundPosition'||!elem.currentStyle||elem.currentStyle[name]){return oldCurCSS.apply(this,arguments);}
var style=elem.style;if(!force&&style&&style[name]){return style[name];}
return oldCurCSS(elem,'backgroundPositionX',force)+' '+oldCurCSS(elem,'backgroundPositionY',force);};}
var oldAnim=$.fn.animate;$.fn.animate=function(prop){if('background-position'in prop){prop.backgroundPosition=prop['background-position'];delete prop['background-position'];}
if('backgroundPosition'in prop){prop.backgroundPosition='('+prop.backgroundPosition;}
return oldAnim.apply(this,arguments);};function toArray(strg){strg=strg.replace(/left|top/g,'0px');strg=strg.replace(/right|bottom/g,'100%');strg=strg.replace(/([0-9\.]+)(\s|\)|$)/g,"$1px$2");var res=strg.match(/(-?[0-9\.]+)(px|\%|em|pt)\s(-?[0-9\.]+)(px|\%|em|pt)/);return[parseFloat(res[1],10),res[2],parseFloat(res[3],10),res[4]];}
$.fx.step.backgroundPosition=function(fx){if(!fx.bgPosReady){var start=$.curCSS(fx.elem,'backgroundPosition');if(!start){start='0px 0px';}
start=toArray(start);fx.start=[start[0],start[2]];var end=toArray(fx.end);fx.end=[end[0],end[2]];fx.unit=[end[1],end[3]];fx.bgPosReady=true;}
var nowPosX=[];nowPosX[0]=((fx.end[0]-fx.start[0])*fx.pos)+fx.start[0]+fx.unit[0];nowPosX[1]=((fx.end[1]-fx.start[1])*fx.pos)+fx.start[1]+fx.unit[1];fx.elem.style.backgroundPosition=nowPosX[0]+' '+nowPosX[1];};})(jQuery);;(function($){$._spritely={animate:function(options){var el=$(options.el);var el_id=el.attr('id');if(!$._spritely.instances[el_id]){return this;}
options=$.extend(options,$._spritely.instances[el_id]||{});if(options.play_frames&&!$._spritely.instances[el_id]['remaining_frames']){$._spritely.instances[el_id]['remaining_frames']=options.play_frames+1;}
if(options.type=='sprite'&&options.fps){var frames;var animate=function(el){var w=options.width,h=options.height;if(!frames){frames=[];total=0
for(var i=0;i<options.no_of_frames;i++){frames[frames.length]=(0-total);total+=w;}}
if($._spritely.instances[el_id]['current_frame']==0){if(options.on_first_frame){options.on_first_frame(el);}}else if($._spritely.instances[el_id]['current_frame']==frames.length-1){if(options.on_last_frame){options.on_last_frame(el);}}
if(options.on_frame&&options.on_frame[$._spritely.instances[el_id]['current_frame']]){options.on_frame[$._spritely.instances[el_id]['current_frame']](el);}
if(options.rewind==true){if($._spritely.instances[el_id]['current_frame']<=0){$._spritely.instances[el_id]['current_frame']=frames.length-1;}else{$._spritely.instances[el_id]['current_frame']=$._spritely.instances[el_id]['current_frame']-1;};}else{if($._spritely.instances[el_id]['current_frame']>=frames.length-1){$._spritely.instances[el_id]['current_frame']=0;}else{$._spritely.instances[el_id]['current_frame']=$._spritely.instances[el_id]['current_frame']+1;}}
var yPos=$._spritely.getBgY(el);el.css('background-position',frames[$._spritely.instances[el_id]['current_frame']]+'px '+yPos);if(options.bounce&&options.bounce[0]>0&&options.bounce[1]>0){var ud=options.bounce[0];var lr=options.bounce[1];var ms=options.bounce[2];el.animate({top:'+='+ud+'px',left:'-='+lr+'px'},ms).animate({top:'-='+ud+'px',left:'+='+lr+'px'},ms);}}
if($._spritely.instances[el_id]['remaining_frames']&&$._spritely.instances[el_id]['remaining_frames']>0){$._spritely.instances[el_id]['remaining_frames']--;if($._spritely.instances[el_id]['remaining_frames']==0){$._spritely.instances[el_id]['remaining_frames']=-1;delete $._spritely.instances[el_id]['remaining_frames'];return;}else{animate(el);}}else if($._spritely.instances[el_id]['remaining_frames']!=-1){animate(el);}}else if(options.type=='pan'){if(!$._spritely.instances[el_id]['_stopped']){if(options.dir=='up'){$._spritely.instances[el_id]['l']=$._spritely.getBgX(el).replace('px','');$._spritely.instances[el_id]['t']=($._spritely.instances[el_id]['t']-(options.speed||1))||0;}else if(options.dir=='down'){$._spritely.instances[el_id]['l']=$._spritely.getBgX(el).replace('px','');$._spritely.instances[el_id]['t']=($._spritely.instances[el_id]['t']+(options.speed||1))||0;}else if(options.dir=='left'){$._spritely.instances[el_id]['l']=($._spritely.instances[el_id]['l']-(options.speed||1))||0;$._spritely.instances[el_id]['t']=$._spritely.getBgY(el).replace('px','');}else{$._spritely.instances[el_id]['l']=($._spritely.instances[el_id]['l']+(options.speed||1))||0;$._spritely.instances[el_id]['t']=$._spritely.getBgY(el).replace('px','');}
var bg_left=$._spritely.instances[el_id]['l'].toString();if(bg_left.indexOf('%')==-1){bg_left+='px ';}else{bg_left+=' ';}
var bg_top=$._spritely.instances[el_id]['t'].toString();if(bg_top.indexOf('%')==-1){bg_top+='px ';}else{bg_top+=' ';}
$(el).css('background-position',bg_left+bg_top);}}
$._spritely.instances[el_id]['options']=options;$._spritely.instances[el_id]['timeout']=window.setTimeout(function(){$._spritely.animate(options);},parseInt(1000/options.fps));},randomIntBetween:function(lower,higher){return parseInt(rand_no=Math.floor((higher-(lower-1))*Math.random())+lower);},getBgY:function(el){if($.browser.msie){var bgY=$(el).css('background-position-y')||'0';}else{var bgY=($(el).css('background-position')||' ').split(' ')[1];}
return bgY;},getBgX:function(el){if($.browser.msie){var bgX=$(el).css('background-position-x')||'0';}else{var bgX=($(el).css('background-position')||' ').split(' ')[0];}
return bgX;},get_rel_pos:function(pos,w){var r=pos;if(pos<0){while(r<0){r+=w;}}else{while(r>w){r-=w;}}
return r;}};$.fn.extend({spritely:function(options){var options=$.extend({type:'sprite',do_once:false,width:null,height:null,fps:12,no_of_frames:2,stop_after:null},options||{});var el_id=$(this).attr('id');if(!$._spritely.instances){$._spritely.instances={};}
if(!$._spritely.instances[el_id]){if(options.start_at_frame){$._spritely.instances[el_id]={current_frame:options.start_at_frame-1};}else{$._spritely.instances[el_id]={current_frame:-1};}}
$._spritely.instances[el_id]['type']=options.type;$._spritely.instances[el_id]['depth']=options.depth;options.el=this;options.width=options.width||$(this).width()||100;options.height=options.height||$(this).height()||100;var get_rate=function(){return parseInt(1000/options.fps);}
if(!options.do_once){window.setTimeout(function(){$._spritely.animate(options);},get_rate(options.fps));}else{$._spritely.animate(options);}
return this;},sprite:function(options){var options=$.extend({type:'sprite',bounce:[0,0,1000]},options||{});return $(this).spritely(options);},pan:function(options){var options=$.extend({type:'pan',dir:'left',continuous:true,speed:1},options||{});return $(this).spritely(options);},flyToTap:function(options){var options=$.extend({el_to_move:null,type:'moveToTap',ms:1000,do_once:true},options||{});if(options.el_to_move){$(options.el_to_move).active();}
if($._spritely.activeSprite){if(window.Touch){$(this)[0].ontouchstart=function(e){var el_to_move=$._spritely.activeSprite;var touch=e.touches[0];var t=touch.pageY-(el_to_move.height()/2);var l=touch.pageX-(el_to_move.width()/2);el_to_move.animate({top:t+'px',left:l+'px'},1000);};}else{$(this).click(function(e){var el_to_move=$._spritely.activeSprite;$(el_to_move).stop(true);var w=el_to_move.width();var h=el_to_move.height();var l=e.pageX-(w/2);var t=e.pageY-(h/2);el_to_move.animate({top:t+'px',left:l+'px'},1000);});}}
return this;},isDraggable:function(options){if((!$(this).draggable)){return this;}
var options=$.extend({type:'isDraggable',start:null,stop:null,drag:null},options||{});var el_id=$(this).attr('id');if(!$._spritely.instances[el_id]){return this;}
$._spritely.instances[el_id].isDraggableOptions=options;$(this).draggable({start:function(){var el_id=$(this).attr('id');$._spritely.instances[el_id].stop_random=true;$(this).stop(true);if($._spritely.instances[el_id].isDraggableOptions.start){$._spritely.instances[el_id].isDraggableOptions.start(this);}},drag:options.drag,stop:function(){var el_id=$(this).attr('id');$._spritely.instances[el_id].stop_random=false;if($._spritely.instances[el_id].isDraggableOptions.stop){$._spritely.instances[el_id].isDraggableOptions.stop(this);}}});return this;},active:function(){$._spritely.activeSprite=this;return this;},activeOnClick:function(){var el=$(this);if(window.Touch){el[0].ontouchstart=function(e){$._spritely.activeSprite=el;};}else{el.click(function(e){$._spritely.activeSprite=el;});}
return this;},spRandom:function(options){var options=$.extend({top:50,left:50,right:290,bottom:320,speed:4000,pause:0},options||{});var el_id=$(this).attr('id');if(!$._spritely.instances[el_id]){return this;}
if(!$._spritely.instances[el_id].stop_random){var r=$._spritely.randomIntBetween;var t=r(options.top,options.bottom);var l=r(options.left,options.right);$('#'+el_id).animate({top:t+'px',left:l+'px'},options.speed)}
window.setTimeout(function(){$('#'+el_id).spRandom(options);},options.speed+options.pause)
return this;},makeAbsolute:function(){return this.each(function(){var el=$(this);var pos=el.position();el.css({position:"absolute",marginLeft:0,marginTop:0,top:pos.top,left:pos.left}).remove().appendTo("body");});},spSet:function(prop_name,prop_value){var el_id=$(this).attr('id');$._spritely.instances[el_id][prop_name]=prop_value;return this;},spGet:function(prop_name,prop_value){var el_id=$(this).attr('id');return $._spritely.instances[el_id][prop_name];},spStop:function(bool){$(this).each(function(){var el_id=$(this).attr('id');$._spritely.instances[el_id]['_last_fps']=$(this).spGet('fps');$._spritely.instances[el_id]['_stopped']=true;$._spritely.instances[el_id]['_stopped_f1']=bool;if($._spritely.instances[el_id]['type']=='sprite'){$(this).spSet('fps',0);}
if(bool){var bp_top=$._spritely.getBgY($(this));$(this).css('background-position','0 '+bp_top);}});return this;},spStart:function(){$(this).each(function(){var el_id=$(this).attr('id');var fps=$._spritely.instances[el_id]['_last_fps']||12;$._spritely.instances[el_id]['_stopped']=false;if($._spritely.instances[el_id]['type']=='sprite'){$(this).spSet('fps',fps);}});return this;},spToggle:function(){var el_id=$(this).attr('id');var stopped=$._spritely.instances[el_id]['_stopped']||false;var stopped_f1=$._spritely.instances[el_id]['_stopped_f1']||false;if(stopped){$(this).spStart();}else{$(this).spStop(stopped_f1);}
return this;},fps:function(fps){$(this).each(function(){$(this).spSet('fps',fps);});return this;},goToFrame:function(n){var el_id=$(this).attr('id');if($._spritely.instances&&$._spritely.instances[el_id]){$._spritely.instances[el_id]['current_frame']=n-1;}
return this;},spSpeed:function(speed){$(this).each(function(){$(this).spSet('speed',speed);});return this;},spRelSpeed:function(speed){$(this).each(function(){var rel_depth=$(this).spGet('depth')/100;$(this).spSet('speed',speed*rel_depth);});return this;},spChangeDir:function(dir){$(this).each(function(){$(this).spSet('dir',dir);});return this;},spState:function(n){$(this).each(function(){var yPos=((n-1)*$(this).height())+'px';var xPos=$._spritely.getBgX($(this));var bp=xPos+' -'+yPos;$(this).css('background-position',bp);});return this;},lockTo:function(el,options){$(this).each(function(){var el_id=$(this).attr('id');if(!$._spritely.instances[el_id]){return this;}
$._spritely.instances[el_id]['locked_el']=$(this);$._spritely.instances[el_id]['lock_to']=$(el);$._spritely.instances[el_id]['lock_to_options']=options;$._spritely.instances[el_id]['interval']=window.setInterval(function(){if($._spritely.instances[el_id]['lock_to']){var locked_el=$._spritely.instances[el_id]['locked_el'];var locked_to_el=$._spritely.instances[el_id]['lock_to'];var locked_to_options=$._spritely.instances[el_id]['lock_to_options'];var locked_to_el_w=locked_to_options.bg_img_width;var locked_to_el_h=locked_to_el.height();var locked_to_el_y=$._spritely.getBgY(locked_to_el);var locked_to_el_x=$._spritely.getBgX(locked_to_el);var el_l=(parseInt(locked_to_el_x)+parseInt(locked_to_options['left']));var el_t=(parseInt(locked_to_el_y)+parseInt(locked_to_options['top']));el_l=$._spritely.get_rel_pos(el_l,locked_to_el_w);$(locked_el).css({'top':el_t+'px','left':el_l+'px'});}},options.interval||20);});return this;},destroy:function(){var el=$(this);var el_id=$(this).attr('id');if($._spritely.instances[el_id]&&$._spritely.instances[el_id]['timeout']){window.clearInterval($._spritely.instances[el_id]['timeout']);}
if($._spritely.instances[el_id]&&$._spritely.instances[el_id]['interval']){window.clearInterval($._spritely.instances[el_id]['interval']);}
delete $._spritely.instances[el_id]
return this;}})})(jQuery);try{document.execCommand("BackgroundImageCache",false,true);}catch(err){};jQuery.easing['jswing']=jQuery.easing['swing'];jQuery.extend(jQuery.easing,{def:'easeOutQuad',swing:function(x,t,b,c,d){return jQuery.easing[jQuery.easing.def](x,t,b,c,d);},easeInQuad:function(x,t,b,c,d){return c*(t/=d)*t+b;},easeOutQuad:function(x,t,b,c,d){return-c*(t/=d)*(t-2)+b;},easeInOutQuad:function(x,t,b,c,d){if((t/=d/2)<1)return c/2*t*t+b;return-c/2*((--t)*(t-2)-1)+b;},easeInCubic:function(x,t,b,c,d){return c*(t/=d)*t*t+b;},easeOutCubic:function(x,t,b,c,d){return c*((t=t/d-1)*t*t+1)+b;},easeInOutCubic:function(x,t,b,c,d){if((t/=d/2)<1)return c/2*t*t*t+b;return c/2*((t-=2)*t*t+2)+b;},easeInQuart:function(x,t,b,c,d){return c*(t/=d)*t*t*t+b;},easeOutQuart:function(x,t,b,c,d){return-c*((t=t/d-1)*t*t*t-1)+b;},easeInOutQuart:function(x,t,b,c,d){if((t/=d/2)<1)return c/2*t*t*t*t+b;return-c/2*((t-=2)*t*t*t-2)+b;},easeInQuint:function(x,t,b,c,d){return c*(t/=d)*t*t*t*t+b;},easeOutQuint:function(x,t,b,c,d){return c*((t=t/d-1)*t*t*t*t+1)+b;},easeInOutQuint:function(x,t,b,c,d){if((t/=d/2)<1)return c/2*t*t*t*t*t+b;return c/2*((t-=2)*t*t*t*t+2)+b;},easeInSine:function(x,t,b,c,d){return-c*Math.cos(t/d*(Math.PI/2))+c+b;},easeOutSine:function(x,t,b,c,d){return c*Math.sin(t/d*(Math.PI/2))+b;},easeInOutSine:function(x,t,b,c,d){return-c/2*(Math.cos(Math.PI*t/d)-1)+b;},easeInExpo:function(x,t,b,c,d){return(t==0)?b:c*Math.pow(2,10*(t/d-1))+b;},easeOutExpo:function(x,t,b,c,d){return(t==d)?b+c:c*(-Math.pow(2,-10*t/d)+1)+b;},easeInOutExpo:function(x,t,b,c,d){if(t==0)return b;if(t==d)return b+c;if((t/=d/2)<1)return c/2*Math.pow(2,10*(t-1))+b;return c/2*(-Math.pow(2,-10*--t)+2)+b;},easeInCirc:function(x,t,b,c,d){return-c*(Math.sqrt(1-(t/=d)*t)-1)+b;},easeOutCirc:function(x,t,b,c,d){return c*Math.sqrt(1-(t=t/d-1)*t)+b;},easeInOutCirc:function(x,t,b,c,d){if((t/=d/2)<1)return-c/2*(Math.sqrt(1-t*t)-1)+b;return c/2*(Math.sqrt(1-(t-=2)*t)+1)+b;},easeInElastic:function(x,t,b,c,d){var s=1.70158;var p=0;var a=c;if(t==0)return b;if((t/=d)==1)return b+c;if(!p)p=d*.3;if(a<Math.abs(c)){a=c;var s=p/4;}else var s=p/(2*Math.PI)*Math.asin(c/a);return-(a*Math.pow(2,10*(t-=1))*Math.sin((t*d-s)*(2*Math.PI)/p))+b;},easeOutElastic:function(x,t,b,c,d){var s=1.70158;var p=0;var a=c;if(t==0)return b;if((t/=d)==1)return b+c;if(!p)p=d*.3;if(a<Math.abs(c)){a=c;var s=p/4;}else var s=p/(2*Math.PI)*Math.asin(c/a);return a*Math.pow(2,-10*t)*Math.sin((t*d-s)*(2*Math.PI)/p)+c+b;},easeInOutElastic:function(x,t,b,c,d){var s=1.70158;var p=0;var a=c;if(t==0)return b;if((t/=d/2)==2)return b+c;if(!p)p=d*(.3*1.5);if(a<Math.abs(c)){a=c;var s=p/4;}else var s=p/(2*Math.PI)*Math.asin(c/a);if(t<1)return-.5*(a*Math.pow(2,10*(t-=1))*Math.sin((t*d-s)*(2*Math.PI)/p))+b;return a*Math.pow(2,-10*(t-=1))*Math.sin((t*d-s)*(2*Math.PI)/p)*.5+c+b;},easeInBack:function(x,t,b,c,d,s){if(s==undefined)s=1.70158;return c*(t/=d)*t*((s+1)*t-s)+b;},easeOutBack:function(x,t,b,c,d,s){if(s==undefined)s=1.70158;return c*((t=t/d-1)*t*((s+1)*t+s)+1)+b;},easeInOutBack:function(x,t,b,c,d,s){if(s==undefined)s=1.70158;if((t/=d/2)<1)return c/2*(t*t*(((s*=(1.525))+1)*t-s))+b;return c/2*((t-=2)*t*(((s*=(1.525))+1)*t+s)+2)+b;},easeInBounce:function(x,t,b,c,d){return c-jQuery.easing.easeOutBounce(x,d-t,0,c,d)+b;},easeOutBounce:function(x,t,b,c,d){if((t/=d)<(1/2.75)){return c*(7.5625*t*t)+b;}else if(t<(2/2.75)){return c*(7.5625*(t-=(1.5/2.75))*t+.75)+b;}else if(t<(2.5/2.75)){return c*(7.5625*(t-=(2.25/2.75))*t+.9375)+b;}else{return c*(7.5625*(t-=(2.625/2.75))*t+.984375)+b;}},easeInOutBounce:function(x,t,b,c,d){if(t<d/2)return jQuery.easing.easeInBounce(x,t*2,0,c,d)*.5+b;return jQuery.easing.easeOutBounce(x,t*2-d,0,c,d)*.5+c*.5+b;}});;(function(){var initializing=false,fnTest=/xyz/.test(function(){xyz;})?/\b_super\b/:/.*/;this.Class=function(){};Class.extend=function(prop){var _super=this.prototype;initializing=true;var prototype=new this();initializing=false;for(var name in prop){prototype[name]=typeof prop[name]=="function"&&typeof _super[name]=="function"&&fnTest.test(prop[name])?(function(name,fn){return function(){var tmp=this._super;this._super=_super[name];var ret=fn.apply(this,arguments);this._super=tmp;return ret;};})(name,prop[name]):prop[name];}
function Class(){if(!initializing&&this.init)
this.init.apply(this,arguments);}
Class.prototype=prototype;Class.prototype.constructor=Class;Class.extend=arguments.callee;return Class;};})();;function trackClient(appkeys){if(!appkeys){return false;}
var url="http://bi.redatoms.com/logger/log";var info={};var timeoutTimer=null;this.trackEvent=function(){if(arguments.length<5)return false;var _cs="";var async=false;var tm=0;for(var i=0,l=5;i<l;i++){var val=arguments[i]==null?'':arguments[i].toString();al=val.replace(':','_');_cs+=_cs==""?"":":";_cs+=val;}
if(arguments.length>5)async=arguments[5];if(arguments.length>6)tm=arguments[6];this.sendData("_cs="+_cs,async,tm);};this.setChannel=function(channel){info.channel=channel;};this.setVersion=function(version){info.bv=version;};this.setRuid=function(ruid){setuid(ruid);};this.onEvent=function(obj,action,remark,async,tm){this.trackEvent(' ',obj,action,1,remark,async,tm);};this.onBuy=function(obj,cnt,remark,async,tm){this.trackEvent('_bi_',obj,'buy',cnt,remark,async,tm);};this.onSell=function(obj,cnt,remark,async,tm){this.trackEvent('_bi_',obj,'sell',cnt,remark,async,tm);};this.sendData=function(extdata,async,tm){addidx();var datastr="";for(var key in info){datastr+="&"+key+"="+info[key];}
if(extdata){datastr+="&"+extdata;}
ajaxget(url,datastr,async,tm);};var navig=window.navigator;var uuid=getCookie('msc_uuid');var sid=getCookie('msc_sid');if(uuid==null){var nowt=(new Date()).getTime();var ttl=new Date(nowt+2*365*24*3600*1000);uuid=nowt+""+Math.round(Math.random()*10000);setCookie('msc_uuid',uuid,ttl,'/');}
if(sid==null){var nowt=(new Date()).getTime();sid=nowt+""+Math.round(Math.random()*10000);setCookie('msc_sid',sid);}
info={uuid:uuid,appkey:appkeys,channel:'html',sa:navig.systemLanguage||navig.language,sl:navig.userLanguage||navig.language,imei:uuid,sid:sid};info.sr=window.screen.width+"x"+window.screen.height;info.sdkt='html';info.sdkv='1.1';info.bf=document.referrer;info.bp=window.location.href;var str_ua=navig.userAgent.toLowerCase();var expp=/(msie|firefox|opera|chrome|netscape|safari|ucweb|360se|metasr)/;expp.test(str_ua);info.appname=RegExp.$1;var str_p=navig.platform.toLowerCase();var os='';if(str_p.indexOf('linux')>-1){os="Linux";}else if(str_p.indexOf('mac')>-1){os="Mac";}else if(str_p.indexOf('x11')>-1){os="Unix";}else if(str_p.indexOf('win')>-1){if(str_ua.indexOf("windows nt 5.0")>-1||str_ua.indexOf("windows 2000")>-1){os="Windows2000";}
if(str_ua.indexOf("windows nt 5.1")>-1||str_ua.indexOf("windows xp")>-1){os="WindowsXP";}
if(str_ua.indexOf("windows nt 5.2")>-1||str_ua.indexOf("windows 2003")>-1){os="Windows2003";}
if(str_ua.indexOf("windows nt 6.0")>-1||str_ua.indexOf("windows vista")>-1){os="WindowsVista";}
if(str_ua.indexOf("windows nt 6.1")>-1||str_ua.indexOf("windows 7")>-1){os="Windows7";}}else if(str_ua.indexOf('iphone os')>-1){os="ios";}else if(str_ua.indexOf('android')>-1){os="Android";}else if(str_ua.indexOf('windows ce')>-1){os="Windows ce";}else if(str_ua.indexOf('ipad')>-1){os="ipad";}else if(str_ua.indexOf('windows mobile')>-1){os="Windows Mobile";}
info.sos=os;function addidx(){var sno=getCookie('msc_sno');var ruid=getCookie('msc_uid');if(sno==null){sno=0;}
setCookie('msc_sno',++sno);info.sh=sno+"."+sid+".0.0";if(ruid!=null){info.ruid=ruid;}}
function setuid(id){var uid=getCookie('msc_uid');if(uid==null){uid=id;}else{if(uid!=id){var nowt=(new Date()).getTime();sid=nowt+""+Math.round(Math.random()*10000);info.sid=sid;setCookie('msc_sid',sid);setCookie('msc_sno',0);}}
setCookie('msc_uid',id);}
function getCookie(key){var tmp=document.cookie.match((new RegExp(key+'=[a-zA-Z0-9.()=|%/]+($|;)','g')));if(!tmp||!tmp[0])return null;else return unescape(tmp[0].substring(key.length+1,tmp[0].length).replace(';',''))||null;}
function setCookie(name,value){var argv=arguments;var argc=argv.length;var expires=(argc>2)?argv[2]:null;var path=(argc>3)?argv[3]:null;var domain=(argc>4)?argv[4]:null;var secure=(argc>5)?argv[5]:false;document.cookie=name+"="+escape(value)+
((expires==null)?"":("; expires="+expires.toUTCString()))+
((path==null)?"":("; path="+path))+
((domain==null)?"":("; domain="+domain))+
((secure==true)?"; secure":"");}
function ajaxget(geturl,extdata,async,tm){try{var xmlhttp=null;if(extdata){geturl+="?"+extdata;}
if(window.XMLHttpRequest){xmlhttp=new XMLHttpRequest();}else if(window.ActiveXObject){xmlhttp=new ActiveXObject("Microsoft.XMLHTTP");}else{alert('');return false;}
if(async&&tm&&tm>0){timeoutTimer=window.setTimeout(function(){xmlhttp.abort();},tm);}
if(async){xmlhttp.open('get',encodeURI(encodeURI(geturl)),true);}else{xmlhttp.open('get',encodeURI(encodeURI(geturl)),false);}
xmlhttp.onreadystatechange=function(x,y){if(timeoutTimer){clearTimeout(timeoutTimer);}
if(!async){xmlhttp.abort();}};xmlhttp.setRequestHeader("Content-Type","application/x-www-form-urlencoded; charset=utf-8");xmlhttp.send(null);}catch(e){}}};(function(w,$,undefined){w.Mojo=w.Mojo||{};w.Mojo.Object=Class.extend({getR:function(k){var device=Mojo.gap.device||"";return w.Mojo.ui.R(device,this.clsname(),k);},getL:function(k1,k2,k3){return Mojo.utils.locale(k1,k2,k3);},init:function(id,options){this._id=id;this._options=this._getDefaultOptions();$.extend(true,this._options,options||{});if(this._id==undefined||this._id==null){this._element=$('<div></div>');}else{this._element=$('<div id="'+this._id+'"></div>');}
this._children=[];this._parent=null;var self=this;if(this._options.classes!=undefined){$.each(this._options.classes,function(i,c){self.element().addClass(c);})}
if(this._options.deviceaware){self.element().addClass(Mojo.gap.device);}},_getDefaultOptions:function(){return{classes:[],deviceaware:true};},id:function(){return this._id;},element:function(){return this._element;},data:function(key,value){if(value==undefined){return this.element().data(key);}
this.element().data(key,value);},show:function(){this.element().show();},hide:function(){this.element().hide();},clsname:function(){return"Object";},localeCat:function(){return"";},locale:function(key,params){return Mojo.utils.locale(this.localeCat(),key,params);},rebinding:function(){this.element().unbind('touchend');this.element().bind('touchend',function(){});},resize:function(size){if(size==undefined){return;}
if(size.width!=undefined){this.element().width(size.width);}
if(size.height!=undefined){this.element().height(size.height);}
this._onResize(size);},_onResize:function(size){}});w.Mojo.supportTouch=function(){if(w.Mojo._supportTouch==undefined){w.Mojo._supportTouch='ontouchstart'in w;}
return w.Mojo._supportTouch;};if(!w.console){w.console={};w.console.log=function(){return;};}})(window,jQuery);;(function(w,$){w.Mojo=w.Mojo||{};w.Mojo.ui=w.Mojo.ui||{};w.Mojo.ui.R=function(d,c,k){if(w.Mojo.ui.Resource[d]){if(w.Mojo.ui.Resource[d][c]){var t=w.Mojo.ui.Resource[d][c][k]
return t;}}}
w.Mojo.ui.Resource={'ipad':{'com.BaseSlotList':{'unitWidth':140},'com.Collection':{'offsets':[{x:198,y:-54},{x:0,y:75},{x:400,y:75},{x:0,y:290},{x:400,y:290},{x:198,y:425},]},'com.CollectList':{'unitWidth':140},'com.EntityElement':{'unitWidth':22},'com.FbTaskList':{'unitWidth':157},'com.IllustrationList':{'unitWidth':157,'height':742,'pageSize':30},'com.IllustrationPanel':{'pageSize':20},'com.GiftCard':{'playsize':160},'com.MapElement':{'left':1.1,'top':1.4},'com.Marquee':{"width":600,"height":100},'com.TaskList':{'unitWidth':155,},'page.Intensify':{'viewHeight':60},'com.Slot':{'imgHeight':'480','spriteHeight':'120','background-position':'0 -5px','range':'','bgPos':'','targetPos':''},'com.Tutorial':{"home_left":64,"mission_left":192,"rob_left":320,"battle_left":448,"friend_left":576,"mall_left":704,"arrowwidth":104,"arrowheight":150},'com.CardElement':{'unitWidth':22},'page.Server':{"height1":43,"height2":220,"margin-top":"100px"},'com.BattleDetailDialog':{"height":450},'com.FbBattleDetailDialog':{"height":450},'com.RankPlayerPage':{'unitWidth':97},'page.Home':{'unitWidth':128},'com.ActivityCenterList':{'unitWidth':157,'height':742,'pageSize':30},'com.BarrackPackage':{'unitWidth':140},},'iphone':{'com.BaseSlotList':{'unitWidth':62},'com.Collection':{'treasurePos':{x:115,y:159},'offsets':[{x:102,y:-23},{x:0,y:35},{x:200,y:35},{x:0,y:145},{x:200,y:145},{x:102,y:200},]},'com.CollectList':{'unitWidth':62},'com.EntityElement':{'unitWidth':15},'com.FbTaskList':{'unitWidth':97},'com.IllustrationList':{'unitWidth':102,'height':345,'pageSize':25},'com.IllustrationPanel':{'pageSize':36},'com.GiftCard':{'playsize':80},'com.MapElement':{'left':1,'top':1},'com.Marquee':{"width":320,"height":60},'com.TaskList':{'unitWidth':97,},'page.Intensify':{'viewHeight':46},'com.Slot':{'imgHeight':240,'spriteHeight':60,'background-position':'5px -7px','range':'','bgPos':'','targetPos':''},'com.Tutorial':{"home_left":26.5,"mission_left":79.5,"rob_left":132.5,"battle_left":185.5,"friend_left":238.5,"mall_left":291.5,"arrowwidth":52,"arrowheight":75},'com.CardElement':{'unitWidth':15},'page.Server':{"height1":43,"height2":220,"margin-top":"100px"},'com.BattleDetailDialog':{"height":200},'com.FbBattleDetailDialog':{"height":200},'com.RankPlayerPage':{'unitWidth':97},'page.Home':{'unitWidth':53},'com.ActivityCenterList':{'unitWidth':102,'height':345,'pageSize':25},'com.BarrackPackage':{'unitWidth':62},}}})(window,jQuery);;(function(w,jQuery,undefined){w.Mojo=w.Mojo||{};w.Mojo.ui=w.Mojo.ui||{};w.Mojo.ui.Button=Mojo.Object.extend({init:function(id,options){this._super(id,options);var self=this;this.element().addClass('mojo-ui-button');if(self._options.special!=null){self.element().addClass(self._options.special);}
if(this._options.icon){this.element().append('<div class="icon"></div>');}
if(this._options.textWrap){this.element().append('<div class="text">'+this._options.text+'</div>');}else{this.element().append(this._options.text);}
var onTouchStart=function(e){if(!self._options.disabled){self.element().addClass('mojo-ui-button-down');if(self._options.special!=null){self.element().addClass(self._options.special+'-down');}
if(self._options.sound==undefined||self._options.sound==null){Mojo.gap.soundPlay('12_action_do');}else{Mojo.gap.soundPlay(self._options.sound);}}};var onTouchMove=function(e){if(!self._options.disabled){self.element().removeClass('mojo-ui-button-down');if(self._options.special!=null){self.element().removeClass(self._options.special+'-down');}}};var onTouchEnd=function(e){if(!self._options.disabled){self.element().removeClass('mojo-ui-button-down');if(self._options.special!=null){self.element().removeClass(self._options.special+'-down');}}};if(Mojo.supportTouch()){this.element().bind('touchstart',onTouchStart);this.element().bind('touchmove',onTouchMove);this.element().bind('touchend',onTouchEnd);}else{this.element().bind('mousedown',onTouchStart);this.element().bind('mousemove',onTouchMove);this.element().bind('mouseup',onTouchEnd);}
this._bindClick();this.disable(this._options.disabled);},_bindClick:function(){var self=this;this.element().unbind('click');this.element().click(function(e){if(self._options.disabled){self._options.disableClick(self,e);}else{self._options.click(self,e);}});},_getDefaultOptions:function(){return{text:'Button',click:$.noop,disableClick:$.noop,disabled:false,icon:false,textWrap:false,sound:null,special:null,};},disable:function(value){this._options.disabled=value;this._element[value?'addClass':'removeClass']('mojo-ui-button-disabled');if(this._options.special!=null){this._element[value?'addClass':'removeClass'](this._options.special+'-disabled');}},text:function(text){if(text==undefined){return this._options.text;}
this._options.text=text;if(this._options.textWrap){this.element().find(".text").html(text);}else{this.element().html(text);}},click:function(func){var self=this;this._options.click=func;this._bindClick();},setFlag:function(flag){if(flag!=undefined&&flag!=null){var flagHtml="";var flagClasses=null;if(typeof(flag)=="string"){flagHtml=flag}else if(typeof(flag)=="object"){flagHtml=flag.text;flagClasses=flag.classes;}
$('<div class="flag"></div>').addClass(flag.classes.join(" ")).html(flagHtml).appendTo(this.element());}},clsname:function(){return"ui.Button";}});})(window,jQuery);;(function(w,jQuery,undefined){w.Mojo=w.Mojo||{};w.Mojo.ui=w.Mojo.ui||{};w.Mojo.ui.Label=Mojo.Object.extend({init:function(id,options){this._super(id,options);var self=this;this.element().addClass('mojo-ui-label');this.element().append('<div class="icon"></div><div class="text"><span>'+this._options.text+'</span></div>');},_getDefaultOptions:function(){return{text:'Label',};},text:function(text){if(text==undefined){return this._options.text;}
this._options.text=text;this.element().find('.text > span').html(text);},clsname:function(){return"ui.Label";}});})(window,jQuery);;(function(w,jQuery,undefined){w.Mojo=w.Mojo||{};w.Mojo.ui=w.Mojo.ui||{};w.Mojo.ui.Progress=Mojo.Object.extend({init:function(id,options){this._super(id,options);var self=this;this.element().addClass('mojo-ui-progress');this.element().append('<div class="icon"></div><div class="bar"><span></span></div>');this._refresh();},_getDefaultOptions:function(){return{max:100,min:0,value:0,labelTemplate:'#{percent}',};},_percentage:function(){var p=Math.round(100*this._options.value/(this._options.max-this._options.min));if(p>100){p=100;}
if(p<0){p=0;}
return p;},_refresh:function(){var per=this._percentage()+"%";var div=this._options.value+"/"+(this._options.max-this._options.min);this.element().find('.bar').css('width',per);var l=this._options.labelTemplate.replace(/#\{percent\}/g,per).replace(/#\{divide\}/g,div);this.element().find('.bar > span').html(l);},value:function(value){if(value==undefined){return this._options.value;}
if(typeof(value)=='object'){$.extend(true,this._options,value);}else{this._options.value=value;}
this._refresh();},clsname:function(){return"ui.Progress";}});})(window,jQuery);;(function(w,jQuery,undefined){w.Mojo=w.Mojo||{};w.Mojo.ui=w.Mojo.ui||{};w.Mojo.ui.Radio=Mojo.Object.extend({init:function(id,options){this._super(id,options);var self=this;this.element().addClass('mojo-ui-radio');this.element().append('<ul></ul>');$.each(this._options.options,function(i,it){var opt=$('<li>'+it+'</li>');self.element().find('ul').append(opt);opt.click(function(){self._optClick($(this).index());});});this._refresh();},_getDefaultOptions:function(){return{options:[],selected:0,selectionChange:$.noop,disableClick:$.noop,};},_refresh:function(){this.element().find('li').removeClass('mojo-ui-radio-selected').eq(this._options.selected).addClass('mojo-ui-radio-selected');},_optClick:function(index){var self=this;if(self.disable(index)){self._options.disableClick(index);return;}
if(self._options.selected!=index){self._options.selected=index;self._refresh();self._options.selectionChange(index);}},addOption:function(it){var self=this;if(it!=undefined&&it!=null){this._options.options.push(it);var opt=$('<li>'+it+'</li>');self.element().find('ul').append(opt);opt.click(function(){self._optClick($(this).index());});}},remove:function(index){this.element().find('ul > li').eq(index).remove();},removeAll:function(){this.element().find('ul').empty();},selection:function(index){if(index==undefined){return this._options.selected;}
this._options.selected=index;this._refresh();},disable:function(index,value){if(value==undefined){return this.element().find('li').eq(index).hasClass('mojo-ui-radio-disabled');}
this.element().find('li').eq(index)[value?'addClass':'removeClass']('mojo-ui-radio-disabled');},clsname:function(){return"ui.Radio";}});})(window,jQuery);;/*!
  iScroll Lite base on iScroll v4.1.6 ~ Copyright (c) 2011 Matteo Spinelli, http://cubiq.org
  Released under MIT license, http://cubiq.org/license
 */(function(){var m=Math,mround=function(r){return r>>0;},vendor=(/webkit/i).test(navigator.appVersion)?'webkit':(/firefox/i).test(navigator.userAgent)?'Moz':'opera'in window?'O':'',isAndroid=(/android/gi).test(navigator.appVersion),isIDevice=(/iphone|ipad/gi).test(navigator.appVersion),isPlaybook=(/playbook/gi).test(navigator.appVersion),isTouchPad=(/hp-tablet/gi).test(navigator.appVersion),has3d='WebKitCSSMatrix'in window&&'m11'in new WebKitCSSMatrix(),hasTouch='ontouchstart'in window&&!isTouchPad,hasTransform=vendor+'Transform'in document.documentElement.style,hasTransitionEnd=isIDevice||isPlaybook,nextFrame=(function(){return window.requestAnimationFrame||window.webkitRequestAnimationFrame||window.mozRequestAnimationFrame||window.oRequestAnimationFrame||window.msRequestAnimationFrame||function(callback){return setTimeout(callback,17);}})(),cancelFrame=(function(){return window.cancelRequestAnimationFrame||window.webkitCancelAnimationFrame||window.webkitCancelRequestAnimationFrame||window.mozCancelRequestAnimationFrame||window.oCancelRequestAnimationFrame||window.msCancelRequestAnimationFrame||clearTimeout})(),RESIZE_EV='onorientationchange'in window?'orientationchange':'resize',START_EV=hasTouch?'touchstart':'mousedown',MOVE_EV=hasTouch?'touchmove':'mousemove',END_EV=hasTouch?'touchend':'mouseup',CANCEL_EV=hasTouch?'touchcancel':'mouseup',trnOpen='translate'+(has3d?'3d(':'('),trnClose=has3d?',0)':')',iScroll=function(el,options){var that=this,doc=document,i;that.wrapper=el.get(0);that.wrapper.style.overflow='hidden';that.scroller=that.wrapper.children[0];that.options={hScroll:true,vScroll:true,x:0,y:0,bounce:true,bounceLock:false,momentum:true,lockDirection:true,useTransform:false,useTransition:false,onRefresh:null,onBeforeScrollStart:function(e){e.preventDefault();},onScrollStart:null,onBeforeScrollMove:null,onScrollMove:null,onBeforeScrollEnd:null,onScrollEnd:null,onTouchEnd:null,onDestroy:null};for(i in options)that.options[i]=options[i];that.x=that.options.x;that.y=that.options.y;that.options.useTransform=hasTransform?that.options.useTransform:false;that.options.hScrollbar=that.options.hScroll&&that.options.hScrollbar;that.options.vScrollbar=that.options.vScroll&&that.options.vScrollbar;that.options.useTransition=hasTransitionEnd&&that.options.useTransition;that.scroller.style[vendor+'TransitionProperty']=that.options.useTransform?'-'+vendor.toLowerCase()+'-transform':'top left';that.scroller.style[vendor+'TransitionDuration']='0';that.scroller.style[vendor+'TransformOrigin']='0 0';if(that.options.useTransition)that.scroller.style[vendor+'TransitionTimingFunction']='cubic-bezier(0.33,0.66,0.66,1)';if(that.options.useTransform)that.scroller.style[vendor+'Transform']=trnOpen+that.x+'px,'+that.y+'px'+trnClose;else that.scroller.style.cssText+=';position:absolute;top:'+that.y+'px;left:'+that.x+'px';that.refresh();that._bind(RESIZE_EV,window);that._bind(START_EV);if(!hasTouch)that._bind('mouseout',that.wrapper);};iScroll.prototype={enabled:true,x:0,y:0,steps:[],scale:1,handleEvent:function(e){var that=this;switch(e.type){case START_EV:if(!hasTouch&&e.button!==0)return;that._start(e);break;case MOVE_EV:that._move(e);break;case END_EV:case CANCEL_EV:that._end(e);break;case RESIZE_EV:that._resize();break;case'mouseout':that._mouseout(e);break;case'webkitTransitionEnd':that._transitionEnd(e);break;}},_resize:function(){this.refresh();},_pos:function(x,y){x=this.hScroll?x:0;y=this.vScroll?y:0;if(this.options.useTransform){this.scroller.style[vendor+'Transform']=trnOpen+x+'px,'+y+'px'+trnClose+' scale('+this.scale+')';}else{x=mround(x);y=mround(y);this.scroller.style.left=x+'px';this.scroller.style.top=y+'px';}
this.x=x;this.y=y;},_start:function(e){var that=this,point=hasTouch?e.touches[0]:e,matrix,x,y;if(!that.enabled)return;if(that.options.onBeforeScrollStart)that.options.onBeforeScrollStart.call(that,e);if(that.options.useTransition)that._transitionTime(0);that.moved=false;that.animating=false;that.zoomed=false;that.distX=0;that.distY=0;that.absDistX=0;that.absDistY=0;that.dirX=0;that.dirY=0;if(that.options.momentum){if(that.options.useTransform){matrix=getComputedStyle(that.scroller,null)[vendor+'Transform'].replace(/[^0-9-.,]/g,'').split(',');x=matrix[4]*1;y=matrix[5]*1;}else{x=getComputedStyle(that.scroller,null).left.replace(/[^0-9-]/g,'')*1;y=getComputedStyle(that.scroller,null).top.replace(/[^0-9-]/g,'')*1;}
if(x!=that.x||y!=that.y){if(that.options.useTransition)that._unbind('webkitTransitionEnd');else cancelFrame(that.aniTime);that.steps=[];that._pos(x,y);}}
that.startX=that.x;that.startY=that.y;that.pointX=point.pageX;that.pointY=point.pageY;that.startTime=e.timeStamp||Date.now();if(that.options.onScrollStart)that.options.onScrollStart.call(that,e);that._bind(MOVE_EV);that._bind(END_EV);that._bind(CANCEL_EV);},_move:function(e){var that=this,point=hasTouch?e.touches[0]:e,deltaX=point.pageX-that.pointX,deltaY=point.pageY-that.pointY,newX=that.x+deltaX,newY=that.y+deltaY,timestamp=e.timeStamp||Date.now();if(that.options.onBeforeScrollMove)that.options.onBeforeScrollMove.call(that,e);that.pointX=point.pageX;that.pointY=point.pageY;if(newX>0||newX<that.maxScrollX){newX=that.options.bounce?that.x+(deltaX/2):newX>=0||that.maxScrollX>=0?0:that.maxScrollX;}
if(newY>0||newY<that.maxScrollY){newY=that.options.bounce?that.y+(deltaY/2):newY>=0||that.maxScrollY>=0?0:that.maxScrollY;}
that.distX+=deltaX;that.distY+=deltaY;that.absDistX=m.abs(that.distX);that.absDistY=m.abs(that.distY);if(that.absDistX<6&&that.absDistY<6){return;}
if(that.options.lockDirection){if(that.absDistX>that.absDistY+5){newY=that.y;deltaY=0;}else if(that.absDistY>that.absDistX+5){newX=that.x;deltaX=0;}}
that.moved=true;that._pos(newX,newY);that.dirX=deltaX>0?-1:deltaX<0?1:0;that.dirY=deltaY>0?-1:deltaY<0?1:0;if(timestamp-that.startTime>300){that.startTime=timestamp;that.startX=that.x;that.startY=that.y;}
if(that.options.onScrollMove)that.options.onScrollMove.call(that,e);},_end:function(e){if(hasTouch&&e.touches.length!=0)return;var that=this,point=hasTouch?e.changedTouches[0]:e,target,ev,momentumX={dist:0,time:0},momentumY={dist:0,time:0},duration=(e.timeStamp||Date.now())-that.startTime,newPosX=that.x,newPosY=that.y,newDuration;that._unbind(MOVE_EV);that._unbind(END_EV);that._unbind(CANCEL_EV);if(that.options.onBeforeScrollEnd)that.options.onBeforeScrollEnd.call(that,e);if(!that.moved){if(hasTouch){target=point.target;while(target.nodeType!=1)target=target.parentNode;if(target.tagName!='SELECT'&&target.tagName!='INPUT'&&target.tagName!='TEXTAREA'){ev=document.createEvent('MouseEvents');ev.initMouseEvent('click',true,true,e.view,1,point.screenX,point.screenY,point.clientX,point.clientY,e.ctrlKey,e.altKey,e.shiftKey,e.metaKey,0,null);ev._fake=true;target.dispatchEvent(ev);}}
that._resetPos(200);if(that.options.onTouchEnd)that.options.onTouchEnd.call(that,e);return;}
if(duration<300&&that.options.momentum){momentumX=newPosX?that._momentum(newPosX-that.startX,duration,-that.x,that.scrollerW-that.wrapperW+that.x,that.options.bounce?that.wrapperW:0):momentumX;momentumY=newPosY?that._momentum(newPosY-that.startY,duration,-that.y,(that.maxScrollY<0?that.scrollerH-that.wrapperH+that.y:0),that.options.bounce?that.wrapperH:0):momentumY;newPosX=that.x+momentumX.dist;newPosY=that.y+momentumY.dist;if((that.x>0&&newPosX>0)||(that.x<that.maxScrollX&&newPosX<that.maxScrollX))momentumX={dist:0,time:0};if((that.y>0&&newPosY>0)||(that.y<that.maxScrollY&&newPosY<that.maxScrollY))momentumY={dist:0,time:0};}
if(momentumX.dist||momentumY.dist){newDuration=m.max(m.max(momentumX.time,momentumY.time),10);that.scrollTo(mround(newPosX),mround(newPosY),newDuration);if(that.options.onTouchEnd)that.options.onTouchEnd.call(that,e);return;}
that._resetPos(200);if(that.options.onTouchEnd)that.options.onTouchEnd.call(that,e);},_resetPos:function(time){var that=this,resetX=that.x>=0?0:that.x<that.maxScrollX?that.maxScrollX:that.x,resetY=that.y>=0||that.maxScrollY>0?0:that.y<that.maxScrollY?that.maxScrollY:that.y;if(resetX==that.x&&resetY==that.y){if(that.moved){if(that.options.onScrollEnd)that.options.onScrollEnd.call(that);that.moved=false;}
return;}
that.scrollTo(resetX,resetY,time||0);},_mouseout:function(e){var t=e.relatedTarget;if(!t){this._end(e);return;}
while(t=t.parentNode)
if(t==this.wrapper)return;this._end(e);},_transitionEnd:function(e){var that=this;if(e.target!=that.scroller)return;that._unbind('webkitTransitionEnd');that._startAni();},_startAni:function(){var that=this,startX=that.x,startY=that.y,startTime=Date.now(),step,easeOut,animate;if(that.animating)return;if(!that.steps.length){that._resetPos(400);return;}
step=that.steps.shift();if(step.x==startX&&step.y==startY)step.time=0;that.animating=true;that.moved=true;if(that.options.useTransition){that._transitionTime(step.time);that._pos(step.x,step.y);that.animating=false;if(step.time)that._bind('webkitTransitionEnd');else that._resetPos(0);return;}
animate=function(){var now=Date.now(),newX,newY;if(now>=startTime+step.time){that._pos(step.x,step.y);that.animating=false;if(that.options.onAnimationEnd)that.options.onAnimationEnd.call(that);that._startAni();return;}
now=(now-startTime)/step.time-1;easeOut=m.sqrt(1-now*now);newX=(step.x-startX)*easeOut+startX;newY=(step.y-startY)*easeOut+startY;that._pos(newX,newY);if(that.animating)that.aniTime=nextFrame(animate);};animate();},_transitionTime:function(time){this.scroller.style[vendor+'TransitionDuration']=time+'ms';},_momentum:function(dist,time,maxDistUpper,maxDistLower,size){var deceleration=0.0006,speed=m.abs(dist)/time,newDist=(speed*speed)/(2*deceleration),newTime=0,outsideDist=0;if(dist>0&&newDist>maxDistUpper){outsideDist=size/(6/(newDist/speed*deceleration));maxDistUpper=maxDistUpper+outsideDist;speed=speed*maxDistUpper/newDist;newDist=maxDistUpper;}else if(dist<0&&newDist>maxDistLower){outsideDist=size/(6/(newDist/speed*deceleration));maxDistLower=maxDistLower+outsideDist;speed=speed*maxDistLower/newDist;newDist=maxDistLower;}
newDist=newDist*(dist<0?-1:1);newTime=speed/deceleration;return{dist:newDist,time:mround(newTime)};},_offset:function(el){var left=-el.offsetLeft,top=-el.offsetTop;while(el=el.offsetParent){left-=el.offsetLeft;top-=el.offsetTop;}
return{left:left,top:top};},_bind:function(type,el,bubble){(el||this.scroller).addEventListener(type,this,!!bubble);},_unbind:function(type,el,bubble){(el||this.scroller).removeEventListener(type,this,!!bubble);},destroy:function(){var that=this;that.scroller.style[vendor+'Transform']='';that._unbind(RESIZE_EV,window);that._unbind(START_EV);that._unbind(MOVE_EV);that._unbind(END_EV);that._unbind(CANCEL_EV);that._unbind('mouseout',that.wrapper);if(that.options.useTransition)that._unbind('webkitTransitionEnd');if(that.options.onDestroy)that.options.onDestroy.call(that);},refresh:function(){var that=this,offset;that.wrapperW=that.wrapper.clientWidth;that.wrapperH=that.wrapper.clientHeight;that.scrollerW=that.scroller.offsetWidth;that.scrollerH=that.scroller.offsetHeight;that.maxScrollX=that.wrapperW-that.scrollerW;that.maxScrollY=that.wrapperH-that.scrollerH;that.dirX=0;that.dirY=0;that.hScroll=that.options.hScroll&&that.maxScrollX<0;that.vScroll=that.options.vScroll&&(!that.options.bounceLock&&!that.hScroll||that.scrollerH>that.wrapperH);offset=that._offset(that.wrapper);that.wrapperOffsetLeft=-offset.left;that.wrapperOffsetTop=-offset.top;that.scroller.style[vendor+'TransitionDuration']='0';that._resetPos(200);},scrollTo:function(x,y,time,relative){var that=this,step=x,i,l;that.stop();if(!step.length)step=[{x:x,y:y,time:time,relative:relative}];for(i=0,l=step.length;i<l;i++){if(step[i].relative){step[i].x=that.x-step[i].x;step[i].y=that.y-step[i].y;}
that.steps.push({x:step[i].x,y:step[i].y,time:step[i].time||0});}
that._startAni();},scrollToElement:function(el,time){var that=this,pos;el=el.nodeType?el:that.scroller.querySelector(el);if(!el)return;pos=that._offset(el);pos.left+=that.wrapperOffsetLeft;pos.top+=that.wrapperOffsetTop;pos.left=pos.left>0?0:pos.left<that.maxScrollX?that.maxScrollX:pos.left;pos.top=pos.top>0?0:pos.top<that.maxScrollY?that.maxScrollY:pos.top;time=time===undefined?m.max(m.abs(pos.left)*2,m.abs(pos.top)*2):time;that.scrollTo(pos.left,pos.top,time);},disable:function(){this.stop();this._resetPos(0);this.enabled=false;this._unbind(MOVE_EV);this._unbind(END_EV);this._unbind(CANCEL_EV);},enable:function(){this.enabled=true;},stop:function(){cancelFrame(this.aniTime);this.steps=[];this.moved=false;this.animating=false;}};if(typeof exports!=='undefined')exports.iScroll=iScroll;else window.iScroll=iScroll;})();;(function(w,jQuery,undefined){w.Mojo=w.Mojo||{};w.Mojo.ui=w.Mojo.ui||{};w.Mojo.ui.Scroll=Mojo.Object.extend({init:function(id,scroller,options){this._super(id,options);if(scroller instanceof Mojo.Object){this._scroller=scroller.element();}else{this._scroller=scroller;}
this._m=Math;var self=this;this.element().addClass('mojo-ui-scroll');this._window=$('<div class="window"></div>').appendTo(this.element());this._wrapper=$('<div class="wrapper"></div>').appendTo(this._window).append(this._scroller);this._scroller.addClass('scroller');this._control=new iScroll(this._window,{bounce:false,bounceLock:true,onScrollEnd:function(){self._refreshArrow();}});if(this._options.showArrow){this._bar=$('<div class="bar"></div>');this._arrowUp=new Mojo.ui.Button(undefined,{classes:['arrow-up'],text:this._options.arrowUpLabel,click:function(){if(self._options.direction==1){self.scrollByStep(-self._options.step,0);}else if(self._options.direction==2){self.scrollByStep(0,-self._options.step);}},});this._arrowDown=new Mojo.ui.Button(undefined,{classes:['arrow-down'],text:this._options.arrowDownLabel,click:function(){if(self._options.direction==1){self.scrollByStep(self._options.step,0);}else if(self._options.direction==2){self.scrollByStep(0,self._options.step);}},});this._bar.append(this._arrowUp.element()).append(this._arrowDown.element()).appendTo(this.element());}
this._initializeWrapperStyle();this._refreshArrow();},_stopTouchScoll:function(){},_refreshArrow:function(){if(this._options.showArrow){var pos=this._wrapper.position();if(this._options.direction==1){this._arrowUp.disable(pos.left>=0);this._arrowDown.disable(Math.abs(pos.left)>=this.scrollerWidth()-this.wrapperWidth());}else if(this._options.direction==2){this._arrowUp.disable(pos.top>=0);this._arrowDown.disable(pos.top<=this._wrapper.height()-this._scroller.height());}}},refresh:function(){this._refreshArrow();this._control.refresh();},_horizontalOutBounds:function(x){var self=this;return!(x<=0&&x>=(self._wrapper.width()-self._scroller.width()));},_verticalOutBounds:function(y){var self=this;return!(y<=0&&y>=(self._wrapper.height()-self._scroller.height()));},_initializeWrapperStyle:function(){if(this._options.direction==1){}else if(this._options.direction==2){this._wrapper.css({"width":"100%"});}else{}},_getDefaultOptions:function(){return{direction:0,outbounds:false,step:0,showTrack:false,showArrow:false,arrowUpLabel:'',arrowDownLabel:'',};},wrapperWidth:function(){return this._window.innerWidth();},wrapperHeight:function(){return this._window.innerHeight();},scrollerWidth:function(){return this._wrapper.outerWidth();},scrollerHeight:function(){return this._wrapper.outerHeight();},scrollerLeft:function(){return this._wrapper.position().left;},scrollerTop:function(){return this._wrapper.position().top;},initial:function(){this.refresh();},scroll:function(relativeX,relativeY){var maxScolleX=this.scrollerWidth()-this.wrapperWidth();var maxScolleY=this.scrollerHeight()-this.wrapperHeight();if(relativeX>maxScolleX){relativeX=maxScolleX}
if(relativeX<=0){relativeX=0;}
if(relativeY>maxScolleY){relativeY=maxScolleY}
if(relativeY<=0){relativeY=0;}
offsetX=relativeX+this.scrollerLeft();offsetY=relativeY+this.scrollerTop();this._control.scrollTo(offsetX,offsetY,500,true);this._refreshArrow();},scrollByStep:function(stepX,stepY){var left=Math.abs(this.scrollerLeft());var top=Math.abs(this.scrollerTop());relativeX=left+stepX;relativeY=top+stepY;this.scroll(relativeX,relativeY)},scrollTo:function(x,y){this.scroll(x,y);},clsname:function(){return"ui.Scroll";}});})(window,jQuery);;(function(w,jQuery,undefined){w.Mojo=w.Mojo||{};w.Mojo.ui=w.Mojo.ui||{};w.Mojo.ui.Overlay=Mojo.Object.extend({init:function(id,options){this._super(id,options);var self=this;this.element().addClass('mojo-ui-overlay');if(this._options.reusable){this.element().appendTo($(document.body));}else{}
this.element().bind((Mojo.supportTouch?'touchmove':'mousemove'),function(e){e.preventDefault();});},_getDefaultOptions:function(){return{zIndex:1000,opacity:0.8,reusable:false,};},show:function(){this.element().css({width:$(document).width()+'px',height:$(document).height()+'px',zIndex:this._options.zIndex,opacity:this._options.opacity,}).show();if(this._options.reusable){}else{this.element().appendTo($(document.body));}},hide:function(){if(this._options.reusable){this.element().hide();}else{this.element().remove();}},clsname:function(){return"ui.Overlay";}});})(window,jQuery);;(function(w,jQuery,undefined){w.Mojo=w.Mojo||{};w.Mojo.ui=w.Mojo.ui||{};w.Mojo.ui.Dialog=Mojo.Object.extend({init:function(id,options){this._super(id,options);this._nextDialog=undefined;var self=this;this.element().addClass('mojo-ui-dialog');if(this._options.noTitle==false){this.element().append(this._title=$('<div class="title"></div>'));if(this._options.canClose){this.element().append(new Mojo.ui.Button(undefined,{special:'button-close',text:'',click:function(){self.close();},}).element());}}
this.element().append(this._content=$('<div class="content"></div>')).append(this._footer=$('<div class="footer"></div>'));if(this._options.noTitle==false){if(this._options.title!=undefined&&this._options.title!=null){if(this._options.canClose){this.element().find('.title').append(this._options.title).click(function(){self.close();});}else{this.element().find('.title').append(this._options.title);}}}
if(this._options.content!=undefined&&this._options.content!=null){this.element().find('.content').append(this._options.content);}
if(this._options.reusable){this.element().appendTo($(document.body));this.rebinding();}else{}
this.element().bind((Mojo.supportTouch?'touchmove':'mousemove'),function(e){e.preventDefault();});},_getDefaultOptions:function(){return{title:'Dialog',content:null,close:$.noop,zIndex:1001,reusable:false,noTitle:false,noOverlay:false,canClose:true};},open:function(force){if(Mojo.app.dialog===undefined||force===true){if(force!=true){Mojo.app.dialog=this;}
if(this._options.noOverlay==false){this._overlayShow();}
this.element().show().css('z-index',this._options.zIndex+1);if(this._options.reusable){}else{this.element().appendTo($(document.body));this.rebinding();if(this._onDialogAppend){this._onDialogAppend();}}
Mojo.utils.center(this.element());}else{Mojo.app.dialog.openNext(this);}},openNext:function(dialog){if(this._nextDialog===undefined){this._nextDialog=dialog;}else{this._nextDialog.openNext(dialog);}},close:function(){this._options.close();if(this._options.reusable){this.element().hide();}else{this.element().remove();}
if(this._options.noOverlay==false){this._overlayHide();}
Mojo.app.dialog=undefined;if(this._nextDialog!=undefined&&this._nextDialog!=null){this._nextDialog.open();}},show:function(){this.element().show();if(this.overlay!==undefined){this.overlay.show();}},hide:function(){this.element().hide();if(this.overlay!==undefined){this.overlay.hide();}},_overlayShow:function(){if(this.overlay===undefined){this.overlay=new Mojo.ui.Overlay(undefined,{zIndex:this._options.zIndex,reusable:this._options.reusable,})}
this.overlay.show();},_overlayHide:function(){if(this.overlay!=undefined){this.overlay.hide();}},clsname:function(){return"ui.Dialog";}});})(window,jQuery);;(function(w,jQuery,undefined){w.Mojo=w.Mojo||{};w.Mojo.ui=w.Mojo.ui||{};w.Mojo.ui.Tabs=Mojo.Object.extend({init:function(id,options){this._super(id,options);var self=this;this.element().addClass('mojo-ui-tabs');this._nav=$('<div class="nav"><ul></ul></div>').appendTo(this.element());$.each(this._options.tabs,function(i,it){if(self._options.panels[i]==undefined){self._options.panels[i]=null;}
self._addTab(i,it);});this._refresh();this._enableStatus=[];},_getDefaultOptions:function(){return{tabs:[],panels:[],selected:-1,selectionChange:$.noop,};},_refresh:function(){this._nav.find('ul > li').removeClass('mojo-ui-tabs-selected').eq((this._options.selected<0?0:this._options.selected)).addClass('mojo-ui-tabs-selected');this.element().find('.panel').hide().eq((this._options.selected<0?0:this._options.selected)).show();},_select:function(index){if(index<0||index>=this._options.tabs.length||index==this._options.selected)return;this._options.selected=index;this._refresh();this._options.selectionChange(index);},_addTab:function(index,item,flag){var self=this;var li=$('<li>'+item+'</li>').appendTo(self._nav.find('ul')).click(function(){if(self._enableStatus[$(this).index()]){self._select($(this).index());}});self._enableStatus[index]=true;if(flag!=undefined&&flag!=null){var flagHtml="";var flagClasses=null;if(typeof(flag)=="string"){flagHtml=flag}else if(typeof(flag)=="object"){flagHtml=flag.text;flagClasses=flag.classes;}
$('<div class="flag"></div>').addClass(flag.classes.join(" ")).html(flagHtml).appendTo(li).click(function(){self._select($(this).index());});}
var p=$('<div class="panel"></div>').appendTo(self.element());if(self._options.panels[index]!=undefined&&self._options.panels[index]!=null){p.append(self._options.panels[index].element());}
return p;},addTab:function(item,panel,flag){this._options.tabs.push(item);if(panel!=undefined){this._options.panels.push(panel);}else{this._options.panels.push(null);}
var p=this._addTab(this._options.tabs.length-1,item,flag);this._refresh();return p;},setPanel:function(index,panel){this._options.panels[index]=panel;this.element().children('.panel').eq(index).empty();this.element().children('.panel').eq(index).append(panel.element());},selected:function(){return this._options.selected;},enable:function(index,value){var f=(value===undefined||value==true);if(this._enableStatus[index]!=f){this._enableStatus[index]=f;var t=this._nav.find('ul > li').eq(index);t[f?'removeClass':'addClass']('mojo-ui-tabs-disabled');}},clsname:function(){return"ui.Tabs";}});})(window,jQuery);;(function(w,jQuery,undefined){w.Mojo=w.Mojo||{};w.Mojo.ui=w.Mojo.ui||{};w.Mojo.ui.Image=Mojo.Object.extend({init:function(id,options){this._super(id,options);var self=this;this.element().addClass('mojo-ui-image');this.element().append('<img>');this._refresh();},_getDefaultOptions:function(){return{src:'',width:-1,height:-1,};},_refresh:function(){this.element().find('img').attr('src',this._options.src);if(this._options.width>-1){this.element().find('img').attr('width',this._options.width);}
if(this._options.height>-1){this.element().find('img').attr('height',this._options.height);}},src:function(src){if(text==undefined){return this._options.src;}
this._options.src=src;this._refresh();},clsname:function(){return"ui.Image";}});})(window,jQuery);;(function(w,$,g){w.Mojo=w.Mojo||{};g=w.Mojo.utils=w.Mojo.utils||{};g.debug=g.debug||{};g.debug.style='console';g.debug.vars=g.debug.vars||{};g.debug.vars.ui=g.debug.vars.ui||{};g.debug.vars.com=g.debug.vars.com||{};g.debug.vars.page=g.debug.vars.page||{};g.debug.print=function(obj,title,debug){if(debug===true){var msg=((title===undefined)?'Debug Message':title)+"\n==========================\n";if(obj===null){msg+="null";}else if(obj===undefined){msg+="Undefined Object!";}else if(typeof(obj)=='object'){for(var prop in obj){msg+=prop+" : "+obj[prop]+"\n";}}else{msg+=obj.toString();}
if(g.debug.style==='console'){console.log(msg);}else{alert(msg);}}};g.formatTime=function(sec){var hour=parseInt(sec/(60*60));var second=parseInt(sec%(60*60));var minute=parseInt(second/60);second=second%60;var str=hour>=10?hour:"0"+hour;str+=":"+(minute>=10?minute:"0"+minute);str+=":"+(second>=10?second:"0"+second);return str;};g.formatSecTime=function(sec){var day=parseInt(sec/(3600*24));var hour=parseInt(sec/(60*60));var second=parseInt(sec%(60*60));var minute=parseInt(second/60);second=second%60;return((day>0?day+Mojo.utils.locale('ui','days'):"")||(hour>0?hour+Mojo.utils.locale('ui','hours'):"")||(minute>0?minute+Mojo.utils.locale('ui','minutes'):"")||(second>0?second+Mojo.utils.locale('ui','seconds'):""));};g.getFromNowTime=function(time){var date=new Date();var now=date.getTime()/1000;var send=parseInt(time);var t=parseInt(now-send);if(t<1){t=1;}
var day=parseInt(t/(3600*24));var hour=parseInt((t%(3600*24))/3600);var minute=parseInt((t%3600)/60);var second=t%60;return(((day>0?day+Mojo.utils.locale('ui','days'):"")||(hour>0?hour+Mojo.utils.locale('ui','hours'):"")||(minute>0?minute+Mojo.utils.locale('ui','minutes'):"")||(second>0?second+Mojo.utils.locale('ui','seconds'):""))+
Mojo.utils.locale('ui','ago'));};g.center=function(element){var left=$(window).width()/2-element.outerWidth()/2;var top=$(window).height()/2-element.outerHeight()/2;var sl=$(document).scrollLeft();var st=$(document).scrollTop();element.css({left:left+sl,top:top+st});};g.relaW=function(num){return num/320*$(window).width();};g.relaH=function(num){return num/440*$(windw).height();};g.bottom=function(element){var left=$(window).width()/2-element.outerWidth()/2;var sl=$(document).scrollLeft();element.css({left:left+sl,bottom:0,position:'absolute'});};g.isWhat=function(typeId,what){if(parseInt(typeId)==1){return(what===undefined?"general":(what=="general"));}
if(parseInt(typeId)==2){return(what===undefined?"sword":(what=="sword"));}
if(parseInt(typeId)==3){return(what===undefined?"shield":(what=="shield"));}
if(parseInt(typeId)==4){return(what===undefined?"mounts":(what=="mounts"));}
if(parseInt(typeId)==5){return(what===undefined?"treasure":(what=="treasure"));}
if(parseInt(typeId)==6){return(what===undefined?"shouji":(what=="shouji"));}
if(parseInt(typeId)==7){return(what===undefined?"props":(what=="props"));}
if(parseInt(typeId)==8){return(what===undefined?"minis":(what=="minis"));}
if(parseInt(typeId)==21){return(what===undefined?"rm":(what=="rm"));}
if(parseInt(typeId)==22){return(what===undefined?"vm":(what=="vm"));}
if(parseInt(typeId)==23){return(what===undefined?"xp":(what=="xp"));}
return undefined;};w.Mojo.lang=w.Mojo.lang||{};g.locale=function(cat,key,params,userLanguage){if(userLanguage==undefined){userLanguage=Mojo.app.getUserLanguage();}
var result="";var paramsObj=params||{};if(cat!=undefined&&cat!=null&&key!=undefined&&key!=null){if(w.Mojo.lang[cat]!=undefined&&w.Mojo.lang[cat][userLanguage]!=undefined&&w.Mojo.lang[cat][userLanguage][key]!=undefined){result=w.Mojo.lang[cat][userLanguage][key];}
if(result.length<=0){if(paramsObj.__default__){result=paramsObj['__default__'];}else{result=key;}}
var regExp=new RegExp();for(var k in paramsObj){regExp=eval("/{{:"+k+"}}/g");result=result.replace(regExp,paramsObj[k]);}}
return result;};g.getFromParams=function(key){var url=location.href;var str=url.substring(url.indexOf('?')+1,url.length).split('&');var obj={};for(i=0;j=str[i];i++){obj[j.substring(0,j.indexOf('=')).toLowerCase()]=j.substring(j.indexOf('=')+1,j.length);}
return obj[key.toLowerCase()];};g.getHttpGetParams=function(){var url=window.location.href;var str=url.substring(url.indexOf('?')+1,url.length).split('&');var obj={};for(i=0;j=str[i];i++){obj[j.substring(0,j.indexOf('=')).toLowerCase()]=j.substring(j.indexOf('=')+1,j.length);}
return obj;}
g.getFromHost=function(key){var url=location.href;var host=url.split("?")[0]
var hostList=host.split("/");for(var index=0;index<hostList.length;index++){var k=hostList[index];if(k==key&&index<(hostList.length-1)){return hostList[index+1];}}
return undefined;};g._hasSomething={};g.getSomething=function(key,onlyOnce){if(onlyOnce==true&&g._hasSomething[key]){return undefined;}
var result=g.getFromParams(key);if(result==undefined||result==null){result=g.getFromHost(key);}
if(onlyOnce==true){g._hasSomething[key]=result;}
return result;};g.formatTimePlus=function(format,time){if(time===undefined){time=(new Date()).getTime()/1000;}
var day=0,hour=0,minutes=0,second=0;if(format.indexOf("%dd")>=0){day=parseInt(time/(3600*24));time=parseInt(time%3600*24);}
if(format.indexOf("%hhu")>=0){hour=parseInt(time/3600);time=parseInt(time%3600);}
if(format.indexOf("%mmu")>=0){minutes=parseInt(time/60);time=parseInt(time%60);}
second=parseInt(time);var result=format.replace("%ddu",(day<=0?"":day+Mojo.utils.locale('common','day'))).replace("%hhu",(hour<=0?"":hour+Mojo.utils.locale('common','hour'))).replace("%mmu",(minutes<=0?"":minutes+Mojo.utils.locale('common','minutes'))).replace("%ssu",(second<=0?"":second+Mojo.utils.locale('common','second')));return result;};g.formatPlayerName=function(name,title){if(typeof(name)=='object'){title=name.title;name=name.name;}
if(title){return'[<span class="official">'+title+'</span>]'+name;}
return name;};g.isNone=function(d){if(d==undefined||d==null){return true;}
if((typeof(d)=='string'||Array.isArray(d))&&d.length<=0){return true;}
if(typeof(d)=='number'){return isNaN(d);}
if(typeof(d)=='object'){for(var i in d){return false;}
return true;}
return false;};g.cardprice=function(lv,star){lv=parseInt(lv);star=parseInt(star);var temp=40*(lv-1)*Math.pow((lv/50+1),1.2)+25*Math.pow((star+1),2)/(5.2-star);return Math.ceil(temp);}
g.showWait=function(isOpen){if(isOpen===false){$(document.body).find(".mojo-utils-shadow").remove();}else{var shadow=$('<div class="mojo-utils-shadow"><div class="pp-chrysanthemum"></div></div>').css({'width':$(document).width(),'height':$(document).height(),}).appendTo($(document.body));g.center(shadow.find(".pp-chrysanthemum").first());}};g.trim=function(str){return str.replace(/(^\s*)|(\s*$)/g,'');};g.getEntityTitle=function(typeId){var str='';switch(parseInt(typeId)){case 1:str=Mojo.utils.locale('entity','generals_info');break;case 2:str=Mojo.utils.locale('entity','weapon_info');break;case 3:str=Mojo.utils.locale('entity','armor_info');break;case 4:str=Mojo.utils.locale('entity','mounts_info');break;case 5:str=Mojo.utils.locale('entity','treasure_info');break;default:break;}
return str;};g.getClientVersion=function(){return Mojo.cache.get('app_version')==undefined?"1.0":Mojo.cache.get('app_version');};g.isOpenUrlAvailable=function(){var version=parseFloat(g.getClientVersion());if(Mojo.gap.device=='iphone'){if(version>=1.3){return true;}}else if(Mojo.gap.device=='ipad'){if(version>=1.2){return true;}}
return false;};g.formatTimeToDate=function(sec){var str='';var date=new Date(sec*1000);var year=date.getFullYear();var month=date.getMonth()+1;var dd=date.getDate();var min=date.getMinutes()+"";if(min.length<2)
min="0"+min;str=month+Mojo.utils.locale('common','month')+dd+Mojo.utils.locale('common','dday')+date.getHours()+"";return str;};g.checkPasswdNumChar=function(passwd){var num=/[0-9]+/;var abc=/[A-Za-z]/;if(!abc.test(passwd)){return false;}
if(!num.test(passwd)){return false;}
return true;};g.getCookie=function(key){var search=key+"=";if(document.cookie.length>0){var offset=document.cookie.indexOf(search);if(offset>-1){offset+=search.length;var end=document.cookie.indexOf(";",offset);if(end==-1)end=document.cookie.length;return document.cookie.substring(offset,end);}else{return"";}}};g.showDiaochan=function(text,click){(new Mojo.com.Diaochan(undefined,{text:text,click:click})).open();};g.showLockedToast=function(id){var d={'btn-force':20,'btn-fuben':10,'btn-chat':5,'btn-entity-battle':5,'btn-ranking':3,'btn-battle':4,'btn-entity-browse':2,'btn-task':1,'btn-intensify':1,'btn-illustration':1,'btn-friend':1,'btn-messages':1,'btn-settings':1,'btn-entity-embed':1,'btn-mall':1};Mojo.app.toast.show(Mojo.utils.locale('common','do_task_update',{level:d[id]}));}})(window,jQuery);;(function(w,$,undefined){w.Mojo=w.Mojo||{};w.Mojo.lang={};w.Mojo.lang['ui']={'zh_tw':{'Agree':'','Agreed':'','Assist Lose':'','Assist Win':'','Back':'','Back to {{:scenario}}':'{{:scenario}}','Base Informations':'','Close':'','Congratulations':'','Congratulations! You got a card!':'','Congratulations! You got rewards!':'','Denied':'','Deny':'','Do':'','Duel':'','Fight Informations':'','For Help':'','For Help Again':'','Force Invite':'','Force War':'','Friend Assist Request':'','Friend Confirmation':'','Friend Delete':'','Friend Message':'','Friend PK Lose':'','Friend PK Win':'','Friend Rejection':'','Friend Request':'','In War':'','In War2':'','Introduction':'','Leave Message':'','Level':'','More Messages':'','Next':'','PK Lose':'','PK Win':'','Previous':'','Progress':'','Ranking':'','Refresh Succ':'','Reject':'','Reply':'','Requirement':'','Retaliate':'','Reward':'','Select':'','Select a friend':'','Send':'','Send Troops':'','System Message':'','Thanko_kr':'','Thanks':'','Type message':'','View Force':'','View More':'','ago':'','day':'','days':'','hour':'','hours':'','lost_title':'','minute':'','minutes':'','second':'','seconds':'','ui War':'',},'zh_cn':{'Agree':'','Agreed':'','Assist Lose':'','Assist Win':'','Back':'','Back to {{:scenario}}':'{{:scenario}}','Base Informations':'','Close':'','Congratulations':'','Congratulations! You got a card!':'','Congratulations! You got rewards!':'','Denied':'','Deny':'','Do':'','Duel':'','Fight Informations':'','For Help':'','For Help Again':'','Force Invite':'','Force War':'','Friend Assist Request':'','Friend Confirmation':'','Friend Delete':'','Friend Message':'','Friend PK Lose':'','Friend PK Win':'','Friend Rejection':'','Friend Request':'','In War':'','In War2':'','Introduction':'','Leave Message':'','Level':'','More Messages':'','Next':'','PK Lose':'','PK Win':'','Previous':'','Progress':'','Ranking':'','Refresh Succ':'','Reject':'','Reply':'','Requirement':'','Retaliate':'','Reward':'','Select':'','Select a friend':'','Send':'','Send Troops':'','System Message':'','Thanko_kr':'','Thanks':'','Type message':'','View Force':'','View More':'','ago':'','day':'','days':'','hour':'','hours':'','lost_title':'','minute':'','minutes':'','second':'','seconds':'','ui War':'',},};w.Mojo.lang['common']={'zh_tw':{'Go Statistics':'','acceleration for restore ep':'&#149','acceleration for restore sp':'&#149','action_error':'','add_cp':'{{:name}}, {{:value}}','add_ep':'{{:name}}','add_friend':'','add_sp':'{{:name}}','ago':'','and':'','assign_title':'','attack':'','attack_again':'','avoid war time':'{{:avoid_war_time}}','avoid_war_content':'<br><b>{{:avoid_war_time}}</b>','avoid_war_title':'','back':'','bad network':'','barrack_active_dlg_content':'','barrack_active_dlg_title':'','base_attack':'{{:old}}  <span>{{:new}}</span>','base_defence':'{{:old}}  <span>{{:new}}</span>','battle':'','battle_search':'','before_login_data':'','bind':'','bind_tip1':'emailEmail<div class="tip">email~</div>','bind_tip2':'email 7email~','bind_tip3':'','bind_title':'','bind_weibo':'Facebook','buy':'','buy ep succ':'','buy sp succ':'','buy_fail_title':'','buy_something_success':'{{:name}}','buy_warning_content':'','buy_warning_title':'','cancel':'','capacify_lack':'','capacify_lack_tip':'~~','choose_a_player_enter':'','clear_avoid_war':'','close':'','common':'','confirm quit':'','count':'','create_new_player':'','create_player_tips':'','day':'','days':'','dday':'','default_text':'','diaochan_battle_guide':'','diaochan_first_card':'','diaochan_intity_first_card':'','diaochan_new_player':'','diaochan_rob_guide':'','discount':'','do_task_update':'','email':'email','email bind tips':'','enter':'','enter game':'','ep':'','expire':'','explanation':'','facebook':'Facebook','findpwd_email_address':'email *','findpwd_email_tip':'email','findpwd_method_tip':'<br>&#149<br>&#149email<br>&#149<br>emailsupport@redatoms.com','findpwd_mobile_tip':'','findpwd_send_email':'','findpwd_server_tip':'','findpwd_with_email':'','findpwd_with_mobile':'','force':'','force-none':'','force_message':'','force_war_tip2':'','forcewar_lose_grain':'{{:forcename}}{{:grain}}','forcewar_notice_members1':'[<span>{{:title}}</span>]{{:ownername}}{{:forcename}}','forcewar_win_grain':'{{:forcename}}{{:grain}}','forgetpwd':'','friend_search':'','friendly_tip':'','full':'','gain_levelup_award':'','game account':'','general_count':'','general_slot_unlock':'!','get_wuhu_tip':'','go_accept':'','go_bless':'','go_download':'','go_embed':'','go_fuben':'','go_intensify':'','go_look':'','go_neizheng':'','go_package_card':'','go_payment':'','go_rebirth':'','go_sale':'','go_vm':'','grain':'','has reached the maximum':'','hot':'','hour':'','hours':'','in_cd':'','input_account_tip':'','input_email':'','input_mobile':'','input_username':'','intensify':'','invite_friend':'','level':'','level_up':'{{:level}}','level_up_title':'','login_forget_description':'','login_forget_passwd':'','login_forget_phone':' *','login_forget_sendsms':'','login_forget_username':'  *','login_nickname_tip':'','login_time':'','lv':'','main_j':'','max_energy':'{{:old}}  <span>{{:new}}</span>','max_entity':'{{:old}}  <span>{{:new}}</span>','max_friends_count':'{{:old}}  <span>{{:new}}</span>','max_stamina':'{{:old}}  <span>{{:new}}</span>','minute':'','minutes':'','month':'','more':'','name':'','need_logout':'','need_logout_notice':'','new':'','new_attack':'','new_defence':'','new_player_gift_title':'','nickname_not_empty':'','no content':'','no enough energy':'','no enough stamina':'','no_weixin':'','not enough ep':': ,','not enough sp':': ,','not_bind':'','ok':'','player num max prompt':'','playerId':'','player_role':'','pls_input_acc':'','price':'','price in mall':'','price_title':'','priceless':'','recharge':'','relation':'{{:platform}}','relation_guest':'email<br>emailsupport@redatoms.com','repeat_login':'','reset_avoid_war':'{{:avoid_war_time}}','revocation_of_war_free':'','rm':'','rob':'','sanguo_coming':'','search':'','search_force_hint':'','second':'','seconds':'','select_all':'','send success':'','send_pwd_to_email':'','send_pwd_to_mobile':'','send_pwd_to_phone':'','share':'','simple':'','simple_attack':'','simple_defence':'','simplified':'','sp':'','suggestion_default_text':'','suggestion_has_send':'','suggestion_title':'','sure_buy':'','task':'','team_attack':'','team_defence':'','think_again':'','time for all ep':'&#149','time for all sp':'&#149','time for next ep':'&#149','time for next sp':'&#149','tips':'','traditional':'','unknown':'','unlock_fuben_name':'{{:name}}','unlock_slot_count':'{{:old}}  <span>{{:new}}</span>','use':'','userbuff':'','username_tip':'','username_too_long':'','view':'','vm':'','wait_to_do':'','weibo':'Facebook','weixin':'','weixinfriends':'','when lose':'','when win':'','win_rate':'{{:percent}}%','xp':'','year':'',},'zh_cn':{'Go Statistics':'','acceleration for restore ep':'&#149','acceleration for restore sp':'&#149','action_error':'~~','add_cp':'{{:name}}, {{:value}}','add_ep':'{{:name}}','add_friend':'','add_sp':'{{:name}}','ago':'','and':'','assign_title':'','attack':'','attack_again':'','avoid war time':'{{:avoid_war_time}}','avoid_war_content':'<br><b>{{:avoid_war_time}}</b>','avoid_war_title':'','back':'','bad network':'','barrack_active_dlg_content':'~~','barrack_active_dlg_title':'','base_attack':'{{:old}}  <span>{{:new}}</span>','base_defence':'{{:old}}  <span>{{:new}}</span>','battle':'','battle_search':'','before_login_data':'','bind':'','bind_tip1':'<div class="tip">~</div>','bind_tip2':'7~','bind_tip3':'~,,~','bind_title':'','bind_weibo':'','buy':'','buy ep succ':'','buy sp succ':'','buy_fail_title':'','buy_something_success':'{{:name}}','buy_warning_content':'','buy_warning_title':'','cancel':'','capacify_lack':'','capacify_lack_tip':'~~','choose_a_player_enter':'','clear_avoid_war':'','close':'','common':'','confirm quit':'','count':'','create_new_player':'','create_player_tips':'{{:players}}/{{:maxPlayers}}','day':'','days':'','dday':'','default_text':'Ta','diaochan_battle_guide':'~~<br><span class="special-text"></span>~<div class="goBtn"></div>','diaochan_first_card':'~~<br/>~<br/><span class="special-text"></span>~<div class="goBtn"></div>','diaochan_intity_first_card':'~<br/><span class="special-text"></span>~<div class="goBtn"></div>','diaochan_new_player':'Hi~~<br/>~<br/><span class="special-text"></span>~<div class="goBtn"></div>','diaochan_rob_guide':'~~<br><span class="special-text"></span>~<div class="goBtn"></div>','discount':'','do_task_update':'{{:level}}~','email':'','email bind tips':'','enter':'','enter game':'','ep':'','expire':'','explanation':'','facebook':'facebook','findpwd_email_address':' *','findpwd_email_tip':'','findpwd_method_tip':'<b></b><br>&#149<br>&#149<br>&#149<br>support@redatoms.com','findpwd_mobile_tip':'','findpwd_send_email':'','findpwd_server_tip':'','findpwd_with_email':'','findpwd_with_mobile':'','force':'','force-none':'','force_message':'','force_war_tip2':'{{:contribute}}~','forcewar_lose_grain':'{{:forcename}}{{:grain}}','forcewar_notice_members1':'[<span>{{:title}}</span>]{{:ownername}}{{:forcename}}','forcewar_win_grain':'{{:forcename}}{{:grain}}','forgetpwd':'','friend_search':'','friendly_tip':'','full':'','gain_levelup_award':'','game account':'','general_count':'','general_slot_unlock':'!','get_wuhu_tip':'~{{:wuhu}}~','go_accept':'','go_bless':'','go_download':'','go_embed':'','go_fuben':'','go_intensify':'','go_look':'','go_neizheng':'','go_package_card':'','go_payment':'','go_rebirth':'','go_sale':'','go_vm':'','grain':'','has reached the maximum':'','hot':'','hour':'','hours':'','in_cd':'','input_account_tip':'','input_email':'','input_mobile':'','input_username':'','intensify':'','invite_friend':'','level':'','level_up':'{{:level}}','level_up_title':'','login_forget_description':'','login_forget_passwd':'','login_forget_phone':' *','login_forget_sendsms':'','login_forget_username':' *','login_nickname_tip':'','login_time':'','lv':'','main_j':'','max_energy':'{{:old}}  <span>{{:new}}</span>','max_entity':'{{:old}}  <span>{{:new}}</span>','max_friends_count':'{{:old}}  <span>{{:new}}</span>','max_stamina':'{{:old}}  <span>{{:new}}</span>','minute':'','minutes':'','month':'','more':'','name':'','need_logout':'','need_logout_notice':'~~','new':'','new_attack':'','new_defence':'','new_player_gift_title':'','nickname_not_empty':'','no content':'','no enough energy':'','no enough stamina':'','no_weixin':'~~','not enough ep':': ,','not enough sp':': ,','not_bind':'','ok':'','player num max prompt':'~{{:maxplayer}}~','playerId':'ID','player_role':'','pls_input_acc':'','price':'','price in mall':'','price_title':'','priceless':'','recharge':'','relation':'{{:platform}}','relation_guest':'<br>support@redatoms.com','repeat_login':'','reset_avoid_war':'{{:avoid_war_time}}','revocation_of_war_free':'','rm':'','rob':'','sanguo_coming':'','search':'','search_force_hint':'','second':'','seconds':'','select_all':'','send success':'','send_pwd_to_email':'<span style="color:#A80E0E">{{:email}}</span>','send_pwd_to_mobile':'<span style="color:#A80E0E">{{:mobile}}</span>','send_pwd_to_phone':'','share':'','simple':'','simple_attack':'','simple_defence':'','simplified':'','sp':'','suggestion_default_text':'','suggestion_has_send':'','suggestion_title':'','sure_buy':'','task':'','team_attack':'','team_defence':'','think_again':'','time for all ep':'&#149','time for all sp':'&#149','time for next ep':'&#149','time for next sp':'&#149','tips':'','traditional':'','unknown':'','unlock_fuben_name':'{{:name}}','unlock_slot_count':'{{:old}}  <span>{{:new}}</span>','use':'','userbuff':'','username_tip':'','username_too_long':'','view':'','vm':'','wait_to_do':'','weibo':'','weixin':'','weixinfriends':'','when lose':'','when win':'','win_rate':'{{:percent}}%','xp':'','year':'',},};w.Mojo.lang['weibo']={'zh_tw':{'A new general socket will unlock after binding weibo account.':'','Bind Success Tip':'','Bind sina weibo account':'','Bind succeed and why not to follow us':'','Bind weibo':'','Binding sina weibo account, please wait...':'...','Change account':'','Fail to bind your weibo account!':'','Fail to fetch your weibo account infomation!':'','Fail to logout current account!':'','Fetching your nickname of sina weibo, please wait...':'...','Has bind to sina weibo account':'','Has bind to sina weibo account:{{:account}}':'<br>{{:account}}','Have not bind any weibo account!':'','I am watting for you in #SanGuo lai le#!':'##','Login':'','Merge Succeed':'','Please input weibo content':'','Receive 50 coins for every weibo message(The daily limit is 500 coins).':'100500','Send Success':'','Send message':'','Send weibo':'','Share achievements with your friends and fans.':'','Weibo Bind Success Tip':'','Weibo has a lot of benefits':'','Your weibo account "{{:account}}" has expired, please login again!':'<br>{{:account}}','Your weibo account has been binded, do you want to use it binding current':'','Your weibo account has expired!':'','bind exist':'','bind message':'<br>-<br>PS:','bind succeed':'','bind succeed 7 day ago has card':'','bind succeed 7 day ago no card':'','bind title':'','bind_notice':'','change weibo success tips':'','change weibo success tips0':'','email_merge_prompt_content':'','enter_game':'','expire message':'<br>-<br>PS:','follow':'','follow message':'<br>1000','follow official':'','go bind':'','go login':'','merge_faild_content':'','merge_faild_tips':'','merge_prompt_content':'','merge_prompt_tips':'','no_bind_notice':'','rebind weibo faild':'','rebind weibo faild content':'','relation_official_weibo':'<br><span>1000~</span>','relation_weibo':'','relation_weibo_tip':'~','weibo bind succeed 7 day ago has card':'','weibo bind succeed 7 day ago no card':'','weibo binding content':'','weibo binding tips':'','weibo bonus':'100','weibo_bind_success_7_tips':'','weibo_bind_success_7_tips2':'',},'zh_cn':{'A new general socket will unlock after binding weibo account.':'','Bind Success Tip':'~1000~','Bind sina weibo account':'','Bind succeed and why not to follow us':'~10~<br/>1000','Bind weibo':'','Binding sina weibo account, please wait...':'...','Change account':'','Fail to bind your weibo account!':'','Fail to fetch your weibo account infomation!':'','Fail to logout current account!':'','Fetching your nickname of sina weibo, please wait...':'...','Has bind to sina weibo account':'','Has bind to sina weibo account:{{:account}}':'<br>{{:account}}','Have not bind any weibo account!':'','I am watting for you in #SanGuo lai le#!':'##','Login':'','Merge Succeed':'','Please input weibo content':'','Receive 50 coins for every weibo message(The daily limit is 500 coins).':'100500','Send Success':'','Send message':'','Send weibo':'','Share achievements with your friends and fans.':'','Weibo Bind Success Tip':'~','Weibo has a lot of benefits':'','Your weibo account "{{:account}}" has expired, please login again!':'<br>{{:account}}','Your weibo account has been binded, do you want to use it binding current':'~<span style="color:#A80E0E">{{:nickname}}</span><span style="color:#A80E0E">({{:weibo}})</span>','Your weibo account has expired!':'','bind exist':'~','bind message':'<br>-<br>PS:','bind succeed':'','bind succeed 7 day ago has card':'~7!(<span style="color:#A80E0E">{{:weibo}}</span>)1,10~','bind succeed 7 day ago no card':'~7!(<span style="color:#A80E0E">{{:weibo}}</span>)10~','bind title':'','bind_notice':'','change weibo success tips':'~','change weibo success tips0':'~!10~<br/>,?','email_merge_prompt_content':'~(<span style="color:#A80E0E">{{:email}}</span>),,(<span style="color:#A80E0E">{{:email}}</span>),','enter_game':'','expire message':'<br>--<br>PS:','follow':'','follow message':'<br>1000','follow official':'','go bind':'','go login':'','merge_faild_content':'~,','merge_faild_tips':'','merge_prompt_content':'~(<span style="color:#A80E0E">{{:weibo}}</span>),,(<span style="color:#A80E0E">{{:weibo}}</span>),','merge_prompt_tips':'','no_bind_notice':'','rebind weibo faild':'','rebind weibo faild content':'~~','relation_official_weibo':'<br><span>1000~</span>','relation_weibo':'','relation_weibo_tip':'~','weibo bind succeed 7 day ago has card':'~(<span style="color:#A80E0E">{{:weibo}}</span>)!,,(<span style="color:#A80E0E">{{:weibo}}</span>)','weibo bind succeed 7 day ago no card':'~(<span style="color:#A80E0E">{{:weibo}}</span>)!,(<span style="color:#A80E0E">{{:weibo}}</span>)','weibo binding content':'~','weibo binding tips':'','weibo bonus':'32000','weibo_bind_success_7_tips':'~7110~','weibo_bind_success_7_tips2':'~710~',},};w.Mojo.lang['facebook']={'zh_tw':{'A new general socket will unlock after binding weibo account.':'','Bind sina weibo account':'facebook','Bind weibo':'facebook','Binding sina weibo account, please wait...':'facebook...','Change account':'','Fail to bind your weibo account!':'facebook','Fail to fetch your weibo account infomation!':'facebook','Fail to logout current account!':'facebook','Fetching your nickname of sina weibo, please wait...':'facebook...','Has bind to sina weibo account':'facebook','Has bind to sina weibo account:{{:account}}':'facebook<br>{{:account}}','Have not bind any weibo account!':'facebook','I am watting for you in #SanGuo lai le#!':'##','Login':'','Please input weibo content':'','Receive 50 coins for every weibo message(The daily limit is 500 coins).':'po100500','Send Success':'','Send message':'','Send weibo':'','Share achievements with your friends and fans.':'','Weibo has a lot of benefits':'facebook','Your weibo account "{{:account}}" has expired, please login again!':'facebook<br>{{:account}}','Your weibo account has expired!':'facebook','bind message':'facebook<br>-<br>PS:','bind title':'facebook','enter_game':'','expire message':'facebook<br>-<br>PS:','follow':'','follow message':'facebook<br>1000','follow official':'facebook','go bind':'','go login':'','relation_official_weibo':'Facebook<br><span>1000~</span>','relation_weibo':'facebook','relation_weibo_tip':'facebook~','weibo bonus':'po100',},'zh_cn':{'A new general socket will unlock after binding weibo account.':'','Bind sina weibo account':'facebook','Bind weibo':'facebook','Binding sina weibo account, please wait...':'facebook...','Change account':'','Fail to bind your weibo account!':'facebook','Fail to fetch your weibo account infomation!':'facebook','Fail to logout current account!':'facebook','Fetching your nickname of sina weibo, please wait...':'facebook...','Has bind to sina weibo account':'facebook','Has bind to sina weibo account:{{:account}}':'facebook<br>{{:account}}','Have not bind any weibo account!':'facebook','I am watting for you in #SanGuo lai le#!':'##','Login':'','Please input weibo content':'','Receive 50 coins for every weibo message(The daily limit is 500 coins).':'100500','Send Success':'','Send message':'','Send weibo':'','Share achievements with your friends and fans.':'','Weibo has a lot of benefits':'facebook','Your weibo account "{{:account}}" has expired, please login again!':'facebook<br>{{:account}}','Your weibo account has expired!':'facebook','bind message':'facebook<br>-<br>PS:','bind title':'facebook','enter_game':'','expire message':'facebook<br>-<br>PS:','follow':'','follow message':'facebook<br>1000','follow official':'facebook','go bind':'','go login':'','relation_official_weibo':'<br><span>1000~</span>','relation_weibo':'facebook','relation_weibo_tip':'facebook~','weibo bonus':'100',},};w.Mojo.lang['largeentity']={'zh_tw':{'attack':' + ','defence':' + ','effect_ep':' + ','effect_max_attack':' + ','effect_max_attack_pro':' + ','effect_max_defence':' + ','effect_max_defence_pro':' + ','effect_min_attack':' + ','effect_min_defence':' + ','effect_rm':' + ','effect_sp':' + ','effect_vm':' + ','effect_xp':' + ',},'zh_cn':{'attack':' + ','defence':' + ','effect_ep':' + ','effect_max_attack':' + ','effect_max_attack_pro':' + ','effect_max_defence':' + ','effect_max_defence_pro':' + ','effect_min_attack':' + ','effect_min_defence':' + ','effect_rm':' + ','effect_sp':' + ','effect_vm':' + ','effect_xp':' + ',},};w.Mojo.lang['mall']={'zh_tw':{'batch_buy_dlg_tip':'','batch_buy_num_tip':'','buy':'','buy_entity_content':'-','buy_fail_title':'','buy_props_content':'-','buy_rm':'','buy_success_body':'PS:','buy_success_title':'','buy_vm':'','buy_warning_content':'','buy_warning_title':'','continue_mall':'','cost_vm':'','current_rm':'','current_vm':'','discount_goods_flag':'%<br/>','discount_goods_flag_new':'{{:discount}}','go_accept':'','go_payment':'','go_vm':'','goods_detail_title':'','has_buy':'','heaven_bless':'','hot_goods_flag':'','need_rm':'','need_vm':'','new_goods_flag':'','open_minis_result':'','open_minis_tip':'{{name}}-','open_minis_tip1':'{{name}}--','play_minis':'','price_title':'{{name}}','spend_rm':'','spend_vm':'','sure_buy':'','tavern_update_time':' %hhu %mmu %ssu','think_again':'','wait_buy_result':'',},'zh_cn':{'batch_buy_dlg_tip':'~~','batch_buy_num_tip':'','buy':'','buy_entity_content':'-','buy_fail_title':'','buy_props_content':'-','buy_rm':'','buy_success_body':'PS:','buy_success_title':'','buy_vm':'','buy_warning_content':'','buy_warning_title':'','continue_mall':'','cost_vm':'','current_rm':'','current_vm':'','discount_goods_flag':'%<br/>','discount_goods_flag_new':'{{:discount}}','go_accept':'','go_payment':'','go_vm':'','goods_detail_title':'','has_buy':'','heaven_bless':'','hot_goods_flag':'','need_rm':'','need_vm':'','new_goods_flag':'','open_minis_result':'','open_minis_tip':'{{name}}-','open_minis_tip1':'{{name}}--','play_minis':'','price_title':'{{name}}','spend_rm':'','spend_vm':'','sure_buy':'','tavern_update_time':' %hhu %mmu %ssu','think_again':'','wait_buy_result':'',},};w.Mojo.lang['mission']={'zh_tw':{'Attack Another Generals':'{{:boss_name}}{{:name}}','Attack One Generals':'{{:boss_name}}{{:name}}','Coins':'','Energy point is not enough':'','Gained':'','Get Another Collection':'{{:name}}','Get Another Generals':'{{:name}}','Get One Collection':'{{:name}}','Get One Generals':'{{:name}}','Please complete the tasko_kr above!':'','Please complete the tasks above!':'','Task Awards':'','The task is completed!':'','You have to complete the previous task group!':'','action':'','battle result preview':'','battle_result_fail':'','battle_result_formation_title_lose':'','battle_result_formation_title_win':'','formation':'','formation detail':'','new_player_gift_title':'','win_card':'',},'zh_cn':{'Attack Another Generals':'{{:boss_name}}{{:name}}','Attack One Generals':'{{:boss_name}}{{:name}}','Coins':'','Energy point is not enough':'','Gained':'','Get Another Collection':'{{:name}}','Get Another Generals':'{{:name}}','Get One Collection':'{{:name}}','Get One Generals':'{{:name}}','Please complete the tasko_kr above!':'','Please complete the tasks above!':'','Task Awards':'','The task is completed!':'','You have to complete the previous task group!':'','action':'','battle result preview':'','battle_result_fail':'~','battle_result_formation_title_lose':'','battle_result_formation_title_win':'','formation':'','formation detail':'','new_player_gift_title':'','win_card':'~~',},};w.Mojo.lang['message']={'zh_tw':{'All':'','Battle':'','Friend':'','Handle':'','Messages':'','More Messages':'','No Message!':'','Send Message to Friend':'','Send succeed!':'','System':'','attack':'{{:min}}-{{:max}}','level':'{{:level}}','nick':'{{:nick}}',},'zh_cn':{'All':'','Battle':'','Friend':'','Handle':'','Messages':'','More Messages':'','No Message!':'','Send Message to Friend':'','Send succeed!':'','System':'','attack':'{{:min}}-{{:max}}','level':'{{:level}}','nick':'{{:nick}}',},};w.Mojo.lang['battle']={'zh_tw':{'Can not attack weak':'','Enemy':'','Fight':'','More opponents':'','No enemies':'','No fight opponents':'','action':'','armor_protect':'','base attack':'','base defence':'','battle result preview':'','battle_fail_content':'','battle_fail_title':'','battle_result_formation_title_lose':'','battle_result_formation_title_win':'','battle_result_title':'','battle_result_title_lose':'','battle_result_title_rob_lose':'','battle_result_title_rob_win':'','battle_result_title_win':'','battle_tip':'~','be_restraint':'','force_none':'','formation':'','formation detail':'','in_avoid_war':'','lose_message':'','refresh opps':'','refresh_opponents':'','resist':'','restraint':'','search_prefix':'Lv.','sum attack':'','sum defence':'','weapon_hit':'','win_message_01':'{{:name}}{{:bonus}}','win_message_02':'{{:name}}{{:bonus}}','win_message_03':'{{:name}}','win_message_04':'{{:bonus}}','win_message_05':'{{:name}}{{:bonus}}','win_message_06':'','win_message_07':'~{{:name}}{{:bonus}}{{:frdname}}',},'zh_cn':{'Can not attack weak':'','Enemy':'','Fight':'','More opponents':'','No enemies':'','No fight opponents':'','action':'','armor_protect':'','base attack':'','base defence':'','battle result preview':'','battle_fail_content':'','battle_fail_title':'','battle_result_formation_title_lose':'','battle_result_formation_title_win':'','battle_result_title':'','battle_result_title_lose':'','battle_result_title_rob_lose':'','battle_result_title_rob_win':'','battle_result_title_win':'','battle_tip':'~','be_restraint':'','force_none':'','formation':'','formation detail':'','in_avoid_war':'','lose_message':'','refresh opps':'','refresh_opponents':'','resist':'','restraint':'','search_prefix':'Lv.','sum attack':'','sum defence':'','weapon_hit':'','win_message_01':'{{:name}}{{:bonus}}','win_message_02':'{{:name}}{{:bonus}}','win_message_03':'{{:name}}','win_message_04':'{{:bonus}}','win_message_05':'{{:name}}{{:bonus}}','win_message_06':'','win_message_07':'~{{:name}}{{:bonus}}{{:frdname}}',},};w.Mojo.lang['package']={'zh_tw':{'add_friend':'','and':'','barrack_army':'','barrack_armyguide_content':'','barrack_armyguide_title':'','barrack_armyup_content':'','barrack_attack':'','barrack_card_detail_title':'','barrack_center_army':'','barrack_disabled_jisi_btn':'','barrack_down':'','barrack_fangyu':'','barrack_getJingyan':'','barrack_guid':'','barrack_jihuojiangli':'','barrack_jihuojineng':'','barrack_jingyan':'','barrack_jisi':'','barrack_jisiBaowu_num':'','barrack_jisiOk':'','barrack_jisiok_content':'','barrack_jisiok_title':'','barrack_kezhi':'','barrack_left_army':'','barrack_level':'','barrack_level_max_guid':'','barrack_reset':'','barrack_right_army':'','barrack_select_jisiCard':'','barrack_unlockLevel':'','barrack_up':'','barrack_up_ok':'','barracks_centerArmy_title':'','barracks_leftArmy_title':'','barracks_rightArmy_title':'','bind_weibo_and_unlock_generals':'PS:Facebook','cannot_swicth_package':'','entity_umount':'','friend_head_title':'','general_detail_title':'','general_umount':'','goto_mission':'','has_max_slot':'','has_mount':'','inlay_not_slot':'','install_general':'','install_mounts':'','install_shield':'','install_sword':'','install_treasure':'','mounts_detail_title':'','my_head_title':'','need_friends':'{{friends}}','need_install_general':'\""','need_install_mounts':' ','need_install_shield':' ','need_install_sword':' ','need_install_treasure':' ','need_level':'{{level}}','null_skills':'','package_num1':'','package_num2':'','package_num3':'','package_num4':'','package_num5':'','package_num6':'','package_num7':'','package_num8':'','package_switch':'','package_switch1':'','package_using':'','page_loading':'...','poptip_choose_general':'','poptip_choose_mounts':'','poptip_choose_shield':'','poptip_choose_sword':'','poptip_choose_treasure':'','shield_detail_title':'','skill':'','slot_unlock_award':'~<br>~','start_niudan':'','sword_detail_title':'','title_info':'','treasure_detail_title':'','unlock_egg':'','unlock_next':'',},'zh_cn':{'add_friend':'','and':'','barrack_army':'','barrack_armyguide_content':'<div>1.4</div><div>2.30</div><div>3.</div><div>4.</div>','barrack_armyguide_title':'','barrack_armyup_content':'~{{:level}}','barrack_attack':'<span class="label"></span><span class="attack">{{:min}} - {{:max}}</span>','barrack_card_detail_title':'','barrack_center_army':'','barrack_disabled_jisi_btn':'~','barrack_down':'','barrack_fangyu':'<span class="label"></span><span class="attack">{{:min}} - {{:max}}</span>','barrack_getJingyan':'EXP ','barrack_guid':'','barrack_jihuojiangli':'','barrack_jihuojineng':'','barrack_jingyan':'','barrack_jisi':'','barrack_jisiBaowu_num':'','barrack_jisiOk':'EXP ','barrack_jisiok_content':'<div>~</div><div><span class="red">{{:jisiCard}}</span></div><div>EXP {{:exp}}</div><div></div>','barrack_jisiok_title':'','barrack_kezhi':'<span class="label"></span><span class="attack">{{:value}}</span>','barrack_left_army':'','barrack_level':' LV{{:level}}','barrack_level_max_guid':'~~','barrack_reset':'','barrack_right_army':'','barrack_select_jisiCard':'','barrack_unlockLevel':'{{:level}}~','barrack_up':'','barrack_up_ok':'','barracks_centerArmy_title':'<div class="t"></div><div class="c"></div>','barracks_leftArmy_title':'<div class=\"t\"></div><div class=\"c\"></div>','barracks_rightArmy_title':'<div class="t"></div><div class="c"></div>','bind_weibo_and_unlock_generals':'PS:','cannot_swicth_package':'~105~','entity_umount':'','friend_head_title':'','general_detail_title':'','general_umount':'','goto_mission':'','has_max_slot':'','has_mount':'~','inlay_not_slot':'','install_general':'','install_mounts':'','install_shield':'','install_sword':'','install_treasure':'','mounts_detail_title':'','my_head_title':'','need_friends':'{{friends}}','need_install_general':'\"\"','need_install_mounts':' ','need_install_shield':' ','need_install_sword':' ','need_install_treasure':' ','need_level':'{{level}}','null_skills':'','package_num1':'','package_num2':'','package_num3':'','package_num4':'','package_num5':'','package_num6':'','package_num7':'','package_num8':'','package_switch':'','package_switch1':'','package_using':'~{{:packageName}}','page_loading':'...','poptip_choose_general':'','poptip_choose_mounts':'','poptip_choose_shield':'','poptip_choose_sword':'','poptip_choose_treasure':'','shield_detail_title':'','skill':'','slot_unlock_award':'~<br>~','start_niudan':'','sword_detail_title':'','title_info':'','treasure_detail_title':'','unlock_egg':'','unlock_next':'',},};w.Mojo.lang['friend']={'zh_tw':{'add_friend':'','add_friend_need_leveup':'','condition':'','confirm_delete_friend':'','contact':'','default_text':'','delete_friend':'','delete_friend_title':'','deleted':'','do_with_friend':'{{:name}}','formation':'','friend':'','friend not found':'','friend_detail':'','friend_numbers':'','has invited':'','has sended':'','invite':'','invite_force':'','invite_friend':'','leave_message_to':'{{:name}}','message':'','more_friend':'','more_player':'','no content':'','no friends':'','not found':'','order':'','order_friend':'','order_type':'','pk':'','please choose your favorite':'','refresh':'','say something':'','search':'','send':'','view':'','view_force':'',},'zh_cn':{'add_friend':'','add_friend_need_leveup':'','condition':'','confirm_delete_friend':'<span>{{:name}}</span>','contact':'','default_text':'Ta','delete_friend':'','delete_friend_title':'','deleted':'','do_with_friend':'<span>{{:name}}</span>','formation':'','friend':'','friend not found':'{{:name}}','friend_detail':'','friend_numbers':'','has invited':'','has sended':'','invite':'','invite_force':'','invite_friend':'','leave_message_to':'{{:name}}','message':'','more_friend':'','more_player':'','no content':'','no friends':'','not found':'','order':'','order_friend':'','order_type':'','pk':'','please choose your favorite':'','refresh':'','say something':'','search':'','send':'','view':'','view_force':'',},};w.Mojo.lang['force']={'zh_tw':{'adjust':'','adjust_official':'','adjust_tax_rate':'','adjust_time_input_err':'','adjust_time_input_update':'','adjust_times':'','adjust_times_auth':'','adjust_times_tips1':'','adjust_times_tips2':'','adjust_times_title':'','after_leave':'','alert_cooling_time_battle':'','alert_cooling_time_if_leave':'','all_chanllenge_get':'&#149','alliance':'','alliance_description':'','allied':'','ally':'','ally_apply_expire':'','ally_cancel':'','ally_friend':'','ally_info':'','ally_succ':'','ally_success':'','already_ally':'','already_join_tip':'~{{:name}}~','appellate_resign_apply':'','applicant_cd_time_not_enough':'','armygrain':'','assign_title':'','assignbuff':'','assistAlliance_defenceer_win_momentum':'','assistAlliance_lose_content':'','assistAlliance_win_content':'','assistSlave_defenceer_win_momentum':'','assistSlave_lose_content':'','assistSlave_win_content':'','assist_lose':'','assist_win':'','base_info':'','battle':'','battle_fail':'','battle_fail_forcerest':'','battle_food':'','be_boycott':'','be_capitulate':'','be_rebel':'','be_revolted':'','be_seized':'','be_uniterebel':'','be_usurp':'','boycott':'','boycott_cancel':'','boycott_lose':'','boycott_succ':'','break_alliance':'','call_toge_member':'','can_as_title_count':'','can_not_ally':'','can_not_boycott':'','can_not_submission':'','cancel_ally':'','cannot_abandon_your_brother':'','cannot_adjust_more_official':'~{{:official}}~','cannot_adjust_owner':'~50~','cannot_allocatetitle':'','cannot_change':'','cannot_do_it':'','capitulate':'','capitulate_beforeend':'','capitulate_declaration':'','capitulate_description':'','capitulate_subhead':'','capitulate_succ':'','capture':'','capture_again':'','capture_default_message':'','capture_lodgment':'{{:name}}','capture_lose':'','capture_win':'','chairman':'','challenge_cost':'','chat':'','collect_tax':'','con_capitulate':'','con_capitulated':'','contact':'','continue_exchange':'','cost_grain':'','cost_rm':'','count_challenge':'','count_member':'','count_officer_1':'','count_officer_2':'','count_officer_3':'','counterattack':'','crazywar_attack_retreat_answer':'','crazywar_defence_retreat_answer':'','crazywar_retreat_question':'','create_force':'','create_free':'','create_pay':'','create_succ':'','create_succ_tip':'{{:name}}~','create_succ_weibo':'##{{:name}}','create_tip':'','create_use_rebirth':'68~','current_level':'{{:level}}','default_chat_message':'','defence_lose':'','defence_succ':'','defense_lose':'','defense_resign':'','defense_succ':'','deleted':'','deny_apply':'','deny_boycott':'','deny_capitulate':'','deny_capture':'','deny_resign_apply':'','depose':'','do_with_member':'{{:honor}}{{:name}}','edit_force_fobbiden':'~~','electioneer_officer':'','electioneer_officer_lose':'','electioneer_officer_succ':'','empty':'','empty_notice_default_text':'','enemy force':'','event':'','exchange':'','exchange_again':'','exchange_failed_content':'~','exchange_failed_title':'','exchange_successful_content':'~<br/>--~','exchange_successful_content2':'','exchange_successful_title':'','exchange_warning_content':'~','exchange_warning_title':'','expiretime_coming':'','expiretime_coming_message':'','explanation_content':'','fail_to_do':'','fight':'','food_description':'','force':'','force_alliance':'','force_appling':'','force_apply':'','force_apply_fail':'','force_become_slave':'','force_become_slave_seize_lose':'','force_boss_challenge':'','force_boss_challenge_attack_default_msg':'','force_boss_challenge_attack_preview_cost':'','force_boss_challenge_attack_preview_header':'','force_boss_challenge_attack_preview_lose':'','force_boss_challenge_attack_preview_not':'','force_boss_challenge_attack_preview_speedup':'','force_boss_challenge_attack_preview_win':'','force_boss_challenge_attack_reattack':'','force_boss_challenge_attack_rm':'','force_boss_challenge_cd':'','force_boss_challenge_cd_content':'','force_boss_challenge_detail':'','force_boss_challenge_detail_content':'','force_boss_challenge_detail_dlg':'','force_boss_challenge_exchange_answer':'','force_boss_challenge_exchange_fail':'','force_boss_challenge_exchange_reason':'','force_boss_challenge_final_des1':'','force_boss_challenge_final_des2':'','force_boss_challenge_final_des3':'','force_boss_challenge_final_des4':'','force_boss_challenge_final_des5':'','force_boss_challenge_final_goexchange':'','force_boss_challenge_final_goexchange2':'','force_boss_challenge_final_lose':'','force_boss_challenge_final_win':'','force_boss_challenge_final_win2':'','force_boss_challenge_final_win_grain':'','force_boss_challenge_freetimes':'','force_boss_challenge_help_content':'','force_boss_challenge_help_title':'','force_boss_challenge_hint_text':'','force_boss_challenge_lack_rm':'','force_boss_challenge_lack_title':'','force_boss_challenge_lack_vm':'','force_boss_challenge_limit':'','force_boss_challenge_limit2':'','force_boss_challenge_msg_content':'','force_boss_challenge_msg_content2':'','force_boss_challenge_no_right':'','force_boss_challenge_no_right2':'','force_boss_challenge_notice':'','force_boss_challenge_notice2':'','force_boss_challenge_preview_choose_niudan':'','force_boss_challenge_preview_cost':'','force_boss_challenge_preview_header':'','force_boss_challenge_preview_niudan1':'','force_boss_challenge_preview_niudan2':'','force_boss_challenge_preview_niudan3':'','force_boss_challenge_preview_niudan4':'','force_boss_challenge_preview_niudan5':'','force_boss_challenge_preview_niudan6':'','force_boss_challenge_preview_niudan7':'','force_boss_challenge_profile':'','force_boss_challenge_reward':'','force_boss_challenge_reward_des':'','force_boss_challenge_reward_des2':'','force_boss_challenge_reward_get':'','force_boss_challenge_reward_get2':'','force_boss_challenge_reward_killboss':'','force_boss_challenge_speed_fail_title':'','force_boss_challenge_start':'','force_boss_challenge_start2':'','force_boss_challenge_start3':'','force_boss_challenge_start4':'','force_boss_challenge_start5':'','force_boss_challenge_tip_content':'','force_boss_flee_time':'','force_boss_left':'','force_boss_name_level':'','force_boss_name_level2':'','force_capitulate_fail':'','force_contribute_not_enough':'','force_create_failed':'','force_create_ok':'~','force_disband':'','force_dismiss':'','force_empty':'','force_event_alliance_notice':'','force_exchange_unavailable':'~~','force_exchange_unavailable_forceboss':'','force_free':'','force_grain':'','force_invite':'','force_join_no':'~{{:level}}~','force_join_ok':'{{:level}}','force_level':'','force_level_is_not_enough':'~~','force_level_not_enough':'','force_level_not_enough_msg':'','force_level_too_low':'~~','force_list_limit':'~100~','force_list_more':'','force_master':'','force_message':'','force_name':'','force_name_empty':'','force_name_empty1':'','force_name_max':'5','force_num':'/{{:count}}','force_owner':'','force_search_noresult':'','force_slave':'','force_vice_owner':'','force_war':'','force_war_tip':'~','force_war_tip2':'','force_war_tip3':'','forcebuff':'','forcewar_action':'','forcewar_alliancemember':'','forcewar_battle':'','forcewar_battle_action':'','forcewar_battle_notice':'{{:opponent-force}}({{:battle-schedule}}) - {{:battle-time}}','forcewar_battle_preview':'','forcewar_battle_start':'','forcewar_change':'','forcewar_communion':'','forcewar_defence_notice':'','forcewar_defense':'','forcewar_disband_content':'<br/>','forcewar_element_assistforce':'','forcewar_element_captured':'','forcewar_element_defence':'','forcewar_element_expiretime':'','forcewar_element_force':'','forcewar_element_general':'','forcewar_element_group':'','forcewar_element_hascaptured':'','forcewar_element_position':'{{:index}}','forcewar_enemy':'','forcewar_enemy_grain':'','forcewar_enemy_level':'','forcewar_enemy_mem':'','forcewar_enemy_notice':'','forcewar_enemy_owner':'','forcewar_hasborrowmember':'','forcewar_help':'','forcewar_help_content':'','forcewar_help_title':'','forcewar_lose':'','forcewar_lose_content':'{{:forcename}}','forcewar_lose_grain':'{{:forcename}}{{:grain}}','forcewar_march_header':'','forcewar_no_battle':':{{:challenge}}/{{:challenge_limit}}','forcewar_notice_members':'{{:ownername}}{{:forcename}}{{:content}}','forcewar_notice_members1':'[<span>{{:title}}</span>]{{:ownername}}{{:forcename}}','forcewar_only_owner_change_defender':'~~','forcewar_only_owner_start':'','forcewar_preview':'','forcewar_retreat':'','forcewar_retreat_content':'{{:forcename}}~','forcewar_retreat_question':'','forcewar_retreat_tip':'','forcewar_start_content':'<br/><br/><br/><br/><br/><br/><br/><br/>','forcewar_start_title':'','forcewar_tip_content':'{{:opponent_force}}10','forcewar_tip_title':'','forcewar_win':'','forcewar_win_commend':'<br/>','forcewar_win_content':'{{:forcename}}<br/>','forcewar_win_grain':'{{:forcename}}{{:grain}}','foreign':'','formation detail':'','free_only_owner_can_ask_alliance':'','free_only_ownerorvice_can_ask_surrender':'','free_only_ownerorvice_can_start_battle':'','from':'','gained':'','get_officer':'','get_out_of_force':'','get_out_of_force_content':'','get_title':'','go':'','go_internal':'','goaway':'','grain':'','grain_contribute':'','grain_cost':'','grain_donate':'','grain_input_err':'~~','grain_not_enouph':'~~','grain_not_input':'~~','grain_share_cd':'3~','grain_share_cdtip':'','grain_share_confirm':'~','grain_share_fail':'~~','grain_succ':'','graun_share_cd_no':'~~','has_captured':'','has_in_force':'~~','have_armygrain':'','have_grain':'','help revenge':'','help_defense_member_change':'','help_defense_time_finish':'','hour':'','how_to_adjust_official':'{{:honor}}{{:name}}','in_force_rest':'','in_war':'','info':'','info_board':'','info_level':'','info_member':'','info_member1':'','info_owner':'','info_vice_owner':'','input_message_call_toge':'','internal':'','is_submission':'','its_alliance':'','its_master':'','its_slave':'','join_already':'','join_apply':'','join_apply_force':'','join_event_privilege':'','join_force':'','join_slogen':'','lake_grain':'','last_grain':'','leve_updated':'{{:level}}','level':'','level_full':'','level_full_tip':'','levelinfo':'{{:level}}','login':'','lose_lodgment_defender':'{{:defendername}}{{:lodgment}}','lose_officer':'','lose_title':'','march_content_rebel_attack':'','march_content_rebel_defence':'','march_content_uniterebel_attack':'','march_content_uniterebel_defence':'','march_content_usurp_attack':'','march_content_usurp_defence':'','march_expiretime_rebel_attack':'','march_expiretime_rebel_defence':'','march_expiretime_uniterebel_attack':'','march_expiretime_uniterebel_defence':'','march_expiretime_usurp_attack':'','march_expiretime_usurp_defence':'','master_slave_num':'','member':'','member_contact':'','member_count':'','member_count1':'{{:now}}/{{:max}}','member_count_txt':'','member_empty':'','member_full':'~~','member_max':'','member_more':'','more':'','more_force':'','name':'','need_rm':'','next_chanllenge_get':'&#149','nextday':'','no enemy force':'','no_allocatebuff':'','non_rmb_player_add_defense':'','non_rmb_player_assist_attack':'','non_rmb_player_assist_defense':'','non_rmb_player_assist_result':'','non_rmb_player_defense_data':'','non_rmb_player_sub_defense':'','none':'','not_resign_apply':'','not_this_member':'','notice':'','notice_default_text1':'','notice_default_text2':'','notice_default_title1':'','notice_default_title2':'','notice_edit_btn':'','notice_title':'','offer':'','offer1':'','officer_first':'','officer_second':'','officer_third':'','official1':'','official100':'','official2':'','official3':'','official4':'','official5':'','ok_submission':'','only_official_can_refresh':'','order':'{{:order}}','order_condition':'','order_force':'','other':'','other_prefect_message':'','out':'','out_force':'','out_force_message':'{{:honor}}{{:name}}','out_force_tip':'~~','over':'','owner':'[<span class=\"official\">{{:title}}</span>]{{:name}}','owner_title':'','pass_resign_apply':'','personal_grain_amount':'{{:amount}}','position_count':'','position_empty':'','prefect_be_seized':'','prefect_count':'','prefect_message':'','prefect_revolt':'','price':'','prince_message':'','profile_level':'','ranking':'','rebel':'','rebel_attack_disband':'','rebel_attack_explanation':'','rebel_attack_lose':'','rebel_attack_lose_content':'','rebel_attack_win':'','rebel_attack_win_content':'','rebel_attacker_win_momentum':'','rebel_defence_disband':'','rebel_defence_explanation':'','rebel_defence_lose':'','rebel_defence_lose_content':'','rebel_defence_win':'','rebel_defence_win_content':'','rebel_defenceer_win_momentum':'','rebel_fail':'','rebel_fail_forcerest':'','rebel_over':'','rebirth_not_enouph':'~~','rebirth_not_enouph_title':'','rebirth_now_have':'{{:num}}','rece_invite':'','receive_capitulate':'','refresh':'','refresh_award':'','refresh_award1':'','refresh_cost':'','refresh_fail':'','refresh_fail_tip':'~~','refresh_info1':'','refresh_info3':'({{:cost}}{{:yb}}{{:point}})','refresh_info4':'{{:official}}{{:name}}<br>()','refresh_internal_mission':'','refresh_text':'24','relation':'','relation_disband':'','relation_join_no':'','relation_join_no_dlg_title':'','relationship':'','require_force_level':'','resign':'','response':'','responsedandsummon':'','revenge':'','revenge result preview':'','revenge_result_title_fail':'','revenge_result_title_win':'','revolt':'','revolt_cancel':'','revolt_lose':'','revolt_succ':'','reward':'','rm':'','salary_only_owner':'~~','search':'','seize':'','seize_evacuate':'','seize_lose':'','seize_succ':'','seizing_phase_cancel':'','select_assign_title':'','send_already':'','send_apply':'','send_weibo':'','set_resttime_sucess':'','share_grain':'','submission':'','submission_succ':'','submissioned':'','sum_tax':'','summon':'','sure_exchange':'','tax_rate':'','tax_rate_adjust':'','time_tip_for_own_battle':'','tip1':'~~','title':'','to_msg':'','turning_point_condition':'','uniterebel':'','uniterebel_attack_disband':'','uniterebel_attack_explanation':'','uniterebel_attack_lose':'','uniterebel_attack_lose_content':'','uniterebel_attack_win':'','uniterebel_attack_win_content':'','uniterebel_attacker_win_momentum':'','uniterebel_defence_disband':'','uniterebel_defence_explanation':'','uniterebel_defence_lose':'','uniterebel_defence_lose_content':'','uniterebel_defence_retreat_answer':'','uniterebel_defence_win':'','uniterebel_defence_win_content':'','uniterebel_defenceer_win_momentum':'','uniterebel_fail':'','uniterebel_fail_forcerest':'','uniterebel_num':'','uniterebel_retreat_tip':'','unlock_level':'{{:level}}','until':'','update':'','update_force':'','update_grain':'','update_only_owner':'~~','update_succ_weibo':'##{{:name}}{{:level}}','update_tip':'','usurp':'','usurp_assist_notice':'','usurp_attack_disband':'','usurp_attack_explanation':'','usurp_attack_lose':'','usurp_attack_lose_content':'','usurp_attack_terminated':'','usurp_attack_win':'','usurp_attack_win_content':'','usurp_attacker_win_momentum':'','usurp_battle_tip':'','usurp_def_notice':'','usurp_defence_disband':'','usurp_defence_explanation':'','usurp_defence_lose':'','usurp_defence_lose_content':'','usurp_defence_terminated':'','usurp_defence_win':'','usurp_defence_win_content':'','usurp_defenceer_win_momentum':'','usurp_description':'','usurp_fail':'','usurp_fail_forcerest':'','usurp_preview_tip':'','usurp_tip':'','usurp_war_help':'','usurp_war_help_subhead':'','usurp_war_help_title':'','usurp_war_notice':'','usurp_war_tip':'','vice_chairman':'','view member':'','view_battle_array':'','vm':'','win_lodgment_with_defender':'{{:defendername}}{{:lodgment}}','win_lodgment_without_defender':'{{:lodgment}}',},'zh_cn':{'adjust':'','adjust_official':'','adjust_tax_rate':'','adjust_time_input_err':'~~','adjust_time_input_update':'~~','adjust_times':' <span>{{:time1}}</span>  <span>{{:time2}}</span>','adjust_times_auth':'~','adjust_times_tips1':'~~<br/><br/>','adjust_times_tips2':'<br/>10','adjust_times_title':'','after_leave':'','alert_cooling_time_battle':'<br>24','alert_cooling_time_if_leave':'<br>{{:cooling}}','all_chanllenge_get':'&#149','alliance':'','alliance_description':'','allied':'','ally':'','ally_apply_expire':'','ally_cancel':'','ally_friend':'','ally_info':'','ally_succ':'','ally_success':'~{{:name}}~','already_ally':'','already_join_tip':'~{{:name}}~','appellate_resign_apply':'','applicant_cd_time_not_enough':'','armygrain':'','assign_title':'','assignbuff':'','assistAlliance_defenceer_win_momentum':'<br/>','assistAlliance_lose_content':'{{:sibling}}{{:opponent_force}}','assistAlliance_win_content':'{{:sibling}}{{:opponent_force}}TA','assistSlave_defenceer_win_momentum':'<br/>','assistSlave_lose_content':'{{:sibling}}{{:opponent_force}}','assistSlave_win_content':'{{:sibling}}{{:opponent_force}}TA','assist_lose':'','assist_win':'','base_info':'','battle':'','battle_fail':'','battle_fail_forcerest':'~TA~','battle_food':'','be_boycott':'','be_capitulate':'','be_rebel':'','be_revolted':'','be_seized':'','be_uniterebel':'','be_usurp':'','boycott':'','boycott_cancel':'','boycott_lose':'','boycott_succ':'','break_alliance':'','call_toge_member':'','can_as_title_count':'','can_not_ally':'','can_not_boycott':'','can_not_submission':'','cancel_ally':'','cannot_abandon_your_brother':'','cannot_adjust_more_official':'{{:official}}','cannot_adjust_owner':'~50~','cannot_allocatetitle':'','cannot_change':'','cannot_do_it':'','capitulate':'','capitulate_beforeend':'','capitulate_declaration':'~{{:name}}~','capitulate_description':'','capitulate_subhead':'~','capitulate_succ':'','capture':'','capture_again':'','capture_default_message':'','capture_lodgment':'{{:name}}','capture_lose':'','capture_win':'','chairman':'[<span class="highlight">{{:title}}</span>]<b>{{:name}}</b>','challenge_cost':'','chat':'','collect_tax':'','con_capitulate':'','con_capitulated':'','contact':'','continue_exchange':'','cost_grain':'','cost_rm':'','count_challenge':'','count_member':'','count_officer_1':'','count_officer_2':'','count_officer_3':'','counterattack':'','crazywar_attack_retreat_answer':'~{{:action}}','crazywar_defence_retreat_answer':'{{:opponent_force}}','crazywar_retreat_question':'~{{:forcename}}{{:action}}','create_force':'','create_free':'','create_pay':'','create_succ':'','create_succ_tip':'{{:name}}~','create_succ_weibo':'##{{:name}}','create_tip':'','create_use_rebirth':'68~','current_level':'{{:level}}','default_chat_message':'','defence_lose':'','defence_succ':'','defense_lose':'','defense_resign':'','defense_succ':'','deleted':'','deny_apply':'~{{:name}}','deny_boycott':'~{{:name}}','deny_capitulate':'','deny_capture':'~{{:name}}','deny_resign_apply':'~{{:name}}TA','depose':'','do_with_member':'{{:honor}}<span class=\"overstriking\">{{:name}}</span>','edit_force_fobbiden':'~~','electioneer_officer':'','electioneer_officer_lose':'','electioneer_officer_succ':'','empty':'','empty_notice_default_text':'','enemy force':'','event':'','exchange':'','exchange_again':'','exchange_failed_content':'~','exchange_failed_title':'','exchange_successful_content':'~<br/>--~','exchange_successful_content2':'~<br/>-~','exchange_successful_title':'','exchange_warning_content':'~','exchange_warning_title':'','expiretime_coming':'','expiretime_coming_message':'','explanation_content':'<br>0<br>','fail_to_do':'','fight':'','food_description':'','force':'','force_alliance':'[]','force_appling':'','force_apply':'','force_apply_fail':'','force_become_slave':'~{{:name}}','force_become_slave_seize_lose':'~{{:name}}<br>{{:name2}}','force_boss_challenge':'','force_boss_challenge_attack_default_msg':'','force_boss_challenge_attack_preview_cost':'','force_boss_challenge_attack_preview_header':'~','force_boss_challenge_attack_preview_lose':'100~2005~10','force_boss_challenge_attack_preview_not':'','force_boss_challenge_attack_preview_speedup':'','force_boss_challenge_attack_preview_win':'200~30010~15','force_boss_challenge_attack_reattack':'','force_boss_challenge_attack_rm':'~','force_boss_challenge_cd':'{{:time}}','force_boss_challenge_cd_content':'~~','force_boss_challenge_detail':'','force_boss_challenge_detail_content':'<br><br>1<br><br>0<br><br><br>60<br><br><br><br><br><br>5<br>','force_boss_challenge_detail_dlg':'','force_boss_challenge_exchange_answer':'','force_boss_challenge_exchange_fail':'','force_boss_challenge_exchange_reason':'','force_boss_challenge_final_des1':'{{:level}}{{:name}}{{:num}}','force_boss_challenge_final_des2':'{{:level}}{{:name}}{{:num}}{{:num2}}','force_boss_challenge_final_des3':'-5','force_boss_challenge_final_des4':'~{{:level}}{{:name}}~','force_boss_challenge_final_des5':'{{:level}}{{:name}}{{:num}}5','force_boss_challenge_final_goexchange':'','force_boss_challenge_final_goexchange2':'','force_boss_challenge_final_lose':'','force_boss_challenge_final_win':'','force_boss_challenge_final_win2':'','force_boss_challenge_final_win_grain':'','force_boss_challenge_freetimes':'{{:times}}','force_boss_challenge_help_content':'','force_boss_challenge_help_title':'','force_boss_challenge_hint_text':'','force_boss_challenge_lack_rm':'~','force_boss_challenge_lack_title':'','force_boss_challenge_lack_vm':'~','force_boss_challenge_limit':'{{:num}}','force_boss_challenge_limit2':'{{:num}}','force_boss_challenge_msg_content':'{{:name}}{{:num}}{{:boss}}','force_boss_challenge_msg_content2':'{{:time}}','force_boss_challenge_no_right':'~','force_boss_challenge_no_right2':'~~','force_boss_challenge_notice':'5~','force_boss_challenge_notice2':'100~3005~15~','force_boss_challenge_preview_choose_niudan':'5','force_boss_challenge_preview_cost':'','force_boss_challenge_preview_header':'~','force_boss_challenge_preview_niudan1':'','force_boss_challenge_preview_niudan2':'','force_boss_challenge_preview_niudan3':'','force_boss_challenge_preview_niudan4':'','force_boss_challenge_preview_niudan5':'','force_boss_challenge_preview_niudan6':'','force_boss_challenge_preview_niudan7':'','force_boss_challenge_profile':'{{:name}}{{:time}}<br>{{:num}}<br>{{:defencemin}}~{{:defencemax}}<br><br>{{:skill}}','force_boss_challenge_reward':'','force_boss_challenge_reward_des':'{{:num}}{{:name}}','force_boss_challenge_reward_des2':'{{:level}}{{:name}}','force_boss_challenge_reward_get':'','force_boss_challenge_reward_get2':'','force_boss_challenge_reward_killboss':'','force_boss_challenge_speed_fail_title':'','force_boss_challenge_start':'','force_boss_challenge_start2':'','force_boss_challenge_start3':'','force_boss_challenge_start4':'','force_boss_challenge_start5':'','force_boss_challenge_tip_content':'{{:opponent_force}}','force_boss_flee_time':'{{:time}}','force_boss_left':'{{:num}}/{{:wholenum}}','force_boss_name_level':'{{:name}}<span class="challenge-highlight">({{:level}})</span>','force_boss_name_level2':'{{:name}}{{:level}}','force_capitulate_fail':'','force_contribute_not_enough':'{{:force_level}}{{:contribute}}~~','force_create_failed':'','force_create_ok':'','force_disband':'','force_dismiss':'','force_empty':'','force_event_alliance_notice':'','force_exchange_unavailable':'~~','force_exchange_unavailable_forceboss':'~~','force_free':'[]','force_grain':'','force_invite':'','force_join_no':'{{:level}}~','force_join_ok':'{{:level}}','force_level':'','force_level_is_not_enough':'','force_level_not_enough':'','force_level_not_enough_msg':'~TA','force_level_too_low':'~~','force_list_limit':'~100~','force_list_more':'~~','force_master':'[]','force_message':'','force_name':'{{:force_name}}','force_name_empty':'','force_name_empty1':'','force_name_max':'5','force_num':'/{{:count}}','force_owner':'','force_search_noresult':'','force_slave':'[]','force_vice_owner':'','force_war':'','force_war_tip':'~','force_war_tip2':'{{:contribute}}~','force_war_tip3':'','forcebuff':'','forcewar_action':'','forcewar_alliancemember':'','forcewar_battle':'','forcewar_battle_action':'','forcewar_battle_notice':'{{:opponent_force}} ({{:battle_schedule}}) - {{:battle_time}}','forcewar_battle_preview':'','forcewar_battle_start':'','forcewar_change':'','forcewar_communion':'','forcewar_defence_notice':'','forcewar_defense':'','forcewar_disband_content':'<br/>','forcewar_element_assistforce':'','forcewar_element_captured':'','forcewar_element_defence':'','forcewar_element_expiretime':'','forcewar_element_force':'','forcewar_element_general':'','forcewar_element_group':'','forcewar_element_hascaptured':'','forcewar_element_position':'{{:index}}  ','forcewar_enemy':'','forcewar_enemy_grain':'','forcewar_enemy_level':'{{:index}}  ','forcewar_enemy_mem':'{{:current_mem}}/{{:total_mem}}','forcewar_enemy_notice':'10','forcewar_enemy_owner':'[{{:owner_title}}] {{:owner_name}}','forcewar_hasborrowmember':' ','forcewar_help':'','forcewar_help_content':'','forcewar_help_title':'','forcewar_lose':'','forcewar_lose_content':'{{:forcename}}','forcewar_lose_grain':'{{:forcename}}{{:grain}}','forcewar_march_header':'','forcewar_no_battle':':{{:challenge}}/{{:challenge_limit}}','forcewar_notice_members':'{{:ownername}}{{:forcename}}{{:content}}','forcewar_notice_members1':'[<span>{{:title}}</span>]{{:ownername}}{{:forcename}}','forcewar_only_owner_change_defender':'~~','forcewar_only_owner_start':'~','forcewar_preview':'','forcewar_retreat':'','forcewar_retreat_content':'{{:forcename}}~','forcewar_retreat_question':'','forcewar_retreat_tip':'~~','forcewar_start_content':'<br/><br/><br/><br/><br/><br/><br/><br/>','forcewar_start_title':'','forcewar_tip_content':'{{:opponent_force}}10','forcewar_tip_title':'','forcewar_win':'','forcewar_win_commend':'<br/>','forcewar_win_content':'{{:forcename}}<br/>','forcewar_win_grain':'{{:forcename}}{{:grain}}','foreign':'','formation detail':'','free_only_owner_can_ask_alliance':'~~','free_only_ownerorvice_can_ask_surrender':'~~','free_only_ownerorvice_can_start_battle':'~','from':'','gained':'','get_officer':'','get_out_of_force':'','get_out_of_force_content':'','get_title':'','go':'','go_internal':'','goaway':'','grain':'','grain_contribute':'','grain_cost':'','grain_donate':'','grain_input_err':'~~','grain_not_enouph':'~~','grain_not_input':'~~','grain_share_cd':'3~','grain_share_cdtip':'','grain_share_confirm':'~','grain_share_fail':'~~','grain_succ':'~','graun_share_cd_no':'~~','has_captured':'','has_in_force':'~TA~','have_armygrain':'','have_grain':'{{:grain}}{{:safe_grain}}','help revenge':'','help_defense_member_change':'','help_defense_time_finish':'','hour':'','how_to_adjust_official':'{{:honor}}{{:name}}','in_force_rest':'','in_war':'','info':'','info_board':'','info_level':'','info_member':'','info_member1':'','info_owner':'','info_vice_owner':'','input_message_call_toge':'~','internal':'','is_submission':'','its_alliance':'TA','its_master':'TA','its_slave':'TA','join_already':'','join_apply':'','join_apply_force':'','join_event_privilege':'~','join_force':'','join_slogen':'','lake_grain':'','last_grain':'','leve_updated':'{{:level}}','level':': ','level_full':'','level_full_tip':'','levelinfo':'{{:level}}','login':'','lose_lodgment_defender':'{{:defendername}}{{:lodgment}}','lose_officer':'','lose_title':'','march_content_rebel_attack':'{{:forcename}}<br/>30<br/><br/><br/>','march_content_rebel_defence':'30<br/><br/><br/>','march_content_uniterebel_attack':'{{:forcename}}<br/>30<br/><br/><br/><br/>','march_content_uniterebel_defence':'<br/>30<br/><br/><br/>','march_content_usurp_attack':'{{:forcename}}<br/>30<br/><br/><br/>','march_content_usurp_defence':'<br/>30<br/><br/><br/>','march_expiretime_rebel_attack':'{{:expiretime}}{{:forcename}}','march_expiretime_rebel_defence':'{{:forcename}}{{:expiretime}}','march_expiretime_uniterebel_attack':'{{:expiretime}}{{:forcename}}','march_expiretime_uniterebel_defence':'{{:forcename}}{{:expiretime}}','march_expiretime_usurp_attack':'{{:expiretime}}{{:forcename}}','march_expiretime_usurp_defence':'{{:forcename}}{{:expiretime}}','master_slave_num':'{{:slavenum}}/{{:maxslavenum}}','member':'','member_contact':'','member_count':'','member_count1':'{{:now}}/{{:max}}','member_count_txt':'','member_empty':'','member_full':'','member_max':'','member_more':'','more':'','more_force':'','name':'','need_rm':'','next_chanllenge_get':'&#149','nextday':'','no enemy force':'','no_allocatebuff':'~~','non_rmb_player_add_defense':'{{:percent}}%','non_rmb_player_assist_attack':'','non_rmb_player_assist_defense':'','non_rmb_player_assist_result':'{{:name}}{{:percent}}%55','non_rmb_player_defense_data':'({{:percent}}%)','non_rmb_player_sub_defense':'{{:percent}}%','none':'','not_resign_apply':'','not_this_member':'','notice':'','notice_default_text1':'##','notice_default_text2':'##','notice_default_title1':'','notice_default_title2':'','notice_edit_btn':'','notice_title':'','offer':'','offer1':'','officer_first':'','officer_second':'','officer_third':'','official1':'','official100':'','official2':'','official3':'','official4':'','official5':'','ok_submission':'','only_official_can_refresh':'','order':'{{:order}}','order_condition':'','order_force':'','other':'','other_prefect_message':'','out':'','out_force':'','out_force_message':'{{:honor}}{{:name}}TA','out_force_tip':'','over':'','owner':'[<span class=\"official\">{{:title}}</span>]{{:name}}','owner_title':'','pass_resign_apply':'~{{:name}}TA','personal_grain_amount':'{{:amount}}','position_count':'','position_empty':'','prefect_be_seized':'','prefect_count':'','prefect_message':'','prefect_revolt':'','price':'','prince_message':'','profile_level':'','ranking':'','rebel':'','rebel_attack_disband':'','rebel_attack_explanation':'<br>','rebel_attack_lose':'','rebel_attack_lose_content':'{{:opponent_force}}','rebel_attack_win':'','rebel_attack_win_content':'{{:opponent_force}}<br><br>{{:players}}','rebel_attacker_win_momentum':'<br/>','rebel_defence_disband':'','rebel_defence_explanation':'<br>','rebel_defence_lose':'','rebel_defence_lose_content':'{{:opponent_force}}','rebel_defence_win':'','rebel_defence_win_content':'{{:opponent_force}}','rebel_defenceer_win_momentum':'<br/>','rebel_fail':'','rebel_fail_forcerest':'~TA~','rebel_over':'','rebirth_not_enouph':'~','rebirth_not_enouph_title':'','rebirth_now_have':'{{:num}}','rece_invite':'','receive_capitulate':'','refresh':'','refresh_award':'','refresh_award1':'','refresh_cost':'','refresh_fail':'','refresh_fail_tip':'~~','refresh_info1':'','refresh_info3':'({{:cost}}{{:yb}}{{:point}})','refresh_info4':'{{:official}}{{:name}}<br>()','refresh_internal_mission':'','refresh_text':'24','relation':'','relation_disband':'','relation_join_no':'{{:level}}~','relation_join_no_dlg_title':'','relationship':'','require_force_level':'','resign':'','response':'','responsedandsummon':'~{{:name}}~<br>','revenge':'','revenge result preview':'','revenge_result_title_fail':'','revenge_result_title_win':'','revolt':'','revolt_cancel':'','revolt_lose':'','revolt_succ':'','reward':'','rm':'','salary_only_owner':'~~','search':'','seize':'','seize_evacuate':'','seize_lose':'','seize_succ':'','seizing_phase_cancel':'','select_assign_title':'{{:honor}}{{:name}}','send_already':'','send_apply':'','send_weibo':'','set_resttime_sucess':'','share_grain':'','submission':'','submission_succ':'','submissioned':'','sum_tax':'','summon':'','sure_exchange':'','tax_rate':'','tax_rate_adjust':'','time_tip_for_own_battle':'{{:time}}~','tip1':'','title':'','to_msg':'','turning_point_condition':'','uniterebel':'','uniterebel_attack_disband':'{{:sibling}}','uniterebel_attack_explanation':'<br>','uniterebel_attack_lose':'','uniterebel_attack_lose_content':'{{:sibling}}{{:opponent_force}}','uniterebel_attack_win':'','uniterebel_attack_win_content':'{{:sibling}}{{:opponent_force}}<br><br>{{:players}}','uniterebel_attacker_win_momentum':'<br/>','uniterebel_defence_disband':'','uniterebel_defence_explanation':'<br>','uniterebel_defence_lose':'','uniterebel_defence_lose_content':'{{:opponent_force}}','uniterebel_defence_retreat_answer':'{{:opponent_force}}','uniterebel_defence_win':'','uniterebel_defence_win_content':'{{:opponent_force}}','uniterebel_defenceer_win_momentum':'<br/>','uniterebel_fail':'','uniterebel_fail_forcerest':'~TA~','uniterebel_num':'','uniterebel_retreat_tip':'~~','unlock_level':'{{:level}}','until':'&nbsp; ','update':'','update_force':'','update_grain':'','update_only_owner':'~~','update_succ_weibo':'##{{:name}}{{:level}}','update_tip':'','usurp':'','usurp_assist_notice':'{{:opponent_force}} ({{:battle_schedule}})','usurp_attack_disband':'','usurp_attack_explanation':'<br>','usurp_attack_lose':'','usurp_attack_lose_content':'{{:opponent_force}}','usurp_attack_terminated':'~~','usurp_attack_win':'','usurp_attack_win_content':'{{:opponent_force}}TA~<br><br>{{:players}}','usurp_attacker_win_momentum':'<br/>','usurp_battle_tip':'','usurp_def_notice':'{{:opponent_force}} ({{:battle_schedule}})','usurp_defence_disband':'','usurp_defence_explanation':'<br>','usurp_defence_lose':'','usurp_defence_lose_content':'{{:opponent_force}}','usurp_defence_terminated':'~~','usurp_defence_win':'','usurp_defence_win_content':'{{:opponent_force}}','usurp_defenceer_win_momentum':'<br/>','usurp_description':'','usurp_fail':'','usurp_fail_forcerest':'~TA~','usurp_preview_tip':'~','usurp_tip':'~2','usurp_war_help':'','usurp_war_help_subhead':'~','usurp_war_help_title':'','usurp_war_notice':'{{:opponent_force}} ({{:battle_schedule}})','usurp_war_tip':'~{{:opponent_force}}<br><br>2{{:opponent_force}}<br>2<br>30','vice_chairman':'','view member':'','view_battle_array':'','vm':'','win_lodgment_with_defender':'{{:defendername}}{{:lodgment}}','win_lodgment_without_defender':'{{:lodgment}}',},};})(window,jQuery);;(function(w,$,undefined){w.Mojo=w.Mojo||{};var g=w.Mojo.app=w.Mojo.app||{};g.baseUrl='/mojo';g.isNd=false;g.data=g.data||{entityCategory:{groups:[],types:[],rarities:[],orders:[],},};g.pageParams=g.pageParams||{};g.redirect=function(url,params,track,obj,action,remark){var u=url+((params!=undefined||track!=undefined)?"?":"");for(key in params){u+=(key+"="+params[key]+"&");}
if(track!=undefined){var prefix='__track_'+track+'_';if(obj!=undefined){u+=(prefix+'object__='+obj);if(action!=undefined){u+=('&'+prefix+'action__='+action);if(remark!=undefined){u+=('&'+prefix+'remark__='+remark);}}}}
w.location.href=g.baseUrl+u;};g.request=function(params){var url=location.href;var str=url.substring(url.indexOf('?')+1,url.length).split('&');var obj={};for(i=0;j=str[i];i++){obj[j.substring(0,j.indexOf('=')).toLowerCase()]=j.substring(j.indexOf('=')+1,j.length);}
var val=obj[params.toLowerCase()];if(typeof(val)=='undefined'){return'';}else{return val;}};g.booleanStorage=function(key,value){if(value==undefined){return localStorage[key]==undefined||localStorage[key]==1;}
localStorage[key]=value?1:0;};g.saveStorage=function(key,value){if(!window.localStorage){return false;}
localStorage[key]=value;};g.getStorage=function(key){if(!window.localStorage){return false;}
return localStorage[key];};g.clearStorage=function(){if(!window.localStorage){return false;}
localStorage.clear();};g.getUserLanguage=function(){var lang=g.getStorage('user_language');if(lang==undefined||lang==''){if(g.data.userLanguage==undefined||g.data.userLanguage==null||g.data.userLanguage==''){lang='zh_cn';}else{lang=g.data.userLanguage;}}
return lang;};g.getServerNode=function(){if(g.getStorage('single_server')=='true'||g.isNewVersion()==false)return null;if(g.serverNode!=undefined){var server=g.serverNode;if(server.regionId==server.userRegionId){server.signal='good';}else{var r=Math.random()*100;if(r<50)server.signal='bad';else server.signal='normal';}
if(parseInt(server.regionId)==1){server.platform=Mojo.utils.locale('common','weibo');}else{server.platform=Mojo.utils.locale('common','facebook');}
switch(parseInt(server.groupId)){case 1:server.flag='new';break;case 2:server.flag='hot';break;case 3:server.flag='simple';break;case 4:server.flag='full';break;case 5:server.flag='expire';break;default:server.flag='simple';break;}
return server;}
return null;};g.isNewVersion=function(){if(g.data.userLanguage=='ko_kr')
return true;var isNew=g.getStorage('is_new_version');var v;if(isNew==undefined||g.clientVersion!=undefined){if(g.isNd){v='1.0.1';}else{v='1.2';}
var oldArr=v.split('.');if(g.clientVersion!=undefined){var arr=g.clientVersion.split('.');for(var i=0;i<arr.length;i++){if(i>=oldArr.length||arr[i]>oldArr[i]){g.saveStorage('is_new_version',true);return true;}else if(arr[i]==oldArr[i]){continue;}else{break;}}}
return false;}
if(isNew!=undefined)return true;};g.isNewClientVersion=function(){var client_v=Mojo.app.clientVersion;var new_v=Mojo.app.newClientVersion;if(client_v&&new_v){if(client_v==new_v){return true;}
client_v=(client_v.toString().replace(/\./g,''));new_v=(new_v.toString().replace(/\./g,''));if(new_v.length<client_v.length){new_v=(Math.pow(10,client_v.length-new_v.length))*parseInt(new_v);}else{new_v=parseInt(new_v);}
if(parseInt(client_v)>=new_v){return true;}}
return false;};g.getPlatform=function(){var region=Mojo.app.getStorage('user_region');if(region=='overseas'||g.data.userLanguage=='ko_kr'||g.data.userLanguage=='zh_tw'){return'facebook';}else{return'sina';}},g.bgSound=function(value){return g.booleanStorage('settings-bg-sound',value);};g.effectSound=function(value){return g.booleanStorage('settings-effect-sound',value);};g.battleAnimation=function(value){return g.booleanStorage('settings-battle-animation',value);};g.splash=function(value){return g.booleanStorage('settings-splash',value);};g.currentPage=undefined;g.refreshCurrentProfile=function(){if(g.currentPage!=undefined){g.currentPage.refreshProfile();}};g.facebook={};g.facebook.call=function(func){if(window.FB){Mojo.app.facebook.init(Mojo.app.fbparams);func(window.FB);}else{if(!window.fbAsyncInit){window.fbAsyncInit=function(){Mojo.app.facebook.init(Mojo.app.fbparams);func(window.FB);};}
var js,id='facebook-jssdk',ref=document.getElementsByTagName('script')[0];if(document.getElementById(id)){Mojo.app.facebook.init(Mojo.app.fbparams);func(window.FB);}else{js=document.createElement('script');js.id=id;js.async=true;js.src="//connect.facebook.net/en_US/all.js";ref.parentNode.insertBefore(js,ref);}}};g.facebook.init=function(params){if(!window.FB){return;}
if(Mojo.app.hasInitFacebookSDK==true){return;}
Mojo.app.hasInitFacebookSDK=true;FB.init(params);};g.facebook.login=function(){var index=w.location.href.indexOf('?');if(index>0){callback_url=w.location.href.substring(0,index);}else{callback_url=w.location.href;}
var u="https://www.facebook.com/dialog/oauth"+"?";u+=("client_id="+Mojo.app.data.facebookAppId+"&");u+=("redirect_uri="+callback_url+"&");u+=("response_type="+"token"+"&");u+=("scope="+"publish_stream"+"&");w.location.href=u;};g.facebook.logout=function(callback){Mojo.app.facebook.call(function(FB){FB.getLoginStatus(function(response){if(response.authResponse){FB.logout(callback);}else{callback();}});});};g.weibo={};g.weibo.login=function(){var index=w.location.href.indexOf('?');if(index>0){callback_url=w.location.href.substring(0,index);}else{callback_url=w.location.href;}
callback_url=callback_url+"?";var u="https://api.weibo.com/oauth2/authorize"+"?";u+=("client_id="+g.weibo.appKey+"&");u+=("redirect_uri="+callback_url+"&");u+=("response_type="+"token"+"&");u+=("display="+g.weibo.display+"&");w.location.href=u;};g.weibo.logout=function(options){_options={access_token:'',errorFunc:$.noop,successFunc:$.noop,failedFunc:$.noop,};$.extend(_options,options);$.ajax({url:"https://api.weibo.com/2/account/end_session.json",cache:false,dataType:"jsonp",type:"get",data:{access_token:_options.access_token,},error:function(){_options.errorFunc();},success:function(data,textStatus,jqXHR){if(data.code==1){_options.successFunc(data.data);}else{_options.failedFunc();}},});};g.weibo.showUser=function(options){_options={access_token:'',uid:0,errorFunc:$.noop,successFunc:$.noop,failedFunc:$.noop,};$.extend(_options,options);$.ajax({url:"https://api.weibo.com/2/users/show.json",cache:false,dataType:"jsonp",type:"get",data:{access_token:_options.access_token,uid:_options.uid,},error:function(){_options.errorFunc();},success:function(data,textStatus,jqXHR){if(data.code==1){_options.successFunc(data.data);}else{_options.failedFunc();}},});};g.weibo.statusesUpdate=function(options){_options={access_token:'',status:'',errorFunc:$.noop,successFunc:$.noop,failedFunc:$.noop,};$.extend(_options,options);$.ajax({url:"https://api.weibo.com/2/statuses/update.json",cache:false,dataType:"json",type:"post",data:{access_token:_options.access_token,status:_options.status,},error:function(){_options.errorFunc();},success:function(data,textStatus,jqXHR){if(data.code==1){_options.successFunc();}else{_options.failedFunc();}},});};g.weibo.statusesUpdateWithImage=function(options){_options={access_token:'',status:'',errorFunc:$.noop,successFunc:$.noop,failedFunc:$.noop,};$.extend(_options,options);$.ajax({url:"https://api.weibo.com/2/statuses/upload_url_text.json",cache:false,dataType:"json",type:"post",data:{access_token:_options.access_token,status:_options.status,url:_options.url,},error:function(){_options.errorFunc();},success:function(data,textStatus,jqXHR){if(data.code==1){_options.successFunc();}else{_options.failedFunc();}},});};g.weibo.friendshipsShow=function(options){_options={access_token:'',source_id:'',target_id:'',errorFunc:$.noop,successFunc:$.noop,failedFunc:$.noop,};$.extend(_options,options);$.ajax({url:"https://api.weibo.com/2/friendships/show.json",cache:false,dataType:"jsonp",type:"get",data:{access_token:_options.access_token,source_id:_options.source_id,target_id:_options.target_id,},error:function(){_options.errorFunc();},success:function(data,textStatus,jqXHR){if(data.code==1){_options.successFunc(data.data);}else{_options.failedFunc();}},});};g.weibo.friendshipsCreate=function(options){_options={access_token:'',uid:'',errorFunc:$.noop,successFunc:$.noop,failedFunc:$.noop,};$.extend(_options,options);$.ajax({url:"https://api.weibo.com/2/friendships/create.json",cache:false,dataType:"json",type:"post",data:{access_token:_options.access_token,uid:_options.uid,},error:function(){_options.errorFunc();},success:function(data,textStatus,jqXHR){if(data.code==1){_options.successFunc();}else{_options.failedFunc();}},});};g.toast=g.toast||{show:function(text,timeout,init){var tm=timeout||2000;var self=this;if(this._status==0){if(init){this._element.hide();}else{this._element.show();}
this._element.appendTo($(document.body)).css({zIndex:2000}).html(text);this._status=1;}else{w.clearTimeout(this._timer);this._element.html(text);}
Mojo.utils.bottom(this._element);this._timer=w.setTimeout(function(){self._hide();},tm);},_hide:function(){var self=this;self._element.fadeOut('slow',function(){self._element.remove();self._status=0;});},_element:$('<div class="toast"></div>'),_status:0,_timer:0,};g.tutorial=undefined;g.dialog=undefined;})(window,jQuery);;(function(w,$,undefined){w.Mojo=w.Mojo||{};w.Mojo.getAccessToken=function(callback){w.Mojo._ajax('/player/accessToken?v='+new Date().getTime(),{},function(response){if(response.errorCode==0){if(response.data.accessToken){Mojo.app.saveStorage('accessToken',response.data.accessToken);}
if(callback!==undefined&&callback!=null&&callback instanceof Function){callback(response);}}else{Mojo.app.toast.show(response.errorMsg);}});}
var g=w.Mojo.ajax=function(url,params,callback,onError,options){var loginCookie=Mojo.utils.getCookie('bfff9d71bbba80d88def25ce6c5988b1');var accessToken=Mojo.app.getStorage('accessToken');if(loginCookie&&!accessToken){w.Mojo.getAccessToken(function(){w.Mojo._ajax(url,params,callback,onError,options);});}else{w.Mojo._ajax(url,params,callback,onError,options);}};w.Mojo._ajax=function(url,params,callback,onError,options){if(options&&options.showWait===true){Mojo.utils.showWait(true);}
var lang=Mojo.app.getUserLanguage();$.ajax({url:g.baseUrl+"/ajax"+url,cache:false,dataType:"json",type:"post",data:params,timeout:20000,headers:{gamelanguage:lang,Signature:localStorage['mojo_sign'],'Mojo-A-T':Mojo.app.getStorage('accessToken')||''},error:function(jqXHR,textStatus,errorThrown){if(options&&options.showWait===true){Mojo.utils.showWait(false);}
if(options&&options.showToast==false){}else{Mojo.app.toast.show(Mojo.utils.locale('common','bad network'));}
if(Mojo.app.tutorial=="__NAV__"){Mojo.gap.highlightMenuItem(-1);}else if(typeof(Mojo.app.tutorial)=="object"&&Mojo.app.tutorial.close){Mojo.app.tutorial.close(true);}
if(onError!=undefined&&onError!=null){onError();}},success:function(data,textStatus,jqXHR){if(jqXHR){var accessToken4Header=jqXHR.getResponseHeader('MOJO_A_T');if(accessToken4Header){accessToken4Header=Mojo.utils.trim(accessToken4Header);Mojo.app.saveStorage('accessToken',accessToken4Header);}}
if(options&&options.showWait===true){Mojo.utils.showWait(false);}
if(data&&data.errorCode===140002){Mojo.app.redirect('/default/logout/isMultiLogin/yes');}else if(callback!==undefined&&callback!=null){callback(data);}
if(data&&data.event!=undefined&&data.event!=null){for(index in data.event){var evt=data.event[index];if(evt.name=='level.up'){Mojo.gap.levelupAnimationPlay();w.setTimeout(function(evt){(new Mojo.com.LevelUpDialog(evt.data,data)).open();},500,evt);}else if(evt.name=='weibo.create'&&evt.expire==0){if(evt.data.manual_mode==0){w.setTimeout(function(evt){(new Mojo.com.WeiboPublishDialog({access_token:evt.data.access_token,},{defaultText:evt.data.content,appendix:evt.data.download_url,})).open();},500,evt);}}else if(evt.name=='facebook.create'&&evt.expire==0){if(evt.data.manual_mode==0){w.setTimeout(function(evt){(new Mojo.com.FacebookFeedDialog({access_token:evt.data.access_token,},{defaultTitle:evt.data.title,defaultText:evt.data.content,appendix:evt.data.download_url,})).open();},500,evt);}}}}}});}
g.baseUrl='/mojo';})(window,jQuery);;(function(w,$,undefined){w.Mojo=w.Mojo||{};var g=w.Mojo.gap=w.Mojo.gap||{};w.Mojo.gap.Bridge=Class.extend({init:function(options){this._options=$.extend(true,{device:'',bgSound:true,effectSound:true,},options||{});},_execNativeCode:function(){},soundPlay:function(file,loop,type){},soundStop:function(){},battleAnimationPlay:function(player_army,opponent_army){},niudanAnimationPlay:function(rarity){},intensifyAnimationPlay:function(){},levelupAnimationPlay:function(){},compositeAnimationPlay:function(){},purchase:function(channelId,itemId,userId,friendId,params){},settings:function(domain,enabled){},highlightMenuItem:function(index){},tutorialCallback:function(index){},rechargeCallback:function(){},clearCache:function(){},bindUser:function(userId){},showMallIcon:function(){},hideMallIcon:function(){},openTpCenter:function(){},openFeedbackCenter:function(){},selectServer:function(server){},setLanguage:function(language){},getClientVersion:function(){this._execNativeCode('system/clientversion');},clientVersionCallback:function(){},openurl:function(url){},bindPlayerIdToDevice:function(){},clearlogincookie:function(){},showbattleskip:function(){},sharescenesession:function(){},sharescenetimeline:function(){},updateAfterLogin:function(){},});w.Mojo.gap.IOSBridge=w.Mojo.gap.Bridge.extend({init:function(options){this._super(options);this.sendMessageQueue=[];this.uniqueId=1;this.responseCallbacks={};this.messageHandlers={};this._bridge=$('<iframe></iframe>').hide().attr('width','0px').attr('height','0px').attr('frameborder','0').appendTo($(document.body));},fetchQueue:function(){var messageQueueString=this.sendMessageQueue.join("__MOJO_MESSAGE_SEPERATOR__");this.sendMessageQueue=[];return messageQueueString;},handleMessageFromObjC:function(messageJSON){var self=this;setTimeout(function(){var message=JSON.parse(messageJSON);if(message.responseId){var responseCallback=self.responseCallbacks[message.responseId];if(!responseCallback){return;}
try{responseCallback(message.responseData)}finally{delete self.responseCallbacks[message.responseId];}}})},ajax:function(url,params,onSucc,onError){var stringParams={};for(var i in params){if(typeof params[i]!="string"&&params[i]!=undefined){stringParams[i]=params[i].toString();}else{stringParams[i]=params[i]}}
this._execNativeCode('system','ajax',[url,stringParams],function(response){var responseInJson=$.parseJSON(response);if(responseInJson.status==200){var o=$.parseJSON(responseInJson.body);onSucc(o);if(o&&o.event){for(var index in o.event){var evt=o.event[index];if('level.up'==evt.name){Mojo.gap.levelupAnimationPlay();window.setTimeout(function(evt){(new Mojo.com.LevelUpDialog(evt.data,o)).open();},500,evt);}else if('weibo.create'==evt.name&&evt.expire==0){if(evt.data.manual_mode==0){w.setTimeout(function(evt){(new Mojo.com.WeiboPublishDialog({access_token:evt.data.access_token},{defaultText:evt.data.content,appendix:evt.data.download_url})).open();},500,evt);}}else if(evt.name=='facebook.create'&&evt.expire==0){if(evt.data.manual_mode==0){w.setTimeout(function(evt){(new Mojo.com.FacebookFeedDialog({access_token:evt.data.access_token},{defaultTitle:evt.data.title,defaultText:evt.data.content,appendix:evt.data.download_url})).open();},500,evt);}}}}}else{onError(response.status,responseInJson.body);}});},_execNativeCode:function(service,action,params,callback){if(false===Mojo.app.isNewClientVersion()){var mojo_proto='mojo://'+service+'/'+action;if($.isArray(params)&&params.length>0){mojo_proto+='/'+params.join(',');}
this._bridge.attr('src',mojo_proto);return;}
var cmd={data:{service:service,action:action,params:params||[]}};if(callback){var callbackId='cb_'+(this.uniqueId++)+'_'+new Date().getTime();this.responseCallbacks[callbackId]=callback;cmd['callbackId']=callbackId;}
this.sendMessageQueue.push(JSON.stringify(cmd));this._bridge.attr('src','bridge://__MOJO_QUEUE_MESSAGE__');},soundPlay:function(file,loop,type){if(this._options.effectSound){type=type==undefined?'mp3':type;loop=loop==undefined?0:loop;this._execNativeCode('media','soundplay',[file,type,""+loop]);}},soundStop:function(){this._execNativeCode('media','soundstop');},battleAnimationPlay:function(player_army,opponent_army){if(player_army==undefined||player_army==null){playerImgs='null&null&null';}else if(player_army.length==3){playerImgs=player_army[0]+'&'+player_army[1]+'&'+player_army[2];}else if(player_army.length==2){playerImgs=player_army[0]+'&'+player_army[1]+'&'+'null';}else if(player_army.length==1){playerImgs='null'+'&'+player_army[0]+'&'+'null';}else{playerImgs='null&null&null';}
if(opponent_army==undefined||opponent_army==null){oppImgs='null&null&null';}else if(opponent_army.length==3){oppImgs=opponent_army[0]+'&'+opponent_army[1]+'&'+opponent_army[2];}else if(opponent_army.length==2){oppImgs=opponent_army[0]+'&'+opponent_army[1]+'&'+'null';}else if(opponent_army.length==1){oppImgs='null'+'&'+opponent_army[0]+'&'+'null';}else{oppImgs='null&null&null';}
this._execNativeCode('media','playBattleAnimation',[playerImgs,oppImgs]);},niudanAnimationPlay:function(rarity){this._execNativeCode('media','playNiudanAnimation',[""+rarity]);},intensifyAnimationPlay:function(){this._execNativeCode('media','playIntensifyAnimation');},levelupAnimationPlay:function(){},compositeAnimationPlay:function(){this._execNativeCode('media','playCompositeAnimation');},purchase:function(channelId,itemId,userId,friendId,params){Mojo.ajax('/mall/waitplayerrecharge',{rid:itemId});var payParams=[""+channelId,""+itemId,""+userId,""+friendId];if($.isArray(params)){for(var index in params){payParams.push(""+params[index]);}}
this._execNativeCode('iap','purchase',payParams);},settings:function(domain,enabled){if(domain=='bg-sound'){if(enabled==true){this._execNativeCode('media','enablebgmusic');}else{this._execNativeCode('media','disablebgmusic');}}else if(domain=='effect-sound'){if(enabled==true){this._execNativeCode('media','enableeffectsound');}else{this._execNativeCode('media','disableeffectsound');}}},highlightMenuItem:function(index){this._execNativeCode('tutorial','highlightmenuitem',[""+index]);},tutorialCallback:function(index){if(Mojo.app.tutorial!=undefined&&Mojo.app.tutorial!=null){Mojo.app.tutorial.done();}},rechargeCallback:function(){},clearCache:function(){this._execNativeCode('system','clearcache');},bindUser:function(userId){this._execNativeCode('system','binduser',[""+userId]);},showMallIcon:function(){this._execNativeCode('system','showmallicon');},hideMallIcon:function(){this._execNativeCode('system','hidemallicon');},openTpCenter:function(){this._execNativeCode('system','opentpcenter');},openFeedbackCenter:function(){this._execNativeCode('system','openfeedbackcenter');},selectServer:function(server){if(false===Mojo.app.isNewClientVersion()){server=server.replace(/:\/\//g,",").replace(/\//g,",");}
this._execNativeCode('system','selectserver',[server]);},setLanguage:function(language){this._execNativeCode('system','setlanguage',[language]);},getClientVersion:function(){this._execNativeCode('system','clientversion');},clientVersionCallback:function(){},openurl:function(url){if(false===Mojo.app.isNewClientVersion()){url=url.replace(/:\/\//g,",").replace(/\//g,",");}
this._execNativeCode('system','openurl',[url]);},bindPlayerIdToDevice:function(uid){this._execNativeCode('system','bindplayeridtodevice',[""+uid]);},clearlogincookie:function(){this._execNativeCode('system','clearlogincookie');},showbattleskip:function(){this._execNativeCode('media','showbattleskip');},buffCut:function(buffcnt){this._execNativeCode('system','buffcnt',[""+buffcnt]);},sharescenesession:function(title,description,imgurl,webpageurl,callback){this._execNativeCode('system','sharescenesession',[title,description,imgurl,webpageurl],callback);},sharescenetimeline:function(title,description,imgurl,webpageurl,callback){this._execNativeCode('system','sharescenetimeline',[title,description,imgurl,webpageurl],callback);},updateAfterLogin:function(){Mojo.app.main.baseProfile.sync();},});w.Mojo.gap.AndroidBridge=w.Mojo.gap.Bridge.extend({init:function(options){this._super(options);},_execNativeCode:function(params){},soundPlay:function(file,loop,type){if(this._options.effectSound){type=type==undefined?'mp3':type;window.MojoGapHandler.playSound('a_'+file+'.'+type);}},soundStop:function(){},battleAnimationPlay:function(player_army,opponent_army){if(player_army==undefined||player_army==null){playerImgs='null&null&null';}else if(player_army.length==3){playerImgs=player_army[0]+'&'+player_army[1]+'&'+player_army[2];}else if(player_army.length==2){playerImgs=player_army[0]+'&'+player_army[1]+'&'+'null';}else if(player_army.length==1){playerImgs='null'+'&'+player_army[0]+'&'+'null';}else{playerImgs='null&null&null';}
if(opponent_army==undefined||opponent_army==null){oppImgs='null&null&null';}else if(opponent_army.length==3){oppImgs=opponent_army[0]+'&'+opponent_army[1]+'&'+opponent_army[2];}else if(opponent_army.length==2){oppImgs=opponent_army[0]+'&'+opponent_army[1]+'&'+'null';}else if(opponent_army.length==1){oppImgs='null'+'&'+opponent_army[0]+'&'+'null';}else{oppImgs='null&null&null';}
window.MojoGapHandler.playBattleAnimation(playerImgs,oppImgs);},niudanAnimationPlay:function(rarity){window.MojoGapHandler.playNiuDanAnimation(rarity);},intensifyAnimationPlay:function(){window.MojoGapHandler.playIntensifyAnimation();},levelupAnimationPlay:function(){window.MojoGapHandler.playLevelupAnimation();},compositeAnimationPlay:function(){window.MojoGapHandler.playCompositeAnimation();},purchase:function(userId,itemId){},settings:function(domain,enabled){if(domain=='bg-sound'){if(enabled==true){window.MojoGapHandler.enableBgMusic();}else{window.MojoGapHandler.disableBgMusic();}}else if(domain=='effect-sound'){if(enabled==true){window.MojoGapHandler.enableEffectSound();}else{window.MojoGapHandler.disableEffectSound();}}},highlightMenuItem:function(index){},tutorialCallback:function(index){},rechargeCallback:function(){},clearCache:function(){},bindUser:function(userId){},showMallIcon:function(){},hideMallIcon:function(){},openTpCenter:function(){},openFeedbackCenter:function(){},selectServer:function(server){},setLanguage:function(language){},getClientVersion:function(){},clientVersionCallback:function(){},openurl:function(url){},bindPlayerIdToDevice:function(){},clearlogincookie:function(){},sharescenesession:function(){},sharescenetimeline:function(){},updateAfterLogin:function(){},});g.init=function(params){var params=$.extend(true,{device:'',bgSound:true,effectSound:true,isJailbreak:false},params||{});if(params.device.indexOf('iphone')>-1){g.isJailbreak=params.isJailbreak=(params.device.indexOf('Other')>-1);g.device=params.device='iphone';w.Mojo.gap=new w.Mojo.gap.IOSBridge(params);}else if(params.device.indexOf('ipad')>-1){g.isJailbreak=params.isJailbreak=(params.device.indexOf('Other')>-1);g.device=params.device='ipad';w.Mojo.gap=new w.Mojo.gap.IOSBridge(params);}else if(params.device.indexOf('andriod')>-1){g.isJailbreak=params.isJailbreak=true;g.device=params.device='android';w.Mojo.gap=new w.Mojo.gap.AndroidBridge(params);}else{g.isJailbreak=params.isJailbreak=false;g.device=params.device='iphone';w.Mojo.gap=new w.Mojo.gap.IOSBridge(params);}
w.Mojo.gap.device=params.device;w.Mojo.gap.isJailbreak=params.isJailbreak;}})(window,jQuery);;(function(w,$,undefined){w.Mojo=w.Mojo||{};w.Mojo.ui=w.Mojo.ui||{};w.Mojo.ui.BattleAnimation=w.Mojo.ui.BattleAnimation||{};Mojo.ui.BattleAnimation.init=function(){this.mainBaseArray=Mojo.app.baseUrl.split('/');this.mainBaseUrl="/"+this.mainBaseArray[1]+"/resources/classic/"+this.mainBaseArray[2];this.fpsTimes=80;this.scale=1;this.defaultHeroUrl=this.mainBaseUrl+"/image/entity/1/large/j4_5_1.png";this.baseUrl=this.mainBaseUrl+"/image/battleanimation/";this.battleSoundUrl=this.mainBaseUrl+"/sound/battle";this.battleTag="extra";this.winTag=0;this.attaker={};this.defender={};this.battleImageSource={};this.attakerImageSource=[];this.attakerInfo={}
this.defenderImageSource=[];this.defenderInfo={};this.attakerValue=0;this.defenderValue=0;this.attakerPercent=0;this.defenderPercent=0;this.maxTimes=0;this.attakeTimes=0;this.attakerShowOver=false;this.defenderShowOver=false;this.heroNumTag=true;this.sourceSize=0;this.loadedSourceSize=0;this.loadingDiv=null;this.loadingImg=null;this.bufferCanvas=null;this.bufferCtx=null;this.bgImage=null;this.showLoadingImage=null;this.exitImage=null;this.iImage=null;this.showXZ=0;this.strandImage=null;this.attakerKZ=0;this.attakerDK=0;this.attakerBJ=0;this.defenderKZ=0;this.defenderDK=0;this.defenderFH=0;this.attakerInfoLater=[0,0,0];this.defenderInfoLater=[0,0,0];this.attakerTotalValue=0;this.defenderTotalValue=0;this.attackerAddValue=0;this.attackerInfoRefresh=[false,false,false];this.defenderInfoRefresh=[false,false,false];this.boutOver=2;this.showOverTag=2;this.gameLater=0;this.showExit=true;this.numImage=null;this.infoSImage=null;this.kzImage=null;this.kzTimes=0;this.kzShowTag=false;this.dkImage=null;this.dkShowTag=false;this.dkTimes=0;this.bjImage=null;this.bjTimes=[0,0,0];this.fhImage=null;this.fhTimes=[0,0,0];this.winImage=null;this.winTimes=0;this.failImage=null;this.extraImg=null;this.extraLoadTimes=0;this.attackerExtraTag=false;this.defenderExtraTag=false;this.attackerTag=[true,false,false];this.attackeLater=[0,0,0];this.defenderTag=[true,false,false];this.infoAttackValueImg=[null,null,null,null,null,null];this.showExitTag=true;this.showExitLater=0;this.initdata={"data":{"attacker":{"army":[{"name":"\u9093\u8302","small_image":"/mojo/resources/classic/mobile/image/entity/1/small/j4_5_1.png","attack":0,"level":"1","id":263201620,"weapon_add_attack":0,"is_anti_res":0,"is_be_res":0,"rebirth_sum":0,"has_weapon_skill":false},],"player":{"id":"","name":"","level":1,"base_attack":840,"sum_attack":840},"sumAttack":840,"restraint":[]},"defender":{"army":[{"name":"\u9093\u8302","small_image":"/mojo/resources/classic/mobile/image/entity/1/small/j4_5_1.png","defence":0,"bid":"j4511","id":263201620,"is_be_res":0,"is_anti_res":0,"armor_add_defence":0,"has_armor_skill":false,"rebirth_sum":0},],"player":{"id":"1","name":"\u9093\u8302","level":"??","base_defence":0,"sum_defence":736},"sumDefence":736,"restraint":[]},"win":1,"skill_summary":{"attacker":{"is_res":0,"is_anti_res":0,"weapon_add_attack":0},"defender":{"is_res":0,"is_anti_res":0,"armor_add_defence":0}}}};this.initdata.data.attacker.army[0].small_image=this.initdata.data.defender.army[0].small_image=this.mainBaseUrl+"/image/entity/1/small/j4_5_1.png";}
Mojo.ui.BattleAnimation.openBattle=function(battleData,baseUrl,defaultSrc,fpsTimes,scale){var tt=Mojo.ui.BattleAnimation;if(battleData==undefined||battleData.length==0||!Mojo.app.battleAnimation()){if(Mojo.ui.BattleAnimation.onclose instanceof Function){Mojo.ui.BattleAnimation.onclose();}
return;}
Mojo.ui.BattleAnimation.init();$.extend(true,Mojo.ui.BattleAnimation.initdata,battleData);if(fpsTimes!=undefined&&fpsTimes!=''){Mojo.ui.BattleAnimation.fpsTimes=fpsTimes;}
if(defaultSrc!=undefined&&defaultSrc!=''){Mojo.ui.BattleAnimation.defaultHeroUrl=defaultSrc;}
if(baseUrl!=undefined&&baseUrl!=''){Mojo.ui.BattleAnimation.baseUrl=baseUrl;}
if(scale!=undefined&&scale!=''){Mojo.ui.BattleAnimation.scale=scale;}
tt.loadingDiv=document.createElement("div");tt.loadingDiv.setAttribute("style","background:none repeat scroll 0 0 #000;left:0;position:absolute;top:0;width:100%;height:100%;opacity:0.8;text-align:center;vertical-align:middle;z-index:2000");tt.loadingImg=document.createElement("img");tt.loadingImg.src=tt.baseUrl+"mojo_common_waiting.gif";tt.loadingImg.setAttribute("style","position:absolute;width:25px;height:25px;top:50%;bottom:50%;left:50%;right:50%");tt.loadingDiv.appendChild(tt.loadingImg);tt.parseData(Mojo.ui.BattleAnimation.initdata);}
Mojo.ui.BattleAnimation.isExit=function(aTag,dTag,aLength,bLength){if(aTag){if(dTag){if(aLength==1&&bLength==1)
return true;}else{if(aLength==1&&bLength==0)
return true;}}else{if(dTag){if(aLength==0&&bLength==1)
return true;}else{if(aLength==0&&bLength==0)
return true;}}
return false;}
Mojo.ui.BattleAnimation.parseData=function(battleData){var tt=Mojo.ui.BattleAnimation;var jsonData=battleData;tt.winTag=jsonData.data.win;tt.attaker=jsonData.data.attacker;tt.defender=jsonData.data.defender;if(tt.attaker.is_barracks==1){var barracks=jsonData.data.attacker.army[0];if(barracks.attack>0||barracks.is_res>0||barracks.is_anti_res>0||barracks.weapon_add_attack>0){tt.attackerExtraTag=true;}}
if(tt.defender.is_barracks==1){var barracks=jsonData.data.defender.army[0];if(barracks.defence>0||barracks.is_res>0||barracks.is_anti_res>0||barracks.armor_add_defence>0){tt.defenderExtraTag=true;}}
if(tt.isExit(tt.attaker.is_barracks==1,tt.defender.is_barracks==1,tt.attaker.army.length,tt.defender.army.length)){tt.exit();return;}
document.body.appendChild(tt.loadingDiv);var attakerLastTotal=(tt.attaker.player.sum_attack-tt.attaker.player.base_attack)/(tt.attaker.army.length*3);var defenderLastTotal=(tt.defender.player.sum_defence-tt.defender.player.base_defence)/(tt.defender.army.length*3);tt.attackerAddValue=attakerLastTotal>defenderLastTotal?attakerLastTotal:defenderLastTotal;tt.loadSource(tt.attaker.army);tt.loadSource(tt.defender.army);tt.resetAttake(tt.attaker.player.base_attack,0);tt.resetAttake(tt.defender.player.base_defence,1);tt.attakerArmyLength=tt.attaker.army.length;if(tt.attaker.is_barracks==1){tt.attakerArmyLength--;}
tt.defenderArmyLength=tt.defender.army.length;if(tt.defender.is_barracks==1){tt.defenderArmyLength--;}
if(tt.attakerArmyLength>=tt.defenderArmyLength){tt.maxTimes=parseInt(tt.attakerArmyLength/3);if(tt.attakerArmyLength%3==0){tt.maxTimes=parseInt(tt.attakerArmyLength/3)-1;}
tt.heroNumTag=true;}else{tt.maxTimes=parseInt(tt.defenderArmyLength/3);if(tt.defenderArmyLength%3==0){tt.maxTimes=parseInt(tt.defenderArmyLength/3)-1;}
tt.heroNumTag=false;}
tt.bgImage=new Image();tt.bgImage.src=tt.baseUrl+"mojo_common_battle_bg.png";tt.showLoadingImage=new Image();tt.showLoadingImage.src=tt.baseUrl+"mojo_common_battle_showloading.png";tt.strandImage=new Image();tt.strandImage.src=tt.baseUrl+"mojo_common_battle_strand.png";tt.exitImage=new Image();tt.exitImage.src=tt.baseUrl+"mojo_common_battle_exit.png";tt.numImage=new Image();tt.numImage.src=tt.baseUrl+"mojo_common_num.png";tt.failImage=new Image();tt.failImage.src=tt.baseUrl+"mojo_common_fail.png";var infoImageUrl=[{name:"info1",src:"mojo_common_info_0001.png"},{name:"info2",src:"mojo_common_info_0002.png"},{name:"info3",src:"mojo_common_info_0003.png"},{name:"info4",src:"mojo_common_info_0004.png"},{name:"info5",src:"mojo_common_info_0005.png"},{name:"info6",src:"mojo_common_info_0006.png"},{name:"info7",src:"mojo_common_info_0007.png"},{name:"info8",src:"mojo_common_info_0008.png"},{name:"info9",src:"mojo_common_info_0009.png"},{name:"info10",src:"mojo_common_info_0010.png"},{name:"info11",src:"mojo_common_info_0011.png"},{name:"info12",src:"mojo_common_info_0012.png"}];tt.iImage=tt.loadImage(infoImageUrl);var infoSImageUrl=[{name:"infoKZ",src:"mojo_common_info_kz.png"},{name:"infoDK",src:"mojo_common_info_dk.png"},{name:"infoBJ",src:"mojo_common_info_bj.png"},{name:"infoFH",src:"mojo_common_info_fh.png"}];tt.infoSImage=tt.loadImage(infoSImageUrl);var infoKZImgUrl=[{name:"info_kz01",src:"mojo_common_info_kz01.png"},{name:"info_kz02",src:"mojo_common_info_kz02.png"},{name:"info_kz03",src:"mojo_common_info_kz03.png"},{name:"info_kz04",src:"mojo_common_info_kz04.png"},{name:"info_kz05",src:"mojo_common_info_kz05.png"},{name:"info_kz06",src:"mojo_common_info_kz06.png"},{name:"info_kz07",src:"mojo_common_info_kz07.png"},{name:"info_kz08",src:"mojo_common_info_kz08.png"},{name:"info_kz09",src:"mojo_common_info_kz09.png"},{name:"info_kz10",src:"mojo_common_info_kz10.png"},{name:"info_kz11",src:"mojo_common_info_kz11.png"},{name:"info_kz12",src:"mojo_common_info_kz12.png"},{name:"info_kz13",src:"mojo_common_info_kz13.png"}];tt.kzImage=tt.loadImage(infoKZImgUrl);var infoDKImgUrl=[{name:"info_dk_01",src:"mojo_common_info_dk01.png"},{name:"info_dk_02",src:"mojo_common_info_dk02.png"},{name:"info_dk_03",src:"mojo_common_info_dk03.png"},{name:"info_dk_04",src:"mojo_common_info_dk04.png"},{name:"info_dk_05",src:"mojo_common_info_dk05.png"},{name:"info_dk_06",src:"mojo_common_info_dk06.png"},{name:"info_dk_07",src:"mojo_common_info_dk07.png"},{name:"info_dk_08",src:"mojo_common_info_dk08.png"},{name:"info_dk_09",src:"mojo_common_info_dk09.png"},{name:"info_dk_10",src:"mojo_common_info_dk10.png"}];tt.dkImage=tt.loadImage(infoDKImgUrl);var infoBJImgUrl=[{name:"info_bj_01",src:"mojo_common_info_bj01.png"},{name:"info_bj_02",src:"mojo_common_info_bj02.png"},{name:"info_bj_04",src:"mojo_common_info_bj04.png"},{name:"info_bj_05",src:"mojo_common_info_bj05.png"},{name:"info_bj_06",src:"mojo_common_info_bj06.png"},{name:"info_bj_07",src:"mojo_common_info_bj07.png"},{name:"info_bj_08",src:"mojo_common_info_bj08.png"},{name:"info_bj_09",src:"mojo_common_info_bj09.png"},{name:"info_bj_10",src:"mojo_common_info_bj10.png"}];tt.bjImage=tt.loadImage(infoBJImgUrl);var mojo_FHImgUrl=[{name:"info_fh_01",src:"mojo_common_info_fh01.png"},{name:"info_fh_02",src:"mojo_common_info_fh02.png"},{name:"info_fh_03",src:"mojo_common_info_fh03.png"},{name:"info_fh_04",src:"mojo_common_info_fh04.png"},{name:"info_fh_05",src:"mojo_common_info_fh05.png"},{name:"info_fh_06",src:"mojo_common_info_fh06.png"},{name:"info_fh_07",src:"mojo_common_info_fh07.png"},{name:"info_fh_08",src:"mojo_common_info_fh08.png"},{name:"info_fh_09",src:"mojo_common_info_fh09.png"},{name:"info_fh_10",src:"mojo_common_info_fh10.png"},{name:"info_fh_11",src:"mojo_common_info_fh11.png"},{name:"info_fh_12",src:"mojo_common_info_fh12.png"},{name:"info_fh_13",src:"mojo_common_info_fh13.png"}];tt.fhImage=tt.loadImage(mojo_FHImgUrl);var winImgUrl=[{name:"win01",src:"mojo_common_win01.png"},{name:"win02",src:"mojo_common_win02.png"},{name:"win03",src:"mojo_common_win03.png"},{name:"win04",src:"mojo_common_win04.png"},{name:"win05",src:"mojo_common_win05.png"},{name:"win06",src:"mojo_common_win06.png"},{name:"win07",src:"mojo_common_win07.png"},{name:"win08",src:"mojo_common_win08.png"},{name:"win09",src:"mojo_common_win09.png"},{name:"win10",src:"mojo_common_win10.png"},{name:"win11",src:"mojo_common_win11.png"}];tt.winImage=tt.loadImage(winImgUrl);if(tt.attackerExtraTag){tt.extraImg=tt.battleImageSource[tt.attaker.army[0].name];}else{if(tt.defenderExtraTag){tt.extraImg=tt.battleImageSource[tt.defender.army[0].name]}}}
Mojo.ui.BattleAnimation.loadImage=function(source){var tempImage=[];for(var i=0;i<source.length;i++){tempImage[i]=new Image();tempImage[i].src=Mojo.ui.BattleAnimation.baseUrl+source[i].src;}
return tempImage;}
Mojo.ui.BattleAnimation.loadSource=function(source){var tt=Mojo.ui.BattleAnimation;tt.sourceSize=parseInt(tt.sourceSize)+source.length;for(var i=0;i<source.length;i++){var mm=source[i].name;tt.battleImageSource[mm]=new Image();tt.battleImageSource[mm].src=tt.resetUrl(source[i].small_image);tt.battleImageSource[mm].onload=function(){tt.loadedSourceSize++;if(tt.loadedSourceSize==tt.sourceSize){tt.createBattle();document.body.removeChild(tt.loadingDiv);}}
tt.battleImageSource[mm].onerror=function(){this.src=tt.defaultHeroUrl;}}}
Mojo.ui.BattleAnimation.resetUrl=function(imgUrl){return imgUrl.replace("/small/","/large/");}
Mojo.ui.BattleAnimation.circleHero=function(tempImage){var tempCanvas=document.createElement("canvas");var context=tempCanvas.getContext("2d");var clientWidth=tempImage.width;var clientHeight=tempImage.height;tempCanvas.width=clientWidth;tempCanvas.height=clientHeight;context.translate(clientWidth/2,clientHeight/2);context.rotate(Math.PI);context.scale(1,-1);context.drawImage(tempImage,-clientWidth/2,-clientHeight/2);return tempCanvas;}
Mojo.ui.BattleAnimation.createBattle=function(){var tt=Mojo.ui.BattleAnimation;tt.bufferCanvas=document.createElement("canvas");tt.bufferCanvas.setAttribute("style","position:absolute;left:0;top:0;width:100%;height:100%;z-index:2000");tt.bufferCanvas.width=640*tt.scale;;tt.bufferCanvas.height=960*tt.scale;document.body.appendChild(tt.bufferCanvas);tt.bufferCanvas.addEventListener("click",function(event){if(tt.showExit){tt.exit();}});tt.bufferCtx=tt.bufferCanvas.getContext("2d");tt.resetHero();tt.terval=setInterval(tt.battleDraw,tt.fpsTimes);}
Mojo.ui.BattleAnimation.resetAttake=function(attakeValue,tag){var tt=Mojo.ui.BattleAnimation;switch(tag){case 0:if(attakeValue!=undefined){tt.attakerValue=parseInt(tt.attakerValue)+parseInt(attakeValue);}
break;case 1:if(attakeValue!=undefined){tt.defenderValue=parseInt(tt.defenderValue)+parseInt(attakeValue);}
break;default:break;}
tt.attakerPercent=parseInt(tt.attakerValue/(tt.attakerValue+tt.defenderValue)*364);if(tt.attakerPercent>320){tt.attakerPercent=320;}
if(tt.attakerPercent<44){tt.attakerPercent=44;}
tt.attakerPercent=tt.attakerPercent*tt.scale;tt.defenderPercent=364*tt.scale-tt.attakerValue;}
Mojo.ui.BattleAnimation.parseNumToImage=function(value){var ttImag=Mojo.ui.BattleAnimation.numImage;var width=37.5*value.length+37.5;var tempCanvas=document.createElement("canvas");tempCanvas.width=width;tempCanvas.height=50;var tempCtx=tempCanvas.getContext("2d");tempCtx.drawImage(ttImag,37.5,0,37.5,50,0,0,37.5,50);for(i in value){var tempNum=parseInt(value[i]);tempCtx.drawImage(ttImag,75+tempNum*37.5,0,37.5,50,41+i*37.5,0,37.5,50);}
return tempCanvas;}
Mojo.ui.BattleAnimation.resetHero=function(){var tt=Mojo.ui.BattleAnimation;if(tt.attakeTimes*3<tt.attakerArmyLength){tt.attakerImageSource=[];tt.attakerInfo={};var attakerArmy=tt.attaker.army;var tempAttakerLength=(tt.attakeTimes*3+3)<tt.attakerArmyLength?(tt.attakeTimes*3+3):tt.attakerArmyLength;if(tt.attaker.is_barracks==1){for(var i=tt.attakeTimes*3+1;i<tempAttakerLength+1;i++){tt.attakerImageSource[(i-1)%3]=tt.circleHero(tt.battleImageSource[attakerArmy[i].name]);tt.attakerInfo[(i-1)%3]=attakerArmy[i];}}else{for(var i=tt.attakeTimes*3;i<tempAttakerLength;i++){tt.attakerImageSource[i%3]=tt.circleHero(tt.battleImageSource[attakerArmy[i].name]);tt.attakerInfo[i%3]=attakerArmy[i];}}
for(i in tt.attakerInfo){var ttInfo=tt.attakerInfo[i];tt.infoAttackValueImg[i]=tt.parseNumToImage(ttInfo.attack+"");if(ttInfo.is_res>0&&!tt.kzShowTag){tt.kzShowTag=true;}}}else{tt.attakerShowOver=true;}
if(tt.attakeTimes*3<tt.defenderArmyLength){tt.defenderImageSource=[];tt.defenderInfo={};var defenderArmy=tt.defender.army;var tempDefenderLength=(tt.attakeTimes*3+3)<tt.defenderArmyLength?(tt.attakeTimes*3+3):tt.defenderArmyLength;if(tt.defender.is_barracks==1){for(var i=tt.attakeTimes*3+1;i<tempDefenderLength+1;i++){tt.defenderImageSource[(i-1)%3]=tt.battleImageSource[defenderArmy[i].name];tt.defenderInfo[(i-1)%3]=defenderArmy[i];}}else{for(var i=tt.attakeTimes*3;i<tempDefenderLength;i++){tt.defenderImageSource[i%3]=tt.battleImageSource[defenderArmy[i].name];tt.defenderInfo[i%3]=defenderArmy[i];}}
for(i in tt.defenderInfo){var ttInfo=tt.defenderInfo[i];tt.infoAttackValueImg[3+parseInt(i)]=tt.parseNumToImage(ttInfo.defence+"");if(ttInfo.is_res>0&&!tt.kzShowTag){tt.kzShowTag=true;}}}else{tt.defenderShowOver=true;}}
Mojo.ui.BattleAnimation.battleDraw=function(){var tt=Mojo.ui.BattleAnimation;tt.commonDraw();switch(tt.battleTag){case"extra":tt.extraDraw();break;case"prepare":tt.prepareDraw();break;case"battle":tt.attack();break;default:break;}}
Mojo.ui.BattleAnimation.commonDraw=function(){var tt=Mojo.ui.BattleAnimation;tt.bufferCtx.clearRect(0,0,640*tt.scale,960*tt.scale);tt.bufferCtx.drawImage(tt.bgImage,0,0,tt.bgImage.width,tt.bgImage.height,0,0,640*tt.scale,960*tt.scale);tt.bufferCtx.drawImage(tt.strandImage,0,0,tt.strandImage.width,tt.strandImage.height,137*tt.scale,63*tt.scale,tt.attakerPercent,27*tt.scale);var infoWidth=tt.iImage[0].width,infoHeight=tt.iImage[0].height;if(tt.attackerInfoRefresh[0]){tt.bufferCtx.drawImage(tt.iImage[1],0,0,infoWidth,infoHeight,20*tt.scale,120*tt.scale,83*tt.scale,50*tt.scale);tt.attakerInfoLater[0]++;if(tt.attakerInfoLater[0]==3){tt.attackerInfoRefresh[0]=false;tt.attakerInfoLater[0]=0;}}else{tt.bufferCtx.drawImage(tt.iImage[0],0,0,infoWidth,infoHeight,20*tt.scale,120*tt.scale,83*tt.scale,50*tt.scale);}
if(tt.attackerInfoRefresh[1]){tt.bufferCtx.drawImage(tt.iImage[3],0,0,infoWidth,infoHeight,105*tt.scale,120*tt.scale,83*tt.scale,50*tt.scale);tt.attakerInfoLater[1]++;if(tt.attakerInfoLater[1]==3){tt.attackerInfoRefresh[1]=false;tt.attakerInfoLater[1]=0;}}else{tt.bufferCtx.drawImage(tt.iImage[2],0,0,infoWidth,infoHeight,105*tt.scale,120*tt.scale,83*tt.scale,50*tt.scale);}
if(tt.attackerInfoRefresh[2]){tt.bufferCtx.drawImage(tt.iImage[5],0,0,infoWidth,infoHeight,200*tt.scale,120*tt.scale,83*tt.scale,50*tt.scale);tt.attakerInfoLater[2]++;if(tt.attakerInfoLater[2]==3){tt.attackerInfoRefresh[2]=false;tt.attakerInfoLater[2]=0;}}else{tt.bufferCtx.drawImage(tt.iImage[4],0,0,infoWidth,infoHeight,200*tt.scale,120*tt.scale,83*tt.scale,50*tt.scale);}
if(tt.defenderInfoRefresh[0]){tt.bufferCtx.drawImage(tt.iImage[7],0,0,infoWidth,infoHeight,368*tt.scale,120*tt.scale,83*tt.scale,50*tt.scale);tt.defenderInfoLater[0]++;if(tt.defenderInfoLater[0]==3){tt.defenderInfoRefresh[0]=false;tt.defenderInfoLater[0]=0;}}else{tt.bufferCtx.drawImage(tt.iImage[6],0,0,infoWidth,infoHeight,368*tt.scale,120*tt.scale,83*tt.scale,50*tt.scale);}
if(tt.defenderInfoRefresh[1]){tt.bufferCtx.drawImage(tt.iImage[9],0,0,infoWidth,infoHeight,453*tt.scale,120*tt.scale,83*tt.scale,50*tt.scale);tt.defenderInfoLater[1]++;if(tt.defenderInfoLater[1]==3){tt.defenderInfoRefresh[1]=false;tt.defenderInfoLater[1]=0;}}else{tt.bufferCtx.drawImage(tt.iImage[8],0,0,infoWidth,infoHeight,453*tt.scale,120*tt.scale,83*tt.scale,50*tt.scale);}
if(tt.defenderInfoRefresh[2]){tt.bufferCtx.drawImage(tt.iImage[11],0,0,infoWidth,infoHeight,538*tt.scale,120*tt.scale,83*tt.scale,50*tt.scale);tt.defenderInfoLater[2]++;if(tt.defenderInfoLater[2]==3){tt.defenderInfoRefresh[2]=false;tt.defenderInfoLater[2]=0;}}else{tt.bufferCtx.drawImage(tt.iImage[10],0,0,infoWidth,infoHeight,538*tt.scale,120*tt.scale,83*tt.scale,50*tt.scale);}
tt.bufferCtx.fillStyle="#ffff00";tt.bufferCtx.font=28*tt.scale+"px Arial";tt.bufferCtx.textAlign="left";tt.bufferCtx.fillText(tt.attakerKZ,63*tt.scale,155*tt.scale);tt.bufferCtx.fillText(tt.attakerDK,148*tt.scale,155*tt.scale);tt.bufferCtx.fillText(tt.attakerBJ,244*tt.scale,155*tt.scale);tt.bufferCtx.fillStyle="#33ffcc";tt.bufferCtx.fillText(tt.defenderKZ,410*tt.scale,155*tt.scale);tt.bufferCtx.fillText(tt.defenderDK,495*tt.scale,155*tt.scale);tt.bufferCtx.fillText(tt.defenderFH,580*tt.scale,155*tt.scale);tt.bufferCtx.fillStyle="#000000";tt.bufferCtx.font=26*tt.scale+"px Arial";tt.bufferCtx.textAlign="center";tt.bufferCtx.fillText(tt.attaker.player.level,45*tt.scale,44*tt.scale);if(tt.defender.player.level!=undefined){tt.bufferCtx.fillText(tt.defender.player.level,595*tt.scale,44*tt.scale);}else{tt.bufferCtx.fillText("??",595*tt.scale,44*tt.scale);}
tt.bufferCtx.font=32*tt.scale+"px Arial";tt.bufferCtx.fillStyle="#ff0000";tt.bufferCtx.textAlign="left";var ttakerName=tt.attaker.player.name;for(var i=ttakerName.length;i>0;i--){var tempName=ttakerName.substring(0,i);if(tt.bufferCtx.measureText(tempName).width<194*tt.scale){tt.bufferCtx.fillText(tempName,90*tt.scale,38*tt.scale);break;}}
tt.bufferCtx.fillStyle="#3366ff";tt.bufferCtx.textAlign="right";var defenderName=tt.defender.player.name;for(var i=defenderName.length;i>0;i--){var tempName=defenderName.substring(0,i);if(tt.bufferCtx.measureText(tempName).width<194*tt.scale){tt.bufferCtx.fillText(tempName,550*tt.scale,38*tt.scale);break;}}
tt.bufferCtx.font=28*tt.scale+"px Arial";tt.bufferCtx.fillStyle="#ffffff";tt.bufferCtx.textAlign="left";if(parseInt(tt.attakerTotalValue+tt.attackerAddValue)<tt.attakerValue){tt.attakerTotalValue=parseInt(tt.attakerTotalValue+tt.attackerAddValue);}else{tt.attakerTotalValue=tt.attakerValue;}
tt.bufferCtx.fillText(tt.attakerTotalValue,145*tt.scale,87*tt.scale);tt.bufferCtx.textAlign="right";if(parseInt(tt.defenderTotalValue+tt.attackerAddValue)<tt.defenderValue){tt.defenderTotalValue=parseInt(tt.defenderTotalValue+tt.attackerAddValue);}else{tt.defenderTotalValue=tt.defenderValue;}
tt.bufferCtx.fillText(tt.defenderTotalValue,495*tt.scale,87*tt.scale);if(tt.showExitTag){if(tt.showExitLater==30){tt.showExitTag=false;}
tt.showExitLater++;}else{if(tt.showExitLater==-10){tt.showExitTag=true;}
tt.showExitLater--;}
tt.bufferCtx.font=20*tt.scale+"px Arial";tt.bufferCtx.fillStyle="rgba(255,255,0,"+tt.showExitLater*0.05+")";tt.bufferCtx.textAlign="center";tt.bufferCtx.fillText("",320*tt.scale,930*tt.scale);if(tt.extraLoadTimes>=6){if(tt.attackerExtraTag){tt.bufferCtx.drawImage(tt.extraImg,0,0,tt.extraImg.width,tt.extraImg.height,20*tt.scale,74*tt.scale,50*tt.scale,50*tt.scale);}
if(tt.defenderExtraTag){tt.bufferCtx.drawImage(tt.extraImg,0,0,tt.extraImg.width,tt.extraImg.height,570*tt.scale,74*tt.scale,50*tt.scale,50*tt.scale);}}}
Mojo.ui.BattleAnimation.extraDraw=function(){var tt=Mojo.ui.BattleAnimation;var tempImg=tt.showLoading(tt.extraLoadTimes);if(tt.attackerExtraTag){tt.bufferCtx.drawImage(tempImg,0,0,tempImg.width,tempImg.height,20*tt.scale,74*tt.scale,50*tt.scale,50*tt.scale);}
if(tt.defenderExtraTag){tt.bufferCtx.drawImage(tempImg,0,0,tempImg.width,tempImg.height,570*tt.scale,74*tt.scale,50*tt.scale,50*tt.scale);}
if(tt.extraLoadTimes==5){if(tt.attackerExtraTag){var tempHero=tt.attaker.army[0];tt.resetAttake(tempHero.attack,0);if(tempHero.is_res>0){tt.attakerKZ++;tt.attackerInfoRefresh[0]=[true];}
if(tempHero.is_anti_res>0){tt.attakerDK++;tt.attackerInfoRefresh[1]=[true];}
if(tempHero.weapon_add_attack>0){tt.attakerBJ++;tt.attackerInfoRefresh[2]=[true];}}
if(tt.defenderExtraTag){var tempHero=tt.defender.army[0];tt.resetAttake(tempHero.defence,1);if(tempHero.is_res>0){tt.defenderKZ++;tt.defenderInfoRefresh[0]=[true];}
if(tempHero.is_anti_res>0){tt.defenderDK++;tt.defenderInfoRefresh[1]=[true];}
if(tempHero.armor_add_defence>0){tt.defenderFH++;tt.defenderInfoRefresh[2]=[true];}}
tt.battleTag="prepare";}
tt.extraLoadTimes++;}
Mojo.ui.BattleAnimation.showLoading=function(value){var tt=Mojo.ui.BattleAnimation;value=value%4*0.5;var tempCanvas=document.createElement("canvas");var tempCtx=tempCanvas.getContext("2d");tempCanvas.width=60;tempCanvas.height=60;tempCtx.clearRect(0,0,60,60);var showWidth=tt.showLoadingImage.width,showHeight=tt.showLoadingImage.height;switch(value){case 0:tempCtx.rotate(0*Math.PI/180);tempCtx.drawImage(tt.showLoadingImage,0,0,showWidth,showHeight,0,0,60,60);break;case 0.5:tempCtx.rotate(90*Math.PI/180);tempCtx.drawImage(tt.showLoadingImage,0,0,showWidth,showHeight,0,-60,60,60);break;case 1:tempCtx.rotate(Math.PI);tempCtx.drawImage(tt.showLoadingImage,0,0,showWidth,showHeight,-60,-60,60,60);break;case 1.5:tempCtx.rotate(270*Math.PI/180);tempCtx.drawImage(tt.showLoadingImage,0,0,showWidth,showHeight,-60,0,60,60);break;default:break;}
return tempCanvas;}
Mojo.ui.BattleAnimation.prepareDraw=function(){var tt=Mojo.ui.BattleAnimation;if(tt.attakerShowOver){tt.attakerAttack();}else{var tempCanvas=tt.showLoading(tt.showXZ);if(tt.showXZ<6){if(null!=tt.attakerImageSource[0]){tt.bufferCtx.drawImage(tempCanvas,0,0,60,60,70*tt.scale,200*tt.scale,200*tt.scale,240*tt.scale);}}else{if(null!=tt.attakerImageSource[0]){var tempHero=tt.attakerImageSource[0];tt.bufferCtx.drawImage(tempHero,0,0,tempHero.width,tempHero.height,70*tt.scale,200*tt.scale,200*tt.scale,240*tt.scale);}
if(tt.showXZ>5&&tt.showXZ<11){if(null!=tt.attakerImageSource[1]){tt.bufferCtx.drawImage(tempCanvas,0,0,60,60,70*tt.scale,440*tt.scale,200*tt.scale,240*tt.scale);}}else{if(null!=tt.attakerImageSource[1]){var tempHero=tt.attakerImageSource[1];tt.bufferCtx.drawImage(tempHero,0,0,tempHero.width,tempHero.height,70*tt.scale,440*tt.scale,200*tt.scale,240*tt.scale);}
if(tt.showXZ>10&&tt.showXZ<16){if(null!=tt.attakerImageSource[2]){tt.bufferCtx.drawImage(tempCanvas,0,0,60,60,70*tt.scale,680*tt.scale,200*tt.scale,240*tt.scale);}}else{if(null!=tt.attakerImageSource[2]){var tempHero=tt.attakerImageSource[2];tt.bufferCtx.drawImage(tempHero,0,0,tempHero.width,tempHero.height,70*tt.scale,680*tt.scale,200*tt.scale,240*tt.scale);}}}}}
if(tt.defenderShowOver){tt.defenderAttack();}else{var tempCanvas=tt.showLoading(tt.showXZ);if(tt.showXZ<6){if(null!=tt.defenderImageSource[0]){tt.bufferCtx.drawImage(tempCanvas,0,0,60,60,370*tt.scale,200*tt.scale,200*tt.scale,240*tt.scale);}}else{if(null!=tt.defenderImageSource[0]){var tempHero=tt.defenderImageSource[0];tt.bufferCtx.drawImage(tempHero,0,0,tempHero.width,tempHero.height,370*tt.scale,200*tt.scale,200*tt.scale,240*tt.scale);}
if(tt.showXZ>5&&tt.showXZ<11){if(null!=tt.defenderImageSource[1]){tt.bufferCtx.drawImage(tempCanvas,0,0,60,60,370*tt.scale,440*tt.scale,200*tt.scale,240*tt.scale);}}else{if(null!=tt.defenderImageSource[1]){var tempHero=tt.defenderImageSource[1];tt.bufferCtx.drawImage(tempHero,0,0,tempHero.width,tempHero.height,370*tt.scale,440*tt.scale,200*tt.scale,240*tt.scale);}
if(tt.showXZ>10&&tt.showXZ<16){if(null!=tt.defenderImageSource[2]){tt.bufferCtx.drawImage(tempCanvas,0,0,60,60,370*tt.scale,680*tt.scale,200*tt.scale,240*tt.scale);}}else{if(null!=tt.defenderImageSource[2]){var tempHero=tt.defenderImageSource[2];tt.bufferCtx.drawImage(tempHero,0,0,tempHero.width,tempHero.height,370*tt.scale,680*tt.scale,200*tt.scale,240*tt.scale);}}}}}
if(tt.showXZ>15){tt.battleTag="battle";}
tt.showXZ++;}
Mojo.ui.BattleAnimation.circleAttaker=function(img,value){var tempCanvas=document.createElement("canvas");var tempCtx=tempCanvas.getContext("2d");tempCanvas.width=img.width;tempCanvas.height=img.height;tempCtx.clearRect(0,0,img.width,img.height);tempCtx.rotate(parseInt(value)*8*Math.PI/180);tempCtx.translate(parseInt(value)*40,-parseInt(value)*30);tempCtx.drawImage(img,0,0,img.width,img.height,0,0,img.width,img.height);return tempCanvas;}
Mojo.ui.BattleAnimation.circleDefender=function(img,value){var tempCanvas=document.createElement("canvas");var tempCtx=tempCanvas.getContext("2d");tempCanvas.width=img.width;tempCanvas.height=img.height;tempCtx.clearRect(0,0,img.width,img.height);tempCtx.rotate(parseInt(value)*parseInt(-8)*Math.PI/180);tempCtx.translate(-parseInt(value)*(60),parseInt(value)*2);tempCtx.drawImage(img,0,0,img.width,img.height,0,0,img.width,img.height);return tempCanvas;}
Mojo.ui.BattleAnimation.attakerAttack=function(){var tt=Mojo.ui.BattleAnimation;var tempImage=tt.attakerImageSource;var infoKZ=tt.infoSImage[0];var infoDK=tt.infoSImage[1];var infoBJ=tt.infoSImage[2];for(i in tempImage){var tempHero=tempImage[i];var tempInfo=tt.attakerInfo[i];if(!tt.attakerShowOver){var attackImage=tt.infoAttackValueImg[i];var startX=(320/2-attackImage.width/2)*tt.scale;if(tt.attackeLater[i]==1){tt.bufferCtx.drawImage(tt.circleDefender(tempHero,1),0,0,tempHero.width,tempHero.height,70*tt.scale,(200+(parseInt(i)*240))*tt.scale,200*tt.scale,240*tt.scale);}else if(tt.attackeLater[i]==2){tt.bufferCtx.drawImage(tt.circleDefender(tempHero,2),0,0,tempHero.width,tempHero.height,70*tt.scale,(200+(parseInt(i)*240))*tt.scale,200*tt.scale,240*tt.scale);}else if(tt.attackeLater[i]==3){tt.bufferCtx.drawImage(tt.circleAttaker(tempHero,2),0,0,tempHero.width,tempHero.height,70*tt.scale,(200+(parseInt(i)*240)-30)*tt.scale,200*tt.scale,240*tt.scale);}else if(tt.attackeLater[i]==4){tt.bufferCtx.drawImage(tt.circleAttaker(tempHero,1),0,0,tempHero.width,tempHero.height,70*tt.scale,(200+(parseInt(i)*240)-10)*tt.scale,200*tt.scale,240*tt.scale);}else{tt.bufferCtx.drawImage(tempHero,0,0,tempHero.width,tempHero.height,70*tt.scale,(200+(parseInt(i)*240))*tt.scale,200*tt.scale,240*tt.scale);}
if(tempInfo.is_res>0&&tt.kzTimes<tt.kzImage.length){var tempKZImg=tt.kzImage[tt.kzTimes];tt.bufferCtx.drawImage(tempKZImg,0,0,tempKZImg.width,tempKZImg.height,70*tt.scale,(200+(parseInt(i)*240))*tt.scale,200*tt.scale,200*tt.scale);if(tt.kzTimes==2){tt.bufferCtx.drawImage(infoKZ,0,0,infoKZ.width,infoKZ.height,120*tt.scale,(360+(parseInt(i)*240))*tt.scale,90*tt.scale,40*tt.scale);}else if(tt.kzTimes==3){tt.bufferCtx.drawImage(infoKZ,0,0,infoKZ.width,infoKZ.height,115*tt.scale,(352+(parseInt(i)*240))*tt.scale,96*tt.scale,48*tt.scale);}else if(tt.kzTimes==4){tt.bufferCtx.drawImage(infoKZ,0,0,infoKZ.width,infoKZ.height,110*tt.scale,(350+(parseInt(i)*240))*tt.scale,100*tt.scale,50*tt.scale);}else if(tt.kzTimes==5){tt.bufferCtx.drawImage(infoKZ,0,0,infoKZ.width,infoKZ.height,(100+(Math.random()*10))*tt.scale,(340+(parseInt(i)*240)+(Math.random()*10))*tt.scale,120*tt.scale,60*tt.scale);}else if(tt.kzTimes==6){tt.bufferCtx.drawImage(infoKZ,0,0,infoKZ.width,infoKZ.height,(100+(Math.random()*10))*tt.scale,(340+(parseInt(i)*240)+(Math.random()*10))*tt.scale,120*tt.scale,60*tt.scale);}else if(tt.kzTimes==7){tt.bufferCtx.drawImage(infoKZ,0,0,infoKZ.width,infoKZ.height,(100+(Math.random()*10))*tt.scale,(340+(parseInt(i)*240)+(Math.random()*10))*tt.scale,120*tt.scale,60*tt.scale);tt.attakerKZ++;tt.attackerInfoRefresh[0]=true;}}
if(tt.dkShowTag){if(tempInfo.is_anti_res>0&&tt.dkTimes>0&&tt.dkTimes<tt.dkImage.length){var tempDKImg=tt.dkImage[tt.dkTimes];tt.bufferCtx.drawImage(tempDKImg,0,0,tempDKImg.width,tempDKImg.height,30*tt.scale,(180+(parseInt(i)*240))*tt.scale,260*tt.scale,260*tt.scale);if(tt.dkTimes==2){tt.bufferCtx.drawImage(infoDK,0,0,infoDK.width,infoDK.height,120*tt.scale,(360+(parseInt(i)*240))*tt.scale,90*tt.scale,40*tt.scale);}else if(tt.dkTimes==3){tt.bufferCtx.drawImage(infoDK,0,0,infoDK.width,infoDK.height,115*tt.scale,(352+(parseInt(i)*240))*tt.scale,96*tt.scale,48*tt.scale);}else if(tt.dkTimes==4){tt.bufferCtx.drawImage(infoDK,0,0,infoDK.width,infoDK.height,110*tt.scale,(350+(parseInt(i)*240))*tt.scale,100*tt.scale,50*tt.scale);}else if(tt.dkTimes==5){tt.bufferCtx.drawImage(infoDK,0,0,infoDK.width,infoDK.height,(100+(Math.random()*10))*tt.scale,(340+(parseInt(i)*240)+(Math.random()*10))*tt.scale,120*tt.scale,60*tt.scale);}
if(tt.dkTimes==6){tt.bufferCtx.drawImage(infoDK,0,0,infoDK.width,infoDK.height,(100+(Math.random()*10))*tt.scale,(340+(parseInt(i)*240)+(Math.random()*10))*tt.scale,120*tt.scale,60*tt.scale);}else
if(tt.dkTimes==7){tt.bufferCtx.drawImage(infoDK,0,0,infoDK.width,infoDK.height,(100+(Math.random()*10))*tt.scale,(340+(parseInt(i)*240)+(Math.random()*10))*tt.scale,120*tt.scale,60*tt.scale);tt.attakerDK++;tt.attackerInfoRefresh[1]=true;}}}
if(tt.dkTimes>=10){if(tt.attackerTag[i]){tt.attackeLater[i]++;if(tt.bjTimes[i]<tt.bjImage.length){if(tt.attackeLater[i]>2){var tempBJImg=tt.bjImage[tt.bjTimes[i]];tt.bufferCtx.drawImage(tempBJImg,0,0,tempBJImg.width,tempBJImg.height,30*tt.scale,(150+(parseInt(i)*240))*tt.scale,360*tt.scale,176*tt.scale);if(tempInfo.weapon_add_attack>0){if(tt.bjTimes[i]==2){tt.bufferCtx.drawImage(infoBJ,0,0,infoBJ.width,infoBJ.height,120*tt.scale,(360+(parseInt(i)*240))*tt.scale,90*tt.scale,40*tt.scale);}else if(tt.bjTimes[i]==3){tt.bufferCtx.drawImage(infoBJ,0,0,infoBJ.width,infoBJ.height,115*tt.scale,(352+(parseInt(i)*240))*tt.scale,96*tt.scale,48*tt.scale);}else if(tt.bjTimes[i]==4){tt.bufferCtx.drawImage(infoBJ,0,0,infoBJ.width,infoBJ.height,110*tt.scale,(350+(parseInt(i)*240))*tt.scale,100*tt.scale,50*tt.scale);}else if(tt.bjTimes[i]==5){tt.bufferCtx.drawImage(infoBJ,0,0,infoBJ.width,infoBJ.height,(100+(Math.random()*10))*tt.scale,(340+(parseInt(i)*240)+(Math.random()*10))*tt.scale,120*tt.scale,60*tt.scale);}else if(tt.bjTimes[i]==6){tt.bufferCtx.drawImage(infoBJ,0,0,infoBJ.width,infoBJ.height,(100+(Math.random()*10))*tt.scale,(340+(parseInt(i)*240)+(Math.random()*10))*tt.scale,120*tt.scale,60*tt.scale);}else if(tt.bjTimes[i]==7){tt.bufferCtx.drawImage(infoBJ,0,0,infoBJ.width,infoBJ.height,(100+(Math.random()*10))*tt.scale,(340+(parseInt(i)*240)+(Math.random()*10))*tt.scale,120*tt.scale,60*tt.scale);tt.attakerBJ++;tt.attackerInfoRefresh[2]=true;}}
if(tt.bjTimes[i]==1){tt.bufferCtx.drawImage(attackImage,0,0,attackImage.width,attackImage.height,startX,(260+(parseInt(i)*240))*tt.scale,attackImage.width*tt.scale,attackImage.height*tt.scale);tt.resetAttake(tempInfo.attack,0);}
if(tt.bjTimes[i]==2){tt.bufferCtx.drawImage(attackImage,0,0,attackImage.width,attackImage.height,startX,(252+(parseInt(i)*240))*tt.scale,attackImage.width*tt.scale,attackImage.height*tt.scale);}else if(tt.bjTimes[i]>=3&&tt.bjTimes[i]<8){tt.bufferCtx.drawImage(attackImage,0,0,attackImage.width,attackImage.height,startX,(248+(parseInt(i)*240))*tt.scale,attackImage.width*tt.scale,attackImage.height*tt.scale);}
if(tt.bjTimes[i]==8){tt.bufferCtx.drawImage(attackImage,0,0,attackImage.width,attackImage.height,startX,(247+(parseInt(i)*240))*tt.scale,attackImage.width*tt.scale,attackImage.height*tt.scale);if(tt.heroNumTag){if(tt.attakeTimes!=tt.maxTimes&&i==2){tt.boutOver=0;}else if(tt.attakeTimes==tt.maxTimes&&tt.attakerImageSource.length==parseInt(i)+1){tt.boutOver=1;}}}
tt.bjTimes[i]++;}}else{var ttM=parseInt(i)+1;if(ttM<3){tt.attackerTag[ttM]=true;}}}}}else{tt.bufferCtx.drawImage(tempHero,0,0,tempHero.width,tempHero.height,70*tt.scale,(200+(parseInt(i)*240))*tt.scale,200*tt.scale,240*tt.scale);}}}
Mojo.ui.BattleAnimation.defenderAttack=function(){var tt=Mojo.ui.BattleAnimation;var tempImage=tt.defenderImageSource;var infoKZ=tt.infoSImage[0];var infoDK=tt.infoSImage[1];var infoFH=tt.infoSImage[3];for(i in tempImage){var tempHero=tempImage[i];var tempInfo=tt.defenderInfo[i];if(!tt.defenderShowOver){var attackImage=tt.infoAttackValueImg[3+parseInt(i)];var startX=(320+320/2-attackImage.width/2)*tt.scale;if(tt.fhTimes[i]==1){tt.bufferCtx.drawImage(tt.circleAttaker(tempHero,1),0,0,tempHero.width,tempHero.height,(370+20)*tt.scale,(200+(parseInt(i)*240)+20)*tt.scale,200*tt.scale,230*tt.scale);}else if(tt.fhTimes[i]==2){tt.bufferCtx.drawImage(tempHero,0,0,tempHero.width,tempHero.height,(370+20)*tt.scale,(200+(parseInt(i)*240))*tt.scale,200*tt.scale,240*tt.scale);}else if(tt.fhTimes[i]==3){tt.bufferCtx.drawImage(tempHero,0,0,tempHero.width,tempHero.height,(370+10)*tt.scale,(200+(parseInt(i)*240))*tt.scale,200*tt.scale,240*tt.scale);}else{tt.bufferCtx.drawImage(tempHero,0,0,tempHero.width,tempHero.height,370*tt.scale,(200+(parseInt(i)*240))*tt.scale,200*tt.scale,240*tt.scale);}
if(tempInfo.is_res>0&&tt.kzTimes<tt.kzImage.length){var tempKZImg=tt.kzImage[tt.kzTimes];tt.bufferCtx.drawImage(tempKZImg,0,0,tempKZImg.width,tempKZImg.height,370*tt.scale,(200+(parseInt(i)*240))*tt.scale,200*tt.scale,200*tt.scale);if(tt.kzTimes==2){tt.bufferCtx.drawImage(infoKZ,0,0,infoKZ.width,infoKZ.height,420*tt.scale,(360+(parseInt(i)*240))*tt.scale,90*tt.scale,40*tt.scale);}else if(tt.kzTimes==3){tt.bufferCtx.drawImage(infoKZ,0,0,infoKZ.width,infoKZ.height,412*tt.scale,(352+(parseInt(i)*240))*tt.scale,96*tt.scale,48*tt.scale);}else if(tt.kzTimes==4){tt.bufferCtx.drawImage(infoKZ,0,0,infoKZ.width,infoKZ.height,410*tt.scale,(350+(parseInt(i)*240))*tt.scale,100*tt.scale,50*tt.scale);}else if(tt.kzTimes==5){tt.bufferCtx.drawImage(infoKZ,0,0,infoKZ.width,infoKZ.height,(400+(Math.random()*10))*tt.scale,(340+(parseInt(i)*240)+(Math.random()*10))*tt.scale,120*tt.scale,60*tt.scale);}else if(tt.kzTimes==6){tt.bufferCtx.drawImage(infoKZ,0,0,infoKZ.width,infoKZ.height,(400+(Math.random()*10))*tt.scale,(340+(parseInt(i)*240)+(Math.random()*10))*tt.scale,120*tt.scale,60*tt.scale);}else if(tt.kzTimes==7){tt.bufferCtx.drawImage(infoKZ,0,0,infoKZ.width,infoKZ.height,(400+(Math.random()*10))*tt.scale,(340+(parseInt(i)*240)+(Math.random()*10))*tt.scale,120*tt.scale,60*tt.scale);tt.defenderKZ++;tt.defenderInfoRefresh[0]=true;}}
if(tt.dkShowTag){if(tempInfo.is_anti_res>0&&tt.dkTimes>0&&tt.dkTimes<tt.dkImage.length){var tempDKImg=tt.dkImage[tt.dkTimes];tt.bufferCtx.drawImage(tempDKImg,0,0,tempDKImg.width,tempDKImg.height,335*tt.scale,(180+(parseInt(i)*240))*tt.scale,260*tt.scale,260*tt.scale);if(tt.dkTimes==2){tt.bufferCtx.drawImage(infoDK,0,0,infoDK.width,infoDK.height,420*tt.scale,(360+(parseInt(i)*240))*tt.scale,90*tt.scale,40*tt.scale);}else if(tt.dkTimes==3){tt.bufferCtx.drawImage(infoDK,0,0,infoDK.width,infoDK.height,412*tt.scale,(352+(parseInt(i)*240))*tt.scale,96*tt.scale,48*tt.scale);}else if(tt.dkTimes==4){tt.bufferCtx.drawImage(infoDK,0,0,infoDK.width,infoDK.height,410*tt.scale,(350+(parseInt(i)*240))*tt.scale,100*tt.scale,50*tt.scale);}else if(tt.dkTimes==5){tt.bufferCtx.drawImage(infoDK,0,0,infoDK.width,infoDK.height,(400+(Math.random()*10))*tt.scale,(340+(parseInt(i)*240)+(Math.random()*10))*tt.scale,120*tt.scale,60*tt.scale);}
if(tt.dkTimes==6){tt.bufferCtx.drawImage(infoDK,0,0,infoDK.width,infoDK.height,(400+(Math.random()*10))*tt.scale,(340+(parseInt(i)*240)+(Math.random()*10))*tt.scale,120*tt.scale,60*tt.scale);}else if(tt.dkTimes==7){tt.bufferCtx.drawImage(infoDK,0,0,infoDK.width,infoDK.height,(400+(Math.random()*10))*tt.scale,(340+(parseInt(i)*240)+(Math.random()*10))*tt.scale,120*tt.scale,60*tt.scale);tt.defenderDK++;tt.defenderInfoRefresh[1]=true;}}}
if(tt.dkTimes>=10){if(tt.defenderTag[i]){if(tt.fhTimes[i]<tt.fhImage.length){var tempFHImg=tt.fhImage[tt.fhTimes[i]];tt.bufferCtx.drawImage(tempFHImg,0,0,tempFHImg.width,tempFHImg.height,315*tt.scale,(200+(parseInt(i)*240))*tt.scale,216*tt.scale,240*tt.scale);if(tempInfo.armor_add_defence>0){if(tt.fhTimes[i]==2){tt.bufferCtx.drawImage(infoFH,0,0,infoFH.width,infoFH.height,420*tt.scale,(360+(parseInt(i)*240))*tt.scale,90*tt.scale,40*tt.scale);}else if(tt.fhTimes[i]==3){tt.bufferCtx.drawImage(infoFH,0,0,infoFH.width,infoFH.height,412*tt.scale,(352+(parseInt(i)*240))*tt.scale,96*tt.scale,48*tt.scale);}else if(tt.fhTimes[i]==4){tt.bufferCtx.drawImage(infoFH,0,0,infoFH.width,infoFH.height,410*tt.scale,(350+(parseInt(i)*240))*tt.scale,100*tt.scale,50*tt.scale);}else if(tt.fhTimes[i]==5){tt.bufferCtx.drawImage(infoFH,0,0,infoFH.width,infoFH.height,(400+(Math.random()*10))*tt.scale,(340+(parseInt(i)*240)+(Math.random()*10))*tt.scale,120*tt.scale,60*tt.scale);}else if(tt.fhTimes[i]==6){tt.bufferCtx.drawImage(infoFH,0,0,infoFH.width,infoFH.height,(400+(Math.random()*10))*tt.scale,(340+(parseInt(i)*240)+(Math.random()*10))*tt.scale,120*tt.scale,60*tt.scale);tt.defenderFH++;tt.defenderInfoRefresh[2]=true;}else if(tt.fhTimes[i]==7){tt.bufferCtx.drawImage(infoFH,0,0,infoFH.width,infoFH.height,(400+(Math.random()*10))*tt.scale,(340+(parseInt(i)*240)+(Math.random()*10))*tt.scale,120*tt.scale,60*tt.scale);}}
if(tt.fhTimes[i]==4){tt.bufferCtx.drawImage(attackImage,0,0,attackImage.width,attackImage.height,startX,(260+(parseInt(i)*240))*tt.scale,attackImage.width*tt.scale,attackImage.height*tt.scale);tt.resetAttake(tempInfo.defence,1);}
if(tt.fhTimes[i]==5){tt.bufferCtx.drawImage(attackImage,0,0,attackImage.width,attackImage.height,startX,(254+(parseInt(i)*240))*tt.scale,attackImage.width*tt.scale,attackImage.height*tt.scale);}else if(tt.fhTimes[i]==6){tt.bufferCtx.drawImage(attackImage,0,0,attackImage.width,attackImage.height,startX,(250+(parseInt(i)*240))*tt.scale,attackImage.width*tt.scale,attackImage.height*tt.scale);}else if(tt.fhTimes[i]>=7&&tt.fhTimes[i]<12){tt.bufferCtx.drawImage(attackImage,0,0,attackImage.width,attackImage.height,startX,(247+(parseInt(i)*240))*tt.scale,attackImage.width*tt.scale,attackImage.height*tt.scale);}else
if(tt.fhTimes[i]==12){if(!tt.heroNumTag){if(tt.attakeTimes!=tt.maxTimes&&i==2){tt.boutOver=0;}else if(tt.attakeTimes==tt.maxTimes&&tt.defenderImageSource.length==parseInt(i)+1){tt.boutOver=1;}}}
tt.fhTimes[i]++;}else{var ttM=parseInt(i)+1;if(ttM<3){tt.defenderTag[ttM]=true;}}}}}else{tt.bufferCtx.drawImage(tempHero,0,0,tempHero.width,tempHero.height,370*tt.scale,(200+(parseInt(i)*240))*tt.scale,200*tt.scale,240*tt.scale);}}}
Mojo.ui.BattleAnimation.attack=function(){var tt=Mojo.ui.BattleAnimation;if(!tt.kzShowTag||tt.kzTimes>13){tt.dkShowTag=true;tt.dkTimes++;}
tt.attakerAttack();tt.defenderAttack();if(0==tt.boutOver){tt.gameLater++;if(tt.gameLater>6){tt.goOn();}}
if(1==tt.boutOver){tt.resultDraw();tt.winTimes++;if(tt.winTimes>25){tt.attackerTag=[true,false,false];tt.defenderTag=[true,false,false];tt.exit();}}
tt.kzTimes++;}
Mojo.ui.BattleAnimation.resultDraw=function(){var tt=Mojo.ui.BattleAnimation;if(tt.winTimes<tt.winImage.length){if(1==tt.winTag){var tempImg=tt.winImage[tt.winTimes];tt.bufferCtx.drawImage(tempImg,0,0,tempImg.width,tempImg.height,70*tt.scale,333*tt.scale,500*tt.scale,295*tt.scale);}else{tt.bufferCtx.drawImage(tt.failImage,0,0,tt.failImage.width,tt.failImage.height,(170-10*tt.winTimes)*tt.scale,(392-5.2*tt.winTimes)*tt.scale,(300+20*tt.winTimes)*tt.scale,(164+10.4*tt.winTimes)*tt.scale);}}else{if(1==tt.winTag){var tempImg=tt.winImage[tt.winImage.length-1];tt.bufferCtx.drawImage(tempImg,0,0,tempImg.width,tempImg.height,70*tt.scale,333*tt.scale,500*tt.scale,295*tt.scale);}else{tt.bufferCtx.drawImage(tt.failImage,0,0,tt.failImage.width,tt.failImage.height,70*tt.scale,333*tt.scale,500*tt.scale,295*tt.scale);}}}
Mojo.ui.BattleAnimation.goOn=function(){var tt=Mojo.ui.BattleAnimation;tt.battleTag="prepare";tt.attakeTimes++;tt.boutOver=2;tt.showXZ=0;tt.kzTimes=0;tt.dkTimes=0;tt.bjTimes=[0,0,0];tt.fhTimes=[0,0,0];tt.attackeLater=[0,0,0];tt.infoAttackValueImg=[null,null,null,null,null,null];tt.attackerTag=[true,false,false];tt.defenderTag=[true,false,false];tt.resetHero();}
Mojo.ui.BattleAnimation.exit=function(){var tt=Mojo.ui.BattleAnimation;try{clearInterval(tt.terval);if(null!=tt.bufferCanvas){document.body.removeChild(tt.bufferCanvas);}
tt.onclose();tt.init();}catch(e){}}})(window,jQuery);;(function(w,$,undefined){w.Mojo=w.Mojo||{};var g=w.Mojo.track=w.Mojo.track||{};w.Mojo.track.Client=Class.extend({init:function(options){var options=$.extend(true,{appKey:'1322184698308194',ruid:'',channel:'html',},options||{});this._c=new trackClient(options.appKey);this._c.setChannel(options.channel);this._c.setRuid(options.ruid);},_valid:function(type,key){if(Mojo.app.data.track==undefined)return true;if(Mojo.app.data.track[type]!=undefined){return Mojo.app.data.track[type][key]!=undefined;}
return false;},sendData:function(async,tm){this._c.sendData(async==undefined?true:false,tm);},onEvent:function(object,action,remark,async,tm){if(!this._valid('events',object))return;this._c.onEvent(object,action,remark,async==undefined?true:false,tm);},onBuy:function(object,cnt,remark,async,tm){if(!this._valid('buys',object))return;this._c.onBuy(object,cnt,remark,async==undefined?true:false,tm);},onSell:function(object,cnt,remark,async,tm){if(!this._valid('sells',object))return;this._c.onSell(object,cnt,remark,async==undefined?true:false,tm);},});g.init=function(params){w.Mojo.track=new w.Mojo.track.Client(params);}})(window,jQuery);;(function(w,$,undefined){w.Mojo=w.Mojo||{};w.Mojo.ui=w.Mojo.ui||{};w.Mojo.ui.ListPanel=w.Mojo.Object.extend({init:function(id,options){this._super(id,options);this.element().addClass('mojo-ui-listpanel');this._children=[];this._hasLoaded=false;var self=this;this._header=$('<div class="header"></div>').appendTo(this.element());this._list=$('<div class="list"></div>')
if(this._options.scrollable){this._scroll=new Mojo.ui.Scroll(undefined,this._list,{direction:2});this.element().append(this._scroll.element());}else{this.element().append(this._list);}
this._footer=$('<div class="footer"></div>').appendTo(this.element());this._more=new Mojo.ui.Button(undefined,{text:this._options.moreLabel,classes:['more'],click:function(btn,e){if(self._options.moreClick instanceof Function){self._options.moreClick(self);}else{if(self._options.refreshable==true){self._list.find(".mojo-ui-listpanel-child").remove();self._children=[];self._more.element().hide();}
self._load();}}});if(this._options.showMore){this._more.element().appendTo(this._list);if(this._options.alwaysMore==true){this._more.element().show();}}
this._load();},_load:function(params){this._showWait();this._options.loadFunc(this._children.length,this._options.pageSize,params,this);},_getDefaultOptions:function(){return{pageSize:10,showMore:true,alwaysMore:false,moreLabel:'More',moreClick:undefined,refreshable:false,drawFunc:$.noop,loadFunc:$.noop,scrollable:false,emptyLabel:null,onLoaded:undefined,direction:2,};},_showWait:function(){this._more.disable(true);if(this._options.showMore===true){$('<div class="waiting"></div>').insertBefore(this._more.element());}else{this._list.append('<div class="waiting"></div>');}},_hideWait:function(){this._list.find('.waiting').remove();this._more.disable(false);},_addChild:function(child){if(child!=undefined&&child!=null){if(this._options.showMore===true){child.element().addClass("mojo-ui-listpanel-child").insertBefore(this._more.element());}else{this._list.append(child.element().addClass("mojo-ui-listpanel-child"));}
this._children.push(child);}},appendData:function(data,showMore){if(this._options.refreshable==true){this.initial();}
var self=this;self._hideWait();if(data!=undefined&&data!=null){if(Array.isArray(data)){$.each(data,function(i,d){self._addChild(self._options.drawFunc(d));});if(self._options.alwaysMore==false&&(data.length<self._options.pageSize||showMore===false)){self._more.element().hide();}}else{self._addChild(self._options.drawFunc(data));if(self._options.alwaysMore==false&&showMore===false){self._more.element().hide();}}
if(this._hasLoaded===false&&this._options.onLoaded instanceof Function){this._options.onLoaded(this);}
this._hasLoaded=true;}
this._list.find('.empty').remove();if(this._children.length==0&&this._options.emptyLabel!=null){if(this._options.showMore){this._more.element().before('<div class="empty">'+this._options.emptyLabel+"</div>");}else{this._list.append('<div class="empty">'+this._options.emptyLabel+"</div>");}
this._more.element().hide();}else if(this._options.alwaysMore==true&&this._children.length>0){this._more.element().show();}
this.rebinding();this.resize();},remove:function(index){this._list.children().eq(index).remove();},removeAll:function(){this._hasLoaded=false;this._list.empty();},clsname:function(){return"ui.ListPanel";},child:function(index){return this._children[index];},children:function(){return this._children;},resize:function(){if(this._options.scrollable&&this._options.direction!=1){var top=this.element().offset().top;var scrollTop=top+this._header.outerHeight(true);var scrollBottom=this._footer.outerHeight(true);var h=this.element().height()-this._header.outerHeight(true)-this._footer.outerHeight(true);var w=this.element().width();this._scroll._window.css({'top':scrollTop+"px",'bottom':scrollBottom+"px",'height':h+"px",'width':w+"px"});}
if(this._options.scrollable){this._scroll.refresh();}},initial:function(){if(this._options.scrollable){this._scroll.initial();}}});})(window,jQuery);;(function(w,jQuery,undefined){w.Mojo=w.Mojo||{};w.Mojo.Page=w.Mojo.Object.extend({init:function(id,options){this._super(id,options);this.element().addClass('mojo-page');Mojo.app.currentPage=this;var self=this;if(this._options.broadcast){this.broadcast=new Mojo.com.Broadcast();this.element().append(this.broadcast.element());}
if(this._options.baseProfile){this.baseProfile=new Mojo.com.BaseProfile({refreshCallback:function(data){self._baseProfileCallback(data);}});this.element().append(this.baseProfile.element());}
if(this._options.fightProfile){this.fightProfile=new Mojo.com.FightProfile({refreshCallback:function(data){self._fightProfileCallback(data);}});this.element().append(this.fightProfile.element());}
$(document.body).append(this.element());this._pageTrack();},_getDefaultOptions:function(){return{broadcast:true,baseProfile:false,fightProfile:false,};},load:function(){var self=this;if(this._options.baseProfile){self.baseProfile.sync();}
if(this._options.fightProfile){self.fightProfile.sync();}
Mojo.app.toast.show('',10,true);},contentViewportHeight:function(){return $(window).height()-
(this._options.broadcast?this.broadcast.element().outerHeight():0)-
(this._options.baseProfile?this.baseProfile.element().outerHeight():0)-
(this._options.fightProfile?this.fightProfile.element().outerHeight():0)-
5;},_pageTrack:function(){if(Mojo.utils.getFromParams('__track_event_object__')!=undefined){Mojo.track.onEvent(Mojo.utils.getFromParams('__track_event_object__'),Mojo.utils.getFromParams('__track_event_action__'),Mojo.utils.getFromParams('__track_event_remark__'));}
if(Mojo.utils.getFromParams('__track_buy_object__')!=undefined){Mojo.track.onBuy(Mojo.utils.getFromParams('__track_buy_object__'),Mojo.utils.getFromParams('__track_buy_action__'),Mojo.utils.getFromParams('__track_buy_remark__'));}
if(Mojo.utils.getFromParams('__track_sell_object__')!=undefined){Mojo.track.onSell(Mojo.utils.getFromParams('__track_sell_object__'),Mojo.utils.getFromParams('__track_sell_action__'),Mojo.utils.getFromParams('__track_sell_remark__'));}},_fightProfileCallback:function(data){},_baseProfileCallback:function(data){},refreshProfile:function(){if(this.baseProfile!=undefined){this.baseProfile.sync();}
if(this.fightProfile!=undefined){this.fightProfile.sync();}},clsname:function(){return"Page";}});})(window,jQuery);;(function($){var escapeable=/["\\\x00-\x1f\x7f-\x9f]/g,meta={'\b':'\\b','\t':'\\t','\n':'\\n','\f':'\\f','\r':'\\r','"':'\\"','\\':'\\\\'};$.toJSON=typeof JSON==='object'&&JSON.stringify?JSON.stringify:function(o){if(o===null){return'null';}
var type=typeof o;if(type==='undefined'){return undefined;}
if(type==='number'||type==='boolean'){return''+o;}
if(type==='string'){return $.quoteString(o);}
if(type==='object'){if(typeof o.toJSON==='function'){return $.toJSON(o.toJSON());}
if(o.constructor===Date){var month=o.getUTCMonth()+1,day=o.getUTCDate(),year=o.getUTCFullYear(),hours=o.getUTCHours(),minutes=o.getUTCMinutes(),seconds=o.getUTCSeconds(),milli=o.getUTCMilliseconds();if(month<10){month='0'+month;}
if(day<10){day='0'+day;}
if(hours<10){hours='0'+hours;}
if(minutes<10){minutes='0'+minutes;}
if(seconds<10){seconds='0'+seconds;}
if(milli<100){milli='0'+milli;}
if(milli<10){milli='0'+milli;}
return'"'+year+'-'+month+'-'+day+'T'+
hours+':'+minutes+':'+seconds+'.'+milli+'Z"';}
if(o.constructor===Array){var ret=[];for(var i=0;i<o.length;i++){ret.push($.toJSON(o[i])||'null');}
return'['+ret.join(',')+']';}
var name,val,pairs=[];for(var k in o){type=typeof k;if(type==='number'){name='"'+k+'"';}else if(type==='string'){name=$.quoteString(k);}else{continue;}
type=typeof o[k];if(type==='function'||type==='undefined'){continue;}
val=$.toJSON(o[k]);pairs.push(name+':'+val);}
return'{'+pairs.join(',')+'}';}};$.evalJSON=typeof JSON==='object'&&JSON.parse?JSON.parse:function(src){return eval('('+src+')');};$.secureEvalJSON=typeof JSON==='object'&&JSON.parse?JSON.parse:function(src){var filtered=src.replace(/\\["\\\/bfnrtu]/g,'@').replace(/"[^"\\\n\r]*"|true|false|null|-?\d+(?:\.\d*)?(?:[eE][+\-]?\d+)?/g,']').replace(/(?:^|:|,)(?:\s*\[)+/g,'');if(/^[\],:{}\s]*$/.test(filtered)){return eval('('+src+')');}else{throw new SyntaxError('Error parsing JSON, source is not valid.');}};$.quoteString=function(string){if(string.match(escapeable)){return'"'+string.replace(escapeable,function(a){var c=meta[a];if(typeof c==='string'){return c;}
c=a.charCodeAt();return'\\u00'+Math.floor(c/16).toString(16)+(c%16).toString(16);})+'"';}
return'"'+string+'"';};})(jQuery);;(function(w,$){w.Mojo=w.Mojo||{};w.Mojo.cache=w.Mojo.cache||{set:function(k,v,expire){var item={val:v,expire:expire!=undefined?(new Date().getTime()/1000+expire):-1,}
localStorage.setItem(k,$.toJSON(item));},get:function(k){if(k==undefined)return undefined;var o=localStorage.getItem(k);if(o&&o!=''&&o!=undefined){try{o=$.parseJSON(o);}catch(err){return undefined;}
if(o.expire==-1||o.expire>=(new Date().getTime()/1000)){return o.val;}}
return undefined;},remove:function(k){localStorage.remove(k);}}})(window,jQuery);;(function(w,$,undefined){w.Mojo=w.Mojo||{};w.Mojo.com=w.Mojo.com||{};w.Mojo.com.Broadcast=w.Mojo.Object.extend({clsname:function(){return"com.Broadcast";},init:function(options){this._super('com-broadcast',options);this.element().addClass('mojo-com-broadcast');this.element().append('<div class="icon"></div>');this._wrapper=$('<div class="wrapper"></div>').appendTo(this.element());var self=this;this._interval=w.setInterval(function(){self.sync();},300000);this._index=0;this._run();},_run:function(){if(this._data==undefined||this._data==null||this._data.length==0){this._running=false;this.sync();}else{this._running=true;var self=this;if(this._index>=this._data.length)this._index=0;this._current=this._data[this._index];var item=this._genItem(this._current);this["_display"+this._options.display](item);}},_display0:function(item){var self=this;item.animate({left:-item.width(),},{duration:(item.width()+self._wrapper.width())*40,complete:function(){$(this).remove();self._index=parseInt((self._index+1)%self._data.length);self._run();},});},_display1:function(item){var self=this;item.animate({top:"-="+self._wrapper.height(),},{duration:1000,complete:function(){if($(this).position().top+$(this).height()>self._wrapper.height()){setTimeout(function(){self._display1(item);},2000);}else{$(this).delay(3000).animate({opacity:0,},{duration:1000,complete:function(){$(this).remove();self._index=parseInt((self._index+1)%self._data.length);self._run();}});}},});},_genItem:function(data){if(this._options.display==0){return $('<div class="item">'+data.content+'</div>').appendTo(this._wrapper).css('left',this._wrapper.width()).css('top',0);}
return $('<div class="item">'+data.content+'</div>').appendTo(this._wrapper).css('left',0).css('top',this._wrapper.height());},_getDefaultOptions:function(){return{display:1,};},sync:function(){var self=this;var data=Mojo.cache.get("broadcast");if(data!=undefined){self._data=data;if(!self._running){self._run();}}else{Mojo.ajax('/message/broadcast',{start:0,count:1,},function(result){if(result.errorCode==0){self._data=result.data;Mojo.cache.set("broadcast",self._data,300);if(!self._running){self._run();}}});}},});})(window,jQuery);;(function(w,$,undefined){w.Mojo=w.Mojo||{};w.Mojo.ui=w.Mojo.ui||{};w.Mojo.ui.PagePanel=w.Mojo.Object.extend({init:function(id,options){this._super(id,options);this.element().addClass("mojo-ui-pagepanel");this._children={_length:0,_end:undefined};this._current=-1;this._hasLoaded=false;this._panel=$('<div class="panel"></div>').appendTo(this.element());if(this._options.selector&&this._options.selector.element()instanceof jQuery){if(this._options.selectorPosition=="top"){this._options.selector.element().prependTo(this.element());}else{this._options.selector.element().appendTo(this.element());}}
this._load();},_load:function(){this._showWait();this._options.loadFunc(this);},refreshSelector:function(data){if(this._options.selector){this._options.selector.refreshAll(data);}},selector:function(current){if(this._options.beforeSelectFunc instanceof Function){this._options.beforeSelectFunc(this,current);}
if(current!=this._current){if(this._options.count>-1&&current>=this._options.count&&this._children._end){current="_end";}
var child=this._children[current];var lastChild=this._children[this._current];if(lastChild!=undefined&&lastChild!=null){this._children[this._current].element().hide();}else{for(var ck in this._children){if(this._children[ck]&&this._children[ck].element){this._children[ck].element().hide();}}}
if(child!=undefined&&child!=null){child.element().show();this._current=current;if(this._options.selector&&this._options.selector.selector){this._options.selector.selector(current);}
if(this._hasLoaded===false&&this._options.onLoaded instanceof Function){this._options.onLoaded(this._current);this._hasLoaded=true;}
if(this._options.selectFunc instanceof Function){this._options.selectFunc(current);}}else{this._showWait();this._options.loadFunc(this,current);}}},isEnd:function(current){if(current===undefined){current=this._current;}
if(current=='_end'||parseInt(current)>=this._options.count){return true;}
return false;},addData:function(data,start,append){var self=this;if(data!=undefined&&data!=null){if(Array.isArray(data)){$.each(data,function(i,d){if(Mojo.utils.isNone(self._children[start])==false){self._children[start].element().remove();}
self._children[start]=self._options.drawFunc(this,d);if(append===true){self._children._end=self._children[start];}
self._panel.append(self._children[start].element().hide());start++;self._children._length++;});}else{if(Mojo.utils.isNone(self._children[start])==false){self._children[start].element().remove();}
self._children[start]=self._options.drawFunc(this,data);if(append===true){self._children._end=self._children[start];}
self._children._length++;self._panel.append(self._children[start].element().hide());}}
this._hideWait();},removeData:function(index){if(index instanceof Function){var self=this;$.each(this._children,function(i,o){if(i!="_end"&&i!="_length"&&index(i,o)===true){self._children[i]=undefined;}});}else if(this._children[index]){this._children[index]=undefined;}},getSelectedObject:function(current){if(current===undefined){current=this._current;}
return this._children[current];},_showWait:function(){this._hideWait();this._panel.append('<div class="waiting"></div>');},_hideWait:function(){this._panel.find('.waiting').remove();},_getDefaultOptions:function(){return{selector:undefined,selectorPosition:"top",count:-1,loadFunc:$.noop,drawFunc:$.noop,beforeSelectFunc:$.noop,selectFunc:$.noop,onLoaded:undefined};},clsname:function(){return"ui.PagePanel";}});})(window,jQuery);;(function(w,$,undefined){w.Mojo=w.Mojo||{};w.Mojo.com=w.Mojo.com||{};w.Mojo.com.CommonDialog=w.Mojo.ui.Dialog.extend({clsname:function(){return"com.CommonDialog";},init:function(id,options){this._super(id,options);this.element().addClass("mojo-com-commondialog");this.leftButton=undefined;this.rightButton=undefined;this._addButtons();},_getDefaultOptions:function(){return $.extend(true,this._super(),{leftBtnText:undefined,leftBtnDisabled:false,leftBtnClick:undefined,leftBtnDisabledClick:undefined,rightBtnText:undefined,rightBtnDisabled:false,rightBtnClick:undefined,rightBtnDisabledClick:undefined});},_addButtons:function(){var self=this;if(self._options.leftBtnText){self.leftButton=new Mojo.ui.Button(undefined,{text:self._options.leftBtnText,disabled:self._options.leftBtnDisabled,special:"button-big-red",click:function(){if(self._options.leftBtnClick instanceof Function){self._options.leftBtnClick(self);}},disableClick:function(){if(self._options.leftBtnDisabledClick instanceof Function){self._options.leftBtnDisabledClick(self);}}});self.leftButton.element().appendTo(self._footer);}
if(self._options.rightBtnText){self.rightButton=new Mojo.ui.Button(undefined,{text:self._options.rightBtnText,disabled:self._options.rightBtnDisabled,click:function(){if(self._options.rightBtnClick instanceof Function){self._options.rightBtnClick(self);}},disableClick:function(){if(self._options.rightBtnDisabledClick instanceof Function){self._options.rightBtnDisabledClick(self);}}});self.rightButton.element().appendTo(self._footer);}}});})(window,jQuery);;(function(w,$,undefined){w.Mojo=w.Mojo||{};w.Mojo.com=w.Mojo.com||{};w.Mojo.com.NeedBuyDialog=Mojo.ui.Dialog.extend({clsname:function(){return"com.NeedBuyDialog";},init:function(id,options){this._super(id,options);this.element().addClass("mojo-com-needbuydialog");this._paragraph=undefined;this._goods=undefined;this._buyBtn=undefined;this._useBtn=undefined;this._nextRestoreTime=this._options.nextRestoreTime;this._allRestoreTime=(this._options.stamina-this._options.restoreCount-1)*this._options.allRestoreTime+this._nextRestoreTime;this._handle=undefined;this._refreshParagraph();this._refreshGoods();this._addButtons();this._refreshRestoreStatus();},_refreshParagraph:function(){if(this._paragraph==undefined){this._paragraph=$('<div class="paragraph"></div>').appendTo(this._content);}
var html=this._options.needBuyTip+'<br/>'+this._options.nextRestoreText+Mojo.utils.formatTime(this._nextRestoreTime)+'<br/>'+this._options.allRestoreText+Mojo.utils.formatTime(this._allRestoreTime)+'<br/>';this._paragraph.html(html);},_refreshGoods:function(){var self=this;if(this._goods==undefined){this._goods=$('<div class="goods"></div>').appendTo(this._content);$('<div class="card"></div>').append($('<img/>').attr('src',this._options.goods.goods_small_image)).append($('<div class="count"></div>').html(this._options.goods.count)).appendTo(this._goods);this._goods.append($('<div class="name"></div>').html(this._options.goods.goods_name)).append($('<div class="desc"></div>').html(this._options.goods.goods_description)).append((new Mojo.com.Price({'rm':self._options.goods.goods_rm,'vm':self._options.goods.goods_vm})).element());}
self._goods.find('.count').html(self._options.goods.count);if(self._useBtn){if(self._options.goods.count>0){self._useBtn.disable(false);}else{self._useBtn.disable(true);}}},_addButtons:function(){var self=this;var disabled=true;if(self._options.goods.count>0){disabled=false;}
this._useBtn=new Mojo.ui.Button(undefined,{text:self._options.useBtnText,disabled:disabled,click:function(){self._useBtn.disable(true);Mojo.ajax('/entity/Use',{id:self._options.goods.id},function(result){if(result.errorCode==0){self._options.goods.count-=1;self._refreshGoods();if(self._options.goods.count>0){self._useBtn.disable(false);}
if(self._options.useBtnClick instanceof Function){self._options.useBtnClick(self,result);}}else{Mojo.app.toast.show(result.errorMsg);}},function(){self._useBtn.disable(false);},{showWait:true});}});this._useBtn.element().appendTo(this._footer);this._buyBtn=new Mojo.ui.Button(undefined,{text:self._options.buyBtnText,special:'button-big-red',click:function(){self.hide();var buyWarningDialog=new Mojo.ui.Dialog(undefined,{title:Mojo.utils.locale('common','buy_warning_title'),content:$('<div class="tip">'+Mojo.utils.locale('common','buy_warning_content')+'</div>'),deviceaware:true});new Mojo.ui.Button(undefined,{text:Mojo.utils.locale('common','sure_buy'),special:"button-big-red",click:function(){buyWarningDialog.close();self.show();Mojo.ajax('/mall/Buy',{id:self._options.goods.goods_id},function(result){self._buyBtn.disable(false);if(result.errorCode==0){if(self._options.buyBtnClick instanceof Function){self._options.buyBtnClick(self,result);}
self._options.goods.count=parseInt(self._options.goods.count)+1;self._options.goods.id=result.data.entities[0].player_entity_id;self._refreshGoods();Mojo.app.toast.show(Mojo.utils.locale("common","buy_something_success",{name:self._options.goods.goods_name}));}else{if(result&&result.errorCode=='10005'){(new Mojo.com.BuyFailDialog({message:result.errorMsg,close:function(){self.show();},})).open(true);}else{Mojo.app.toast.show(result.errorMsg);}}});self._buyBtn.disable(true);}}).element().appendTo(buyWarningDialog._footer);new Mojo.ui.Button(undefined,{text:Mojo.utils.locale('common','think_again'),special:'button-big-blue',click:function(){buyWarningDialog.close();self.show();}}).element().appendTo(buyWarningDialog._footer);buyWarningDialog.open(true);}});this._buyBtn.element().appendTo(this._footer);},_refreshRestoreStatus:function(){var self=this;self._nextRestoreTime-=1;self._allRestoreTime-=1;if(self._nextRestoreTime<0){self._nextRestoreTime=self._options.allRestoreTime-1;}
if(self._allRestoreTime>=0){self._refreshParagraph();self._handle=setTimeout(function(){self._refreshRestoreStatus();},1000);}},_getDefaultOptions:function(){var self=this;return $.extend(true,this._super(),{goods:{},stamina:0,restoreCount:0,allRestoreText:"",allRestoreTime:0,nextRestoreText:"",nextRestoreTime:0,restoreText:"",needBuyTip:"",buyBtnText:Mojo.utils.locale('common','buy'),buyBtnClick:undefined,useBtnText:Mojo.utils.locale('common','use'),useBtnClick:undefined});}});})(window,jQuery);;(function(w,$,undefined){w.Mojo=w.Mojo||{};w.Mojo.page=w.Mojo.page||{};w.Mojo.page.Force=w.Mojo.Object.extend({clsname:function(){return"page.Force";},_current:undefined,init:function(index){var self=this;w.Mojo.page.Force.getController=function(){return self;};this._super(undefined,undefined);this.element().addClass('mojo-page');this._mojoajax=w.Mojo.ajax;w.Mojo.ajax=function(url,params,callback,onError,options){self._mojoajax(url,params,function(response){if(response&&response.errorCode===130019){if(self._commonDlg!=undefined)return;(self._commonDlg=new Mojo.com.CommonDialog(undefined,{title:Mojo.utils.locale('force','fail_to_do'),content:$('<div class="paragraph"></div>').html(Mojo.utils.locale('force','cannot_do_it')),leftBtnText:Mojo.utils.locale('common','close'),leftBtnClick:function(that){Mojo.app.redirect('/home');},close:function(){Mojo.app.redirect('/home');}})).open(true);}else if(callback instanceof Function){callback(response);}},onError,options);};w.Mojo.ajax.baseUrl=this._mojoajax.baseUrl;this._addBroadcast();this._addProfile();$(document.body).append(this.element());this.sync(function(){self.switchTo(index);});},_addBroadcast:function(){this._broadcast=new Mojo.com.Broadcast();this.element().append(this._broadcast.element());},_addProfile:function(){var self=this;this._forceProfile=new Mojo.com.ForceBaseProfile({getController:function(){return self;},profileUpdate:function(force,player){self._notifyComponet(force,player);}});this.element().append(this._forceProfile.element());},_notifyComponet:function(force,player){for(var index in this.cache){if(this.cache[index]._options.profileUpdated){this.cache[index]._options.profileUpdated(force,player);}}},routeTable:{0:"Mojo.com.ForceBase",1:"Mojo.com.ForceInternal",2:"Mojo.com.ForceWar",3:"Mojo.com.ForceExchange",4:"Mojo.com.ForceMember",5:"Mojo.com.ForceEvent",6:"Mojo.com.ForceRanking"},cache:{},getInstance:function(index,args){var self=this;if(this.cache[index]==undefined){this._create(index,args);}else{var ins=this.cache[index];if(args.refresh==1){ins.element().remove();this.cache[index]=undefined;this._create(index,args);}}
return this.cache[index];},_create:function(index,args){var clsname=this.routeTable[index];var packages=clsname.split('.');var parent=w;var cls=undefined;for(var i=0;i<packages.length;i++){cls=parent[packages[i]];parent=cls;}
var instance=new cls(args);instance.element().appendTo(this.element());this.cache[index]=instance;return instance;},switchToHome:function(args){this.switchTo(0,args);},_defaultOptions:function(){return{refresh:0,};},_sysOptions:function(index){var self=this;return{getController:function(){return self;},getComIndex:function(){return index;}};},switchTo:function(index,args){var self=this;var param=this._defaultOptions();$.extend(true,param,args||{});$.extend(true,param,this._sysOptions(index));var prev=this._current;var instance=this.getInstance(index,param);if(prev&&instance){prev.hide();if(prev.pause){prev.pause();}}
if(instance){this._current=instance;instance.show();if(instance.refreshData){instance.refreshData();}}},load:function(){Mojo.app.toast.show('',10,true);},sync:function(callback){this._forceProfile.sync(callback);},syncForce:function(callback){this._forceProfile.syncForce(callback);},getProfile:function(){return this._forceProfile;},getData:function(){var self=this;var data={force_info:self.getForceProfile(),player_info:self.getPlayerProfile()};return data;},getForceProfile:function(){return this._forceProfile._force;},getPlayerProfile:function(){return this._forceProfile._player;},updateForceProfile:function(force){this._forceProfile._force=$.extend(true,this.getForceProfile(),force);this._forceProfile._refresh();},updatePlayerProfile:function(player){this._forceProfile._player=$.extend(true,this.getPlayerProfile(),player);this._forceProfile._refresh();},diffPlayer:function(player){this._forceProfile.updatePlayerDiff(player);this._forceProfile._refresh();},diffForce:function(force){this._forceProfile.updateForceDiff(force);this._forceProfile._refresh();},debugable:function(){return Mojo.utils.debug.vars.page.force;},hideCurrent:function(){if(this._current){this._current.hide();}},showCurrent:function(){if(this._current){this._current.show();}},});})(window,jQuery);;(function(w,$,undefined){w.Mojo=w.Mojo||{};w.Mojo.com=w.Mojo.com||{};w.Mojo.com.ForceBase=w.Mojo.Object.extend({clsname:function(){return"com.ForceBase";},init:function(options){this._super(undefined,options);this.element().addClass('mojo-com-forcebase');this._addBase();this._addNotice();this._addChatMsg();this._addViewButton();this._addNavButton();this._refresh();this.force_text='';},_addBase:function(){var self=this;self.nameclass='';var lasttext='';var lbl1class='';var forcetype=this._options.getController().getForceProfile().type;switch(parseInt(forcetype)){case 2:self.nameclass='allyfriend';lasttext='ally_friend';break;case 3:self.nameclass='taxrate';lasttext='tax_rate';break;case 4:self.nameclass='precount';lasttext='prefect_count';break;default:self.nameclass='other';}
var intro=$("<div class='intro'></div>").appendTo(this.element());this._fname=$("<div class='fname short'></div>");this._fnameicon=$("<div></div>");this._fnameicon.addClass(self.nameclass);this._fnametext=$("<div class='fnametext'></div>");var stateowner=this._options.getController().getPlayerProfile().state_owner;switch(parseInt(stateowner)){case 1:lbl1class='stateowner';break;default:lbl1class='owner';}
this._lbl1=new Mojo.ui.Label(undefined,{classes:['lbl',lbl1class],text:self.locale('chairman')});this._lbl3=new Mojo.ui.Label(undefined,{classes:['lbl','member'],text:self.locale('member_count_txt')});this._fgrain=new Mojo.ui.Label(undefined,{classes:['fgrain'],text:self.locale('grain'),});this._lastlbl=new Mojo.ui.Label(undefined,{classes:[self.nameclass],text:self.locale(lasttext),});intro.append(this._fname).append(this._lbl1.element()).append(this._lbl3.element()).append(this._fgrain.element()).append(this._lastlbl.element());this._fname.append(this._fnametext);this._restoreInterval=w.setInterval(function(){self._calcSpAndGrain();},1000);intro.click(function(){if(self._force==undefined)return;Mojo.track.onEvent('24_301');(this._fpdlg=new Mojo.com.ForceProfileDialog(self._force,self._player,{getData:function(){return self._force;},getController:function(){return self._options.getController();},})).open();this._fpdlg._scroll.refresh();});},_addNotice:function(){var self=this;self.noticearea=$('<div class="notice"></div>').appendTo(this.element());self._header=$('<div class="n-header"><span></span><marquee scrollamount="2"></marquee></div>').appendTo(self.noticearea).click(function(){self._onEditNotice();});},_addChatMsg:function(){var self=this;self._chat=$('<div class="n-content chat-channel"></div>').appendTo(self.noticearea);self._chatlist=$('<div class="list"></div>');self._chatscroll=new Mojo.ui.Scroll(undefined,self._chatlist,{direction:2});self._chat.append(self._chatscroll.element());self._chat.click(function(){Mojo.app.redirect('/chat',{selected:1,history:1});});if(Mojo.supportTouch()){self._chatlist.bind('touchstart',function(event){event.stopPropagation();});}else{self._chatlist.bind('mousedown',function(event){event.stopPropagation();});}},_onEditNotice:function(){var self=this;var editable=false;if(Mojo.utils.isNone(self._player)){return;}
if(self._player.position_id<=4){editable=true;}else{}
(new Mojo.com.ForceNoticeDialog(self._force,{getController:self._options.getController,editable:editable,showNotice:true,okBtnText:Mojo.utils.locale('force','notice_edit_btn')})).open();},_addChatButton:function(){var self=this;this._chatBtn=new Mojo.ui.Button(undefined,{text:self.locale('chat'),classes:['chat'],click:function(){Mojo.app.redirect('/chat',{selected:1,history:1});},});this._chatBtn.element().appendTo(self.noticearea);},_addViewButton:function(){var self=this;this._viewBtn=new Mojo.ui.Button(undefined,{text:Mojo.utils.locale('common','view'),classes:['chat','view'],click:function(){self._onEditNotice();},});this._viewBtn.element().appendTo(self.noticearea);},_addNavButton:function(){var self=this;var buttonArea=$('<div class="button-area"></div>').appendTo(this.element());this._everydaydo=$('<div class="everyday-do"></div>').appendTo(buttonArea);var btns=[{id:'btn-internal',text:'internal',index:1,refresh:1,isNew:true,eventCode:'24_303'},{id:'btn-foreign',text:'foreign',index:2,refresh:1,eventCode:'24_304'},{id:'btn-exchange',text:'exchange',index:3,refresh:0,eventCode:'24_305'},{id:'btn-member',text:'member',index:4,refresh:1,eventCode:'24_306'},{id:'btn-event',text:'event',index:5,refresh:1,eventCode:'24_307'},{id:'btn-relation',text:'relation',index:6,refresh:1,eventCode:'24_309'},];var ForceButton=[];self.TipsCount=[];var buffdlgs=self._options.getController().getPlayerProfile().messageRemindCount;$.each(btns,function(i,b){ForceButton[i]=new Mojo.ui.Button(b.id,{click:function(){switch(i){case 0:buffdlgs.task=0;break;case 2:buffdlgs.exchange=0;break;case 4:buffdlgs.event=0;break;}
if(i==5){var relationMinLevel=self._options.getController().getForceProfile().min_level_of_network;var armylevel=self._options.getController().getForceProfile().level;if(armylevel<relationMinLevel){new Mojo.com.CommonDialog(undefined,{title:Mojo.utils.locale('force','relation_join_no_dlg_title'),content:$('<div class="paragraph"></div>').html(Mojo.utils.locale('force','relation_join_no',{level:relationMinLevel})),leftBtnText:Mojo.utils.locale('common','close'),leftBtnClick:function(that){that.close();}}).open(true);}else{Mojo.app.redirect('/relation');}}else{self.element().hide();self._options.getController().switchTo(b.index,{refresh:b.refresh,showHeader:true});}
Mojo.track.onEvent(b.eventCode);},text:self.locale(b.text),icon:true,textWrap:true,classes:b.isNew===true?['is_new']:[],});var TipsClass='count';if(i==1||i==5){TipsClass='battleStatus';}
self.TipsCount[i]=$("<div></div>");self.TipsCount[i].addClass(TipsClass);self.TipsCount[i].hide();ForceButton[i].element().append(self.TipsCount[i]);self._everydaydo.append(ForceButton[i].element());});},_calcSpAndGrain:function(){var self=this;if(this._force.challenge<this._force.challenge_limit){if(this._force.challenge_second<0){this._force.challenge_second=this._force.cd_challange;return;}
this._force.challenge_second--;if(this._force.challenge_second==0){this._force.challenge_second=this._force.cd_challange;this._force.challenge++;this._refresh();}}
if(this._force.time_to_assign_grain>0){this._force.time_to_assign_grain--;if(this._force.time_to_assign_grain<=0){w.clearInterval(self._restoreInterval);}}},_refresh:function(){},localeCat:function(){return'force';},_updateInfo:function(force,player){var self=this;self._force=force;self._player=player;self._force.challenge_second=force.time_to_restore_challenge;self._lbl1.text(self.locale('chairman',{title:force.owner.title,name:force.owner.name}));if(force.name.length>3){this._fname.removeClass('short').addClass('long');}
self._lbl3.text(self.locale('member_count_txt')+force.member_num+"/"+force.member_num_limit);self._fgrain.text(self.locale('grain')+force.grain);self._fnameicon.removeClass(this.nameclass);self._lastlbl.element().removeClass(this.nameclass);switch(parseInt(force.type)){case 2:self._lastlbl.text(self.locale('ally_friend')+force.alliance_num+'/'+force.max_alliance);self.nameclass='allyfriend';self.force_text=Mojo.utils.locale('force','force_alliance');break;case 3:self._lastlbl.text(self.locale('tax_rate')+force.tax_ratio+'%');self.nameclass='taxrate';self.force_text=Mojo.utils.locale('force','force_slave');break;case 4:self._lastlbl.text(self.locale('prefect_count')+force.slave_num+'/'+force.max_slave);self.nameclass='precount';self.force_text=Mojo.utils.locale('force','force_master');break;default:self.nameclass='other';self._lastlbl.text("");self.force_text=Mojo.utils.locale('force','force_free');}
self._fnameicon.addClass(this.nameclass);self._lastlbl.element().addClass(this.nameclass);self._fnametext.html(self.force_text+force.name+'('+Mojo.utils.locale('force','current_level',{level:force.level})+')');self._header.find('span').html(self.locale('notice_title'));if(Mojo.utils.trim(force.announcement)==''){self._header.find('marquee').html(self.locale('empty_notice_default_text'));}else{var arr=force.announcement.split('<br />');var announce='';for(var i=0;i<arr.length;i++){announce+=arr[i];}
self._header.find('marquee').html(announce);}
self._chatlist.html('');var ch=0;if(force.force_chat==undefined||force.force_chat.length==0){$('<div class="chatmsg"></div>').html(self.locale('default_chat_message')).appendTo(self._chatlist);}else{var msg='';for(var i=0;i<force.force_chat.length;i++){var data=force.force_chat[i];var chatmsg=$('<div class="chatmsg"></div>');var honor='';if(data.forceTitle!=undefined&&data.forceTitle!=''){honor='[<span class="official">'+data.forceTitle+'</span>]';}
chatmsg.html(honor+'<span class="name">'+data.name+'</span>: '+data.message);chatmsg.appendTo(self._chatlist);if(chatmsg.height()>self._getR('chatMsgHeight'))ch++;}
self._chatscroll.scrollTo(0,self._getR('chatMsgHeight')*ch);self._chatscroll.refresh();}
var playerRemindCount=[player.messageRemindCount.task,player.messageRemindCount.battle,player.messageRemindCount.exchange,0,player.messageRemindCount.event,player.messageRemindCount.relation];var armyRemindCount=player.messageRemindCount.army;$.each(playerRemindCount,function(i,p){if(p>0){if(i==1){self.TipsCount[i].show();}else if(i==5){self.TipsCount[i].show();}else{var count=p;if(count<10){self.TipsCount[i].html(count);}else{self.TipsCount[i].html("N");}
self.TipsCount[i].show();if(i==0){self._everydaydo.find(".is_new .icon").hide();}}}else{if(i==0){self._everydaydo.find(".is_new .icon").show();}
self.TipsCount[i].hide();}
if(i==5&&armyRemindCount>0){Mojo.gap.buffCut(armyRemindCount);return false;}});},refreshData:function(){var self=this;var profile=self._options.getController().getProfile();if(profile!=undefined){self._updateInfo(profile._force,profile._player);}},_getR:function(key){var r={ipad:{'chatMsgHeight':30},iphone:{'chatMsgHeight':20}};if(Mojo.gap.device=='ipad'){return r.ipad[key];}else{return r.iphone[key];}},_getDefaultOptions:function(){var self=this;return{profileUpdated:function(force,player){self._updateInfo(force,player);},btnClick:$.noop,};},});})(window,jQuery);;(function(w,$,undefined){w.Mojo=w.Mojo||{};w.Mojo.com=w.Mojo.com||{};w.Mojo.com.ForceNoticeDialog=w.Mojo.ui.Dialog.extend({clsname:function(){return"com.ForceNoticeDialog";},init:function(data,options){this._data=data;this._super(undefined,options);this.element().addClass('mojo-com-messagedlg');this.element().addClass('mojo-com-forcenoticedlg');this._paragraph=$("<div class='paragraph'></div>").appendTo(this._content);this._addContent();this._addHandleButtons();},_replaceBr:function(str){if(Mojo.utils.isNone(str)){return"";}
return str.replace(/<.+?>/gm,'\r');},_replaceEnter:function(str){if(Mojo.utils.isNone(str)){return"";}
return str.replace(/\n/gm,'\r\n');},_addContent:function(){var hintText=this._options.hintText;if(this._options.showNotice==true){hintText=Mojo.utils.locale('force','notice_default_text1');}
var text1=this._data.announcement?this._data.announcement:hintText;text1=this._replaceBr(text1);this.oldText1=this._replaceBr(this._data.announcement);this._textarea=this._createTextArea(text1,1);if(this._options.showNotice!=true){this._textarea.css({height:'200px'});}
if(this._options.showNotice==true){var text2=this._data.notice?this._data.notice:Mojo.utils.locale('force','notice_default_text2');text2=this._replaceBr(text2);this.oldText2=this._replaceBr(this._data.notice);this._textArea2=this._createTextArea(text2,2);}},_createTextArea:function(text,flag){var self=this;var _titleTip=null;var _title=null;var _tip=null;var _textArea=null;if(self._options.subhead!=undefined){$('<span class="words-subhead"></span>').html(self._options.subhead).appendTo(self._paragraph);}
_titleTip=$('<div class="title_tip"></div>').appendTo(this._paragraph);if(self._options.showNotice==true){_title=$('<div class="title_left"></div>').appendTo(_titleTip);if(flag==1){self._options.hintText1=Mojo.utils.locale('force','notice_default_text1');_title.html(Mojo.utils.locale('force','notice_default_title1'));}else{self._options.hintText2=Mojo.utils.locale('force','notice_default_text2');_title.html(Mojo.utils.locale('force','notice_default_title2'));}}
_tip=$('<div class="words-tip"></div>').html(self._options.maxlength).appendTo(_titleTip);_border=$('<div class="border"></div>').addClass('force-notice').appendTo(this._paragraph);var _content=$('<form name="form" method="post" action=""><textarea name="textarea'+flag+'" class="textarea'+flag+'" maxlength="'+self._options.maxlength+'" id="message-content" cols="45" rows="5">'+text+'</textarea></form>').appendTo(_border);_textArea=this._content.find('.textarea'+flag).focus(function(e){var hintText=e.target.className=='textarea1'?self._options.hintText1:self._options.hintText2;if(self._options.hintText){hintText=self._options.hintText;}
if(this.value==hintText){this.value='';}});_textArea.bind("focus input propertychange",function(){var maxLength=$(this).attr('maxlength');var text=$(this).val();text=self._replaceEnter(text);var v=text.length;if(v<=maxLength){_tip.html(maxLength-v);return true;}else{$(this).val(text.substring(0,maxLength));return false;}});_textArea.trigger("input");if(this._options.editable==false){_textArea.attr('disabled','disabled');}
if(self._options.beforeend!=undefined){$('<span class="words-subhead"></span>').html(self._options.beforeend).appendTo(self._paragraph);}
return _textArea;},_checkCount:function(v){var self=this;var v=parseInt(v.length);if(v<=self._options.maxlength){}},_addHandleButtons:function(){var self=this;var editBtn=new Mojo.ui.Button('ok-btn',{special:'button-big-red',text:self._options.okBtnText,click:function(){var content1=self._textarea.attr('value');if(content1==self._options.hintText&&!self._options.hasDefaultMsg){content1='';}
if(Mojo.utils.trim(content1)==''){Mojo.app.toast.show(Mojo.utils.locale('common','no content'));return;}
if(self._options.showNotice==true){var content2=self._textArea2.attr('value');if(content2==self._options.hintText&&!self._options.hasDefaultMsg){content2='';}
if(Mojo.utils.trim(content2)==''){Mojo.app.toast.show(Mojo.utils.locale('common','no content'));return;}}
if(self._options.okBtnClick instanceof Function){self._options.okBtnClick(self);}else{if(self.oldText1!=content1||self.oldText2!=content2){Mojo.ajax('/force/editAnnouncement',{'announcement':content1,'notice':content2},function(response){if(response.errorCode==0){Mojo.track.onEvent('24_302');self._options.getController().sync();self.close();}},function(e){},{showWait:true});}
self.close();}},disableClick:function(){Mojo.app.toast.show(Mojo.utils.locale('force','edit_force_fobbiden'));},});if(self._options.editable==false){editBtn.disable(true);}
this._footer.append(editBtn.element());this._footer.append((new Mojo.ui.Button('close-btn',{text:Mojo.utils.locale('ui','Close'),click:function(){if(self._options.closeBtnClick instanceof Function){self._options.closeBtnClick(self);}else{self.close();}},})).element());},_getDefaultOptions:function(){return $.extend(true,this._super(),{title:Mojo.utils.locale('force','notice'),subhead:undefined,maxlength:50,okBtnText:Mojo.utils.locale('common','ok'),okBtnClick:undefined,showNotice:false,hasDefaultMsg:false,hintText:'',id:'',callback:$.noop,deviceaware:true});},getContent:function(){var content=this._textarea.val();if(content==this._options.hintText&&!this._options.hasDefaultMsg){return"";}
if(Mojo.utils.trim(content)==''){return"";}
return content;},});})(window,jQuery);;(function(w,$,undefined){w.Mojo=w.Mojo||{};w.Mojo.com=w.Mojo.com||{};w.Mojo.com.ForceInternal=w.Mojo.Object.extend({clsname:function(){return"com.ForceInternal";},init:function(options){this._super('com-force-internal',options);this.element().addClass('mojo-com-forceinternal');this._playerProfile=this._options.getController().getPlayerProfile();this._addTabs();this._addButton();this._tabs.element().find('ul > li').eq(1).append($("<div class='is_new'></div>"));},_createInternalPanel:function(selected){this._createList(selected);this._addHeader();this._showBuffdlg();this._inRefreshing=false;},_createForceChallengePanel:function(selected){var self=this;this._challengePanel=new Mojo.com.ForceChallengePanel({getController:self._options.getController});this._tabs.setPanel(selected,this._challengePanel);},_addTabs:function(){var self=this;this._panels=[{type:1,label:'internal'},{type:2,label:'force_boss_challenge'}];this._tabs=new Mojo.ui.Tabs('tabs-internal',{selectionChange:function(i){if(self._challengePanel){self._challengePanel.pause();}
if(i==0){self._createInternalPanel(i);}else if(i==1){self._createForceChallengePanel(i);}},});$.each(this._panels,function(i,p){self._tabs.addTab(self.locale(p.label));});this.element().append(this._tabs.element());this._tabs.element().find('.panel').addClass('box-outter');if(Mojo.app.request('index')==1)
this._selected=Mojo.app.request('selected');if(Mojo.utils.isNone(this._selected)==true){this._selected=0;}else{this._selected=parseInt(this._selected);}
this._tabs._select(this._selected);},_addHeader:function(){this._header=$("<div class='page-tips'></div>");this._header.appendTo(this._list._header);},_addBuffHeader:function(data){var self=this;if(data.tips.length==1){self._header.html(data.tips[0]);}else{self._buffheader=$('<marquee scrollamount=2 behavior=scroll></marquee>').appendTo(self._header);var datatips='';$.each(data.tips,function(i,t){if(i==data.tips.length-1){datatips+=t;return false;}
datatips+=t+"&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;";});self._buffheader.html(datatips);}},_createList:function(selected){var self=this;this._list=new Mojo.com.ForceInternalList({afterDoTask:function(data,result){self._options.getController().updateForceProfile(data.force);self._options.getController().updatePlayerProfile(data.player);},callback:function(data){self._addRefreshButton();if(data.tips.length!=0){self._addBuffHeader(data);}else{self._header.html(Mojo.utils.locale('force','refresh_text'));}
if(data!=undefined&&data.has_refresh==1){var official='';if(data.refresh_player_title!=''&&data.refresh_player_title!=null&&data.refresh_player_title!=undefined){official='[<span class="official">'+data.refresh_player_title+'</span>]';}
var refreshdlg=new Mojo.com.HandleDialog({title:Mojo.utils.locale('force','refresh_internal_mission'),message:Mojo.utils.locale('force','refresh_info4',{official:official,name:data.refresh_player_name}),btn1:Mojo.utils.locale('common','ok'),handle1:function(){Mojo.ajax('/force/acceptRefreshTask',{},function(result){if(result.errorCode==0){Mojo.track.onEvent('24_602');self._list.refresh(result.data);}else{Mojo.app.toast.show(result.errorMsg);}});},});refreshdlg.open();}},});this._tabs.setPanel(selected,this._list);},_addButton:function(){var self=this;this._backBtn=new Mojo.ui.Button(undefined,{text:Mojo.utils.locale('common','back'),click:function(){if(self._challengePanel){self._challengePanel.pause();}
self.element().hide();self._options.getController().switchToHome();},classes:['force-back-btn'],});this._backBtn.element().appendTo(this.element());},_addRefreshButton:function(){var self=this;var refreshTxt=Mojo.utils.locale('force','refresh_internal_mission');self.refreshBtn=new Mojo.ui.Button(undefined,{text:refreshTxt,classes:['more'],click:function(){Mojo.ajax('/force/refreshTaskPreview',{},function(result){if(result.errorCode==0){self._showRefreshDialog(result.data);}});},disableClick:function(){Mojo.app.toast.show(Mojo.utils.locale('force','only_official_can_refresh'));},});if(parseInt(self._playerProfile.position_id)>3){self.refreshBtn.disable(true);}
self.refreshBtn.element().appendTo(self._list._list).show();this._list.resize();},_showRefreshDialog:function(data){var self=this;var refreshdlg=new Mojo.com.HandleDialog({title:Mojo.utils.locale('force','refresh_internal_mission'),message:'',btn1:Mojo.utils.locale('common','ok'),handle1:function(){if(self._inRefreshing==true)
return;self._inRefreshing=true;Mojo.ajax('/force/refreshTask',{},function(result){self._inRefreshing=false;if(result.errorCode==0){var i=0,player={};if(parseInt(data.vm)>0){i=parseInt(data.vm);player.vm=-i;}else if(parseInt(data.rm)>0){i=parseInt(data.rm);player.rm=-i;}
self._onTrack(i);self._list.refresh(result.data.taskList);var grain=result.data.awardGrain;Mojo.page.Force.getController().diffPlayer({grain:grain});self._list._scroll.scrollTo(0,0);self._options.getController().diffPlayer(player);var c=$("<div class='paragraph'></div>").html(Mojo.utils.locale('force','refresh_award'));var tip2=$("<div class='info2'></div>").appendTo(c).html(Mojo.utils.locale('force','refresh_award1'));new Mojo.ui.Label(undefined,{classes:['grain','award'],text:grain}).element().appendTo(tip2);var dlg=new Mojo.ui.Dialog(undefined,{title:Mojo.utils.locale('ui','Refresh Succ'),classes:['force-refresh-succdlg'],content:c});new Mojo.ui.Button(undefined,{text:Mojo.utils.locale('ui','Close'),click:function(){dlg.close();}}).element().appendTo(dlg._footer);dlg.open();}else{(new Mojo.com.BuyFailDialog({message:result.errorMsg,useRm:(parseInt(data.vm)>0?false:true),})).open();}},function(){},{showWait:true});},});var info1=$('<div class="info1"></div>').html(Mojo.utils.locale('force','refresh_info1')).appendTo(refreshdlg._message);var info2=$('<div class="info2"></div>').appendTo(refreshdlg._message);var cost=$('<div class="cost"></div>').html(Mojo.utils.locale('force','refresh_cost')).appendTo(info2);var i=0;if(parseInt(data.vm)>0){(new Mojo.ui.Label(undefined,{text:data.vm,classes:['vm'],})).element().appendTo(info2);}else if(parseInt(data.rm)>0){(new Mojo.ui.Label(undefined,{text:data.rm,classes:['rm'],})).element().appendTo(info2);}
var param={};param.cost=(parseInt(data.next_vm)>0?data.next_vm:data.next_rm);param.yb=(parseInt(data.next_vm)>0?Mojo.utils.locale('force','vm'):Mojo.utils.locale('force','rm'));param.point=data.time;var info3=$('<div class="info3"></div>').html(Mojo.utils.locale('force','refresh_info3',param)).appendTo(refreshdlg._message);refreshdlg.open();},_showBuffdlg:function(){Mojo.ajax('/force/buffpops',{type:'task'},function(response){if(response.errorCode==0){var tit=undefined;var dlgmsg=undefined;if(response.errorCode==0){if(Mojo.utils.isNone(response.data)||Mojo.utils.isNone(response.data.desc)){return;}
dlgmsg=response.data.desc;if(Mojo.utils.isNone(response.data.title)==false){tit=response.data.title;}else{tit=Mojo.utils.locale('package','title_info');}}else{if(Mojo.utils.isNone(response.errorMsg)){return;}
dlgmsg=response.errorMsg;if(response.data!=undefined&&Mojo.utils.isNone(response.data.title)==false){tit=response.data.title;}else{tit=Mojo.utils.locale('package','title_info');}}
var dlg=new Mojo.ui.Dialog(undefined,{title:tit,content:$('<div class="paragraph"></div>').html(dlgmsg)});(new Mojo.ui.Button(undefined,{text:Mojo.utils.locale('common','close'),click:function(){dlg.close();}})).element().appendTo(dlg._footer);dlg.open();}},function(){});},_onTrack:function(i){var code='';switch(i){case 30000:code='24_001';break;case 500:code='24_002';break;case 1000:code='24_003';break;case 2000:code='24_004';break;case 5000:code='24_005';break;}
Mojo.track.onEvent(code);},_getDefaultOptions:function(){return{backCallback:$.noop,};},localeCat:function(){return'force';},});})(window,jQuery);;(function(w,$,undefined){w.Mojo=w.Mojo||{};w.Mojo.com=w.Mojo.com||{};w.Mojo.com.ForceInternalList=w.Mojo.ui.ListPanel.extend({clsname:function(){return"com.ForceInternalList";},init:function(options){this._super(undefined,options);this.element().addClass('mojo-com-forceinternallist');},refresh:function(data){var self=this;if(data==undefined)return;self._list.find('.mojo-com-forceinternalelement').remove();self.appendData(data);if(data.length==self._options.pageSize){self._more.element().show();}else{self._more.element().hide();}},_getDefaultOptions:function(){var self=this;return{pageSize:10,scrollable:true,showMore:true,moreLabel:Mojo.utils.locale('entity','entity_more'),callback:$.noop,onLoaded:undefined,loadFunc:function(start,count,params){Mojo.ajax('/force/playerTasks',{},function(result){if(result.errorCode==0){if(result.data.illegal_auto_refresh==1){var dlg=new Mojo.com.CommonDialog(undefined,{title:Mojo.utils.locale('force','refresh_fail'),content:$("<div class='paragraph'></div>").html(Mojo.utils.locale('force','refresh_fail_tip')),leftBtnText:Mojo.utils.locale('common','close'),leftBtnClick:function(){dlg.close();},});dlg.open();}
self.data=result.data;self.appendData(self.data.task.tasks);if(result.data!=undefined&&result.data.length==self._options.pageSize){self._more.element().show();}else{self._more.element().hide();}
self._options.callback(result.data);}},function(){self.appendData();});},drawFunc:function(data){return new Mojo.com.ForceInternalElement(data,{forceLevel:self.data.task.force_level,afterDo:function(data,result){self._options.afterDoTask(data,result);},});},};},});})(window,jQuery);;(function(w,$,undefined){w.Mojo=w.Mojo||{};w.Mojo.com=w.Mojo.com||{};w.Mojo.com.ForceInternalElement=w.Mojo.Object.extend({clsname:function(){return"com.ForceInternalElement";},init:function(data,options){this._data=this.task=data;this._super(undefined,options);this.element().addClass('mojo-com-forceinternalelement');this._addTitle();this._addDescription();this._addDetail();this._addAction();this._refresh();},_addTitle:function(){this.element().append('<div class="title"><div class="left">'+
this._data.name+'</div><div class="center"></div><div class="right">'+
Mojo.utils.locale('force','unlock_level',{level:this._data.unlock_level})+'</div></div>');},_addDescription:function(){this.element().append('<div class="row description">'+this._data.description+'</div>');},_addDetail:function(){this._lblDemand=new Mojo.ui.Label(undefined,{classes:['demand'],text:Mojo.utils.locale('force','none'),});this._lblGrain=new Mojo.ui.Label(undefined,{classes:['fgrain'],text:this.task.grain,});this._cd=this.task.cold_down;this._lblCd=new Mojo.ui.Label(undefined,{text:'',classes:['cd'],});this._progress=new Mojo.ui.Progress(undefined,{value:this.task.count,max:this.task.sum_count,});this.element().append('<div class="row"><div class="requirement"></div><div class="reward"></div><div class="progress"></div></div>');this.element().find('.row > .requirement').append(Mojo.utils.locale('ui','Requirement')+'<br>').append(this._lblDemand.element());this.element().find('.row > .reward').append(Mojo.utils.locale('force','reward')+'<br>').append('<div class="group"></div>').find('.group').append(this._lblGrain.element());this.element().find('.row > .progress').append(Mojo.utils.locale('ui','Progress')+'<br>').append(this._progress.element());},_addAction:function(){var self=this;this._slot=new Mojo.com.Slot({slotId:'slot-task-'+this.task.id,});this._btnDo=new Mojo.ui.Button(undefined,{text:Mojo.utils.locale('ui','Do'),click:function(){Mojo.track.onEvent('24_601');self._showWait=false;self._btnDo.disable(true);self._slot.startInSchedule();self._sendRequest();},disableClick:function(){if(self.task.status==2){Mojo.app.toast.show(Mojo.utils.locale('mission','The task is completed!'));}else if(self._cd>0){Mojo.app.toast.show(Mojo.utils.locale('common','wait_to_do'));}else if(parseInt(self._options.forceLevel)<parseInt(self.task.unlock_level)){Mojo.app.toast.show(Mojo.utils.locale('force','force_level_is_not_enough'));}},special:'button-big-red',sound:'17_slotmachine',});var action=$('<div class="action"></div>').append(this._lblCd.element()).append(this._btnDo.element());$('<div class="row"><div class="slot"></div></div>').appendTo(this.element()).append(action).children('.slot').append(this._slot==undefined?this._boss.element():this._slot.element());this._showCd();},_refresh:function(){this._progress.value(this.task.count);this._btnDo.disable(this.task.status==2||parseInt(this.task.cold_down)>0||parseInt(this._options.forceLevel)<parseInt(this.task.unlock_level));},_showCd:function(){var self=this;if(this._data.status==2||this._cd==undefined||this._cd==0)return;this._lblCd.text(Mojo.utils.locale('common','in_cd')+self._formatCDTime(self._cd));this._lblCd.show();this._interval=w.setInterval(function(){if(self._cd!=undefined&&self._cd>1){self._cd--;self._lblCd.text(Mojo.utils.locale('common','in_cd')+self._formatCDTime(self._cd));}else{self._cd=0;w.clearInterval(self._interval);self._btnDo.disable(false);self._lblCd.hide();}},1000);},_overlayShow:function(){if(this._overlay==undefined){this._overlay=new Mojo.ui.Overlay('task-slot-overlay',{opacity:0,});}
this._overlay.show();},_overlayHide:function(){if(this._overlay!=undefined){this._overlay.hide();}},_sendRequest:function(){var self=this;self._overlayShow();Mojo.ajax('/force/doTask',{id:this.task.id,},function(result){if(result.errorCode==0){self._stopSlot(result.data.award.bonus,function(){self._onResult(result);});}else{self._stopSlot(undefined,function(){self._overlayHide();});Mojo.app.toast.show(result.errorMsg);}},function(){self._stopSlot(undefined,function(){self._overlayHide();});},{showWait:self._showWait});},_onResult:function(result){var self=this;var data=result.data;if(data.task!=undefined){self._cd=data.task.cold_down;}else{self._cd=0;}
self._overlayHide();if(data.task.status!=2){self._showCd();}
(new Mojo.com.ForceInternalDialog(data,{close:function(){$.extend(self.task,data.task);self.task.cold_down=self._cd;self._options.afterDo(data,result);self._refresh();if(self.task.status==2){}},})).open(true);},_stopSlot:function(bonus,callback){if(this._slot==undefined)return;var n=1;if(bonus!=undefined){if(bonus.vm!=undefined){n=2;}else if(bonus.xp!=undefined){n=3;}else if(bonus.entities!=undefined){n=4;}else if(bonus.grain!=undefined){n=3;}}
this._slot.stopInSchedule(n,callback);},_formatCDTime:function(sec){var str='';var dd=parseInt(sec/86400);var hh=parseInt((sec%86400)/3600);var mm=parseInt((sec%3600)/60);var ss=sec%60;if(dd>0){str=dd+Mojo.utils.locale('common','day')+hh+Mojo.utils.locale('common','hour');}else if(hh>0){str=hh+Mojo.utils.locale('common','hour')+mm+Mojo.utils.locale('common','minute');}else if(mm>0){str=mm+Mojo.utils.locale('common','minute')+ss+Mojo.utils.locale('common','second');}else{str=ss+Mojo.utils.locale('common','second');}
return str;},unlock:function(value){this._btnDo.disable(!value);},_getDefaultOptions:function(){return{forceLevel:null,afterDo:$.noop,};},});})(window,jQuery);;(function(w,$,undefined){w.Mojo=w.Mojo||{};w.Mojo.com=w.Mojo.com||{};w.Mojo.com.ForceInternalDialog=w.Mojo.ui.Dialog.extend({clsname:function(){return"com.ForceInternalDialog";},init:function(data,options){this._data=data.award;this._task=data.task;this._super(undefined,options);this.element().addClass('mojo-com-forceinternaldlg');var self=this;this._grain=this._data.fixed;this._xp=this._xpText();this._vm=this._vmText();this._grain=this._grainText();this._offer=this._offerText();this._addContent();this._addHandleButtons();},_addContent:function(){var data=null;var vm=0,rm=0,xp=0,addvm=0,addrm=0,addvm=0;if(this._data.bonus!=undefined){if(this._data.bonus.entities!=undefined&&this._data.bonus.entities.length>0){Mojo.gap.soundPlay('18_new_card');data=this._data.bonus.entities[0];}}
if(data!=null){this._entity=new Mojo.com.LargeEntity(data);this._content.append(this._entity.element());this._content.append('<div class="tip">'+this._contentText(data)+'</div>');}
this._content.append('<div class="reward"></div>');if(this._xp!=''&&this._vm!=''){this._content.find('.reward').append((new Mojo.ui.Label(undefined,{text:Mojo.utils.locale('mission','Gained')+'',classes:['gained'],})).element());}else{this._content.find('.reward').append((new Mojo.ui.Label(undefined,{text:Mojo.utils.locale('force','gained')+this._offer,classes:['gained'],})).element());}
if(this._xp!=''){this._content.find('.reward').append((new Mojo.ui.Label(undefined,{text:this._xp,classes:['xp'],})).element());}
if(this._vm!=''){this._content.find('.reward').append((new Mojo.ui.Label(undefined,{text:this._vm,classes:['vm'],})).element());}},_xpText:function(){var xp='';if(this._data.bonus!=undefined&&this._data.bonus.xp>0){xp=this._data.bonus.xp;if(parseInt(this._data.fixed.add_xp)>0){xp+='+'+this._data.fixed.add_xp;}
return xp;}else{return'';}},_vmText:function(){var vm='';if(this._data.bonus!=undefined&&this._data.bonus.vm>0){vm=this._data.bonus.vm;if(parseInt(this._data.fixed.add_vm)>0){vm+='+'+this._data.fixed.add_vm;}
return vm;}else{return'';}},_grainText:function(){if(this._data.bonus!=undefined&&this._data.bonus.grain>0){return this._data.bonus.grain;}else{return'';}},_offerText:function(){if(this._data.fixed!=undefined&&this._data.fixed.grain>0){return this._data.fixed.grain;}else{return'';}},_contentText:function(entity){var number=Math.random();if(this._data.bonus!=undefined){if(entity.type_id==1){if(number>0.5){return Mojo.utils.locale('mission','Get One Generals',{name:entity.name});}else{return Mojo.utils.locale('mission','Get Another Generals',{name:entity.name});}}else{if(number>0.5){return Mojo.utils.locale('mission','Get One Collection',{name:entity.name});}else{return Mojo.utils.locale('mission','Get Another Collection',{name:entity.name});}}}else{if(entity.type_id==1){return Mojo.utils.locale('mission','Attack One Generals',{boss_name:this._task.boss_name,name:entity.name});}else{return Mojo.utils.locale('mission','Attack Another Generals',{boss_name:this._task.boss_name,name:entity.name});}}},_addHandleButtons:function(){var self=this;this._footer.append((new Mojo.ui.Button(undefined,{special:'button-big-red',text:Mojo.utils.locale('common','ok'),click:function(){self.close();},})).element());},_getDefaultOptions:function(){return $.extend(true,this._super(),{title:Mojo.utils.locale('mission','Task Awards'),handle:$.noop,});},open:function(){if(this._entity!=null&&this._entity!=undefined){this._super();}else{var str='';if(this._xp!=''&&this._vm!=''){str+=' XP:'+this._xp+''+Mojo.utils.locale('mission','Coins')+':'+this._vm;}else if(this._xp!=''){str+=' XP:'+this._xp;}else if(this._vm!=''){str+=Mojo.utils.locale('mission','Coins')+':'+this._vm;}else if(this._grain!=''){str+=Mojo.utils.locale('force','grain')+this._grain;}
if(str==''){str+=Mojo.utils.locale('force','offer')+this._offer;}else{str+=''+Mojo.utils.locale('force','offer')+this._offer;}
if(str!=''){Mojo.app.toast.show(Mojo.utils.locale('mission','Gained')+str);}
this.close();}},});})(window,jQuery);;(function(w,$,undefined){w.Mojo=w.Mojo||{};w.Mojo.com=w.Mojo.com||{};var g=w.Mojo.com.Slot=w.Mojo.Object.extend({clsname:function(){return"com.Slot";},init:function(options){this._super(undefined,options);var self=this;this._slotContainer=this.element();this._slotContainer.show().addClass(self._options.slotContainerClass);this._slot=$('<div></div>').attr("id",self._options.slotId).addClass(self._options.slotClass).addClass(self._options.slotClass+'-'+Mojo.app.data.userLanguage).appendTo(this._slotContainer);$(this._slot).pan({fps:30,dir:'down'});$(this._slot).spStop();},_getDefaultOptions:function(){var self=this;return{slotId:'0',speed:0,step:2,interval:null,maxSpeed:60,minSpeed:10,imgHeight:self.getR("imgHeight"),spriteHeight:self.getR("spriteHeight"),started:false,slotContainerClass:'mojo-com-slot-container',slotClass:'mojo-com-slot',slotMotionClass:'mojo-com-slot-motion',slotActivePaneClass:'mojo-com-slot-activepane',slotActiveBtnClass:'mojo-com-slot-activebtn',};},reset:function(){var self=this;$(this._slot).spStop();$._spritely.instances[self._options.slotId].t=0;$(this._slot).css('background-position',self.getR("background-position"));self._options.speed=0;},canStart:function(){var self=this;if(self._options.started===false&&self._options.speed==0){return true;}else{return false;}},startInSchedule:function(){var self=this;if(self._options.started===false){if(self._options.speed==0){self.start();}else{var interval=window.setInterval(function(){if(self._options.speed==0){self.start();clearInterval(interval);}},100);}}},start:function(){var self=this;$(this._slot).spStart();self._options.started=true;self._options.interval=window.setInterval(function(){if(self._options.speed<self._options.maxSpeed){self._options.speed+=self._options.step;$(self._slot).spSpeed(self._options.speed);}},40);},canStop:function(){var self=this;if(self._options.started===true&&self._options.speed>=self._options.maxSpeed){return true;}else{return false;}},stopInSchedule:function(n,callback){var self=this;if(self._options.started===true){var targetPos=self._options.spriteHeight*n;if(self._options.speed>=self._options.maxSpeed){self.stop(targetPos,callback);}else{var interval=window.setInterval(function(){if(self._options.speed>=self._options.maxSpeed){self.stop(targetPos,callback);clearInterval(interval);}},100);}}},stop:function(targetPos,callback){var self=this;clearInterval(self._options.interval);self._options.interval=window.setInterval(function(){if(self._options.speed>self._options.minSpeed){self._options.speed-=self._options.step;$(self._slot).spSpeed(self._options.speed);}
if(self._options.speed<=self._options.minSpeed){var range=self._rangeFromTarget_when_dir_down(targetPos);if(range>0){if(Mojo.gap.device=='ipad'){if(range<0.05){var best=targetPos;var bgPos="0px "+best+"px";$(self._slot).css('background-position',bgPos);$(self._slot).spSpeed(0);$(self._slot).spStop();clearInterval(self._options.interval);$(self._slot).removeClass(self._options.slotMotionClass);self._options.speed=0;self._options.started=false;if(callback!=undefined){callback.call();}}else if(range<0.1){self._options.speed=1;$(self._slot).spSpeed(1);}else if(range<0.5){self._options.speed=2;$(self._slot).spSpeed(2);}else if(range<0.9){self._options.speed=4;$(self._slot).spSpeed(4);}else if(range<1.4){self._options.speed=6;$(self._slot).spSpeed(6);}else if(range<2){self._options.speed=8;$(self._slot).spSpeed(8);}}else{if(range<0.1){var best=targetPos-7;var bgPos="5px "+best+"px";$(self._slot).css('background-position',bgPos);$(self._slot).spSpeed(0);$(self._slot).spStop();clearInterval(self._options.interval);$(self._slot).removeClass(self._options.slotMotionClass);self._options.speed=0;self._options.started=false;if(callback!=undefined){callback.call();}}else if(range<0.5){self._options.speed=2;$(self._slot).spSpeed(2);}else if(range<0.9){self._options.speed=4;$(self._slot).spSpeed(4);}else if(range<1.4){self._options.speed=6;$(self._slot).spSpeed(6);}else if(range<2){self._options.speed=8;$(self._slot).spSpeed(8);}}}}},40);},_rangeFromTarget_when_dir_down:function(targetPos){var self=this;var currentPos=$(self._slot).css('background-position');currentPos=currentPos.split(' ')[1];currentPos=parseInt(currentPos,10);if((targetPos-(currentPos%self._options.imgHeight))>0){return((targetPos-(currentPos%self._options.imgHeight))/self._options.spriteHeight);}else{return-1;}},_rangeFromTarget_when_dir_up:function(targetPos){var self=this;var currentPos=$(self._slot).css('background-position');currentPos=currentPos.split(' ')[1];currentPos=parseInt(currentPos,10);if(((currentPos%self._options.imgHeight)-targetPos)>0){return(((currentPos%self._options.imgHeight)-targetPos)/self._options.spriteHeight);}else{return-1;}},_isNearTarget:function(range,targetPos){var self=this;var currentPos=$(self._slot).css('background-position');currentPos=currentPos.split(' ')[1];currentPos=parseInt(currentPos,10);if(((currentPos%self._options.imgHeight)-targetPos)>0&&((currentPos%self._options.imgHeight)-targetPos)<(self._options.spriteHeight*range)){return true;}else{return false;}},});})(window,jQuery);;(function(w,$,undefined){w.Mojo=w.Mojo||{};w.Mojo.com=w.Mojo.com||{};w.Mojo.com.ForceExchange=w.Mojo.Object.extend({clsname:function(){return"com.ForceExchange";},init:function(options){this._super('com-force-exchange',options);this.element().addClass('mojo-com-forceexchange');this._force=this._options.getController()._forceProfile._force;this.curLevel=this._force.level;this._addTabs();this._addButton();this._showBuffdlg();},_addTabs:function(){var self=this;this._panels=[{type:'exchange',label:'exchange'},];this._tabs=new Mojo.ui.Tabs('tabs-exchange',{selectionChange:function(i){self._createList(i);},});$.each(this._panels,function(i,p){self._tabs.addTab(self.locale(p.label));});this.element().append(this._tabs.element());this._tabs.element().find('.panel').addClass('box-outter');this._panel=this._tabs.element().find('.panel').addClass('box-outter');this._createList(0);},_createList:function(index){var self=this;var p=this._panels[index];if(self._list==undefined||p.list==undefined||p.list==null){self._list=p.list=new Mojo.com.ForceExchangeList('exchange-'+p.type,{type:p.type,level:parseInt(self._force.level),callback:function(data){if(data.tips.length!=0){self._addBuffHeader(data);}}});this._tabs.setPanel(index,p.list);}},_addBuffHeader:function(data){var self=this;self._buffhead=$("<div class='page-tips'></div>");self._buffhead.appendTo(self._list._list._header);if(data.tips.length==1){self._buffhead.html(data.tips[0]);}else{self._buffheader=$('<marquee scrollamount=2 behavior=scroll></marquee>').appendTo(self._buffhead);var datatips='';$.each(data.tips,function(i,t){if(i==data.tips.length-1){datatips+=t;return false;}
datatips+=t+"&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;";});self._buffheader.html(datatips);}
self._list._list.resize();},_addButton:function(){var self=this;this._header=$('<div class="head"></div>').appendTo(this._panel);this._backBtn=new Mojo.ui.Button(undefined,{text:Mojo.utils.locale('common','back'),click:function(){self.element().hide();self._options.getController().switchToHome();},});this._backBtn.element().addClass('force-back-btn').appendTo(this.element());},refreshData:function(){this._list.refreshData();},_getDefaultOptions:function(){var self=this;return{profileUpdated:function(f,p){if(self.curLevel!=f.level&&self._list!=undefined){self.curLevel=f.level;self._list.profileUpdated(f.level);}},backCallback:$.noop,};},_showBuffdlg:function(){Mojo.ajax('/force/buffpops',{type:'exchange'},function(response){if(response.errorCode==0){var tit=undefined;var dlgmsg=undefined;if(response.errorCode==0){if(Mojo.utils.isNone(response.data)||Mojo.utils.isNone(response.data.desc)){return;}
dlgmsg=response.data.desc;if(Mojo.utils.isNone(response.data.title)==false){tit=response.data.title;}else{tit=Mojo.utils.locale('package','title_info');}}else{if(Mojo.utils.isNone(response.errorMsg)){return;}
dlgmsg=response.errorMsg;if(response.data!=undefined&&Mojo.utils.isNone(response.data.title)==false){tit=response.data.title;}else{tit=Mojo.utils.locale('package','title_info');}}
var dlg=new Mojo.ui.Dialog(undefined,{title:tit,content:$('<div class="paragraph"></div>').html(dlgmsg)});(new Mojo.ui.Button(undefined,{text:Mojo.utils.locale('common','close'),click:function(){dlg.close();}})).element().appendTo(dlg._footer);dlg.open();}},function(){});},localeCat:function(){return'force';},debugable:function(){return Mojo.utils.debug.vars.com.forceinternal;},});})(window,jQuery);;(function(w,$,undefined){w.Mojo=w.Mojo||{};w.Mojo.com=w.Mojo.com||{};w.Mojo.com.ForceMember=w.Mojo.Object.extend({clsname:function(){return"com.ForceMember";},init:function(options){this._super('com-force-member',options);this.element().addClass('mojo-com-forcemember');this.forceMemberList=undefined;this.forceHelperMemberList=undefined;this._ForceMemberPanel=undefined;this._ForceHelperMemberPanel=undefined;this._ownmember=undefined;this._assitmemeber=undefined;this._index=undefined;this._forceProfile=this._options.getController().getForceProfile();this._playerProfile=this._options.getController().getPlayerProfile();this._param={typeId:'1,2,3,4,5,6',orderId:'1',type:'all'};this._addTabs();document.onkeydown=function(event){if(event.keyCode==13){$('#search-btn').click();return false;}};},_addTabs:function(){var self=this;this._tabs=new Mojo.ui.Tabs('tabs-member',{selectionChange:function(index){self._index=index;self._createList();self._refreshFilter();}});if(Mojo.utils.isNone(this._ForceMemberPanel)==false){return;}
this._tabs.addTab(this.locale('member'));this.element().append(this._tabs.element());this._ForceMemberPanel=this._tabs.element().find('.panel').eq(0).addClass('box-outter');this._tabs._select(0);this._addButton();},_addHelperTabs:function(data){if(Mojo.utils.isNone(this._ForceHelperMemberPanel)==false){return;}
if(Mojo.utils.isNone(this._options.showAssistTabs)||this._options.showAssistTabs==false){return;}
if(Mojo.utils.isNone(data.hasHelper)||data.hasHelper==false){return;}
this._tabs.addTab(data.hasHelper);this._ForceHelperMemberPanel=this._tabs.element().find(".panel").eq(1).addClass("box-outter");},_addHeader:function(data){if(this._index==undefined)this._index=0;if(Mojo.utils.isNone(this._options.showHeader)||this._options.showHeader==false){return;}
var headerText=undefined;if(this._index==0&&this._ownheader==undefined){if(Mojo.utils.isNone(data.hasHelper)||data.hasHelper==false){headerText=Mojo.utils.locale('force','member_count')+this._forceProfile.member_num+'/'+this._forceProfile.member_num_limit;}else{headerText=Mojo.utils.locale('force','forcewar_hasborrowmember')+data.enabled+'/'+data.available;}
this._ownheader=new Mojo.ui.Label(undefined,{text:headerText,classes:['member-count'],});this._ownheader.element().appendTo((this._index<=0?this.forceMemberList:this.forceHelperMemberList)._header);}else if(this._index==1&&data.hasHelper!=false&&this._helpheader==undefined){headerText=Mojo.utils.locale('force','forcewar_hasborrowmember')+data.enabled+'/'+data.available;this._helpheader=new Mojo.ui.Label(undefined,{text:headerText,classes:['member-count'],});this._helpheader.element().appendTo((this._index<=0?this.forceMemberList:this.forceHelperMemberList)._header);}},update:function(data){var self=this;if(data!=undefined&&data.player_num!=this._forceProfile.member_num){this._header.text(Mojo.utils.locale('force','member_count')+data.player_num+'/'+data.player_num_limit);}
self._options.getController().updateForceProfile({member_num:data.player_num,member_num_limit:data.player_num_limit});for(var i=0;i<data.list.length;i++){if(this._playerProfile.id==data.list[i].id){if(this._playerProfile.position_id!=data.list[i].position_id){this._options.getController().sync(function(){self._forceProfile=self._options.getController().getForceProfile();self._playerProfile=self._options.getController().getPlayerProfile();});break;}}}},_createList:function(){var self=this;if(this._index==undefined)this._index=0;self._refreshFilter();var member={id:this._playerProfile.id,position_id:parseInt(this._playerProfile.position_id),member_count:parseInt(this._forceProfile.member_num),member_owner:self._getTabsId(),forceProfile:this._forceProfile};var forceMemberListOptions={type:'member',params:self._param,member:member,refreshCallback:function(element,op){if(op=="outforce"){element._btn.element().remove();element._hiddenTxt.html(self.getL("force","deleted"));self._forceProfile.member_num=self._forceProfile.member_num-1;self._header.text(Mojo.utils.locale('force','member_count')+self._forceProfile.member_num+'/'+self._forceProfile.member_num_limit);}else{self.refresh();}
self._options.getController().sync();},updateCallback:function(data){self.update(data);}};if(Mojo.utils.isNone(this._options.forceMemberElementOptions)==false){forceMemberListOptions["forceMemberElementOptions"]=this._options.forceMemberElementOptions;}
if(Mojo.utils.isNone(this._options.forceMemberListOptions)==false){$.extend(true,forceMemberListOptions,this._options.forceMemberListOptions);}
if(this._index==0&&this.forceMemberList==undefined){this.forceMemberList=new Mojo.com.ForceMemberList(undefined,forceMemberListOptions);if(Mojo.utils.isNone(this._options.showSearch)||this._options.showSearch)
this._createSearchForm(this.forceMemberList._header,"");this.forceMemberList.element().appendTo(this._ForceMemberPanel);}else if(this.forceHelperMemberList==undefined){this.forceHelperMemberList=new Mojo.com.ForceMemberList(undefined,forceMemberListOptions);this.forceHelperMemberList.element().appendTo(this._ForceHelperMemberPanel);}},_createSearchForm:function(p,defaultv){var self=this;var search='<div id="friend-search-area" class="search-area">\
     <div class="search-input">\
      <form id="friend-search-form" name="form" action="" method="get">\
       <input id="friend-search-condition" name="cc" type="text" value="'+defaultv+'" maxlength="10" />\
      </form>\
     </div>\
    </div>';$("#friend-search-condition").click(function(){$("#friend-search-condition").val("");});self._searchBtn=new Mojo.ui.Button('search-btn',{text:Mojo.utils.locale('common','search'),click:function(){$.each(self.forceMemberList.children(),function(i,child){child.element().remove();});self._searchBtn.disable(true);self.forceMemberList._hasLoaded=false;self.forceMemberList._children=[];self.forceMemberList._load(self);}});var s=$(search);s.appendTo(p);self._searchBtn.element().appendTo(s);},_refreshFilter:function(){var filter=Mojo.cache.get('forceFiter');if(filter!=undefined){for(var p in filter){this._param[p]=filter[p];}}},_addButton:function(){var self=this;this._backBtn=new Mojo.ui.Button(undefined,{text:Mojo.utils.locale('common','back'),click:function(){if(self._options.backCallback instanceof Function){self._options.backCallback(self);}},classes:['force-back-btn'],});this._backBtn.element().appendTo(this.element());if(Mojo.utils.isNone(this._options.showSearch)==false&&this._options.showSearch==false){return;}
self.orderBtn=new Mojo.ui.Button('order-btn',{classes:['order_btn'],text:Mojo.utils.locale('force','order_force'),click:function(){var forceFilterDialog=new Mojo.com.ForceFilterDialog({typeId:self._param.typeId,type:self._param.type,orderId:self._param.orderId,callback:function(tid,oid){if(self._param.typeId==tid&&self._param.orderId==oid)
return;self._param.typeId=tid;self._param.orderId=oid;if(self._getTabsId()==0){self.forceMemberList._options.params=self._param;Mojo.cache.set('forceFiter',{typeId:tid,orderId:oid});$.each(self.forceMemberList.children(),function(i,child){child.element().remove();});self.forceMemberList._hasLoaded=false;self.forceMemberList._children=[];self.forceMemberList._load(self._param);}else if(self._getTabsId()==1){self.forceHelperMemberList._options.params=self._param;Mojo.cache.set('forceFiter',{typeId:tid,orderId:oid});$.each(self.forceHelperMemberList.children(),function(i,child){child.element().remove();});self.forceHelperMemberList._hasLoaded=false;self.forceHelperMemberList._children=[];self.forceHelperMemberList._load(self._param);}}});forceFilterDialog.open();},});self.orderBtn.element().appendTo(this.element());},refresh:function(){var self=this;this._options.getController().sync(function(){self._profileUpdate();});},_profileUpdate:function(){this._forceProfile=this._options.getController().getForceProfile();this.forceMemberList.element().remove();this.forceMemberList=undefined;this._createList();},_getDefaultOptions:function(){var self=this;return{backCallback:function(){self.element().hide();self._options.getController().switchToHome();},forceMemberElementOptions:undefined,forceMemberListOptions:undefined,};},localeCat:function(){return'force';},_setResponseData:function(data){if(Mojo.utils.isNone(this._ownmember)==true){this._ownmember=data;}else{this._assitmemeber=data;}
return;},_getResponseData:function(){return this._ownmember;},_getTabsId:function(){return this._tabs.selected();},});})(window,jQuery);;(function(w,$,undefined){w.Mojo=w.Mojo||{};w.Mojo.com=w.Mojo.com||{};w.Mojo.com.ForceMemberList=w.Mojo.ui.ListPanel.extend({clsname:function(){return"com.ForceMemberList";},init:function(id,options){this._super(id,options);this.element().addClass('mojo-com-forcememberlist');this._player=Mojo.page.Force.getController().getPlayerProfile();this._force=Mojo.page.Force.getController().getForceProfile();},_getDefaultOptions:function(){var self=this;return $.extend(true,this._super(),{pageSize:10,moreLabel:Mojo.utils.locale('force','member_more'),loadFunc:function(start,count,params){if(params!=undefined){self._flag=true;}else{self._flag=false;}
Mojo.ajax('/force/playerList',{start:start,count:count,type_id:self._flag?params.typeId:self._options.params.typeId,order_id:self._flag?params.orderId:self._options.params.orderId,search:$("#friend-search-condition").val(),},function(result){if(result.errorCode==0){if(result.data.list!=undefined&&result.data.list.length==self._options.pageSize){self._more.show();}else{self._more.hide();self._options.emptyLabel=Mojo.utils.locale('force','not_this_member');if(self._flag){setTimeout(function(){params._searchBtn.disable(false);},1000);}}
self.appendData(result.data.list);self._options.updateCallback(result.data);self.resize();if(self._flag){self._scroll.scrollTo(0,0);}}});},drawFunc:function(data){return new Mojo.com.ForceMemberElement(data,self._options.forceMemberElementOptions);},scrollable:true,emptyLabel:Mojo.utils.locale('force','member_empty'),forceMemberElementOptions:{showHr:true,clickFunc:function(element){if(self._player.id==element._data.id){if(self._player.position_id==1&&self._force.member_num>1){(new Mojo.com.TipsDialog({message:Mojo.utils.locale('force','cannot_abandon_your_brother'),})).open();}else{var dlg=(new Mojo.com.HandleDialog({title:Mojo.utils.locale('force','get_out_of_force'),message:Mojo.utils.locale('force','get_out_of_force_content'),btn1:Mojo.utils.locale('common','ok'),handle1:function(){Mojo.ajax('/force/quit',{},function(result){if(result.errorCode==0){Mojo.app.redirect('/home',{},'event','24_404');}});}}));Mojo.ajax('/force/getCoolingTimeIfLeave',undefined,function(response){if(response&&response.errorCode===0){var str=Mojo.utils.locale('force','after_leave');if(response.data.cooling_time_if_leave){str+=Mojo.utils.locale('force','alert_cooling_time_if_leave',{cooling:response.data.cooling_time_if_leave});}
str+=Mojo.utils.locale('force','alert_cooling_time_battle');dlg.setAlertMessage(str);Mojo.utils.center(dlg.element());}
dlg.open();});}}else{var params={};params.callback=function(op){self._options.refreshCallback(element,op);};(new Mojo.com.ForceMemberDetailDialog(element._data,params)).open();}},classes:['box-inner'],},refreshCallback:$.noop,updateCallback:$.noop,});},});})(window,jQuery);;(function(w,$,undefined){w.Mojo=w.Mojo||{};w.Mojo.com=w.Mojo.com||{};w.Mojo.com.ForceMemberElement=w.Mojo.Object.extend({clsname:function(){return"com.ForceMemberElement";},init:function(data,options){this._data=data;this._super(undefined,options);this.element().addClass('mojo-com-forcememberelement').addClass('box-inner');this._player=w.Mojo.page.Force.getController().getPlayerProfile();if(this._player.id==data.id&&this._options.goBtnText!=''){this._options.goBtnText=Mojo.utils.locale('force','out');this._options.goSpecialClass='go-close-btn';}
if(this._options.subClass!='')this.element().addClass(this._options.subClass);this._addAttributes();},_addAttributes:function(){var self=this;var attack,defence;if(parseInt(this._data.attack_min)>parseInt(this._data.attack_max)){attack=this._data.attack_min;}else{attack=this._data.attack_min+'-'+this._data.attack_max;}
if(parseInt(this._data.defence_min)>parseInt(this._data.defence_max)){defence=this._data.defence_min;}else{defence=this._data.defence_min+'-'+this._data.defence_max;}
if(this._options.showLevel==false){this.element().append('<div class="force-member-level">'+Mojo.utils.locale('common','lv')+this._data.level+'</div>');}
var title='';if(this._data.title!=undefined&&this._data.title!='')title='[<span class="official">'+this._data.title+'</span>]';this.element().append('<div class="force-member-name">'+title+this._data.name+'</div>');if(this._options.showHr){$('<hr>').appendTo(this.element());}
if(Mojo.utils.isNone(this._data.force)==false)
if(Mojo.utils.isNone(this._data.force.name)==false)
this.element().append('<div class="force-member-force">'+Mojo.utils.locale('force','forcewar_element_force')+this._data.force.name+'</div>');if(this._options.showLevel){this.element().append('<div class="force-member-level">'+Mojo.utils.locale('force','level')+this._data.level+'</div>');}
if(this._options.showOffer){this.element().append('<div class="force-member-offer">'+Mojo.utils.locale('force','offer')+this._data.contribute+'</div>');}
if(this._options.showLogin){this.element().append('<div class="force-member-login">'+Mojo.utils.locale('force','login')+Mojo.utils.getFromNowTime(this._data.last_login_time)+'</div>');}
if(this._options.showAttack){this.element().append('<div class="force-member-attack">'+Mojo.utils.locale('common','simple_attack')+attack+'</div>');}
if(this._options.showDefence){if(typeof this._options.showDefence=="string"){this.element().append('<div class="force-member-defence">'+Mojo.utils.locale('common','simple_defence')+this._options.showDefence+'</div>');}else{this.element().append('<div class="force-member-defence">'+Mojo.utils.locale('common','simple_defence')+defence+'</div>');}}
self._hiddenTxt=$('<div class="hidden-txt"></div>');this.element().append(self._hiddenTxt);self._btn=new Mojo.ui.Button(null,{classes:self._options.goBtnClass,text:self._options.goBtnText,click:function(){self._options.clickFunc(self);},special:self._options.goSpecialClass,});this.element().append(self._btn.element());},_getDefaultOptions:function(){return{showAttack:true,showDefence:true,showOffer:true,showLogin:true,showLevel:false,showHr:false,goBtnText:Mojo.utils.locale('force','contact'),goBtnClass:['go-button'],goSpecialClass:'go-communicate-btn',subClass:'',clickFunc:$.noop,};},});})(window,jQuery);;(function(w,$,undefined){w.Mojo=w.Mojo||{};w.Mojo.com=w.Mojo.com||{};w.Mojo.com.ForceMemberDetailDialog=w.Mojo.ui.Dialog.extend({clsname:function(){return"com.ForceMemberDetailDialog";},init:function(data,options){this._data=data;this._super(undefined,options);this.element().addClass('mojo-com-forcememberdetaildlg');var self=this;this._player=Mojo.page.Force.getController().getPlayerProfile();var title='';if(this._data.title!=undefined&&this._data.title!=''){title='[<span class="official">'+this._data.title+'</span>]';}
this._name=$('<div class="name"></div>').html(Mojo.utils.locale('force','do_with_member',{honor:title,name:this._data.name})).appendTo(this._content);if(this._player.position_id==100&&this._data.is_friend==1){this._actions=self._footer;this._name.css('height',60);}else{this._actions=$('<div class="actions"></div>').appendTo(this._content);}
var btn_num=0;if(this._player.position_id==1&&this._player.state_owner==1&&self._data.has_sobriquet==0){this._actions.append((new Mojo.ui.Button('assign-btn',{text:Mojo.utils.locale('common','assign_title'),click:function(){self.hide();(new Mojo.com.ForceAssignTitleDialog(self._data,{type:2,playerId:self._data.id,close:function(){self.close();},callback:function(){self._options.callback();},})).open(true);},})).element());btn_num++;}
if(this._data.is_friend!=1){this._actions.append((new Mojo.ui.Button('add-btn',{special:'button-big-red',text:Mojo.utils.locale('common','add_friend'),click:function(){self.hide();(new Mojo.com.MessageDialog(null,{title:Mojo.utils.locale('common','invite_friend'),id:self._data.id,isFriendRequest:true,close:function(){self.show();},})).open(true);},})).element());btn_num++;}else{this._actions.append((new Mojo.ui.Button('msg-btn',{special:'button-big-red',text:self.getL("force","to_msg"),click:function(){self.hide();(new Mojo.com.MessageDialog(null,{title:self.getL("force","to_msg"),id:self._data.id,close:function(){self.show();},})).open(true);},})).element());btn_num++;}
this._actions.append((new Mojo.ui.Button('view-btn',{text:Mojo.utils.locale('friend','view'),click:function(){self.hide();(new Mojo.com.FriendFormationDialog(null,{title:self._data.name,frd_id:self._data.id,frd_name:self._data.name,close:function(){self.show();},})).open(true);},})).element());btn_num++;if(this._player.position_id==1){this._actions.append((new Mojo.ui.Button('adjust-btn',{text:Mojo.utils.locale('force','adjust_official'),click:function(){self.hide();(new Mojo.com.ForceMemberAdjustDialog(self._data,{callback:function(){self._options.callback();},close:function(){self.close();},})).open(true);}})).element());btn_num++;}
if(this._player.position_id>=1&&this._player.position_id<=5){this._actions.append((new Mojo.ui.Button('out-btn',{text:Mojo.utils.locale('force','out_force'),click:function(){if(self._player.position_id<parseInt(self._data.position_id)){self.hide();self._showOutForceDialog();}else{Mojo.app.toast.show(Mojo.utils.locale('force','out_force_tip'));}}})).element());btn_num++;}
if(btn_num<5){this._actions.append((new Mojo.ui.Button('close-btn',{text:Mojo.utils.locale('common','close'),click:function(){self.close();},})).element());}},_showOutForceDialog:function(){var self=this;var msg='';if(self._data.title!=undefined&&self._data.title!=''){msg=Mojo.utils.locale('force','out_force_message',{honor:'[<span class="official">'+self._data.title+'</span>]',name:self._data.name});}else{msg=Mojo.utils.locale('force','out_force_message',{honor:'',name:self._data.name});}
(new Mojo.com.HandleDialog({title:Mojo.utils.locale('force','out_force'),message:msg,btn1:Mojo.utils.locale('common','ok'),handle1:function(){Mojo.ajax('/force/kickPlayer',{player_id:self._data.id},function(result){if(result.errorCode==0){Mojo.track.onEvent('24_403');self._options.callback('outforce');}else{Mojo.app.toast.show(result.errorMsg);}});},close:function(){self.close();},})).open(true);},_getDefaultOptions:function(){return $.extend(true,this._super(),{title:Mojo.utils.locale('force','member_contact'),callback:$.noop,});},});})(window,jQuery);;(function(w,$,undefined){w.Mojo=w.Mojo||{};w.Mojo.com=w.Mojo.com||{};w.Mojo.com.FriendFormationDialog=w.Mojo.ui.Dialog.extend({clsname:function(){return"com.FriendFormationDialog";},init:function(data,options){this._data=data;this._super(undefined,options);this.element().addClass('mojo-com-friendformationdlg');var self=this;var panel=new Mojo.ui.PagePanel(null,{selector:(new Mojo.com.BaseSlotList({classes:['general-list-bg-border'],isMine:false,showUnlock:false,friendId:self._options.frd_id,onSelect:function(that,index){panel.selector(index);}})),loadFunc:function(that,current){var selected=parseInt(Mojo.utils.getSomething("selected"));if(!selected||selected<0){selected=0;}
if(current==undefined){current=selected;}else{selected=current;}
Mojo.ajax("/embed",{pid:self._options.frd_id,start:current,count:1},function(result){if(result&&result.errorCode===0){panel._options.count=result.data.total;panel.addData(result.data.base_slots,current,true);}
if(current>=result.data.total){selected="_end";}
panel.selector(selected);},function(){panel.selector(0);});},drawFunc:function(that,data){if(data.is_barracks!=1){return(new Mojo.com.Package(data,{isMine:false,generalClick:function(general){self._generalClick(general);},entityClick:function(entity){self._entityClick(entity);}}));}else{return new Mojo.com.PackageBarrack(data,{pid:self._options.frd_id,is_show_friends:1});}}});this._content.append(panel.element());},_generalClick:function(general){var self=this;var data=general.data();if(data.player_entity_id){self.hide();var generalDetailDialog=new Mojo.ui.Dialog(undefined,{title:Mojo.utils.locale('package','general_detail_title'),content:(new Mojo.com.LargeEntity(data,{showSkill:true}).element()),close:function(){self.show();},});new Mojo.ui.Button(undefined,{text:Mojo.utils.locale('common','ok'),special:"button-big-red",click:function(){generalDetailDialog.close();}}).element().appendTo(generalDetailDialog._footer);generalDetailDialog.open();}else{}},_entityClick:function(entity){var self=this;var data=entity.data();var dialogTitle="";if(Mojo.utils.isWhat(data.type_id,'sword')){dialogTitle=Mojo.utils.locale('package','sword_detail_title');}else if(Mojo.utils.isWhat(data.type_id,'shield')){dialogTitle=Mojo.utils.locale('package','shield_detail_title');}else if(Mojo.utils.isWhat(data.type_id,'mounts')){dialogTitle=Mojo.utils.locale('package','mounts_detail_title');}else if(Mojo.utils.isWhat(data.type_id,'treasure')){dialogTitle=Mojo.utils.locale('package','treasure_detail_title');}
if(data.player_entity_id){self.hide();var entityDetailDialog=new Mojo.ui.Dialog(undefined,{title:dialogTitle,content:(new Mojo.com.LargeEntity(data).element()),close:function(){self.show();},});new Mojo.ui.Button(undefined,{text:Mojo.utils.locale('common','ok'),special:"button-big-red",click:function(){entityDetailDialog.close();}}).element().appendTo(entityDetailDialog._footer);entityDetailDialog.open();}else{}},_getDefaultOptions:function(){return $.extend(true,this._super(),{title:Mojo.utils.locale('friend','formation'),frd_id:'',frd_name:'',});},});})(window,jQuery);;(function(w,$,undefined){w.Mojo=w.Mojo||{};w.Mojo.com=w.Mojo.com||{};w.Mojo.com.BaseSlotList=w.Mojo.Object.extend({clsname:function(){return"com.BaseSlotList";},init:function(options){this._super('com-baseslot-list',options);this._hasLoaded=false;this._baseSlots={};this._lastSelected=undefined;this._scrollDistX=0;this._max_army=1;var self=this;var params=(this._options.isMine?{}:{pid:this._options.friendId});this._list=new Mojo.ui.ListPanel(undefined,{pageSize:20,showMore:false,loadFunc:function(start,count,packageId){Mojo.ajax('/embed/simple',params,function(result){self._max_army=result.data.max_army;if(result.errorCode==0){Mojo.app.baseSlotsCount=result.data.base_slots.length;if(result.data.base_slots.length<4){for(;result.data.base_slots.length<4;){result.data.base_slots.push(undefined);}}else if(self._options.isMine===true&&self._options.showUnlock===true){result.data.base_slots.push(undefined);}
self._list.element().width(result.data.base_slots.length*self._options.unitWidth);self._list.appendData(result.data.base_slots);self._scroll.element().addClass('canswitch');if(self.changeBtn!=undefined){self.changeBtn.element().remove();}
self._addPackageSwitchBtn(result.data.army_id,result.data.player_level<result.data.permit_change_leve);self._scroll.refresh();}else{self._list.appendData(null);}},function(){self._list.appendData(null);});},drawFunc:function(data){return self._getBaseSlotEntity(data);},onLoaded:function(listpanel){if(Mojo.utils.getSomething("selected")){if(Mojo.utils.getSomething("selected")==-1){self.selector(Mojo.app.baseSlotsCount-1);}else{self.selector(parseInt(Mojo.utils.getSomething("selected")));}}
if(self._hasLoaded===false&&self._options.onLoaded instanceof Function){self._options.onLoaded(self);}
self._hasLoaded=true;}});this._scroll=new Mojo.ui.Scroll(undefined,this._list,{direction:1,classes:['all-small-card-border'],showArrow:true,step:self._options.unitWidth,});this.element().append(this._scroll.element());},_addPackageSwitchBtn:function(current,disabled){var self=this;if(self._options.isMine&&self._options.showSwitch){self.changeBtn=new Mojo.ui.Button(undefined,{text:self.getL('package','package_switch'),special:'changePackage-btn',disabled:disabled,disableClick:function(){Mojo.app.toast.show(Mojo.utils.locale('package','cannot_swicth_package'));},click:function(){self._showPackageSwitchDialog(current);}});self.changeBtn.element().appendTo(this.element());}},_showPackageSwitchDialog:function(current){current=parseInt(current);var self=this;var content=$('<div class="paragraph"></div>');var pName=self.getL('package','package_num'+current);$('<div class="package_tip"></div>').html(self.getL('package','package_using',{packageName:pName})).appendTo(content);for(var i=1;i<=self._max_army;i++){new Mojo.ui.Button(undefined,{text:self.getL('package','package_num'+i),special:current==i?"current":"",click:(function(i,c){return function(){if(i!=c){self._switchPackage(i);}else{Mojo.app.toast.show(Mojo.utils.locale('package','has_mount'));}};})(i,current)}).element().appendTo(content);}
self.dlg=new Mojo.ui.Dialog(undefined,{classes:["change-package"],title:self.getL('package','package_switch1'),content:content});self.dlg.open();},_switchPackage:function(index){var self=this;Mojo.ajax('/embed/ChangeArmy',{army_id:index},function(response){if(response.errorCode==0){self.reLoad();self.dlg.close();self._options.onPackageChange();}else{self.dlg.close();Mojo.app.toast.show(response.errorMsg);}},function(){},{showWait:true});},reLoad:function(index){this._list.element().find(".mojo-com-baseslotlist-element").remove();this._hasLoaded=false;this._baseSlots={};this._lastSelected=undefined;this._scrollDistX=0;this._list._load();},refreshAll:function(data){if(Array.isArray(data.list)){var self=this;$.each(data.list,function(i,d){var baseSlotId="base_slot_"+d.player_base_slot_id;var slotObj=self._baseSlots[baseSlotId];if(slotObj instanceof Object){var selected="";if(slotObj.element().find(".card-border").hasClass("selected")||slotObj.element().find(".card-slot").hasClass("selected")){selected="selected";}
slotObj.element().children().remove();if(d.player_entity_id==null||d.player_entity_id==""){slotObj.element().append('<div class="card-slot '+selected+'"></div>');}else{slotObj.element().append('<img src="'+d.small_image+'">');slotObj.element().append('<div class="card-border '+selected+'"></div>');}
if(selected=="selected"){slotObj.element().find('img').addClass('img-class');}}});}},_getDefaultOptions:function(){var self=this;return $.extend(this._super(),{unitWidth:self.getR("unitWidth"),onLoaded:undefined,onSelect:undefined,showUnlock:false,isMine:true,friendId:undefined,onPackageChange:$.noop,showSwitch:false});},_getBaseSlotEntity:function(data){var obj=new Mojo.Object(undefined,{classes:['mojo-com-baseslotlist-element','image'],});if(data==undefined){obj.element().append('<div class="locked"></div>');}else{if(data.is_barracks==1){data.player_base_slot_id=data.id;data.player_entity_id=data.id;}
var baseSlotId="base_slot_"+data.player_base_slot_id;this._baseSlots[baseSlotId]=obj;if(data.player_entity_id==null||data.player_entity_id==""){obj.element().append('<div class="card-slot"></div>');}else{obj.element().append('<img src="'+data.small_image+'">');obj.element().append('<div class="card-border"></div>');}}
var self=this;if(this._lastSelected===undefined){this._lastSelected=obj.element();this._lastSelected.find(".card-border").addClass("selected");}
obj.element().click(function(){if(data==undefined){}else if(data.player_entity_id==null){}else{}
self._lastSelected.find(".card-border").removeClass("selected");self._lastSelected.find(".card-slot").removeClass("selected");self._lastSelected.find("img").removeClass("img-class");obj.element().find(".card-border").addClass("selected");obj.element().find(".card-slot").addClass("selected");obj.element().find("img").addClass("img-class");self._lastSelected=obj.element();if(self._options.onSelect instanceof Function){self._options.onSelect(self,obj.element().index(),data);}});return obj;},selector:function(current){var self=this;if(Mojo.utils.isNone(self._lastSelected)==false){self._lastSelected.find(".card-border").removeClass("selected");self._lastSelected.find(".card-slot").removeClass("selected");}
$.each(this.element().find(".mojo-com-baseslotlist-element"),function(i,e){if(current==i){$(e).find(".card-border").addClass("selected");$(e).find(".card-slot").addClass("selected");$(e).find("img").addClass("img-class");self._lastSelected=$(e);var listleft=self._scroll.scrollerLeft();if(self._options.unitWidth>0){var r=i-Math.abs(listleft/self._options.unitWidth);if(r>2||r<0){var l=((i-1)*self._options.unitWidth);if(self._scrollDistX!=l){self._scroll.scrollTo(l,0);self._scrollDistX=l;}}}}});}});})(window,jQuery);;(function(w,$,undefined){w.Mojo=w.Mojo||{};w.Mojo.com=w.Mojo.com||{};w.Mojo.com.PackageEgg=w.Mojo.Object.extend({init:function(data,options){this._super(undefined,options);this.element().addClass('mojo-com-packageegg');this._data=data;this._addContent();},_addContent:function(){var self=this;$("<div class='tip'></div>").html(self.getL('package','slot_unlock_award')).appendTo(this.element());new Mojo.com.LargeEntity(self._options.niudan,{showDescription:false,showEntityEffect:false}).element().appendTo(this.element());new Mojo.ui.Button(undefined,{text:self.getL('package','start_niudan'),click:function(){self._options.callback();}}).element().appendTo(this.element());},_getDefaultOptions:function(){return $.extend(true,this._super(),{callback:$.noop,niudan:undefined});}});w.Mojo.com.Skill=w.Mojo.Object.extend({clsname:function(){return"com.Package";},init:function(data,options){this._data=data;this._super(undefined,options);this.element().addClass('card-skills');$('<div class="title"></div>').appendTo(this.element());$('<div class="skills"></div>').appendTo(this.element());this._addContent();},_addContent:function(){var cardSkills="";if(Array.isArray(this._data.skills)&&this._data.skills.length<=0){cardSkills+='<div class="skill-group"><span class="skill">('+Mojo.utils.locale('package','null_skills')+')</span></div>';}else if(this._data.skills){var sindex=0;for(var index in this._data.skills){var skill=this._data.skills[index];if(sindex==0){cardSkills+='<div class="skill-group">';}else if(sindex>0&&sindex%2==0){cardSkills+='</div><div class="skill-group">';}
var skillName=(Mojo.utils.isNone(skill.name)?"skill-"+sindex:skill.name);if(skillName.indexOf('<span')==0){skillName=skillName.substring(0,skillName.indexOf('>')+1)+'&#149 '+skillName.substring(skillName.indexOf('>')+1,skillName.length);}else{skillName='<span>&#149 '+skillName+'</span>';}
cardSkills+='<span class="skill">'+skillName+'</span>';sindex++;}
cardSkills+='</div>';}
this.element().find(".title").html(Mojo.utils.locale('package','skill'));this.element().find(".skills").html(cardSkills);this.element().show();},refresh:function(data){this._data=data;this.element().find(".title").empty();this.element().find(".skills").empty();this._addContent();}});w.Mojo.com.Package=w.Mojo.Object.extend({clsname:function(){return"com.Package";},init:function(data,options){this._data=data;this._super(undefined,options);this._general=undefined;this._sword=undefined;this._shield=undefined;this._mounts=undefined;this._treasure=undefined;this.element().addClass("mojo-com-package");this._repaint();this.refresh();},_repaint:function(){this.element().empty();if(this._options.isNewSlot){this._addEggContent();}else{this._addContent();}},_addEggContent:function(){var self=this;var egg=new Mojo.com.PackageEgg(this._data,{callback:function(){self._options.niudanClick(self);},niudan:self._options.niudan});this.element().append(egg.element());},_addContent:function(){var self=this;self._ge=$("<div class='entity-main'></div>").appendTo(this.element());self._entity=$('<div class="entities"></div>').appendTo(self._ge);},refresh:function(data){if(this._options.isNewSlot==true)return;if(data instanceof Object){this._data=data;}
var self=this;if(this._general===undefined){this._general=new Mojo.com.PackageGeneral(this._data,{isMine:self._options.isMine,click:function(general){if(self._options.generalClick instanceof Function){self._options.generalClick(general);}}});this._general.element().appendTo(self._ge);if(self._options.isMine){this._skills=new Mojo.com.Skill(this._data);this._skills.element().appendTo(this.element());}}else{this._general.refresh(data);if(self._options.isMine){this._skills.refresh(data);}}
$.each(this._data.entity_slot_list,function(i,d){var entityId="_"+Mojo.utils.isWhat(d.type_id);if(self[entityId]===undefined){self[entityId]=new Mojo.com.PackageEntity(d,{isMine:self._options.isMine,click:function(entity){if(self._options.entityClick instanceof Function){self._options.entityClick(entity);}}});self[entityId].element().appendTo(self._entity);}else{self[entityId].refresh(d);}});},getObjectByType:function(type,notEmpty){var o=this['_'+type];if(o){if(notEmpty===true&&o.isEmpty()===true){return undefined;}
return o;}
return undefined;},_getDefaultOptions:function(){return{isMine:true,generalClick:undefined,entityClick:undefined,isNewSlot:false,niudanClick:$.noop,niudan:undefined};}});})(window,jQuery);;(function(w,$,undefined){w.Mojo=w.Mojo||{};w.Mojo.com=w.Mojo.com||{};w.Mojo.com.PackageBarrack=w.Mojo.Object.extend({clsname:function(){return"com.BarrackPackage";},init:function(data,options){this._data=data;this._super(undefined,options);this._MAXLEVEL=15;this.element().addClass('mojo-com-barrackpackage mojo-com-package');this.load();},load:function(){var self=this;var params={};if(self._options.is_show_friends==1){params.pid=self._options.pid;}
Mojo.ajax("/barracks",params,function(response){if(response&&response.errorCode===0){response.data.left.entities.length=5;response.data.right.entities.length=5;response.data.center.entities.length=5;var armyPosition=0;for(var i=0;i<self._MAXLEVEL;i++){var army=i%3;var entities=null;if(army==0){entities=response.data.left.entities;}else if(army==1){entities=response.data.right.entities;}else if(army==2){entities=response.data.center.entities;}
if(!entities[armyPosition]){entities[armyPosition]={unlock:0};}
entities[armyPosition].unlock_level=i+1;if(army==2){armyPosition++;}}
self.barracksData=response.data;$('<div class="title"></div>').html(Mojo.utils.locale('package','barrack_level',{level:response.data.level})).appendTo(self.element());self._addContent(response.data);}else{Mojo.app.toast.show(response.errorMsg);}},function(){},{showWait:true});},_addContent:function(d){this._addLeftArmy(d);this._addRightArmy(d);this._addCenterArmy(d);if(this._options.is_show_friends==0){this._addFooter(d);}},_addLeftArmy:function(d){var ld=d.left;var topScroll=$('<div class="army left-army"><div class="leftTitle">'+Mojo.utils.locale('package','barrack_left_army')+'</div><div class="topScroll general-list-bg-border"></div></div>').appendTo(this.element());var bottom=$('<div class="bottom"></div>').html(Mojo.utils.locale('package','barrack_attack',{min:ld.attack_min,max:ld.attack_max})).appendTo(topScroll);var scroll=this._getArmyScroll(ld,0);$(topScroll).find('.topScroll').append(scroll.element());},_addRightArmy:function(d){var rd=d.right;var topScroll=$('<div class="army right-army"><div class="leftTitle">'+Mojo.utils.locale('package','barrack_right_army')+'</div><div class="topScroll general-list-bg-border"></div></div>').appendTo(this.element());var bottom=$('<div class="bottom"></div>').html(Mojo.utils.locale('package','barrack_fangyu',{min:rd.defence_min,max:rd.defence_max})).appendTo(topScroll);var scroll=this._getArmyScroll(rd,1);$(topScroll).find('.topScroll').append(scroll.element());},_addCenterArmy:function(d){var cd=d.center;var topScroll=$('<div class="army center-army"><div class="leftTitle">'+Mojo.utils.locale('package','barrack_center_army')+'</div><div class="topScroll general-list-bg-border"></div></div>').appendTo(this.element());var bottom=$('<div class="bottom"></div>').html(Mojo.utils.locale('package','barrack_kezhi',{value:cd.skill_num})).appendTo(topScroll);var scroll=this._getArmyScroll(cd,2);$(topScroll).find('.topScroll').append(scroll.element());},_addFooter:function(d){var self=this;var footer=$('<div class="foolter"></div>').appendTo(this.element());var progress=$('<div class="progress-div">'+Mojo.utils.locale('package','barrack_jingyan')+'</div>').appendTo(footer);self.jingyanProgress=new Mojo.ui.Progress(undefined,{classes:['xp'],labelTemplate:'#{divide}',});self.jingyanProgress.value({value:d.exp,max:d.exp_conf});var upBtn=new Mojo.ui.Button(undefined,{text:Mojo.utils.locale('package','barrack_up'),classes:['barrack-up-button'],special:"button-big-red",click:function(){self._upClick();}});progress.append(self.jingyanProgress.element());progress.append($('<div class="jingyan-border"></div>'));footer.append(upBtn.element());},_upClick:function(){var self=this;self.element().hide();self._barrackUp=new Mojo.com.BarrackUp(self.barracksData,{onLoadCallback:function(){},onLoaded:function(){},callback:function(){},backCallback:function(){self.element().show();if(self.isLevelUp==1){self._refreshAll();delete self.isLevelUp;}},levelUpCallback:function(flag,d){if(flag==1){self.isLevelUp=1;}else{self.jingyanProgress.value({value:d.exp,max:d.exp_conf});}}});},_getArmyScroll:function(d,army){var self=this;var _list=new Mojo.ui.ListPanel(undefined,{pageSize:20,showMore:false,loadFunc:function(){setTimeout(function(){var arr=new Array(5);var array=d.entities;for(var i=0;i<array.length;i++){arr[i]=array[i];arr[i].index=i;arr[i].army=army;}
_list.element().width(arr.length*self._options.unitWidth);_list.appendData(arr);_scroll.refresh();});},drawFunc:function(data){return self._getArmyScrollEle(data);},onLoaded:function(listpanel){}});var _scroll=new Mojo.ui.Scroll(undefined,_list,{direction:1,classes:['all-small-card-border','left-army'],showArrow:true,step:self._options.unitWidth});return _scroll;},_getArmyScrollEle:function(data){var self=this;var obj=new Mojo.Object(undefined,{classes:['mojo-com-barrack-element','image'],});var ele=obj.element();if(data==undefined||data.unlock==0){ele.append('<div class="locked"></div><div class="lv">'+'LV'+data.unlock_level+'</div>');}else{if(data.player_entity_id==null||data.player_entity_id==""){ele.append('<div class="card-slot"></div>');}else{ele.append('<img src="'+data.small_image+'">');ele.append('<div class="card-border"></div>');}}
if(self._options.is_show_friends==0){obj.element().click(function(){self._armyScrollEleClick(data);});}
return obj;},_armyScrollEleClick:function(data){var self=this;if(data.unlock==1){if(!data.player_entity_id){self._generalClick(data);}else{Mojo.ajax("/embed",{army:data.army||0,is_barracks:1,start:data.index,count:1},function(response){if(response&&response.errorCode===0){var _d={is_barracks:1,getData:function(){response.data.base_slots[0].army=data.army;return response.data.base_slots[0];},refresh:function(){}};self._generalClick(_d);}},function(){});}}else if(data.unlock==0){Mojo.app.toast.show(Mojo.utils.locale('package','barrack_unlockLevel',{level:data.unlock_level}));}},_generalClick:function(general){var self=this;var data=general.getData?general.getData():general;if(data.player_entity_id){var generalDetailDialog=new Mojo.ui.Dialog(undefined,{title:Mojo.utils.locale('package','general_detail_title'),content:(new Mojo.com.LargeEntity((data.isTmp==true?data.player_entity_id:data),{showSkill:true}).element())});var goIntensify=new Mojo.ui.Button(undefined,{text:(parseInt(data.is_max_level)==1&&parseInt(data.rarity_id)<=3?Mojo.utils.locale('common','go_rebirth'):Mojo.utils.locale('common','go_intensify')),special:"button-big-red",click:function(){if(self._hasTutorial===false&&Mojo.utils.getSomething('tutorial')){Mojo.app.redirect("/intensify",{entity:data.player_entity_id,tutorial:'yes'});}else{if(parseInt(data.is_max_level)==1&&parseInt(data.rarity_id)<=3){Mojo.app.redirect("/intensify",{entity:data.player_entity_id,selected:1},'event','06_024');}else{Mojo.app.redirect("/intensify",{entity:data.player_entity_id},'event','06_024');}}}});goIntensify.element().appendTo(generalDetailDialog._footer);new Mojo.ui.Button(undefined,{text:Mojo.utils.locale('package','general_umount'),special:"button-big-blue",click:function(){generalDetailDialog.close();self.element().hide();self._entityPreview=new Mojo.com.EntityPreview({typeId:1,rarityId:'1,2,3,4,5',orderId:1,type:"embed",army:data.army||0,is_barracks:1,isbarracks_up:0,changeGeneral:true,onLoadCallback:function(){},callback:function(generalId,chooseGeneral){self.element().show();self._changeGeneral(general,generalId);},backCallback:function(){self.element().show();}});self._entityPreview.element().appendTo(document.body);}}).element().appendTo(generalDetailDialog._footer);generalDetailDialog.open();}else{self.element().hide();self._entityPreview=new Mojo.com.EntityPreview({typeId:1,rarityId:'1,2,3,4,5',orderId:1,type:"embed",is_barracks:1,isbarracks_up:0,changeGeneral:true,army:data.army||0,onLoadCallback:function(){},onLoaded:function(){},callback:function(generalId,chooseGeneral){if(!generalId){return;}
self.element().show();self._mountGeneral(general,generalId);},backCallback:function(){self.element().show();}});self._entityPreview.element().appendTo(document.body);}},_playGeneralSound:function(reserved_1){if(parseInt(reserved_1)===1){Mojo.gap.soundPlay("03_male_voice");}else{Mojo.gap.soundPlay("04_female_voice");}},_mountGeneral:function(general,generalId){var url='/embed/put';this._embedChange(general,generalId,url);},_changeGeneral:function(general,generalId){var url='/embed/change';this._embedChange(general,generalId,url);},_embedChange:function(general,generalId,url){var self=this;var data=general.getData?general.getData():general;if(data&&(data.isTmp==true||data.player_entity_id!=generalId)){Mojo.ajax(url,{type:0,slot_id:data.player_base_slot_id,entity_id:generalId,is_barracks:1},function(response){if(response&&response.errorCode===0){self._playGeneralSound(response.data.entity_info.reserved_1);var data=response.data.player;var d={};if(data.attack_min!=undefined&&data.attack_min!=null){d["attack_min"]=data.attack_min;}
if(data.attack_max!=undefined&&data.attack_max!=null){d["attack_max"]=data.attack_max;}
if(data.defence_min!=undefined&&data.defence_min!=null){d["defence_min"]=data.defence_min;}
if(data.defence_max!=undefined&&data.defence_max!=null){d["defence_max"]=data.defence_max;}
self._options.corpsProfile.data(d);self._refreshAll(response.data,data);}else{Mojo.app.toast.show(response.errorMsg);}},function(){},{showWait:true});}},_refreshData:function(d){var info=d.barracks_info;var attackMax=info.attack_max;var attackMin=info.attack_min;var defenceMax=info.defence_max;var defenceMin=info.defence_min;var skillsNum=info.skills_num;this.element().find('.left-army .attack').html(attackMin+' - '+attackMax);this.element().find('.right-army .attack').html(defenceMin+' - '+defenceMax);this.element().find('.center-army .attack').html(skillsNum);},_refreshAll:function(){this.element().empty();this.load();},_getDefaultOptions:function(){var self=this;return $.extend(this._super(),{unitWidth:self.getR("unitWidth"),corpsProfile:undefined,is_show_friends:0});},});w.Mojo.com.BarrackUp=w.Mojo.Object.extend({clsname:function(){return"com.BarrackPackage";},init:function(data,options){this._data=data;this._super(undefined,options);this.element().addClass('mojo-com-barrackup');this.element().appendTo(document.body);this.jisiGeneralIds=new Array(5);this.intensifyPreviewDatas=new Array(5);this._isMaxLevel=false;this._MAXLEVEL=15;this._addTabs();this._addBtns();this._load();},_load:function(){this._addContent();this._setTopInfo();this._refresh();},_refresh:function(preview){var self=this;var ids=self._getIds();if(ids.length<=0){self._jisiBtn.disable(true);}else{self._jisiBtn.disable(false);}
Mojo.ajax('/barracks/intensify',{ids:ids.join(','),preview:preview},function(response){if(response.errorCode==0){self.intensifyPreviewDatas=new Array(5);for(var i=0;i<self.jisiGeneralIds.length;i++){if(self.jisiGeneralIds[i]){self.intensifyPreviewDatas[i]=response.data.entities[self.jisiGeneralIds[i]];}}
self.intensifyPreviewData=response.data;if(self._data.level>=self._MAXLEVEL){self._isMaxLevel=true;self._jisiBtn.disable(true);}
self._setBottomInfo();self._addScrollContent();}else{Mojo.app.toast.show(response.errorMsg);}},function(){},{showWait:true});},_addTabs:function(){this._tabs=new Mojo.ui.Tabs();this.element().append(this._tabs.element());this._tabs.addTab(Mojo.utils.locale("package","barrack_army"));this._panel=this._tabs.element().find('.panel').addClass('box-outter');},_addBtns:function(){var self=this;this._backButton=new Mojo.ui.Button('confirm-button',{text:Mojo.utils.locale('common','back'),click:function(){self.element().remove();self._options.backCallback();},});this._backButton.element().addClass('confirm-button').appendTo(this.element());},_addContent:function(){var self=this;var topContent=$('<div class="topContent"></div>').appendTo(this._panel);var left=$('<div class="left"></div>').appendTo(topContent);$('<div class="level">-</div><div class="rightIcon"></div><div><div class="label">'+Mojo.utils.locale("package","barrack_army")+'</div><div class="barDiv"></div></div>').appendTo(left);this._armyGuideButton=$('<div class="army-guide-btn">'+Mojo.utils.locale("package","barrack_guid")+'</div>').bind('click',function(){self._armyGuideClick();});var right=$('<div class="right"></div>').appendTo(topContent);this._armyGuideButton.appendTo(right);var centerContent=$('<div class="centerContent"></div>').appendTo(this._panel);var scrollTitle=$('<div class="scrollTitle">'+Mojo.utils.locale("package","barrack_select_jisiCard")+'</div>').appendTo(centerContent);this._addScrollContent();$('<div class="exp"><span class="label">'+Mojo.utils.locale("package","barrack_getJingyan")+'</span><span class="value">-</span></div><div class="exp exp_ok" style="display: none"><span class="label">'+Mojo.utils.locale("package","barrack_jisiOk")+'</span><span class="value">-</span></div>').appendTo(centerContent);$('<div class="robCount"><span class="label">'+Mojo.utils.locale("package","barrack_jisiBaowu_num")+'</span><span class="value">-</span></div>').appendTo(centerContent);$('<div class="explain"><div class="l"><span class="icon">*</span><span class="text">'+Mojo.utils.locale("package","barrack_jihuojineng")+'</span></div><div class="r"><span class="icon">*</span><span class="text">'+Mojo.utils.locale("package","barrack_jihuojiangli")+'</span></div></div>').appendTo(centerContent);var bottomContent=$('<div class="bottomContent"></div>').appendTo(centerContent);this._jisiBtn=new Mojo.ui.Button(undefined,{text:Mojo.utils.locale("package","barrack_jisi"),classes:['jisi'],special:"button-big-red",disabled:true,click:function(){self._jisiClick();},disableClick:function(){if(!self._isMaxLevel){Mojo.app.toast.show(Mojo.utils.locale('package','barrack_disabled_jisi_btn'));}else{Mojo.app.toast.show(Mojo.utils.locale('package','barrack_level_max_guid'));}}});this._jisiBtn.element().appendTo(bottomContent);this._resetBtn=new Mojo.ui.Button(undefined,{text:Mojo.utils.locale("package","barrack_reset"),classes:['reset'],click:function(){self._resetClick();}});this._resetBtn.element().appendTo(bottomContent);},_addScrollContent:function(){var self=this;var p=self._panel.find('.centerContent');var scrollContent=p.find('.scrollContent');if(scrollContent.length==0){scrollContent=$('<div class="scrollContent"></div>');scrollContent.appendTo(p);}else{scrollContent.empty();}
for(var i=0;i<5;i++){var scrollEle=this.intensifyPreviewDatas[i];var entity=new Mojo.com.BarrackUpEntity(scrollEle,{_idx:i,_scrollEleClick:function(d,idx){self._scrollEleClick(d,idx);}});scrollContent.append(entity.element());}},_setTopInfo:function(){var level=this._data.level;var exp=this._data.exp;var exp_conf=this._data.exp_conf;this._panel.find('.topContent .level').html(level);if(this.barrackArmyProgress){this.barrackArmyProgress.value(exp);}else{this.barrackArmyProgress=new Mojo.ui.Progress(undefined,{classes:['xp'],labelTemplate:'#{divide}',max:exp_conf,min:0,value:exp});this.barrackArmyProgress.element().appendTo(this._panel.find('.topContent .barDiv'));}
this.barrackArmyProgress.value({value:exp,max:exp_conf});},_setBottomInfo:function(){var exp=0;var treasure_num=0;if(this.intensifyPreviewData){var exp_max=""+this.intensifyPreviewData.exp_max;var exp_min=""+this.intensifyPreviewData.exp_min;if(exp_max=='undefined'||exp_min=='undefined'){exp=0;}else{exp=exp_min+'-'+exp_max;}
treasure_num=this.intensifyPreviewData.treasure_num;}
this._panel.find('.centerContent .robCount .value').html(treasure_num);this._panel.find('.centerContent .exp .value').html(exp);},_armyGuideClick:function(){var content=$('<div class="paragraph"></div>').html(Mojo.utils.locale('package','barrack_armyguide_content'));new Mojo.com.CommonDialog(undefined,{title:Mojo.utils.locale('package','barrack_armyguide_title'),content:content,leftBtnText:Mojo.utils.locale('ui','Close'),leftBtnClick:function(that){that.close();},}).open();},_getIds:function(){var self=this;var ids=[];for(var i=0;i<self.jisiGeneralIds.length;i++){if(self.jisiGeneralIds[i]){ids.push(self.jisiGeneralIds[i]);}}
return ids;},_jisiClick:function(){var self=this;var ids=self._getIds();var exp=0;var exp_max=""+this.intensifyPreviewData.exp_max;var exp_min=""+this.intensifyPreviewData.exp_min;if(exp_max=='undefined'||exp_min=='undefined'){exp=0;}else{exp=exp_min+'-'+exp_max;}
var generals={};for(var j=0;j<ids.length;j++){var id=ids[j];var entity=this.intensifyPreviewData.entities[id];var gId=entity.id;if(generals[gId]){++generals[gId].num;}else{generals[gId]={name:entity.name,num:1};}}
var jisiCard=[];for(var key in generals){var g=generals[key];jisiCard.push(g.name+''+g.num);}
var content=$('<div class="paragraph"></div>').html(Mojo.utils.locale('package','barrack_jisiok_content',{jisiCard:jisiCard.join(','),exp:exp}));new Mojo.com.CommonDialog(undefined,{title:Mojo.utils.locale('package','barrack_jisiok_title'),content:content,leftBtnText:Mojo.utils.locale('common','ok'),leftBtnClick:function(that){Mojo.ajax("/barracks/intensify",{ids:ids.join(','),preview:0},function(response){that.close();Mojo.gap.intensifyAnimationPlay();if(response&&response.errorCode===0){var d=response.data;self.element().find('.exp').hide();self.element().find('.exp_ok').show();self.jisiGeneralIds=new Array(5);self.intensifyPreviewDatas=new Array(5);self.intensifyPreviewData=d;self._data.level=d.level;self._data.exp=d.exp;self._data.exp_conf=d.exp_conf;self._setTopInfo();self._setBottomInfo();self._addScrollContent();self._panel.find('.centerContent .exp .value').html(d.add_exp);self._jisiBtn.disable(true);if(d.level_up==1){self._options.levelUpCallback(1);self._showUpSuccessDlg();}else{self._options.levelUpCallback(0,d);}
if(d.level>=self._MAXLEVEL){self._isMaxLevel=true;self._jisiBtn.disable(true);}}else{Mojo.app.toast.show(response.errorMsg);}},function(){},{showWait:true});},rightBtnText:Mojo.utils.locale('ui','Close'),rightBtnClick:function(that){that.close();},}).open();},_showUpSuccessDlg:function(){var content=$('<div class="paragraph"></div>').html(Mojo.utils.locale('package','barrack_armyup_content',{level:this._data.level}));new Mojo.com.CommonDialog(undefined,{title:Mojo.utils.locale('package','barrack_up_ok'),classes:['army-up-dlg'],content:content,leftBtnText:Mojo.utils.locale('ui','Close'),leftBtnClick:function(that){that.close();},}).open();},_resetClick:function(){var self=this;self.intensifyPreviewDatas=new Array(5);self.intensifyPreviewData=null;self.element().find('.exp .value').html('0');self.element().find('.exp_ok .value').html('0');self.element().find('.exp').show();self.element().find('.exp_ok').hide();if(self._getIds(self.jisiGeneralIds).length>0){self.jisiGeneralIds=new Array(5);self._refresh(0);}
self.jisiGeneralIds=new Array(5);self._jisiBtn.disable(true);},_scrollEleClick:function(general,idx){var self=this;self.currentIdx=idx;if(general){var generalDetailDialog=new Mojo.ui.Dialog(undefined,{title:Mojo.utils.locale('package','barrack_card_detail_title'),content:(new Mojo.com.LargeEntity((general.isTmp==true?general.player_entity_id:general),{showSkill:true}).element())});new Mojo.ui.Button(undefined,{text:Mojo.utils.locale('package','general_umount'),special:"button-big-blue",click:function(){generalDetailDialog.close();self._createEntityPreview(2);}}).element().appendTo(generalDetailDialog._footer);var downGeneral=new Mojo.ui.Button(undefined,{text:Mojo.utils.locale('package','barrack_down'),special:"button-big-red",click:function(){generalDetailDialog.close();self._downGeneral();}});downGeneral.element().appendTo(generalDetailDialog._footer);generalDetailDialog.open();}else{self._createEntityPreview(1);}},_createEntityPreview:function(type){var self=this;var entityPreview=new Mojo.com.EntityPreview({typeId:'1,2,3,4,5',rarityId:'1,2',orderId:1,type:"barracks",is_barracks:1,isbarracks_up:1,treasure_num:!self.intensifyPreviewData?0:self.intensifyPreviewData.treasure_num,excludeIds:self._getIds().join(','),onLoadCallback:function(){},onLoaded:function(){},callback:function(generalId,chooseGeneral){if(!generalId){return;}
if(type==1){self.element().find('.exp').show();self.element().find('.exp_ok').hide();self._upGeneral(generalId,chooseGeneral);}else if(type==2){self._changeGeneral(generalId,chooseGeneral);}},backCallback:function(){}});entityPreview.element().appendTo(document.body);},_upGeneral:function(generalId,chooseGeneral){if($.inArray(generalId,this.jisiGeneralIds)<0){this.jisiGeneralIds[this.currentIdx]=generalId;}
this._refresh(1);},_downGeneral:function(generalId,chooseGeneral){this.jisiGeneralIds[this.currentIdx]=null;this._refresh(1);},_changeGeneral:function(generalId,chooseGeneral){this.jisiGeneralIds[this.currentIdx]=generalId;this._refresh(1);},_getDefaultOptions:function(){return $.extend(this._super(),{backCallback:undefined,levelUpCallback:undefined});},});w.Mojo.com.BarrackUpEntity=w.Mojo.Object.extend({clsname:function(){return"com.BarrackUpEntity";},init:function(data,options){this._data=data;this._super(undefined,options);this.element().addClass('mojo-com-barrackupentity');this._addContent();this._bindEvent();},_bindEvent:function(){var self=this;this.element().find('.icon').click(function(e){self._clickEvent(e);});},_clickEvent:function(){this._options._scrollEleClick(this._data,this._options._idx);},_addContent:function(){var d=this._data;if(d){var name=d.name;var icon=d.small_image;var activeSkillNum=d.num;var activeRewardVal=d.val;$('<div class="icon"><img src="'+icon+'"></div><div class="name">'+name+'</div><div class="activeSkill"><span class="l">*</span><span class="r">'+activeSkillNum+'</span></div><div class="reward"><span class="l">*</span><span class="r">'+activeRewardVal+'%</span></div>').appendTo(this.element());}else{$('<div class="icon"></div>').appendTo(this.element());}},_getDefaultOptions:function(){return $.extend(this._super(),{_scrollEleClick:undefined,_idx:0,});},});})(window,jQuery);;(function(w,$,undefined){w.Mojo=w.Mojo||{};w.Mojo.com=w.Mojo.com||{};w.Mojo.com.PackageGeneral=w.Mojo.Object.extend({clsname:function(){return"com.PackageGeneral";},init:function(data,options){this._data=data;this._super(undefined,options);this.element().addClass("mojo-com-package-general");this.element().append('<div class="head"></div>');this.element().append('<div class="card"></div>');this.element().append('<div class="card-default"><div class="text"></div></div>');this.refresh();this._initEvent();},refresh:function(data,isTmp){var self=this;if(data){this._data=data;}
if(isTmp==true){this._data.isTmp=true;}
this.element().find(".head").html((this._options.isMine?Mojo.utils.locale('package','my_head_title'):Mojo.utils.locale('package','friend_head_title')));this.element().find(".head").hide();if(this._data.player_entity_id){this.element().find(".card-default").hide();new Mojo.com.LargeEntity((this._data.isTmp==true?this._data.player_entity_id:this._data),{showSkill:false,showDescription:false,callback:function(card){self.element().find(".card").children().remove();card.element().appendTo(self.element().find(".card").show());}});}else{this.clear();}},clear:function(){this._data.player_entity_id=undefined;this.element().find(".card").hide();this.element().find(".card-default > .text").html(Mojo.utils.locale('package','install_general'));this.element().find(".card-default").show();},getData:function(d){if(Mojo.utils.isNone(d)==false){$.extend(true,this._data,d);}
return this._data;},isEmpty:function(){return(this._data.player_entity_id?false:true);},_initEvent:function(){var self=this;this.element().find(".card").bind("click",function(){if(self._options.click instanceof Function){self._options.click(self);}});this.element().find(".card-default").bind("click",function(){if(self._options.click instanceof Function){self._options.click(self);}});},_getDefaultOptions:function(){return{click:undefined};}});})(window,jQuery);;(function(w,$,undefined){w.Mojo=w.Mojo||{};w.Mojo.com=w.Mojo.com||{};w.Mojo.com.PackageEntity=w.Mojo.Object.extend({clsname:function(){return"com.PackageEntity";},init:function(data,options){this._data=data;this._super(undefined,options);this.element().addClass("mojo-com-package-entity").addClass("entity_"+this._data.type_id);this.element().append('<div class="card"></div>');this.element().append('<div class="name"></div>');this.element().append('<div class="no-entity no-entity-'+Mojo.utils.isWhat(this._data.type_id)+'"><div class="text"></div></div>');this.refresh();this._initEvent();},refresh:function(data,isTmp){if(data){this._data=data;}
if(isTmp===true){this._data.isTmp=true;}
var self=this;if(this._data.player_entity_id){this.element().find(".no-entity").hide();self.element().find(".card").children().remove();new Mojo.com.SmallEntity(this._data,{callback:function(card){self.element().find(".card").show().append(card.element());}});var index1=this._data.name.indexOf("");var aname=this._data.name.substring(index1+1);if(this._data.rebirth_sum==4){this.element().find(".name").addClass("rebirth-4").html(aname).show();}else if(this._data.rebirth_sum==5){this.element().find(".name").addClass("rebirth-5").html(aname).show();}else if(this._data.rebirth_sum>=6){this.element().find(".name").addClass("rebirth-6").html(aname).show();}else{this.element().find(".name").html(this._data.name).show();}}else{this.clear();}},getData:function(d){if(Mojo.utils.isNone(d)==false){$.extend(true,this._data,d);}
return this._data;},isEmpty:function(){return(this._data.player_entity_id?false:true);},clear:function(){this._data.player_entity_id=undefined;var noEntityText="";if(Mojo.utils.isWhat(this._data.type_id,'sword')){noEntityText=Mojo.utils.locale('package','install_sword');}else if(Mojo.utils.isWhat(this._data.type_id,'shield')){noEntityText=Mojo.utils.locale('package','install_shield');}else if(Mojo.utils.isWhat(this._data.type_id,'mounts')){noEntityText=Mojo.utils.locale('package','install_mounts');}else if(Mojo.utils.isWhat(this._data.type_id,'treasure')){noEntityText=Mojo.utils.locale('package','install_treasure');}
this.element().find(".card").hide();this.element().find(".name").hide();this.element().find(".no-entity > .text").html(noEntityText);this.element().find(".no-entity").show();this.element().find(".name").removeClass("rebirth-4").removeClass("rebirth-5").removeClass("rebirth-6");},_initEvent:function(){var self=this;this.element().bind("click",function(){if(self._options.click instanceof Function){self._options.click(self);}});},_getDefaultOptions:function(){return{isMine:true,click:undefined};}});})(window,jQuery);;(function(w,$,undefined){w.Mojo=w.Mojo||{};w.Mojo.com=w.Mojo.com||{};w.Mojo.com.MessageDialog=w.Mojo.ui.Dialog.extend({clsname:function(){return"com.MessageDialog";},init:function(data,options){this._data=data;this._super(undefined,options);this.element().addClass('mojo-com-messagedlg');if(this._options.isSuggestion==true){this._options.hintText=Mojo.utils.locale('settings','suggestion_default_text');}
this._addContent();this._addHandleButtons();},_addContent:function(){var self=this;var paragraph=$('<div class="paragraph"></div>');self._tip=$('<div class="words-tip"></div>').html(self._options.maxlength).appendTo(paragraph);self._border=$('<div class="border"></div>').appendTo(paragraph);self._postcontent=$('<form name="form" method="post" action=""><textarea name="textarea" maxlength="'+self._options.maxlength+'" id="message-content" cols="45" rows="5">'+self._options.hintText+'</textarea></form>').appendTo(self._border);paragraph.appendTo(this._content);this._textarea=this._content.find('textarea').focus(function(){if(this.value==self._options.hintText){this.value='';}});this._textarea.bind("change paste keyup input",function(){var v=parseInt(this.value.length);if(v<=self._options.maxlength){self._tip.html(self._options.maxlength-v);}});},_addHandleButtons:function(){var self=this;this._footer.append((new Mojo.ui.Button(undefined,{special:'button-big-red',text:Mojo.utils.locale('ui','Send'),click:function(){var content=self._textarea.attr('value');if(content==self._options.hintText){content='';}
if(self._options.isFriendRequest==true){Mojo.track.onEvent('09_032');Mojo.ajax('/friend/Add',{friend_id:self._options.id,content:content,},function(result){if(result.errorCode==0){Mojo.app.toast.show(Mojo.utils.locale('friend','has invited'));self._options.callback();}else{Mojo.app.toast.show(result.errorMsg);}});self.close();}else if(self._options.isSuggestion==true){if(Mojo.utils.trim(content)==''){Mojo.app.toast.show(Mojo.utils.locale('common','no content'));return;}
Mojo.app.toast.show(Mojo.utils.locale('common','suggestion_has_send'));Mojo.ajax('/suggestion/Add',{content:content,},function(result){if(result.errorCode==0){}else{}});self.close();}else{if(Mojo.utils.trim(content)==''){Mojo.app.toast.show(Mojo.utils.locale('friend','no content'));return;}
Mojo.app.toast.show(Mojo.utils.locale('friend','has sended'));Mojo.ajax('/friend/Message',{friend_id:self._options.id,content:content,},function(result){if(result.errorCode==0){}else{}});self.close();}},})).element());this._footer.append((new Mojo.ui.Button('close-btn',{text:Mojo.utils.locale('ui','Close'),click:function(){self.close();},})).element());},_getDefaultOptions:function(){return $.extend(true,this._super(),{title:Mojo.utils.locale('ui','Leave Message'),maxlength:100,hintText:Mojo.utils.locale('common','default_text'),id:'',callback:$.noop,isFriendRequest:false,isSuggestion:false,});},});})(window,jQuery);;(function(w,$,undefined){w.Mojo=w.Mojo||{};w.Mojo.com=w.Mojo.com||{};w.Mojo.com.BattleDetailDialog=w.Mojo.ui.Dialog.extend({clsname:function(){return"com.BattleDetailDialog";},init:function(data,options){var self=this;this._data=data;this._super(undefined,options);this.element().addClass('mojo-com-battledetaildlg');this._attackerStatistics={'is_res':0,'is_anti_res':0,'weapon_add_attack':0};this._defenderStatistics={'is_res':0,'is_anti_res':0,'armor_add_defence':0};this._addContent();this._showResult();this._addButtons();},_addContent:function(){var self=this;this._content.append(this._templateLeft);this._content.append(this._templateRight);this._content.after($('<div class="center_line"></div>'));},_showResult:function(){var self=this;this._content.find('.top-left > .player_name').html(self._data.attacker.player.name);this._content.find('.top-left > .player_level').html(Mojo.utils.locale('common','level')+self._data.attacker.player.level);this._content.find('.top-left > .player_sum').html(Mojo.utils.locale('battle','sum attack')+self._data.attacker.player.sum_attack);this._content.find('.top-left > .player_base').html(Mojo.utils.locale('battle','base attack')+self._data.attacker.player.base_attack);this._content.find('.top-right > .player_name').html(self._data.defender.player.name);if(self._options.non_show_def_lever==undefined||self._options.non_show_def_lever==false){this._content.find('.top-right > .player_level').html(Mojo.utils.locale('common','level')+self._data.defender.player.level);}
this._content.find('.top-right > .player_sum').html(Mojo.utils.locale('battle','sum defence')+self._data.defender.player.sum_defence);if(self._options.non_show_base_def==undefined||self._options.non_show_base_def==false){this._content.find('.top-right > .player_base').html(Mojo.utils.locale('battle','base defence')+self._data.defender.player.base_defence);}
this._army=$('<div class="army"></div>').appendTo(this._content);var _blankScroll=$('<div></div>');var _playerArmy=$('<div class="con_left"></div>').appendTo(_blankScroll);if(self._data.attacker.army!=undefined&&self._data.attacker.army.length>0){for(var index in self._data.attacker.army){var army=self._data.attacker.army[index];var attacker=$('<div></div>').addClass("player_attacker").appendTo(_playerArmy);var image=$('<div class="small-card"></div>');$('<img></img>').attr('src',army.small_image).appendTo(image);image.appendTo(attacker);var attackerRestraint=$('<div class="attacker-restraint"></div>').appendTo(attacker);if(army.is_res==1){self._attackerStatistics.is_res+=1;var res=new Mojo.ui.Label(undefined,{text:Mojo.utils.locale('battle','restraint'),classes:['restraint'],});res.element().appendTo(attackerRestraint);}
if(army.is_be_res==1){var be_res=undefined;if(army.is_anti_res==1){self._attackerStatistics.is_anti_res+=1;be_res=new Mojo.ui.Label(undefined,{text:Mojo.utils.locale('battle','resist'),classes:['resist'],});}else{be_res=new Mojo.ui.Label(undefined,{text:Mojo.utils.locale('battle','be_restraint'),classes:['be-restraint'],});}
be_res.element().appendTo(attackerRestraint);}
if(army.weapon_add_attack>0){self._attackerStatistics.weapon_add_attack+=1;var res=new Mojo.ui.Label(undefined,{text:Mojo.utils.locale('battle','weapon_hit'),classes:['weapon_hit'],});res.element().appendTo(attackerRestraint);}
var attackerName=$('<div></div>').addClass("attacker_name").addClass('rebirth-'+(army.rebirth_sum>6?6:army.rebirth_sum)).appendTo(attacker).html(army.name);var attackerAttack=$('<div></div>').addClass("attacker_attack").appendTo(attacker).html(Mojo.utils.locale('common','simple_attack')+army.attack);}
var playerArmyStatistics=$('<div class="army-statistics"></div>').prependTo(_playerArmy);(new Mojo.ui.Label(undefined,{text:Mojo.utils.locale('battle','restraint')+""+"<span class = 'small_font'>"+self._attackerStatistics.is_res+"</span>",classes:['restraint']})).element().appendTo(playerArmyStatistics);(new Mojo.ui.Label(undefined,{text:Mojo.utils.locale('battle','resist')+""+"<span class = 'small_font'>"+self._attackerStatistics.is_anti_res+"</span>",classes:['resist']})).element().appendTo(playerArmyStatistics);(new Mojo.ui.Label(undefined,{text:Mojo.utils.locale('battle','weapon_hit')+""+"<span class = 'small_font'>"+self._attackerStatistics.weapon_add_attack+"</span>",classes:['weapon_hit']})).element().appendTo(playerArmyStatistics);}
var _opponentArmy=$('<div class="con_right"></div>').appendTo(_blankScroll);if(self._data.defender.army!=undefined&&self._data.defender.army.length>0){for(var index in self._data.defender.army){var army=self._data.defender.army[index];var defender=$('<div></div>').addClass("opponent_defender").appendTo(_opponentArmy);var image=$('<div class="small-card"></div>');$('<img></img>').attr('src',army.small_image).appendTo(image);image.appendTo(defender);var defenderRestraint=$('<div class="defender-restraint"></div>').appendTo(defender);if(army.is_res==1){self._defenderStatistics.is_res+=1;var res=new Mojo.ui.Label(undefined,{text:Mojo.utils.locale('battle','restraint'),classes:['restraint'],});res.element().appendTo(defenderRestraint);}
if(army.is_be_res==1){var be_res=undefined;if(army.is_anti_res==1){self._defenderStatistics.is_anti_res+=1;be_res=new Mojo.ui.Label(undefined,{text:Mojo.utils.locale('battle','resist'),classes:['resist'],});}else{be_res=new Mojo.ui.Label(undefined,{text:Mojo.utils.locale('battle','be_restraint'),classes:['be-restraint'],});}
be_res.element().appendTo(defenderRestraint);}
if(army.armor_add_defence>0){self._defenderStatistics.armor_add_defence+=1;var res=new Mojo.ui.Label(undefined,{text:Mojo.utils.locale('battle','armor_protect'),classes:['armor_protect'],});res.element().appendTo(defenderRestraint);}
var defenderName=$('<div></div>').addClass("defender_name").addClass('rebirth-'+(army.rebirth_sum>6?6:army.rebirth_sum)).appendTo(defender).html(army.name);var defenderDefence=$('<div></div>').addClass("defender_defence").appendTo(defender).html(Mojo.utils.locale('common','simple_defence')+army.defence);}
var opponentArmyStatistics=$('<div class="army-statistics"></div>').prependTo(_opponentArmy);(new Mojo.ui.Label(undefined,{text:Mojo.utils.locale('battle','restraint')+""+"<span class = 'small_font'>"+self._defenderStatistics.is_res+"</span>",classes:['restraint']})).element().appendTo(opponentArmyStatistics);(new Mojo.ui.Label(undefined,{text:Mojo.utils.locale('battle','resist')+""+"<span class = 'small_font'>"+self._defenderStatistics.is_anti_res+"</span>",classes:['resist']})).element().appendTo(opponentArmyStatistics);(new Mojo.ui.Label(undefined,{text:Mojo.utils.locale('battle','armor_protect')+""+"<span class = 'small_font'>"+self._defenderStatistics.armor_add_defence+"</span>",classes:['armor_protect']})).element().appendTo(opponentArmyStatistics);}
self._scroll=new Mojo.ui.Scroll(undefined,_blankScroll,{direction:2});self._scroll.element().css('height',self.getR("height"));this._army.append(self._scroll.element());if(self._data.win==true){Mojo.gap.soundPlay('19_battle_win,mp3');}else{Mojo.gap.soundPlay('20_battle_lose,mp3');}},_onDialogAppend:function(){var self=this;self._scroll.refresh();},_addButtons:function(){var self=this;var btn=new Mojo.ui.Button(undefined,{text:Mojo.utils.locale('battle','formation'),click:function(){Mojo.app.redirect('/package');},special:'button-big-red',});if(self._options.show_detail_first==true){btn=new Mojo.ui.Button(undefined,{text:Mojo.utils.locale('common','ok'),click:function(){self.close();},special:'button-big-red',});}
this._footer.append(btn.element());},_getDefaultOptions:function(){return $.extend(true,this._super(),{title:Mojo.utils.locale('battle','formation detail'),opponent_id:'',opponent_name:'',entity_id:'',pk_mode:false,zIndex:1005,backCallback:$.noop,xp:'',vm:'',entity:null,});},_templateLeft:'<div class="top-left">\
    <div class="player_name"></div>\
    <div class="player_level"></div>\
    <div class="player_sum"></div>\
    <div class="player_base"></div>\
   </div>',_templateRight:'<div class="top-right">\
    <div class="player_name"></div>\
    <div class="player_level"></div>\
    <div class="player_sum"></div>\
    <div class="player_base"></div>\
   </div>',});})(window,jQuery);;(function(w,$,undefined){w.Mojo=w.Mojo||{};w.Mojo.com=w.Mojo.com||{};w.Mojo.com.ForceMemberAdjustDialog=w.Mojo.ui.Dialog.extend({clsname:function(){return"com.ForceMemberAdjustDialog";},init:function(data,options){this._data=data;this._super(undefined,options);this.element().addClass('mojo-com-forcememberadjustdlg');this._force=Mojo.page.Force.getController().getForceProfile();this._defaultOfficial={};this._official={};this._addHeader();this._addContent();this._addButtons();},_addHeader:function(){this._paragraph=$('<div class="paragraph"></div>').appendTo(this._content);var title='';if(this._data.title!=undefined&&this._data.title!=''){title='[<span class="official">'+this._data.title+'</span>]';}
this._header=$('<div class="header"></div>').html(Mojo.utils.locale('force','how_to_adjust_official',{honor:title,name:this._data.name}));this._header.appendTo(this._paragraph);},_addContent:function(){var self=this;var officials=[{type:100,name:Mojo.utils.locale('force','official100')},{type:5,name:Mojo.utils.locale('force','official5'),cur:this._force.third_class_officer_num,total:this._force.third_class_officer_num_limit},{type:4,name:Mojo.utils.locale('force','official4'),cur:this._force.second_class_officer_num,total:this._force.second_class_officer_num_limit},{type:3,name:Mojo.utils.locale('force','official3'),cur:this._force.first_class_officer_num,total:this._force.first_class_officer_num_limit},{type:2,name:Mojo.utils.locale('force','official2'),cur:(this._force.vice_owner==null)?0:1,total:1},{type:1,name:Mojo.utils.locale('force','official1')}];this._officials=$('<div class="officials"></div>').appendTo(this._paragraph);for(var i=0;i<officials.length;i++){var o=officials[i];var so=$('<div class="sub-official"></div>').appendTo(this._officials);$('<div class="name"></div>').html(o.name).appendTo(so);if(o.cur!=undefined){$('<div class="official-count"></div>').html('('+o.cur+'/'+o.total+')').appendTo(so);}
var btn=$('<div class="radio"></div>').data({official:o}).click(function(){if($(this).data('official').type==self._official.type)return;if($(this).data('official').cur!=undefined&&$(this).data('official').cur>=$(this).data('official').total){Mojo.app.toast.show(Mojo.utils.locale('force','cannot_adjust_more_official',{official:Mojo.utils.locale('force','official'+$(this).data('official').type)}));return;}
if($(this).hasClass('radio-selected-class')){}else{self._officials.find('.radio').removeClass('radio-selected-class');$(this).addClass('radio-selected-class');self._official=$(this).data('official');}}).appendTo(so);if(o.cur!=undefined&&o.cur>=o.total){btn.addClass('radio-disable-class');}
if(o.type==parseInt(self._data.position_id)){btn.addClass('radio-selected-class');self._official=o;}}},_addButtons:function(){var self=this;(new Mojo.ui.Button(undefined,{text:Mojo.utils.locale('common','ok'),click:function(){if(self._official.type!=parseInt(self._data.position_id)){if(self._official.type==1&&parseInt(self._data.level)<50){self.hide();(new Mojo.com.HandleDialog({title:Mojo.utils.locale('force','fail_to_do'),message:Mojo.utils.locale('force','cannot_adjust_owner'),close:function(){self.show();},})).open(true);return;}
Mojo.ajax('/force/appointOfficer',{player_id:self._data.id,position_id:self._official.type},function(result){if(result.errorCode==0){self._options.callback();}else{Mojo.app.toast.show(result.errorMsg);}});}
self.close();},special:'button-big-red'})).element().appendTo(this._footer);(new Mojo.ui.Button(undefined,{text:Mojo.utils.locale('common','close'),click:function(){self.close();},})).element().appendTo(this._footer);},_getDefaultOptions:function(){return $.extend(true,this._super(),{title:Mojo.utils.locale('force','adjust_official'),callback:$.noop,});},});})(window,jQuery);;(function(w,$,undefined){w.Mojo=w.Mojo||{};w.Mojo.com=w.Mojo.com||{};w.Mojo.com.ForceEvent=w.Mojo.Object.extend({clsname:function(){return"com.ForceEvent";},init:function(options){this._super('com-force-event',options);this._selected=undefined;this.element().addClass('mojo-com-forceevent');this._playerProfile=this._options.getController().getPlayerProfile();this._addTabs();this._addButton();},_addTabs:function(){var self=this;this._panels=[{type:'war',label:'foreign'},{type:'member',label:'member'},{type:'other',label:'other'},];this._tabs=new Mojo.ui.Tabs('tabs-event',{selectionChange:function(i){self._createList(i);},});$.each(this._panels,function(i,p){self._tabs.addTab(self.locale(p.label));});this.element().append(this._tabs.element());this._tabs.element().find('.panel').addClass('box-outter');if(Mojo.app.request('index')==5)
this._selected=Mojo.app.request('selected');if(Mojo.utils.isNone(this._selected)==true){this._selected=0;}else{this._selected=parseInt(this._selected);}
this._createList(this._selected);this._tabs._select(this._selected);},_createList:function(index){var self=this;var p=this._panels[index];if(p.list==undefined||p.list==null){p.list=new Mojo.com.ForceEventList('evt-'+p.type,{type:p.type,positionId:self._playerProfile.position_id,refreshCallback:function(){self._options.getController().syncForce();},getController:function(){return self._options.getController();},});this._tabs.setPanel(index,p.list);}},_addButton:function(){var self=this;this._backBtn=new Mojo.ui.Button(undefined,{text:Mojo.utils.locale('common','back'),click:function(){self.element().hide();self._options.getController().switchToHome();},classes:['force-back-btn'],});this._backBtn.element().appendTo(this.element());},_getDefaultOptions:function(){return{backCallback:$.noop,};},localeCat:function(){return'force';},});})(window,jQuery);;(function(w,$,undefined){w.Mojo=w.Mojo||{};w.Mojo.com=w.Mojo.com||{};w.Mojo.com.ForceEventList=w.Mojo.ui.ListPanel.extend({clsname:function(){return"com.ForceEventList";},init:function(id,options){this._total=0;this._readedStart=0;this._super(id,options);this.element().addClass('mojo-com-msglist');},_getDefaultOptions:function(){var self=this;return $.extend(true,this._super(),{type:'war',positionId:null,moreLabel:Mojo.utils.locale('ui','More Messages'),loadFunc:function(start,count){self._retrieveMessages(start,count);},drawFunc:function(data){return new Mojo.com.ForceEventElement(data,{positionId:self._options.positionId,handle:function(msg,handle,that){if(handle==1){self._msgHandle1(msg,that);}else if(handle==2){self._msgHandle2(msg,that);}},classes:['box-inner'],});},scrollable:true,emptyLabel:Mojo.utils.locale('message','No Message!'),refreshCallback:$.noop,getController:$.noop});},_retrieveMessages:function(start,count){var self=this;var params={};if(self._readedStart>0){params={force_id:1,start:self._readedStart,count:count,total:self._total+count,type:self._options.type,onlyreaded:true,};}else{params={force_id:1,start:start,count:count,total:self._total+count,type:this._options.type};}
Mojo.ajax('/force/messageList',params,function(result){if(result.errorCode==0){self.appendData(result.data.messages);$.each(self.children(),function(i,child){if(i>=start){if(Mojo.utils.isNone(child.data.status)==false&&(parseInt(child.data.status)==1||parseInt(child.data.status)==2)){self._hasHandledThisMsg(child);self._readedStart+=1;}}});if(result.data.messages!=undefined&&result.data.messages.length==self._options.pageSize){self._more.show();}else{self._more.hide();}
if(result.data.messages!=undefined){self._total+=result.data.messages.length;}
self.resize();}});},_msgHandle1:function(msg,msgcom){var tit=undefined;var dlgmsg=undefined;var lBtnTxt=undefined;var lBtnClkFun=undefined;var self=this;var type=parseInt(msg.type);switch(type){case 0:Mojo.ajax('/force/messageHandler',{id:msg.id,handle:1,},function(result){if(result.errorCode==0){Mojo.track.onEvent('24_402');msg.status=1;self._hasHandledThisMsg(msgcom);self._options.refreshCallback();if(result.data!=undefined&&result.data.inForce==1){Mojo.app.toast.show(Mojo.utils.locale('force','has_in_force'));}}else if(result.errorCode==130068){msg.status=2;self._hasHandledThisMsg(msgcom);var dlg=new Mojo.ui.Dialog(undefined,{title:Mojo.utils.locale('force','applicant_cd_time_not_enough',{'__default__':''}),content:$('<div class="paragraph"></div>').html(result.errorMsg)});(new Mojo.ui.Button(undefined,{text:Mojo.utils.locale('common','close'),click:function(){dlg.close();}})).element().appendTo(dlg._footer);dlg.open();}else{msg.status=2;self._hasHandledThisMsg(msgcom);Mojo.app.toast.show(result.errorMsg);}});break;case 9:Mojo.app.redirect('/force',{index:1,refresh:1});break;case 10:Mojo.app.redirect('/force',{index:2,refresh:1});break;case 13:case 14:Mojo.ajax('/force/messageHandler',{id:msg.id,handle:1,},function(result){if(result.errorCode==0){Mojo.app.redirect('/force',{index:2,refresh:1,target_force_id:msg.int_data});}else{new Mojo.com.TipsDialog({message:result.errorMsg,}).open();}});break;case 51:case 52:var opponent_id=(type==52?msg.sender_id:msg.int_data);Mojo.ajax('/battle/preview',{opponent_id:opponent_id,},function(result){if(result.errorCode==0){(new Mojo.com.BattlePreviewDialog(result.data,{title:Mojo.utils.locale('force','revenge result preview'),opponent_id:opponent_id,opponent_name:msg.str_data,message_id:self._options.message_id,forceProfile:self._options.getController(),type:'fight',isForceEnemy:true,from:'force'})).open();}else if(result.errorCode==10003){(new Mojo.com.SpDialog(result.data,{title:Mojo.utils.locale('common','no enough stamina'),message:result.errorMsg,forceProfile:self._options.getController(),isForceEnemy:true,})).open();}else if(result.errorCode==30007){(new Mojo.com.AvoidWarDialog({message:Mojo.utils.locale('common','avoid_war_content',{avoid_war_time:Mojo.utils.formatTime(result.data)}),avoid_war_time:result.data,callback:function(){self._options.callback();},})).open();}else if(result.errorCode==160003){var dlg=new Mojo.com.CommonDialog(undefined,{title:Mojo.utils.locale('common','capacify_lack'),content:$('<div class="paragraph"></div>').html(Mojo.utils.locale('common','capacify_lack_tip')),leftBtnText:Mojo.utils.locale('common','go_intensify'),leftBtnClick:function(){Mojo.app.redirect('/intensify');},rightBtnText:Mojo.utils.locale('common','go_sale'),rightBtnClick:function(){Mojo.app.redirect('/entity',{selected:3});},close:function(){Mojo.app.redirect('/home');}});dlg.open();}else{(new Mojo.com.TipsDialog({title:Mojo.utils.locale('common','tips'),message:result.errorMsg,})).open();}},function(){},{showWait:true});break;case 101:case 203:Mojo.app.redirect('/relation',{index:2,refresh:1});break;case 102:case 103:msg.status=2;self._hasHandledThisMsg(msgcom);new Mojo.com.CrazyForceWar({inBattle:false,action:'capture',targetForceId:msg.int_data,parent:self,backBtnClick:function(){Mojo.app.redirect('/relation');},});break;case 104:var res=undefined;if(self.reserved==true){res=1;}
Mojo.ajax('/force/messageHandler',{id:msg.id,handle:1,reserved:res,},function(result){var tit=undefined;var dlgmsg=undefined;var lBtnTxt=undefined;var lBtnClkFun=undefined;if(result.errorCode==0){Mojo.page.Force.getController().getPlayerProfile().messageRemindCount.task+=1;Mojo.page.Force.getController().sync();msg.status=1;tit=Mojo.utils.locale('force','submission_succ');Mojo.page.Force.getController().syncForce();if(self.reserved==true){if(result.data!=undefined&&result.data.forceName!=undefined&&result.data.forceName2!=undefined)
dlgmsg='<div class="paragraph">'+Mojo.utils.locale('force','force_become_slave_seize_lose',{name:result.data.forceName,name2:result.data.forceName2})+'</div>';self.reserved=undefined;}else{if(result.data!=undefined&&result.data.forceName!=undefined)
dlgmsg='<div class="paragraph">'+Mojo.utils.locale('force','force_become_slave',{name:result.data.forceName})+'</div>';}}else{if(result.data!=undefined&&result.data.title!=undefined){tit=result.data.title;}else{tit=Mojo.utils.locale('force','can_not_submission');}
dlgmsg='<div class="paragraph">'+result.errorMsg+'</div>';switch(result.errorCode){case 194002:case 194004:lBtnTxt=Mojo.utils.locale('force','relationship');lBtnClkFun=function(){msg.status=3;Mojo.app.redirect('/relation');};break;case 194005:lBtnTxt=Mojo.utils.locale('force','forcewar_defense');lBtnClkFun=function(){msg.status=0;Mojo.app.redirect('/force',{index:2,refresh:1,selected:1});};break;case 194010:tit=Mojo.utils.locale('force','is_submission');lBtnTxt=Mojo.utils.locale('force','ok_submission');lBtnClkFun=function(that){msg.status=1;self.reserved=true;that.close();self._msgHandle1(msg,msgcom);};break;case 130010:dlgmsg='<div class="tip">'+result.errorMsg+'</div>';}}
var dlg=new Mojo.com.CommonDialog(undefined,{title:tit,content:dlgmsg,leftBtnText:lBtnTxt,leftBtnClick:function(that){lBtnClkFun(that);self._hasHandledThisMsg(msgcom);},rightBtnText:Mojo.utils.locale('common','close'),rightBtnClick:function(that){that.close();self._hasHandledThisMsg(msgcom);},}).open();});break;case 114:Mojo.ajax('/force/messageHandler',{id:msg.id,handle:1,},function(result){var tit=undefined;var dlgmsg=undefined;var lBtnTxt=undefined;var lBtnClkFun=undefined;if(result.errorCode==0){msg.status=1;tit=Mojo.utils.locale('force','resign');Mojo.page.Force.getController().syncForce();if(result.data!=undefined&&result.data.forceName!=undefined)
dlgmsg=Mojo.utils.locale('force','pass_resign_apply',{name:result.data.forceName});}else{if(result.data!=undefined&&result.data.title!=undefined){tit=result.data.title;}else if(result.errorCode==3){tit=Mojo.utils.locale('force','appellate_resign_apply');}else{tit=Mojo.utils.locale('force','not_resign_apply');}
dlgmsg=result.errorMsg;}
self._hasHandledThisMsg(msgcom);var dlg=new Mojo.com.CommonDialog(undefined,{title:tit,content:$('<div class="paragraph"></div>').html(dlgmsg),leftBtnText:lBtnTxt,leftBtnClick:function(that){lBtnClkFun(that);self._hasHandledThisMsg(msgcom);},rightBtnText:Mojo.utils.locale('common','close'),rightBtnClick:function(that){that.close();self._hasHandledThisMsg(msgcom);},}).open();});break;case 109:case 110:case 111:case 113:case 115:case 116:case 200:case 201:case 202:case 300:case 302:case 303:case 314:case 316:case 321:case 322:case 327:case 328:case 382:case 393:Mojo.app.redirect('/force',{index:2,refresh:1});break;case 107:case 108:case 129:case 134:case 210:case 211:case 212:case 301:case 307:case 309:case 310:case 326:case 331:case 332:case 414:case 415:msg.status=1;self._hasHandledThisMsg(msgcom);Mojo.app.redirect('/force',{index:2,refresh:1,selected:1});break;case 105:case 112:case 150:case 217:case 220:case 221:case 222:case 223:case 224:case 225:case 311:case 312:case 334:case 384:case 418:case 430:case 601:case 602:Mojo.app.redirect('/relation');break;case 124:case 125:case 136:Mojo.app.redirect('/relation',{index:17,target_force_id:msg.int_data});break;case 127:case 130:case 140:case 141:Mojo.ajax('/force/messageHandler',{id:msg.id,handle:1,},function(result){var tit=undefined;var dlgmsg=undefined;var lBtnTxt=undefined;var lBtnClkFun=undefined;if(result.errorCode==0){msg.status=1;switch(result.data.type){case 129:case 134:tit=Mojo.utils.locale('force','ally_succ');lBtnTxt=Mojo.utils.locale('force','forcewar_defense');lBtnClkFun=function(){Mojo.app.redirect('/force',{index:2,refresh:1,selected:1});};break;case 133:tit=Mojo.utils.locale('force','ally');break;}
dlgmsg=result.data.desc;}else{if(result.data!=undefined&&result.data.title!=undefined){tit=result.data.title;}else{tit=Mojo.utils.locale('force','can_not_ally');}
dlgmsg=result.errorMsg;}
var dlg=new Mojo.com.CommonDialog(undefined,{title:tit,content:$('<div class="paragraph"></div>').html(dlgmsg),leftBtnText:lBtnTxt,leftBtnClick:function(){lBtnClkFun();},rightBtnText:Mojo.utils.locale('common','close'),rightBtnClick:function(that){that.close();},}).open();self._hasHandledThisMsg(msgcom);});break;case 81:Mojo.app.redirect('/force',{index:1,selected:1});break;case 82:Mojo.app.redirect('/force',{index:3});break;case 336:case 380:Mojo.ajax('/force/messageHandler',{id:msg.id,handle:1,},function(result){var tit=undefined;var dlgmsg=undefined;var lBtnTxt=undefined;var lBtnClkFun=undefined;msg.status=1;self._hasHandledThisMsg(msgcom);if(result.errorCode==0){tit=Mojo.utils.locale('force','uniterebel');if(result.data!=undefined&&result.data.forceName!=undefined)
dlgmsg=Mojo.utils.locale('force','responsedandsummon',{name:result.data.forceName});lBtnTxt=Mojo.utils.locale('force','summon');lBtnClkFun=function(that){that.close();new Mojo.com.ForceNoticeDialog({},{title:tit,maxlength:100,okBtnText:Mojo.utils.locale('force','summon'),hintText:Mojo.utils.locale('force','input_message_call_toge'),okBtnClick:function(that){that.close();Mojo.ajax("/force/sendWarToMember",{content:that.getContent(),type:'reuniterebel',},function(response){Mojo.app.toast.show(Mojo.utils.locale('common','suggestion_has_send'));});}}).open();};}else{if(result.data!=undefined&&result.data.title!=undefined){tit=result.data.title;}else{tit=Mojo.utils.locale('force','can_not_boycott');}
dlgmsg=result.errorMsg;}
var dlg=new Mojo.com.CommonDialog(undefined,{title:tit,content:$('<div class="paragraph"></div>').html(dlgmsg),leftBtnText:lBtnTxt,leftBtnClick:function(that){lBtnClkFun(that);},rightBtnText:Mojo.utils.locale('common','close'),rightBtnClick:function(that){that.close();},}).open();});break;}},_msgHandle2:function(msg,msgcom){var self=this;var type=parseInt(msg.type);switch(type){case 0:Mojo.ajax('/force/messageHandler',{id:msg.id,handle:2,},function(result){msg.status=2;self._hasHandledThisMsg(msgcom);if(result.errorCode==0){}else{Mojo.app.toast.show(result.errorMsg);}});break;case 13:var forceMember=new Mojo.com.ForceEnemyMember({title:Mojo.utils.locale('force','enemy_figthters',{'__default__':''}),getController:function(){return self._options.getController();},forceMemberListOptions:{loadFunc:function(l,s,p,that){Mojo.ajax("/force/enemyFighters",{ids:msg.str_data},function(response){if(response&&response.errorCode===0){that.appendData(response.data.list);if(response.data!=undefined&&response.data.list.length==that._options.pageSize){that._more.show();}else{that._more.hide();}
that.resize();}else{(new Mojo.com.TipsDialog({title:Mojo.utils.locale('common','tips'),message:response.errorMsg,})).open();forceMember.close();}},function(){});}},backCallback:function(){forceMember.close();},forceMemberElementOptions:{showAttack:true,showDefence:"?",showOffer:false,showLogin:false,showLevel:false,showHr:true,goBtnClass:['go-button','go-attack-btn'],goSpecialClass:'',subClass:'',goBtnText:Mojo.utils.locale('force','revenge'),clickFunc:function(forceMemberElement){Mojo.ajax('/battle/preview',{opponent_id:forceMemberElement._data.id,},function(result){forceMember.close();if(result.errorCode==0){(new Mojo.com.BattlePreviewDialog(result.data,{title:Mojo.utils.locale('force','revenge result preview'),opponent_id:forceMemberElement._data.id,opponent_name:forceMemberElement._data.name,message_id:self._options.message_id,forceProfile:self._options.getController(),type:'fight',isForceEnemy:true,from:'force'})).open();}else if(result.errorCode==10003){(new Mojo.com.SpDialog(result.data,{title:Mojo.utils.locale('common','no enough stamina'),message:result.errorMsg,forceProfile:self._options.getController(),isForceEnemy:true,})).open();}else if(result.errorCode==30007){(new Mojo.com.AvoidWarDialog({message:Mojo.utils.locale('common','avoid_war_content',{avoid_war_time:Mojo.utils.formatTime(result.data)}),avoid_war_time:result.data,callback:function(){self._options.callback();},})).open();}else if(result.errorCode==160003){var dlg=new Mojo.com.CommonDialog(undefined,{title:Mojo.utils.locale('common','capacify_lack'),content:$('<div class="paragraph"></div>').html(Mojo.utils.locale('common','capacify_lack_tip')),leftBtnText:Mojo.utils.locale('common','go_intensify'),leftBtnClick:function(){Mojo.app.redirect('/intensify');},rightBtnText:Mojo.utils.locale('common','go_sale'),rightBtnClick:function(){Mojo.app.redirect('/entity',{selected:3});},close:function(){Mojo.app.redirect('/home');}});dlg.open();}else{(new Mojo.com.TipsDialog({title:Mojo.utils.locale('common','tips'),message:result.errorMsg,})).open();}},function(){},{showWait:true});}}});forceMember.open();break;case 52:Mojo.app.redirect('/force',{index:2,refresh:1,target_force_id:msg.int_data});break;case 102:case 103:msg.status=2;self._hasHandledThisMsg(msgcom);new Mojo.com.CrazyForceWar({inBattle:false,action:'usurp',targetForceId:msg.int_data,parent:self,backBtnClick:function(){Mojo.app.redirect('/relation');},});break;case 114:Mojo.ajax('/force/messageHandler',{id:msg.id,handle:2,},function(result){var tit=undefined;var dlgmsg=undefined;var lBtnTxt=undefined;var lBtnClkFun=undefined;if(result.errorCode==0){tit=Mojo.utils.locale('force','resign');if(result.data!=undefined&&result.data.forceName!=undefined)
dlgmsg=Mojo.utils.locale('force','deny_resign_apply',{name:result.data.forceName});}else{if(result.data!=undefined&&result.data.title!=undefined){tit=result.data.title;}else if(result.errorCode==3){tit=Mojo.utils.locale('force','appellate_resign_apply');}else{tit=Mojo.utils.locale('force','not_resign_apply');}
dlgmsg=result.errorMsg;}
self._hasHandledThisMsg(msgcom);var dlg=new Mojo.com.CommonDialog(undefined,{title:tit,content:$('<div class="paragraph"></div>').html(dlgmsg),leftBtnText:lBtnTxt,leftBtnClick:function(that){lBtnClkFun(that);self._hasHandledThisMsg(msgcom);},rightBtnText:Mojo.utils.locale('common','close'),rightBtnClick:function(that){that.close();self._hasHandledThisMsg(msgcom);},}).open();});break;case 104:case 336:case 380:var tit=undefined;var dlgmsg=undefined;var lBtnTxt=undefined;var lBtnClkFun=undefined;Mojo.ajax('/force/messageHandler',{id:msg.id,handle:2,},function(result){msg.status=2;if(result.errorCode==0){switch(type){case 104:tit=Mojo.utils.locale('force','capture');if(result.data!=undefined&&result.data.forceName!=undefined)
dlgmsg='<div class="paragraph">'+Mojo.utils.locale('force','deny_capture',{name:result.data.forceName})+'</div>';break;case 380:tit=Mojo.utils.locale('force','uniterebel');if(result.data!=undefined&&result.data.forceName!=undefined)
dlgmsg='<div class="paragraph">'+Mojo.utils.locale('force','deny_boycott',{name:result.data.forceName})+'</div>';break;}}else{if(result.data!=undefined&&result.data.title!=undefined){tit=result.data.title;}else{tit=Mojo.utils.locale('common','tips');}
dlgmsg='<div class="paragraph">'+result.errorMsg+'</div>';if(type==104&&result.errorCode==130010){tit=Mojo.utils.locale('force','can_not_submission');dlgmsg='<div class="tip">'+result.errorMsg+'</div>';}}
var dlg=new Mojo.com.CommonDialog(undefined,{title:tit,content:dlgmsg,leftBtnText:lBtnTxt,leftBtnClick:function(that){lBtnClkFun(that);self._hasHandledThisMsg(msgcom);},rightBtnText:Mojo.utils.locale('common','close'),rightBtnClick:function(that){that.close();self._hasHandledThisMsg(msgcom);},}).open();});break;case 127:case 130:case 140:case 141:Mojo.ajax('/force/messageHandler',{id:msg.id,handle:2,},function(result){var tit=undefined;var dlgmsg=undefined;var lBtnTxt=undefined;var lBtnClkFun=undefined;msg.status=2;self._hasHandledThisMsg(msgcom);if(result.errorCode==0){tit=Mojo.utils.locale('force','alliance');dlgmsg=result.data.desc;}else{if(result.data!=undefined&&result.data.title!=undefined){tit=result.data.title;}else{tit=Mojo.utils.locale('common','tips');}
dlgmsg=result.data.desc;}
var dlg=new Mojo.com.CommonDialog(undefined,{title:tit,content:$('<div class="paragraph"></div>').html(dlgmsg),leftBtnText:lBtnTxt,leftBtnClick:function(that){lBtnClkFun(that);self._hasHandledThisMsg(msgcom);},rightBtnText:Mojo.utils.locale('common','close'),rightBtnClick:function(that){that.close();self._hasHandledThisMsg(msgcom);},}).open();});break;case 134:Mojo.app.redirect('/relation');break;}},_hasHandledThisMsg:function(msgcom){if(msgcom.hasHandledShadow()==true){return;}
msgcom.element().addClass('msg-overlay');},});})(window,jQuery);;(function(w,$,undefined){w.Mojo=w.Mojo||{};w.Mojo.com=w.Mojo.com||{};w.Mojo.com.ForceEventElement=w.Mojo.Object.extend({clsname:function(){return"com.ForceEventElement";},init:function(data,options){this.data=data;this._hasHandledShadow=false;this._super(undefined,options);var self=this;this.element().addClass('mojo-com-message');if(this.data.status==0){this.element().addClass('mojo-com-message-unread');}
this.element().append('<div class="left"><div class="content"></div><div class="time"></div></div>');this.element().find('.left > .content').append(this.data.content);this.element().find('.left > .time').append(this._getMsgTime());this._btnGo=new Mojo.ui.Button(undefined,{text:Mojo.utils.locale('message','Handle'),click:function(){var dlg=new Mojo.com.ForceEventDialog(data,{positionId:self._options.positionId,handle:function(handle){self._onHandleMessage(handle);},});if(data.type==104||data.type==100){dlg.element().addClass('special-event-letter');var dlgScroll=new Mojo.ui.Scroll(undefined,dlg._content,{direction:2,});dlg.element().append(dlgScroll.element());dlg.open();dlgScroll.refresh();}else{dlg.open();}},classes:['go-button'],special:'go-message-btn',});this.element().append(this._btnGo.element());},_onHandleMessage:function(handle){this._options.handle(this.data,handle,this);this.element().removeClass('mojo-com-message-unread');},_getMsgTime:function(){var date=new Date();var now=date.getTime()/1000;var send=parseInt(this.data.create_time);var t=parseInt(now-send);if(t<1){t=1;}
var day=parseInt(t/(3600*24));var hour=parseInt((t%(3600*24))/3600);var minute=parseInt((t%3600)/60);var second=t%60;return(((day>0?day+Mojo.utils.locale('ui','days'):"")||(hour>0?hour+Mojo.utils.locale('ui','hours'):"")||(minute>0?minute+Mojo.utils.locale('ui','minutes'):"")||(second>0?second+Mojo.utils.locale('ui','seconds'):""))+
Mojo.utils.locale('ui','ago'));},_getDefaultOptions:function(){return{handle:$.noop,data:{id:'',sender_id:'',receiver_id:'',type:0,content:'',status:0,intData:0,strData:'',create_time:0,positionId:null,}};},hasHandledShadow:function(value){if(value===true||value===false){this._hasHandledShadow=value;}
return this._hasHandledShadow;}});})(window,jQuery);;(function(w,$,undefined){w.Mojo=w.Mojo||{};w.Mojo.com=w.Mojo.com||{};w.Mojo.com.ForceEventDialog=w.Mojo.ui.Dialog.extend({clsname:function(){return"com.ForceEventDialog";},init:function(data,options){this.data=data;this.data.type=parseInt(this.data.type);this._super('event_message',options);this.element().addClass('mojo-com-msgdlg');var self=this;this._addContent();this._addHandleButtons();window.evtDialog=this;},_getTitle:function(){var t='force_message';switch(this.data.type){case 0:t='force_apply';break;case 9:t='refresh_internal_mission';break;case 10:t='force_war';break;case 100:case 102:case 103:t='capitulate';break;case 101:t='capitulate_succ';break;case 104:t='be_capitulate';break;case 105:t='submission_succ';break;case 106:t='deny_capitulate';break;case 107:case 108:case 109:case 110:t='help_defense_member_change';break;case 111:case 114:t='defense_resign';break;case 112:case 113:case 115:case 116:t='resign';break;case 119:case 132:case 150:case 151:t='ally_apply_expire';break;case 120:case 126:case 129:case 134:case 135:t='ally_succ';break;case 118:case 121:case 122:case 123:case 124:case 125:case 127:case 128:case 130:case 131:case 133:case 136:case 138:case 139:case 140:case 141:t='ally';break;case 144:case 601:case 602:t='relation_disband';break;case 200:case 201:case 202:t='seize';break;case 203:t='seize_succ';break;case 204:case 205:case 206:case 207:case 208:case 218:t='seize_lose';break;case 210:case 211:case 212:case 220:case 222:t='be_seized';break;case 209:case 213:case 214:case 215:case 216:case 219:case 312:case 313:case 334:case 360:case 385:t='defence_succ';break;case 217:case 311:case 333:case 393:t='defence_lose';break;case 221:t='ally_cancel';break;case 224:case 225:t='prefect_message';break;case 223:t='prince_message';break;case 300:case 302:case 303:case 304:t='revolt';break;case 301:t='prefect_revolt';break;case 384:t='revolt_succ';break;case 305:case 306:case 361:t='revolt_lose';break;case 307:case 308:case 309:case 310:t='be_revolted';break;case 314:case 315:case 316:case 317:case 318:case 319:case 320:case 321:case 322:case 326:case 327:case 328:case 329:case 330:case 331:case 332:case 336:case 355:case 380:case 382:case 383:case 605:case 606:t='boycott';break;case 335:t='force_disband';break;case 323:t='boycott_succ';break;case 324:case 325:case 381:t='boycott_lose';break;case 386:t='title';break;case 400:case 402:t='grain_contribute';break;case 401:case 403:t='grain_donate';break;case 404:case 405:t='tax_rate_adjust';break;case 406:case 408:case 410:case 27:t='assign_title';break;case 407:case 409:case 411:case 26:t='get_title';break;case 412:case 413:t='depose';break;case 414:case 415:t='cancel_ally';break;case 416:case 417:case 422:case 426:t='electioneer_officer';break;case 418:t='electioneer_officer_succ';break;case 419:t='electioneer_officer_lose';break;case 420:case 421:t='lose_officer';break;case 423:case 424:case 425:case 427:case 428:case 429:t='lose_title';break;case 430:t='get_officer';break;case 440:t='collect_tax';break;case 441:t='sum_tax';break;case 603:case 604:t='rebel_over';break;case 81:t='force_boss_challenge_start';break;case 82:t='force_boss_challenge_final_win2';break;case 83:t='force_boss_challenge_final_lose';break;}
return Mojo.utils.locale('force',t);},_addContent:function(){var self=this;this._paragraph=$('<div class="paragraph"></div>').html(this.data.content);this.element().children('.content').append(this._paragraph);if(Mojo.utils.isNone(self.data.forces)){return;}
switch(this.data.type){case 127:case 130:case 336:case 138:case 139:case 140:case 141:this._list=new Mojo.com.ForceList("force-list",{type:'forceinfo',showBtn:false,refreshable:true,pageSize:2,scrollable:true,ids:this.data.str_data,onLoaded:function(){if(self._options.open){self.open();}},loadFunc:function(start,count,orderParams){if(Mojo.utils.isNone(self.data.forces)==false){setTimeout(function(){self._list.appendData(self.data.forces);},0);}else{self._list.appendData(null);}},});this._paragraph.append($('<hr>'));this._paragraph.prependTo(this._list._list);this.element().addClass('special-event-list');this._list.element().appendTo(this._content);break;}},_addHandleButtons:function(){var self=this;var l1=this._getBtn1Label();var l2=this._getBtn2Label();if(this.data.type!=200&&this.data.type!=201&&this.data.type!=202&&this.data.type!=210&&this.data.type!=211&&this.data.type!=212&&this.data.type!=220&&this.data.type!=222&&this.data.type!=217&&this.data.type!=223&&this.data.type!=224&&this.data.type!=225&&this.data.type!=300&&this.data.type!=301&&this.data.type!=302&&this.data.type!=303&&this.data.type!=304&&this.data.type!=307&&this.data.type!=308&&this.data.type!=309&&this.data.type!=310&&this.data.type!=311&&this.data.type!=312&&this.data.type!=384&&this.data.type!=314&&this.data.type!=316&&this.data.type!=319&&this.data.type!=320&&this.data.type!=321&&this.data.type!=326&&this.data.type!=327&&this.data.type!=328&&this.data.type!=330&&this.data.type!=331&&this.data.type!=332&&this.data.type!=336&&this.data.type!=382&&this.data.type!=334&&this.data.type!=393&&this.data.type!=51&&this.data.type!=52&&this.data.type!=13&&this.data.type!=10&&this.data.type!=81&&this.data.type!=82&&this._options.positionId!=null&&parseInt(this._options.positionId)>5||this.data.status==3){l1=null;l2=null;if(this.data.type==0){Mojo.app.toast.show(self.getL('force','join_event_privilege'));}}else if(52==this.data.type&&this._options.positionId!=null&&parseInt(this._options.positionId)>2){l2=null;}else if(51==this.data.type&&Mojo.cache.get('userId')==this.data.sender_id){l1=null;}else if(103==this.data.type&&this._options.positionId!=null&&parseInt(this._options.positionId)>2){l1=null;l2=null;}
switch(this.data.type){case 101:case 102:case 203:case 104:case 107:case 108:case 109:case 110:case 114:case 124:case 125:case 127:case 130:case 140:case 141:case 336:case 380:if(this._options.positionId!=null&&parseInt(this._options.positionId)>1){l1=null;l2=null;}
break;}
if(l1!=null){this._btn1=new Mojo.ui.Button(undefined,{text:l1,classes:['btn-handle-1'],click:function(){self.close();self._options.handle(1);},disableClick:function(){if(self.data!=undefined&&(self.data.type==13||self.data.type==14)&&parseInt(self._options.positionId)>2){Mojo.app.toast.show(Mojo.utils.locale('force','forcewar_only_owner_fanji',{'__default__':'~'}));}else if(self.data.type==14&&parseInt(self._options.positionId)>2){Mojo.app.toast.show(Mojo.utils.locale('force','forcewar_only_owner_start'));}},special:'button-big-red',});this.element().children('.footer').append(this._btn1.element());if((this.data.type==13||this.data.type==14)&&parseInt(this._options.positionId)>2){this._btn1.disable(true);}}
if(l2!=null){this._btn2=new Mojo.ui.Button(undefined,{text:l2,classes:['btn-handle-2'],click:function(){self.close();self._options.handle(2);},disableClick:function(){if(self.data.type==52&&parseInt(self._options.positionId)>2){Mojo.app.toast.show(Mojo.utils.locale('force','forcewar_only_owner_qiangliang',{'__default__':'~'}));}}});this.element().children('.footer').append(this._btn2.element());if(52==this.data.type&&parseInt(this._options.positionId)>2){this._btn2.disable(true);}}
if(l1==null||l2==null){this._closeBtn=new Mojo.ui.Button(undefined,{text:Mojo.utils.locale('ui','Close'),classes:['btn-close'],click:function(){self.close();},});this.element().children('.footer').append(this._closeBtn.element());}
if(this.data.type==0){if(this.data.status==1){this._btn1.disable(true);this._btn2.hide();}else if(this.data.status==2){this._btn2.disable(true);this._btn1.hide();}}
if(this.data.status==1){this._btn1.disable(true);this._btn2.hide();}else if(this.data.status==2){this._btn2.disable(true);this._btn1.hide();}},_getBtn1Label:function(){switch(this.data.type){case 0:case 114:return Mojo.utils.locale('ui','Agree');case 9:return Mojo.utils.locale('force','go');case 10:return Mojo.utils.locale('force','in_war');case 13:case 14:return Mojo.utils.locale('ui','Retaliate');case 51:return Mojo.utils.locale('force','help_attack',{'__default__':''});case 52:return Mojo.utils.locale('force','to_attack',{'__default__':''});case 101:case 203:return Mojo.utils.locale('force','adjust_tax_rate');case 102:case 103:if(this.data.status==1)return Mojo.utils.locale('force','capitulate');return Mojo.utils.locale('force','con_capitulate');case 104:return Mojo.utils.locale('force','submission');case 109:case 110:case 316:case 327:case 328:case 393:return Mojo.utils.locale('force','foreign');case 124:case 125:case 127:case 130:case 140:case 141:return Mojo.utils.locale('force','ally');case 200:case 201:case 202:case 300:case 302:case 303:case 314:case 321:case 322:return Mojo.utils.locale('force','fight');case 107:case 108:case 129:case 134:case 210:case 211:case 212:case 301:case 307:case 309:case 310:case 326:case 331:case 332:case 414:case 415:return Mojo.utils.locale('force','forcewar_defense');case 105:case 112:case 150:case 217:case 220:case 221:case 222:case 223:case 224:case 225:case 311:case 312:case 334:case 384:case 418:case 430:case 601:case 602:return Mojo.utils.locale('force','relationship');case 336:case 380:return Mojo.utils.locale('force','response');case 382:return Mojo.utils.locale('force','in_war');case 81:return Mojo.utils.locale('ui','In War2');case 82:return Mojo.utils.locale('force','force_boss_challenge_final_goexchange2');}
return null;},_getBtn2Label:function(){switch(this.data.type){case 0:case 104:case 114:case 127:case 130:case 140:case 141:case 336:case 380:return Mojo.utils.locale('ui','Deny');case 134:return Mojo.utils.locale('force','relationship');case 102:case 103:return Mojo.utils.locale('force','seize');case 13:return Mojo.utils.locale('ui','revenge',{'__default__':''});case 52:return Mojo.utils.locale('force','start_grain_war',{'__default__':''});}
return null;},_getDefaultOptions:function(){return $.extend(true,this._super(),{title:this._getTitle(),handle:$.noop,positionId:null,deviceaware:true});},});})(window,jQuery);;(function(w,$,undefined){w.Mojo=w.Mojo||{};w.Mojo.com=w.Mojo.com||{};w.Mojo.com.ForceRanking=w.Mojo.Object.extend({clsname:function(){return"com.ForceRanking";},init:function(options){this._super('com-force-ranking',options);this.element().addClass('mojo-com-forceranking');this._addTabs();this._addButton();},_addTabs:function(){var self=this;this._panels=[{type:'ranking',label:'ranking'},];this._tabs=new Mojo.ui.Tabs('tabs-ranking',{selectionChange:function(i){self._createList(i);},selected:0});$.each(this._panels,function(i,p){self._tabs.addTab(self.locale(p.label));});this.element().append(this._tabs.element());this._tabs.element().find('.panel').addClass('box-outter');self._createList();},_createList:function(){var self=this;var p=this._panels[0];if(p.list==undefined||p.list==null){p.list=new Mojo.com.ForceList(undefined,{type:'rank',showBtn:true,btnText:Mojo.utils.locale('common','view'),specialClass:'go-view-btn',onBtnClick:self._viewBtnClick,showMore:true,moreLabel:Mojo.utils.locale('force','more'),refreshable:false});this._tabs.setPanel(0,p.list);}
this._addSearch();},_addSearch:function(){var self=this;var p=self._panels[0];var search=new Mojo.com.ForceFind(undefined,{onSearch:function(data){self._refreshList(data);},noinput:function(){self._panels[0].list.element().remove();self._panels[0].list=undefined;self._createList();return false;}}).element().appendTo(p.list._header);},_refreshList:function(response){this._panels[0].list._scroll.scrollTo(0,0);this._panels[0].list._list.empty();this._panels[0].list._options.type='search';this._panels[0].list._options.showMore=false;this._panels[0].list._children=[];this._panels[0].list._options.emptyLabel=Mojo.utils.locale('force','force_search_noresult');this._panels[0].list.appendData(response.data.list,false);},_viewBtnClick:function(data){new Mojo.com.ForceInfoDialog(data,{},{showApplyBtn:false}).open();},_addButton:function(){var self=this;this._backBtn=new Mojo.ui.Button(undefined,{text:Mojo.utils.locale('common','back'),click:function(){self.element().hide();self._options.getController().switchToHome();},classes:['force-back-btn'],});this._backBtn.element().appendTo(this.element());},_getDefaultOptions:function(){return{backCallback:$.noop,};},localeCat:function(){return'force';},});})(window,jQuery);;(function(w,$,undefined){w.Mojo=w.Mojo||{};w.Mojo.com=w.Mojo.com||{};w.Mojo.com.ForceWar=w.Mojo.Object.extend({clsname:function(){return"com.ForceWar";},init:function(options){this._super(undefined,options);this.element().addClass("mojo-com-forcewar");var self=this;this._tabs=undefined;this._selected=undefined;this._forceDefenseListPanel=undefined;this._forceBattlePanel=undefined;this._forceBattleStatus=undefined;this._forceBattleTime=undefined;this._forceBattleHandle=undefined;this._forceLodgmentsCount=undefined;this._forceCapturedCount=undefined;this._forceOpponentForceName=undefined;this._helping=undefined;this._crazyForceWar=undefined;this._hasCaptureLodgment=undefined;this._canAttack=undefined;this._forceWarNoticeDiv=undefined;this._hasInit=false;this._forceProfile=Mojo.page.Force.getController().getForceProfile();this._playerProfile=Mojo.page.Force.getController().getPlayerProfile();Mojo.page.Force.getController().getProfile().addSyncHandle(function(data){self._updateChallange(self,data);});if((this._selected=this._getUrlParam("selected"))==null)
this._selected=0;if(options.selected)this._selected=options.selected;this.actionType=Mojo.utils.getSomething("type",true);if(this.actionType=='assistSlave'||this.actionType=='assistAlliance'){this._isAssist=true;}
this.targetForceId=Mojo.utils.getSomething("target_force_id",true);if(this.actionType=='capture'||this.actionType=='usurp'){(new Mojo.com.CrazyForceWar({inBattle:false,action:this.actionType,targetForceId:this.targetForceId,parent:this,backBtnClick:function(){Mojo.app.redirect('/relation');},}));}else{this.refresh();}},_updateChallange:function(that,data){if(that._forceWarNoticeDiv!=undefined){var force=data.force_info;that._forceWarNoticeDiv.html(Mojo.utils.locale('force','forcewar_no_battle',{challenge:force.challenge,challenge_limit:force.challenge_limit}));}},refresh:function(){this._createTabs();this._createBackButton();},_getDefaultOptions:function(){return{backCallback:$.noop,interval:10};},pause:function(){var self=this;clearTimeout(self._forceBattleHandle);if(self._crazyForceWar){self._crazyForceWar.pause();}
if(self._crazyForceDefWar){self._crazyForceDefWar.pause();}},_createTabs:function(){var self=this;if(Mojo.utils.isNone(this._tabs)==false){return;}
this._tabs=new Mojo.ui.Tabs("forcewar-tabs",{selectionChange:function(index){self._forceBattleTime=undefined;self.pause();if(index==0){self._createForceBattle(index);}else if(index==1){var partnerIds=Mojo.utils.getSomething("partnerId",false);Mojo.ajax('/force/battleDefence',{},function(response){if(response.errorCode==198708||Mojo.utils.isNone(partnerIds)==false){if(self.actionType==undefined)self.actionType='usurp';if(self._crazyForceDefWar){self._crazyForceDefWar._refreshForceBattleStatus();}else{self._tabs.element().find('ul > li').eq(1).append($("<div class='battleStatus'></div>"));self._crazyForceDefWar=new Mojo.com.CrazyForceWar({inBattle:true,battleType:'defence',parent:self,partnerIds:partnerIds,action:self.actionType,});}}else{self._createForceDefense(index,response.data);}});}else if(index==2){self._createEnemy(index);}
self._tabs.element().find(".panel").addClass("box-outter");}});this._tabs.addTab(Mojo.utils.locale("force","forcewar_battle"));this._tabs.addTab(Mojo.utils.locale("force","forcewar_defense"));this._tabs.addTab(Mojo.utils.locale("force","forcewar_enemy"));this.element().append(this._tabs.element());this._tabs._select(this._selected);},_isForceOwner:function(isViceOwner,callback){var isOwner=false;var player=Mojo.page.Force.getController().getPlayerProfile();if(Mojo.utils.isNone(player)){var self=this;this._options.getController().sync(function(){player=self._options.getController().getPlayerProfile();if(player&&player.position_id==1){isOwner=true;}else if(isViceOwner==true&&player&&player.position_id==2){isOwner=true;}
if(callback instanceof Function){callback(isOwner);}});}else{if(player.position_id==1){isOwner=true;}
if(isViceOwner==true&&player.position_id==2){isOwner=true;}
if(callback instanceof Function){callback(isOwner);}}
return isOwner;},_forceWarAjax:function(url,params,success,fail){var self=this;Mojo.ajax(url,params,function(response){if(response&&response.errorCode===0){if(response.data.last_battle!=undefined){clearTimeout(self._forceBattleHandle);self._showForceWarResultDialog(response.data.last_battle,function(){Mojo.app.redirect('/force',{index:2});});}else if(response.data.result!=undefined){clearTimeout(self._forceBattleHandle);self._showForceWarResultDialog(response.data.result,function(){Mojo.app.redirect('/force',{index:2});});}else if(response.data!=undefined&&success instanceof Function){success(response);}}else{if(success instanceof Function){success(response);}}},function(){if(fail instanceof Function){fail();}});},_showForceWarResultDialog:function(result,callback){var title=undefined;var content=undefined;if(result.status==1||result.status==4){title=Mojo.utils.locale('force','forcewar_win');content=$('<div class="tip"></div>');if(result.status==1){$('<div></div>').html(Mojo.utils.locale('force','forcewar_win_content',{'forcename':result.defender})).appendTo(content);(new Mojo.ui.Label(undefined,{text:'+'+result.att_grain})).element().addClass("fgrain").appendTo(content);$('<div></div>').html(Mojo.utils.locale('force','forcewar_win_commend')).appendTo(content);var commend="";var icount=1;for(var index in result.contribute){var commendplayer=result.contribute[index];if(icount==result.contribute.length){commend+=Mojo.utils.formatPlayerName(commendplayer);}else if(icount%2==0){commend+=Mojo.utils.formatPlayerName(commendplayer)+",<br/>";}else{commend+=Mojo.utils.formatPlayerName(commendplayer)+", ";}
icount+=1;}
$('<div></div>').html(commend).appendTo(content);}else if(result.status==4){$('<div></div>').html(Mojo.utils.locale('force','forcewar_disband_content')).appendTo(content);(new Mojo.ui.Label(undefined,{text:'+'+result.att_grain})).element().addClass("fgrain").appendTo(content);}}else if(result.status==2){title=Mojo.utils.locale('force','forcewar_lose');content=$('<div class="tip"></div>').html(Mojo.utils.locale('force','forcewar_lose_content',{'forcename':result.defender}));}else if(result.status==3){title=Mojo.utils.locale('force','forcewar_retreat');content=$('<div class="tip"></div>').html(Mojo.utils.locale('force','forcewar_retreat_content',{'forcename':result.defender}));}
(new Mojo.com.CommonDialog(undefined,{title:title,content:content,leftBtnText:Mojo.utils.locale('common','ok'),leftBtnClick:function(that){that.close();},close:function(){if(callback instanceof Function){callback();}}})).open();this._options.getController().getProfile().sync();},_createForceBattleWithBattle:function(){this._forceBattlePanel.element().children().remove();var self=this;var needShowMore=false;if(self._isForceOwner(true)==true){needShowMore=true;}
this._forceOpponentListPanel=new Mojo.ui.ListPanel("forcewar-opponent-listpanel",{scrollable:true,showMore:needShowMore,alwaysMore:needShowMore,pageSize:20,moreLabel:Mojo.utils.locale('force','forcewar_retreat'),moreClick:function(that){if(self._isForceOwner(true)==false){return;}
(new Mojo.com.CommonDialog(undefined,{title:Mojo.utils.locale('force','forcewar_tip_title'),content:$('<div class="tip"></div>').html(Mojo.utils.locale('force','forcewar_retreat_question')),leftBtnText:Mojo.utils.locale('common','ok'),leftBtnClick:function(that){that.close();self._forceWarAjax("/force/battleFightingSurrender",{},function(response){if(response&&response.errorCode===0){self._createForceBattle(0);}});},rightBtnText:Mojo.utils.locale('common','close'),rightBtnClick:function(that){that.close();}})).open();},loadFunc:function(s,l,p,that){self._forceWarAjax("/force/battleFighting",{},function(response){var current=response.data.current;if(Mojo.utils.isNone(current)==false){self._forceBattleTime=current.timeout;self._forceOpponentForceName=current.defender.name;self._forceLodgmentsCount=current.lodgments.length;self._forceCapturedCount=current.captured;that.element().find(".mojo-com-forcewarelement").remove();that._children=[];that.appendData(current.lodgments);self._forceOpponentListPanel._scroll.element().height($(window).height()-162);}});},drawFunc:function(data){var btnDisabled=false;if(data.captured){btnDisabled=true;}
var fwe=(new Mojo.com.ForceWarElement(data,{showForce:true,showDefence:false,btnText:Mojo.utils.locale('force','forcewar_battle_action'),btnSpecial:"go-attack-btn",btnDisabled:btnDisabled,disableClickCallback:function(that){Mojo.app.toast.show(Mojo.utils.locale('force','has_captured'));},clickCallback:function(forceWarElement){var capturedPreviewDialog=new Mojo.com.ForceWarPreviewDialog(undefined,{attackBtnText:Mojo.utils.locale('force','forcewar_battle_action'),title:Mojo.utils.locale('force','forcewar_battle_preview'),attackerName:self._options.getController().getPlayerProfile().name,defenderName:(data.defender?data.defender.name:"?"),actionCallback:function(that){that.close();self._forceWarAjax("/force/battleFightingAttack",{lodgment_id:data.id},function(response){if(response&&response.errorCode===0){var playerLevel=self._options.getController().getPlayerProfile().level;var resultTitle="";var resultTip="";var leftBtnDisabled=false;var leftBtnText=undefined;var leftBtnFunc=undefined;var rightBtnDisabled=false;var rightBtnText=undefined;var rightBtnFunc=undefined;var current=response.data.current;if(current.player){if(parseInt(current.player.sp)==NaN){current.player.sp=0;}
Mojo.page.Force.getController().updatePlayerProfile({sp:current.player.sp});Mojo.page.Force.getController().diffPlayer({grain:current.grain});}
if(current!=undefined){if(current.status==1){self._refreshForceBattleStatus(true);forceWarElement.element().addClass("has-captured");forceWarElement._elementButton.disable(true);resultTitle=Mojo.utils.locale('force','capture_win');leftBtnDisabled=false;rightBtnDisabled=false;leftBtnText=Mojo.utils.locale('package','package_switch');rightBtnText=Mojo.utils.locale('common','close');if(data.defender==undefined){if(playerLevel<105){leftBtnDisabled=true;leftBtnText=undefined;}
resultTip=Mojo.utils.locale('force','win_lodgment_without_defender',{'lodgment':data.name});}else{if(playerLevel<105){leftBtnText=Mojo.utils.locale('battle','formation detail');}else{rightBtnText=Mojo.utils.locale('battle','formation detail');}
var defendername=Mojo.utils.formatPlayerName(data.defender);resultTip=Mojo.utils.locale('force','win_lodgment_with_defender',{'defendername':defendername,'lodgment':data.name});}}else{forceWarElement.element().removeClass("has-captured");forceWarElement._elementButton.disable(false);resultTitle=Mojo.utils.locale('force','capture_lose');leftBtnDisabled=false;rightBtnDisabled=false;leftBtnText=Mojo.utils.locale('force','capture_again');rightBtnText=Mojo.utils.locale('battle','formation detail');if(data.defender==undefined){rightBtnText=Mojo.utils.locale('common','close');}
var defendername=Mojo.utils.formatPlayerName(data.defender);resultTip=Mojo.utils.locale('force','lose_lodgment_defender',{'defendername':defendername,'lodgment':data.name});}
var dlgContent=$('<div class="tip"><div class="fight-result">'+resultTip+'</div></div>');var offer=$('<div class="fight-offer"></div>');new Mojo.ui.Label(undefined,{classes:['grain'],text:"+"+current.grain}).element().appendTo(offer);new Mojo.ui.Label(undefined,{classes:['contribute'],text:Mojo.utils.locale('force','offer1')+"+"+current.contribute}).element().appendTo(offer);offer.appendTo(dlgContent);var onCloseFunc=function(battleDetail){(new Mojo.com.CommonDialog(undefined,{title:resultTitle,content:dlgContent,leftBtnText:leftBtnText,leftBtnDisabled:leftBtnDisabled,leftBtnClick:function(that){if(current.status==1){if(playerLevel>=105){Mojo.app.redirect('/package');}else{that.hide();(new Mojo.com.BattleDetailDialog(battleDetail,{pid:data.defender.id,pkMode:true,vm:'+0',xp:'+0',entity:null,close:function(){that.show();},})).open(true);}}else{that.close();forceWarElement.doClick();}},rightBtnText:rightBtnText,rightBtnDisabled:rightBtnDisabled,rightBtnClick:function(that){if(data.defender==undefined||(current.status==1&&playerLevel<105)){that.close();}else{that.hide();(new Mojo.com.BattleDetailDialog(battleDetail,{pid:data.defender.id,pkMode:true,vm:'+0',xp:'+0',entity:null,close:function(){that.show();},})).open(true);}},})).open();};if(data.defender==undefined){onCloseFunc(undefined);}else{Mojo.ajax('/battle/Detail',{type:'ForceBattleFighting'},function(result){if(result.errorCode==0){Mojo.ui.BattleAnimation.onclose=function(){onCloseFunc(result.data);};Mojo.ui.BattleAnimation.openBattle(result);}},function(){},{showWait:true});}}}else{(new Mojo.com.CommonDialog(undefined,{title:Mojo.utils.locale('force','forcewar_tip_title'),content:$('<div class="tip"></div>').html(response.errorMsg),leftBtnText:Mojo.utils.locale('common','ok'),leftBtnClick:function(that){that.close();}})).open();}},function(){},{showWait:true});Mojo.track.onEvent('24_703');}});self._forceWarAjax("/force/battleFightingAttackPreview",{lodgment_id:data.id},function(response){if(response&&response.errorCode===0){var current=response.data.current;if(current!=undefined){capturedPreviewDialog.setPlayerName(current.attacker.name);if(current.defender){capturedPreviewDialog.setOpponentName(current.defender.name);}else{capturedPreviewDialog.setOpponentName("?");}
var winContent=$('<div><div class="lodgment-name">'+Mojo.utils.locale('force','capture_lodgment',{'name':data.name})+'</div></div>');var offer=$('<div class="capture-offer"></div>');new Mojo.ui.Label(undefined,{classes:['grain'],text:"+"+current.result.win.grain}).element().appendTo(offer);new Mojo.ui.Label(undefined,{classes:['contribute'],text:Mojo.utils.locale('force','offer1')+" +"+current.result.win.contribute}).element().appendTo(offer);offer.appendTo(winContent);capturedPreviewDialog.setWinContents(winContent);var loseoffer=$('<div class="capture-offer"></div>');new Mojo.ui.Label(undefined,{classes:['grain'],text:"+"+current.result.lose.grain}).element().appendTo(loseoffer);new Mojo.ui.Label(undefined,{classes:['contribute'],text:Mojo.utils.locale('force','offer1')+" +"+current.result.lose.contribute}).element().appendTo(loseoffer);capturedPreviewDialog.setLoseContents($("<div></div>").append(loseoffer));}
capturedPreviewDialog.open();}else if(response.errorCode==130204){(new Mojo.com.CommonDialog(undefined,{title:response.data.title,content:$('<div class="tip"></div>').html(response.errorMsg+"<br>"+Mojo.utils.locale('force','force_contribute_not_enough',{force_level:Mojo.page.Force.getController().getForceProfile().level,contribute:response.data.contribute})),leftBtnText:Mojo.utils.locale('common','go_neizheng'),leftBtnClick:function(that){that.close();Mojo.app.redirect('/force',{index:1});},rightBtnText:Mojo.utils.locale('common','close'),rightBtnClick:function(that){that.close();}})).open();}else if(response&&response.errorCode!=0&&Mojo.utils.isNone(response.data)==false&&Mojo.utils.isNone(response.data.props)==false){(new Mojo.com.NeedBuyDialog(undefined,{title:Mojo.utils.locale('force','forcewar_tip_title'),goods:response.data.props,stamina:response.data.stamina,restoreCount:response.data.sp,allRestoreText:Mojo.utils.locale('common','time for all sp'),allRestoreTime:response.data.sp_restore_pp,nextRestoreText:Mojo.utils.locale('common','time for next sp'),nextRestoreTime:response.data.sp_second,restoreText:response.errorMsg,needBuyTip:response.errorMsg,useBtnClick:function(that,result){that.close();if(result&&result.errorCode===0){Mojo.page.Force.getController().updatePlayerProfile({sp:result.data.player.sp});Mojo.app.toast.show(Mojo.utils.locale('common','add_sp',{name:that._options.goods.goods_name,value:result.data.value}));}},buyBtnClick:function(that,result){Mojo.page.Force.getController().updatePlayerProfile({rm:result.data.player.rm,vm:result.data.player.vm});}})).open();}else{var t=Mojo.utils.locale('force','forcewar_tip_title');if(response.data!=undefined&&response.data.title!=undefined){t=response.data.title;}
(new Mojo.com.CommonDialog(undefined,{title:t,content:$('<div class="tip"></div>').html(response.errorMsg),leftBtnText:Mojo.utils.locale('common','close'),leftBtnClick:function(that){that.close();}})).open();}},function(){},{showWait:true});}}));return fwe;}});this._forceOpponentListPanel.element().find('.more').addClass('retreat');this._forceOpponentListPanel.element().appendTo(this._forceBattlePanel.element());if(this._isForceOwner(true)){this._forceOpponentListPanel._more.show();}
this._forceBattleStatus=$("<div></div>").addClass("page-tips  forcewar-battle-notice").appendTo(this._forceOpponentListPanel._header);this._refreshForceBattleStatus();},_actionForFood:function(forceSearch,data){var self=this;var forcePage=self._options.getController();var contribute=undefined;var forcewarPreviewDialog=new Mojo.com.ForceWarPreviewDialog(undefined,{actionCallback:function(that){that.close();Mojo.ajax("/force/battleChallenge",{defender_id:data.id},function(response){if(response&&response.errorCode===0){forceSearch.element().remove();forcePage.showCurrent();self._createForceBattleWithBattle();new Mojo.com.CommonDialog(undefined,{title:Mojo.utils.locale('force','forcewar_tip_title'),content:$('<div class="tip"></div>').html(Mojo.utils.locale('force','forcewar_tip_content').replace('{{:opponent_force}}',data.name)),leftBtnText:Mojo.utils.locale('force','usurp_war_help'),leftBtnClick:function(that){that.close();new Mojo.com.ForceNoticeDialog({},{title:Mojo.utils.locale('force','forcewar_help_title'),hintText:Mojo.utils.locale('force','forcewar_help_content'),okBtnClick:function(that){that.close();Mojo.ajax("/force/sendWarToMember",{content:that.getContent()},function(response){Mojo.app.toast.show(Mojo.utils.locale('common','suggestion_has_send'));});}}).open();},rightBtnText:Mojo.utils.locale('common','close'),rightBtnClick:function(that){that.close();},}).open();self._options.getController().getProfile().sync();Mojo.track.onEvent('24_702');}else{if(response.errorCode==130026){(new Mojo.com.NeedBuyDialog(undefined,{title:Mojo.utils.locale('force','forcewar_tip_title'),goods:response.data.props,stamina:response.data.cp_total,restoreCount:response.data.cp_current,allRestoreText:Mojo.utils.locale('force','all_chanllenge_get'),allRestoreTime:response.data.cp_restore_pp,nextRestoreText:Mojo.utils.locale('force','next_chanllenge_get'),nextRestoreTime:response.data.cp_second,restoreText:response.errorMsg,needBuyTip:response.errorMsg,useBtnClick:function(that,result){that.close();if(result&&result.errorCode===0){Mojo.page.Force.getController().diffForce({challenge:parseInt(result.data.challenge)});self._updateChallange(self,Mojo.page.Force.getController().getData());Mojo.app.toast.show(Mojo.utils.locale('common','add_cp',{name:that._options.goods.goods_name,value:result.data.challenge}));}},buyBtnClick:function(that,result){Mojo.page.Force.getController().updatePlayerProfile({rm:result.data.player.rm,vm:result.data.player.vm});}})).open();}else{if(Mojo.utils.isNone(response.errorMsg)||response.errorMsg==''){response.errorMsg=Mojo.utils.locale('common','action_error');}
(new Mojo.com.CommonDialog(undefined,{title:response.data?response.data.title:Mojo.utils.locale('force','forcewar_tip_title'),content:$('<div class="tip"></div>').html(response.errorMsg),leftBtnText:Mojo.utils.locale('common','ok'),leftBtnClick:function(that){that.close();}})).open();}}});}});var winContent=$('<div class="win-content"><div class="force-grain">'+Mojo.utils.locale('force','force_grain')+'</div></div>');var winGrainLabel=(new Mojo.ui.Label("win-grain",{text:"",classes:['fgrain']}));winGrainLabel.element().appendTo(winContent);var loseContent=$('<div class="lose-content"><div class="force-grain">'+Mojo.utils.locale('force','force_grain')+'</div></div>');var loseGrainLabel=(new Mojo.ui.Label("lose-grain",{text:"",classes:['fgrain']}));loseGrainLabel.element().appendTo(loseContent);forcewarPreviewDialog.setWinContents(winContent);forcewarPreviewDialog.setLoseContents(loseContent);Mojo.ajax("/force/battleChallenge",{defender_id:data.id,preview:1},function(response){if(response&&response.errorCode===0){contribute=response.data.contribute;forcewarPreviewDialog.setPlayerName(response.data.attacker.name);forcewarPreviewDialog.setOpponentName(response.data.defender.name);winGrainLabel.text("+"+response.data.win.attacker.grain);loseGrainLabel.text("-"+response.data.lose.defender.grain);forcewarPreviewDialog.open();}else{var leftButton=undefined;var leftButtonClick=undefined;if(response.errorCode==200003){leftButton=self.locale('relation');leftButtonClick=function(that){that.close();Mojo.app.redirect('/relation');};}
if(Mojo.utils.isNone(response.errorMsg)||response.errorMsg==''){response.errorMsg=Mojo.utils.locale('common','action_error');}
(new Mojo.com.CommonDialog(undefined,{title:response.data?response.data.title:Mojo.utils.locale('force','forcewar_tip_title'),content:$('<div class="tip"></div>').html(response.errorMsg),leftBtnText:leftButton,leftBtnClick:leftButtonClick,rightBtnText:Mojo.utils.locale('common','close'),rightBtnClick:function(that){that.close();}})).open();}});},_createForceSearch:function(targetForceId){var self=this;var forcePage=self._options.getController();forcePage.hideCurrent();var forceSearch=new Mojo.com.ForceSearch('forcewar-forcesearch',{backCallback:function(){forceSearch.element().remove();forcePage.showCurrent();},forceSearchParams:{excludes:forcePage.getForceProfile().id},forceListOptions:{targetForceId:targetForceId,btnText:Mojo.utils.locale('force','forcewar_action'),moreLabel:Mojo.utils.locale('force','refresh'),onBtnClick:function(data){self._actionForFood(forceSearch,data);},erroCallback:function(response){if(response.errorCode==130012){Mojo.app.redirect('/force',{index:2,refresh:1});}}}});forceSearch.element().appendTo(forcePage.element());},_createForceBattleWithoutBattle:function(){if(this._list){return;}
this._forceBattlePanel.element().children().remove();var self=this;this._list=new Mojo.com.ScrollPanel(undefined);this._list.element().addClass('mojo-com-relation').appendTo(this._forceBattlePanel.element());this._forceWarNoticeDiv=this._list._header.addClass('page-tips');var force=this._options.getController().getForceProfile();if(Mojo.utils.isNone(force)){this._options.getController().sync(function(){force=self._options.getController().getForceProfile();self._forceWarNoticeDiv.html(Mojo.utils.locale('force','forcewar_no_battle',{challenge:force.challenge,challenge_limit:force.challenge_limit}));});}else{self._forceWarNoticeDiv.html(Mojo.utils.locale('force','forcewar_no_battle',{challenge:force.challenge,challenge_limit:force.challenge_limit}));}
this._funs=[{id:'battle',label:'battle_food',name:'battle_food',description:'food_description',dynamicinfo:'',index:1,cold_down:0,messageRemindCount:0,coldDownWarning:'coldDownWarning',imgClass:'food',descriptionImgClass:'food-cartoon',hasHr:false,hasColdDown:false,refresh:1,eventCode:'24_304'},{id:'capture',label:'capture',name:'capitulate',description:'capitulate_description',dynamicinfo:'',index:2,cold_down:0,messageRemindCount:0,coldDownWarning:'coldDownWarning',imgClass:'surrender',descriptionImgClass:'surrender-cartoon',hasHr:false,hasColdDown:false,refresh:1,eventCode:'24_304'},{id:'usurp',label:'usurp',name:'usurp',description:'usurp_description',dynamicinfo:'',index:3,cold_down:0,messageRemindCount:0,coldDownWarning:'coldDownWarning',imgClass:'battle',descriptionImgClass:'battle-cartoon',hasHr:false,hasColdDown:false,refresh:1,eventCode:'24_304'},{id:'alliance',label:'alliance',name:'alliance',description:'alliance_description',dynamicinfo:'',index:4,cold_down:0,messageRemindCount:0,coldDownWarning:'coldDownWarning',imgClass:'alliance',descriptionImgClass:'alliance-cartoon',hasHr:false,hasColdDown:false,refresh:1,eventCode:'24_304'},];$.each(this._funs,function(i,b){var element=new Mojo.com.RelationBaseMenuElement({elementId:b.id,buttonLabel:self.locale(b.label),buttonClickFun:function(){if(b.index==1){self._createForceSearch();}else{if(self._crazyForceWar){return;}
self._crazyForceWar=new Mojo.com.CrazyForceWar({inBattle:false,action:b.id,parent:self,updateChallange:function(){self._updateChallange(self,Mojo.page.Force.getController().getData());}});}},elementName:self.locale(b.name)+((i==3&&force.type==2)?" ("+self.locale('allied')+")":""),elementDescription:self.locale(b.description),elementDynamicInfo:self.locale(b.dynamicinfo),cold_down:b.cold_down,messageRemindCount:b.messageRemindCount,buttonClickInfo:self._buttonClickInfo(b.id),hasColdDown:b.hasColdDown,coldDownWarning:self.locale(b.coldDownWarning),imgClass:b.imgClass,hasHr:b.hasHr,descriptionImgClass:b.descriptionImgClass});self._list.appendData(element);});if(this.targetForceId){this._createForceSearch(this.targetForceId);}},_buttonClickInfo:function(buttonId){var self=this;var isViceOwner=true;var tip='';switch(buttonId){case'battle':tip=self.locale('forcewar_only_owner_start');break;case'capture':tip=self.locale('free_only_ownerorvice_can_ask_surrender');break;case'usurp':tip=self.locale('free_only_ownerorvice_can_start_battle');break;case'alliance':tip=self.locale('free_only_owner_can_ask_alliance');isViceOwner=false;break;}
return{isClickable:self._isForceOwner(isViceOwner),warning:tip};},_createCrazyForceBattle:function(){var self=this;var needInit=true;if(self._crazyForceWar){if(self._crazyForceWar.inbattle==true){self._crazyForceWar._refreshForceBattleStatus();needInit=false;}}
if(needInit){self._tabs.element().find('ul > li').eq(0).append($("<div class='battleStatus'></div>"));self._crazyForceWar=new Mojo.com.CrazyForceWar({inBattle:true,battleType:'attack',parent:self,action:self.actionType,});}},_createForceBattle:function(index){if(Mojo.utils.isNone(this._forceBattlePanel)){this._forceBattlePanel=new Mojo.Object();this._forceBattlePanel.element().addClass("forcewar-battlepanel");this._tabs.setPanel(index,this._forceBattlePanel);}
var self=this;self._forceWarAjax("/force/battleFighting",{},function(response){if(response.data&&response.data.kcuf&&!self._hasInit){self._tabs.element().find('ul > li').eq(1).append($("<div class='battleStatus'></div>"));}
if(response&&response.errorCode===0&&response.data.current){self._createForceBattleWithBattle();}else if(response.errorCode==130032){self._createForceBattleWithoutBattle();}else if(response.errorCode==198705){switch(parseInt(response.data.type)){case 1:self.actionType='usurp';break;case 2:self.actionType='rebel';break;case 3:self.actionType='uniterebel';break;}
self._createCrazyForceBattle();}else if(response.errorCode==198708){if(self._hasInit){self._createForceBattleWithoutBattle();}else{self._tabs._select(1);self._hasInit=true;}}},function(){self._createForceBattleWithoutBattle();});},_refreshForceBattleStatus:function(forceUpdate){var self=this;if(self._forceBattleTime!=undefined){self._forceBattleTime-=1;}
if(forceUpdate==true||self._forceBattleTime==undefined||self._forceBattleTime%self._options.interval==0){self._forceWarAjax("/force/battleFighting",{},function(response){if(response&&response.errorCode===0){var current=response.data.current;if(Mojo.utils.isNone(current)==false){self._forceBattleTime=current.timeout;self._forceOpponentForceName=current.defender.name;self._forceLodgmentsCount=current.lodgments.length;self._forceCapturedCount=current.captured;self._forceOpponentListPanel.element().find(".mojo-com-forcewarelement").remove();self._forceOpponentListPanel._children=[];self._forceOpponentListPanel.appendData(current.lodgments);if(self._isForceOwner(true)){self._forceOpponentListPanel._more.element().show();}
if(self.element().find(".forcewar-battle-notice").length==0){self._forceBattleStatus=$("<div></div>").addClass("page-tips").appendTo(self._forceOpponentListPanel._header);}
if(self._forceBattleTime!=undefined){var statusHtml=Mojo.utils.locale('force','forcewar_battle_notice',{opponent_force:self._forceOpponentForceName,battle_schedule:self._forceCapturedCount+'/'+self._forceLodgmentsCount,battle_time:Mojo.utils.formatTime(self._forceBattleTime)});self._forceBattleStatus.html(statusHtml);}else{clearTimeout(self._forceBattleHandle);self._createForceBattle(0);}
self._forceOpponentListPanel._scroll.element().height($(window).height()-162);}else{clearTimeout(self._forceBattleHandle);self._createForceBattle(0);}}},function(){clearTimeout(self._forceBattleHandle);self._createForceBattle(0);});}
if(self.element().find(".forcewar-battle-notice").length==0){self._forceBattleStatus=$("<div></div>").addClass("page-tips").appendTo(self._forceOpponentListPanel._header);}
if(self._forceBattleTime!=undefined){var statusHtml=Mojo.utils.locale('force','forcewar_battle_notice',{opponent_force:self._forceOpponentForceName,battle_schedule:self._forceCapturedCount+'/'+self._forceLodgmentsCount,battle_time:Mojo.utils.formatTime(self._forceBattleTime)});self._forceBattleStatus.html(statusHtml);}
if(forceUpdate!=true){self._forceBattleHandle=setTimeout(function(){self._refreshForceBattleStatus();},1000);}},_createForceDefense:function(index,data){if(Mojo.utils.isNone(this._forceDefenseListPanel)==false){return;}
var self=this;this._forceDefenseListPanel=new Mojo.ui.ListPanel("forcewar-defense-listpanel",{scrollable:true,showMore:false,pageSize:20,loadFunc:function(){},drawFunc:function(data){var btnDisabled=true;if(self._isForceOwner()==true){btnDisabled=false;}
return(new Mojo.com.ForceWarElement(data,{showAssistForce:true,showExpireTime:true,showBtn:true,btnText:Mojo.utils.locale('force','forcewar_change'),btnDisabled:btnDisabled,getController:function(){return self._options.getController();},disableClickCallback:function(){Mojo.app.toast.show(Mojo.utils.locale('force','forcewar_only_owner_change_defender'));},resizeDefence:function(){self._forceDefenseListPanel.resize();},clickCallback:function(forceWarElement){var selectedForceMemberElement=undefined;var forcePage=self._options.getController();forcePage.hideCurrent();var forceMember=new Mojo.com.ForceMember({showAssistTabs:true,showHeader:true,showSearch:false,showOrder:false,getController:function(){return self._options.getController();},forceMemberListOptions:{loadFunc:function(l,s,p,that){if(p!=undefined){self._helpflag=true;}else{self._helpflag=false;}
if(Mojo.utils.isNone(forceMember)==true){self._helping=0;}else{self._helping=forceMember._getTabsId();}
Mojo.ajax("/force/battleMembers",{start:l,count:s,helping:(self._helpflag?p:self._helping)},function(response){if(response&&response.errorCode===0){forceMember._addHelperTabs(response.data);forceMember._addHeader(response.data);if(Mojo.utils.isNone(response.data.list)&&response.data.desc!=undefined){that._options.emptyLabel=response.data.desc;}
that.appendData(response.data.list);if(response.data.list!=undefined&&response.data.list.length==that._options.pageSize){that._more.show();}else{that._more.hide();}
that.resize();}},function(){});}},backCallback:function(){forceMember.element().remove();forcePage.showCurrent();if(selectedForceMemberElement!=undefined){forceWarElement._data.defender={};$.extend(true,forceWarElement._data.defender,selectedForceMemberElement._data);self._helperId=(forceMember._getTabsId())<=0?0:(selectedForceMemberElement._data.force.id);Mojo.ajax("/force/battleChangeDefender",(self._helperId?{lodgment_id:data.id,defender_id:selectedForceMemberElement._data.id,helper:self._helperId}:{lodgment_id:data.id,defender_id:selectedForceMemberElement._data.id}),function(response){if(response.errorCode==0){forceWarElement._data.defender={};$.extend(true,forceWarElement._data.defender,response.data);forceWarElement.refresh();self._forceDefenseListPanel.resize();Mojo.track.onEvent('24_701');}else{var titiletxt=Mojo.utils.locale('force','cannot_change');if(response.data!=undefined&&response.data.title!=undefined)
titiletxt=response.data.title;var errDlg=new Mojo.ui.Dialog(undefined,{title:titiletxt,classes:['tip-dialog'],content:$("<div class='paragraph'></div>").html(response.errorMsg)});new Mojo.ui.Button(undefined,{text:Mojo.utils.locale('common','close'),click:function(){errDlg.close();}}).element().appendTo(errDlg._footer);errDlg.open();}},function(){forceWarElement.refresh();});}},forceMemberElementOptions:{showAttack:false,showDefence:true,showOffer:false,showLogin:false,showLevel:true,showHr:false,goBtnClass:['choose-button','radio'],goSpecialClass:'',subClass:'warClass',goBtnText:"",clickFunc:function(forceMemberElement){forceMember.element().find(".radio-selected-class").removeClass("radio-selected-class");forceMemberElement.element().find(".choose-button").addClass("radio-selected-class");selectedForceMemberElement=forceMemberElement;forceMember._backBtn.text(Mojo.utils.locale('common','ok'));}}});forceMember.element().appendTo(forcePage.element());}}));}});this._tabs.setPanel(index,this._forceDefenseListPanel);$("<div></div>").addClass("page-tips").html(Mojo.utils.locale('force','forcewar_defence_notice')).appendTo(this._forceDefenseListPanel._header);if(parseInt(self._forceProfile.level)>=5){self._adjustTimeArea=$("<div  class = 'adjust-time'></div>").appendTo(this._forceDefenseListPanel._header);var restStartTime=""+self._forceProfile.avoid_war.from+":00";var restEndTime=undefined;if(parseInt(self._forceProfile.avoid_war.to)<=parseInt(self._forceProfile.avoid_war.from)){restEndTime=Mojo.utils.locale("force","nextday")+self._forceProfile.avoid_war.to+":00";}else{restEndTime=self._forceProfile.avoid_war.to+":00";}
self._adjustLabel=$("<div class = 'adjust-time-label'></div>").html(Mojo.utils.locale('force','adjust_times',{time1:restStartTime,time2:restEndTime})).appendTo(self._adjustTimeArea);self._adjustBtn=new Mojo.ui.Button("adjust-time-btn",{text:Mojo.utils.locale("force","adjust"),disableClick:function(){Mojo.app.toast.show(self.locale('adjust_times_auth'));},click:function(){var adjustRestDlg=new Mojo.com.ForceRestDialog(self._forceProfile.avoid_war,{callBackFunc:function(data){self._updateRestInfo(data);},});adjustRestDlg.open();}});self._adjustBtn.element().appendTo(self._adjustTimeArea);if(parseInt(self._playerProfile.position_id)!=1){self._adjustBtn.disable(true);}}
self._forceDefenseListPanel.appendData(data);},_updateRestInfo:function(data){this._forceProfile.avoid_war.next=data.next;},_createEnemy:function(index){if(Mojo.utils.isNone(this._forceEnemyListPanel)==false){return;}
var self=this;this._forceEnemyListPanel=new Mojo.ui.ListPanel("forcewar-defense-listpanel",{scrollable:true,showMore:true,moreLabel:Mojo.utils.locale('common','more'),pageSize:10,emptyLabel:Mojo.utils.locale('force','no enemy force'),loadFunc:function(start,count){Mojo.ajax("/force/enemy",{start:start,count:count,},function(response){if(response&&response.errorCode===0){self._forceEnemyListPanel.appendData(response.data.enemyList);self._canAttack=response.data.can_attack;if(response.data.enemyList!=undefined&&response.data.enemyList.length==self._forceEnemyListPanel._options.pageSize){self._forceEnemyListPanel._more.element().show();}else{self._forceEnemyListPanel._more.element().hide();}
self._forceEnemyListPanel.resize();}else{self._forceEnemyListPanel.appendData(null);self._forceEnemyListPanel._more.element().hide();self._forceEnemyListPanel.resize();}},function(){self._forceEnemyListPanel.appendData(null);self._forceEnemyListPanel._more.element().hide();self._forceEnemyListPanel.resize();});},drawFunc:function(data){var btnDisabled=true;if(self._isForceOwner()==true){btnDisabled=false;}
return(new Mojo.com.ForceWarElement(data,{btnText:Mojo.utils.locale('common','view'),btnDisabled:false,isForceWarEnemy:true,clickCallback:function(forceWarElement){var dlg=new Mojo.com.ForceInfoDialog(forceWarElement._data,{},{showApplyBtn:false,showCloseBtn:false,title:Mojo.utils.locale('force','enemy force'),leftBtnText:Mojo.utils.locale('force','counterattack'),leftBtnDisabled:!self._canAttack,leftBtnDisabledClick:function(){Mojo.app.toast.show(Mojo.utils.locale('force','forcewar_only_owner_fanji',{'__default__':'~'}));},leftBtnClick:function(){dlg.close();Mojo.ajax("/force/battleChallenge",{defender_id:data.id,preview:1},function(response){if(response&&response.errorCode===0){var contribute=response.data.contribute;var forcewarPreviewDialog=new Mojo.com.ForceWarPreviewDialog(undefined,{actionCallback:function(that){that.close();Mojo.ajax("/force/battleChallenge",{defender_id:data.id},function(response){if(response&&response.errorCode===0){self._tabs._select(0);new Mojo.com.CommonDialog(undefined,{title:Mojo.utils.locale('force','forcewar_tip_title'),content:$('<div class="tip"></div>').html(Mojo.utils.locale('force','forcewar_tip_content').replace('{{:opponent_force}}',data.name)),leftBtnText:Mojo.utils.locale('force','usurp_war_help'),leftBtnClick:function(that){that.close();new Mojo.com.ForceNoticeDialog({},{title:Mojo.utils.locale('force','forcewar_help_title'),hintText:Mojo.utils.locale('force','forcewar_help_content'),okBtnClick:function(that){that.close();Mojo.ajax("/force/sendWarToMember",{content:that.getContent()},function(response){Mojo.app.toast.show(Mojo.utils.locale('common','suggestion_has_send'));});}}).open();},rightBtnText:Mojo.utils.locale('common','close'),rightBtnClick:function(that){that.close();},}).open();self._options.getController().getProfile().sync();}else{if(Mojo.utils.isNone(response.data)){(new Mojo.com.CommonDialog(undefined,{title:Mojo.utils.locale('force','forcewar_tip_title'),content:$('<div class="tip"></div>').html(response.errorMsg),leftBtnText:Mojo.utils.locale('common','ok'),leftBtnClick:function(that){that.close();}})).open();}else{(new Mojo.com.NeedBuyDialog(undefined,{title:Mojo.utils.locale('force','forcewar_tip_title'),goods:response.data.props,stamina:response.data.cp_total,restoreCount:response.data.cp_current,allRestoreText:Mojo.utils.locale('force','all_chanllenge_get'),allRestoreTime:response.data.cp_restore_pp,nextRestoreText:Mojo.utils.locale('force','next_chanllenge_get'),nextRestoreTime:response.data.cp_second,restoreText:response.errorMsg,needBuyTip:response.errorMsg,useBtnClick:function(that,result){that.close();if(result&&result.errorCode===0){Mojo.page.Force.getController().diffForce({challenge:parseInt(result.data.challenge)});self._updateChallange(self,Mojo.page.Force.getController().getData());Mojo.app.toast.show(Mojo.utils.locale('common','add_cp',{name:that._options.goods.goods_name,value:result.data.challenge}));}},buyBtnClick:function(that,result){Mojo.page.Force.getController().updatePlayerProfile({rm:result.data.player.rm,vm:result.data.player.vm});}})).open();}}});}});var winContent=$('<div class="win-content"><div class="force-grain">'+Mojo.utils.locale('force','force_grain')+'</div></div>');var winGrainLabel=(new Mojo.ui.Label("win-grain",{text:"",classes:['fgrain']}));winGrainLabel.element().appendTo(winContent);var loseContent=$('<div class="lose-content"><div class="force-grain">'+Mojo.utils.locale('force','force_grain')+'</div></div>');var loseGrainLabel=new Mojo.ui.Label("lose-grain",{text:"",classes:['fgrain']});loseGrainLabel.element().appendTo(loseContent);forcewarPreviewDialog.setWinContents(winContent);forcewarPreviewDialog.setLoseContents(loseContent);forcewarPreviewDialog.setPlayerName(response.data.attacker.name);forcewarPreviewDialog.setOpponentName(response.data.defender.name);winGrainLabel.text("+"+response.data.win.attacker.grain);loseGrainLabel.text("-"+response.data.lose.defender.grain);forcewarPreviewDialog.open();}else{(new Mojo.com.CommonDialog(undefined,{title:Mojo.utils.locale('force','forcewar_tip_title'),content:$('<div class="tip"></div>').html(response.errorMsg),leftBtnText:Mojo.utils.locale('common','ok'),leftBtnClick:function(that){that.close();}})).open();}});},rightBtnText:Mojo.utils.locale('force','view member'),rightBtnClick:function(){dlg.close();var forceMember=new Mojo.com.ForceEnemyMember({title:data.name,getController:function(){return self._options.getController();},forceMemberListOptions:{loadFunc:function(l,s,p,that){Mojo.ajax("/force/enemyMembers",{enemy_id:data.id,start:l,count:s},function(response){if(response&&response.errorCode===0){that.appendData(response.data.list);if(response.data!=undefined&&response.data.list.length==that._options.pageSize){that._more.show();}else{that._more.hide();}
that.resize();}else{(new Mojo.com.TipsDialog({title:Mojo.utils.locale('common','tips'),message:response.errorMsg,})).open();forceMember.close();}},function(){});}},backCallback:function(){forceMember.close();},forceMemberElementOptions:{showAttack:true,showDefence:"?",showOffer:false,showLogin:false,showLevel:false,showHr:true,goBtnClass:['go-button','go-attack-btn'],goSpecialClass:'',subClass:'',goBtnText:Mojo.utils.locale('force','revenge'),clickFunc:function(forceMemberElement){Mojo.ajax('/battle/preview',{opponent_id:forceMemberElement._data.id,},function(result){forceMember.close();if(result.errorCode==0){(new Mojo.com.BattlePreviewDialog(result.data,{title:Mojo.utils.locale('force','revenge result preview'),opponent_id:forceMemberElement._data.id,opponent_name:forceMemberElement._data.name,message_id:self._options.message_id,forceProfile:self._options.getController(),type:'fight',isForceEnemy:true,from:'force'})).open();}else if(result.errorCode==10003){(new Mojo.com.SpDialog(result.data,{title:Mojo.utils.locale('common','no enough stamina'),message:result.errorMsg,forceProfile:self._options.getController(),isForceEnemy:true,})).open();}else if(result.errorCode==30007){(new Mojo.com.AvoidWarDialog({message:Mojo.utils.locale('common','avoid_war_content',{avoid_war_time:Mojo.utils.formatTime(result.data)}),avoid_war_time:result.data,callback:function(){self._options.callback();},})).open();}else if(result.errorCode==160003){var dlg=new Mojo.com.CommonDialog(undefined,{title:Mojo.utils.locale('common','capacify_lack'),content:$('<div class="paragraph"></div>').html(Mojo.utils.locale('common','capacify_lack_tip')),leftBtnText:Mojo.utils.locale('common','go_intensify'),leftBtnClick:function(){Mojo.app.redirect('/intensify');},rightBtnText:Mojo.utils.locale('common','go_sale'),rightBtnClick:function(){Mojo.app.redirect('/entity',{selected:3});},close:function(){Mojo.app.redirect('/home');}});dlg.open();}else{(new Mojo.com.TipsDialog({title:Mojo.utils.locale('common','tips'),message:result.errorMsg,})).open();}},function(){},{showWait:true});}}});forceMember.open();},});dlg.open();}}));}});this._tabs.setPanel(index,this._forceEnemyListPanel);},_createBackButton:function(){var self=this;(new Mojo.ui.Button(undefined,{text:Mojo.utils.locale("common","back"),click:function(){self.element().hide();if(self._isAssist){Mojo.app.redirect('/relation',{index:self.actionType=='assistSlave'?1:11});}else{self._options.getController().switchToHome();}}})).element().addClass("force-back-btn").appendTo(this.element());},localeCat:function(){return'force';},_getUrlParam:function(name){var reg=new RegExp("(^|&)"+name+"=([^&]*)(&|$)");var r=window.location.search.substr(1).match(reg);if(r!=null)return unescape(r[2]);return null;},});})(window,jQuery);;(function(w,$,undefined){w.Mojo=w.Mojo||{};w.Mojo.com=w.Mojo.com||{};w.Mojo.com.ForceWarElement=w.Mojo.Object.extend({clsname:function(){return"com.ForceWarElement";},init:function(data,options){this._data=data;this._super(undefined,options);this.element().addClass("mojo-com-forcewarelement box-inner");this._elementPosition=undefined;this._elementGeneral=undefined;this._elementValue=undefined;this._elementForce=undefined;this._elementButton=undefined;this._elementAssistForce=undefined;this._elementExpireTime=undefined;this._expireTime=undefined;this._forceProfile=Mojo.page.Force.getController().getForceProfile();this.refresh();},refresh:function(data){if(data==undefined){data=this._data;}
var assistFlag=false;if(this._forceProfile.type==2||this._forceProfile.type==3)
assistFlag=true;this._createElementPosition(data);this._createElementGeneral(data);this._createElementForce(data);if(assistFlag)
this._createElementAssistForce(data);this._createElementValue(data);if(assistFlag)
this._createElementExpireTime(data);this._createElementButton(data);},_getDefaultOptions:function(){return{myIndex:0,btnText:"",btnSpecial:"go-instead-btn",btnDisabled:false,clickCallback:undefined,disableClickCallback:undefined,showForce:false,showDefence:true,isForceWarEnemy:false,showAssistForce:false,showExpireTime:false,showBtn:false,showHr:false};},_createElementPosition:function(data){if(Mojo.utils.isNone(this._elementPosition)){this._elementPosition=new Mojo.ui.Label();this.element().append(this._elementPosition.element());if(this._options.showNonRMBPlayerAssistBtn==true){this._nonRMBPlayOverallContribute=$("<div class='non-rmb-player-overall'></div>");this.element().append(this._nonRMBPlayOverallContribute);this._nonRMBPlayIndividualContribute=$("<div class='non-rmb-player-individual'></div>");this.element().append(this._nonRMBPlayIndividualContribute);}
$("<div class='line'></div>").appendTo(this.element());if(this._options.showHr!=false){this._elementPosition.element().append($('<hr>'));}}
var str;if(this._options.isForceWarEnemy){str=Mojo.utils.locale("force","forcewar_enemy_level").replace(/\{\{:index\}\}/g,data.level);}else{str=Mojo.utils.locale("force","forcewar_element_position").replace(/\{\{:index\}\}/g,data.id);}
this._elementPosition.element().addClass("forcewar-element-label forcewar-element-position").find(".icon").html(str);this._elementPosition.text(data.name);},_createElementGeneral:function(data){if(Mojo.utils.isNone(this._elementGeneral)){this._elementGeneral=new Mojo.ui.Label();this.element().append(this._elementGeneral.element());}
this._elementGeneral.element().addClass("forcewar-element-label forcewar-element-general");if(!this._options.isForceWarEnemy){if(Mojo.utils.isNone(data.captured)){this._elementGeneral.element().find(".icon").html(Mojo.utils.locale("force","forcewar_element_general"));if(Mojo.utils.isNone(data.defender)==false){this._elementGeneral.text(Mojo.utils.formatPlayerName(data.defender));}else{this._elementGeneral.text(Mojo.utils.locale('force','none'));}}else{this._elementGeneral.element().find(".icon").html(Mojo.utils.locale("force","forcewar_element_captured"));if(data.captured.name){this._elementGeneral.text(Mojo.utils.formatPlayerName(data.captured));}else{this._elementGeneral.text(Mojo.utils.locale('force','none'));}}}else{this._elementGeneral.text('<span class = "baomadeng">'+Mojo.utils.locale('force','forcewar_enemy_owner',{owner_title:'<span class="official">'+data.owner_title+'</span>',owner_name:data.owner_name})+'</span>');}},_createElementValue:function(data){if(this._options.isForceWarEnemy){this._elementValue=new Mojo.ui.Label();this.element().append(this._elementValue.element());this._elementValue.element().addClass("forcewar-element-label forcewar-element-defence");this._elementValue.text(Mojo.utils.locale('force','forcewar_enemy_mem',{current_mem:data.current_mem,total_mem:data.total_mem}));this._elementValue=$("<div class = 'forcewar-element-enemy-gain-text'></div>");this.element().append(this._elementValue);this._elementValue.html(Mojo.utils.locale('force','forcewar_enemy_grain'));new Mojo.ui.Label(undefined,{classes:this._options.isForceWarEnemy==false?['grain']:['grain enemy'],text:data.grain}).element().appendTo(this._elementValue);}else{if(this._options.showDefence==false){return;}
if(Mojo.utils.isNone(this._elementValue)){this._elementValue=new Mojo.ui.Label();this.element().append(this._elementValue.element());}
this._elementValue.element().addClass("forcewar-element-label forcewar-element-defence").find(".icon").html(Mojo.utils.locale("force","forcewar_element_defence"));if(Mojo.utils.isNone(data.defender)==false&&Mojo.utils.isNone(data.defender.defence_min)==false){this._elementValue.text(data.defender.defence_min+"~"+data.defender.defence_max);}else if(Mojo.utils.isNone(data.captured)==false&&Mojo.utils.isNone(data.captured.defence_min)==false){this._elementValue.text(data.captured.defence_min+"~"+data.captured.defence_max);}else{this._elementValue.text("?");}}},_createElementAssistForce:function(data){var forceName=undefined;if(this._options.showAssistForce==false){return;}
if(Mojo.utils.isNone(data.defender)==true){if(Mojo.utils.isNone(this._elementAssistForce)==false){this._elementAssistForce.hide();this._elementAssistForce=undefined;}
return;}
if(Mojo.utils.isNone(this._elementAssistForce)){this._elementAssistForce=new Mojo.ui.Label();this.element().append(this._elementAssistForce.element());}
if(Mojo.utils.isNone(data.defender.force)||Mojo.utils.isNone(data.defender.force.name)){forceName=this._forceProfile.name;}else{forceName=data.defender.force.name;}
this._elementAssistForce.element().addClass("forcewar-element-label forcewar-element-assistforce").find(".icon").html(Mojo.utils.locale("force","forcewar_element_assistforce"));this._elementAssistForce.text(forceName);},_createElementExpireTime:function(data){if(this._options.showExpireTime==false){w.clearInterval(this._interval);return;}
if(Mojo.utils.isNone(data.defender)||Mojo.utils.isNone(data.defender.force)||Mojo.utils.isNone(data.defender.force.expire)){if(Mojo.utils.isNone(this._elementExpireTime)==false){this._elementExpireTime.hide();this._elementExpireTime=undefined;w.clearInterval(this._interval);}
return;}
this._expireTime=data.defender.force.expire;this._showExpire();},_createElementForce:function(data){var self=this;if(this._options.showForce==false){return;}
var force="";if(data.captured&&data.captured.name){if(data.captured.force_name!=undefined){force=data.captured.force_name;}else{force=self._forceProfile.name;}}else if(data.defender){force=data.defender.force_name;}else{force=Mojo.utils.locale('force','none');}
if(Mojo.utils.isNone(this._elementForce)){this._elementForce=new Mojo.ui.Label();this.element().append(this._elementForce.element());}
this._elementForce.element().addClass("forcewar-element-label forcewar-element-force").find(".icon").html(Mojo.utils.locale("force","forcewar_element_force"));this._elementForce.text(force);},_createElementButton:function(data){if(Mojo.utils.isNone(this._elementButton)==false){return;}
var self=this;if(self._options.showBtn==true||self._options.btnDisabled==false){this._elementButton=new Mojo.ui.Button(undefined,{text:self._options.btnText,classes:self._options.isForceWarEnemy==false?['go-button']:['go-button enemy-btn'],disabled:self._options.btnDisabled,disableClick:function(){if(self._options.disableClickCallback instanceof Function){self._options.disableClickCallback(self);}},click:function(){if(self._options.clickCallback instanceof Function){self._options.clickCallback(self);}},special:self._options.btnSpecial,});if(self._options.showNonRMBPlayerAssistBtn==true&&(data.captured!=undefined||data.defender!=undefined)){this._nonRMBPlayAssistButton=new Mojo.ui.Button(undefined,{text:Mojo.utils.locale('force','non_rmb_player_assist_attack'),classes:['go-button'],click:function(){if(self._options.nonRMBClickCallback instanceof Function){self._options.nonRMBClickCallback(self,'decr');}},special:"force-back-btn",});this._nonRMBPlayAssistButton.element().appendTo(this.element());var overallContribute=undefined;var individualContribute=undefined;if(data.captured!=undefined){overallContribute=data.captured.buff.total;individualContribute=data.captured.buff.self;}else if(data.defender!=undefined){overallContribute=data.defender.buff.total;individualContribute=data.defender.buff.self;}
this._nonRMBPlayOverallContribute.html(Mojo.utils.locale('force','non_rmb_player_defense_data',{percent:'-'+overallContribute}));this._nonRMBPlayOverallContribute.addClass("non-rmb-assist-attack-red");if(individualContribute!=undefined){this._nonRMBPlayIndividualContribute.html(Mojo.utils.locale('force','non_rmb_player_sub_defense',{percent:individualContribute}));}}}else{this._elementButton=new Mojo.Object();this._elementButton.element().addClass('has-captured-tag').html(Mojo.utils.locale('force','forcewar_element_hascaptured'));if(self._options.showNonRMBPlayerAssistBtn==true&&(data.captured!=undefined||data.defender!=undefined)){this._nonRMBPlayAssistButton=new Mojo.ui.Button(undefined,{text:Mojo.utils.locale('force','non_rmb_player_assist_defense'),classes:['go-button'],click:function(){if(self._options.nonRMBClickCallback instanceof Function){self._options.nonRMBClickCallback(self,'incr');}},special:"force-back-btn",});this._nonRMBPlayAssistButton.element().appendTo(this.element());var overallContribute=undefined;var individualContribute=undefined;if(data.captured!=undefined){overallContribute=data.captured.buff.total;individualContribute=data.captured.buff.self;}else if(data.defender!=undefined){overallContribute=data.defender.buff.total;individualContribute=data.defender.buff.self;}
this._nonRMBPlayOverallContribute.html(Mojo.utils.locale('force','non_rmb_player_defense_data',{percent:'+'+overallContribute}));this._nonRMBPlayOverallContribute.addClass("non-rmb-assist-attack-green");if(individualContribute!=undefined){this._nonRMBPlayIndividualContribute.html(Mojo.utils.locale('force','non_rmb_player_add_defense',{percent:individualContribute}));}}}
this._elementButton.element().appendTo(this.element());},doClick:function(){var self=this;if(self._options.clickCallback instanceof Function){self._options.clickCallback(self);}},_showExpire:function(){var self=this;if(self._expireTime==undefined||self._expireTime==0)return;if(Mojo.utils.isNone(self._elementExpireTime)){self._elementExpireTime=new Mojo.ui.Label();self.element().append(self._elementExpireTime.element());}else{w.clearInterval(self._interval);}
self._elementExpireTime.element().addClass("forcewar-element-label forcewar-element-expiretime").find(".icon").html(Mojo.utils.locale("force","forcewar_element_expiretime"));self._elementExpireTime.text(self._formatExpireTime(self._expireTime)+Mojo.utils.locale("force","goaway"));self._interval=w.setInterval(function(){if(self._expireTime!=undefined&&self._expireTime>1){self._expireTime--;self._elementExpireTime.text(self._formatExpireTime(self._expireTime)+Mojo.utils.locale("force","goaway"));}else{self._expireTime=0;w.clearInterval(self._interval);self._data.defender=undefined;self.refresh(self._data);var msg=self._forceProfile.owner.name+Mojo.utils.locale('force','expiretime_coming_message');(new Mojo.com.HandleDialog({title:Mojo.utils.locale('force','expiretime_coming'),message:msg,btn1:Mojo.utils.locale('force','forcewar_defense'),handle1:function(){Mojo.app.redirect('/force',{index:2,refresh:1,selected:1});},close:function(){if(self._options.resizeDefence instanceof Function){self._options.resizeDefence();}},})).open(true);}},1000);},_formatExpireTime:function(sec){var str='';var dd=parseInt(sec/86400);var hh=parseInt((sec%86400)/3600);var mm=parseInt((sec%3600)/60);var ss=sec%60;if(dd>0){str=dd+Mojo.utils.locale('common','day')+hh+Mojo.utils.locale('common','hour');}else if(hh>0){str=hh+Mojo.utils.locale('common','hour')+mm+Mojo.utils.locale('common','minute');}else if(mm>0){str=mm+Mojo.utils.locale('common','minute')+ss+Mojo.utils.locale('common','second');}else{str=ss+Mojo.utils.locale('common','second');}
return str;},});})(window,jQuery);;(function(w,$,undefined){w.Mojo=w.Mojo||{};w.Mojo.com=w.Mojo.com||{};w.Mojo.com.ForceSearch=w.Mojo.Object.extend({clsname:function(){return"com.ForceSearch";},init:function(id,options){this._super(id,options);this.element().addClass('mojo-com-forcesearch');this.forcePanel=undefined;this.forceSearchArea=undefined;this.forceList=undefined;this._params={type_id:'1',order_id:'1'};this._addTabs();this._addButton();},_addTabs:function(){var self=this;this._panels=[{type:'ranking',label:'ranking'},];this._tabs=new Mojo.ui.Tabs('tabs-ranking',{selectionChange:function(i){self._createList(i);},selected:0});$.each(this._panels,function(i,p){self._tabs.addTab(self._options.tabText);});this.element().append(this._tabs.element());this._tabs.element().find('.panel').addClass('box-outter');self._createList(0);},_createList:function(index){var self=this;self._refreshFilter();var p=this._panels[index];if(p.list==undefined||p.list==null){var defaultForceListOptions={type:'battle',showBtn:true,onBtnClick:self._viewBtnClick,alwaysMore:true,refreshable:true,showMore:true,moreLabel:'',params:self._params,};if(Mojo.utils.isNone(this._options.forceListOptions)==false){$.extend(defaultForceListOptions,this._options.forceListOptions);this._options.forceListOptions.listData=undefined;}
p.list=new Mojo.com.ForceList("force-list",defaultForceListOptions);this._tabs.setPanel(index,p.list);}
if(this._options.showSearch==true){self._addSearch();}
if(this._options.showHeader==true){self._addHeader();}},_refreshFilter:function(){var filter=Mojo.cache.get(this._options.filterName);if(filter!=undefined){for(var p in filter){this._params[p]=filter[p];}}},_addSearch:function(){var self=this;var p=self._panels[0];this.search=new Mojo.com.ForceFind(undefined,{url:self._options.forceSearchUrl,param:self._options.forceSearchParams,onSearch:function(data,searchVal){self._refreshList(data,searchVal);},noinput:function(){self._panels[0].list.element().remove();self._panels[0].list=undefined;self._createList(0);return false;}}).element().appendTo(p.list._header);},_addHeader:function(){this._header=new Mojo.ui.Label(undefined,{text:this._options.headerContent,classes:['member-count'],});if(this._options.showHeader){this._header.element().appendTo(this._panels[0].list._header);}
this._options.addHeaderCallback(this._header);},_refreshList:function(response,searchVal){var forcelist=this._panels[0].list;forcelist._scroll.scrollTo(0,0);forcelist._list.find('.mojo-ui-listpanel-child').remove();forcelist._options.alwaysMore=false;forcelist._children=[];forcelist._options.emptyLabel=Mojo.utils.locale('force','force_search_noresult');if(response.data&&response.data.list){forcelist._options.type='search';forcelist._more.element().html(Mojo.utils.locale('common','more')).hide();if(response.data.list.length>=forcelist._options.pageSize){forcelist._options.alwaysMore=true;forcelist._options.showMore=true;forcelist._options.refreshable=false;forcelist._options.forceSearchByLevelParams={'search':searchVal,'excludes':Mojo.page.Force.getController().getForceProfile().id};forcelist.appendData(response.data.list,true);}else{forcelist._options.alwaysMore=false;forcelist._options.showMore=false;forcelist._options.refreshable=true;forcelist.appendData(response.data.list,false);}}else{forcelist.appendData(response.data,false);}},_viewBtnClick:function(data){new Mojo.com.ForceInfoDialog(data,{},{showApplyBtn:false}).open();},_addButton:function(){var self=this;if(self._options.showOrderBtn==true){this.orderBtn=new Mojo.ui.Button('order-btn',{classes:['order_btn'],text:Mojo.utils.locale('force','order_force'),click:function(){var forceFilterDialog=new Mojo.com.ForceFilterDialog({typeId:self._params.type_id,type:self._params.type,orderId:self._params.order_id,filterUrl:self._options.filterUrl,filterDataSource:self._options.filterDataSource,callback:function(tid,oid){if(self._params.type_id==tid&&self._params.order_id==oid)
return;self._params.type_id=tid;self._params.order_id=oid;self._panels[0].list._options.params=self._params;Mojo.cache.set(self._options.filterName,{type_id:tid,order_id:oid});$.each(self._panels[0].list.children(),function(i,child){child.element().remove();});self._panels[0].list._hasLoaded=false;self._panels[0].list._children=[];self._panels[0].list._load(self._params);}});forceFilterDialog.open();},});this.orderBtn.element().appendTo(this.element());}
this._backBtn=new Mojo.ui.Button(undefined,{text:Mojo.utils.locale('common','back'),click:function(){if(self._options.backCallback instanceof Function){self._options.backCallback(self);}},classes:['force-back-btn'],});this._backBtn.element().appendTo(this.element());},_getDefaultOptions:function(){return{showSearch:true,showHeader:false,tabText:Mojo.utils.locale('force','force'),backCallback:$.noop,forceListOptions:undefined,};},localeCat:function(){return'force';},});})(window,jQuery);;;(function(w,$){w.Mojo=w.Mojo||{};w.Mojo.page=w.Mojo.page||{};w.Mojo.com.ForceFind=w.Mojo.Object.extend({clsname:function(){return"com.ForceFind";},init:function(id,options){this._super(id,options);this.element().addClass('search-area');this._search=$("<div class='search-input'></div>");this._search.appendTo(this.element());this._addContent();this._addButton();},_addContent:function(){var self=this;this._input=$('<input  type="text" maxlength="10" />').val(Mojo.utils.locale('common','search_force_hint')).appendTo(this._search);this._input.click(function(){self._input.val('');});},_addButton:function(){var self=this;new Mojo.ui.Button(undefined,{text:Mojo.utils.locale('common','search'),special:'force-search-btn',click:function(){self._doSearch();}}).element().appendTo(self.element());},_doSearch:function(){var self=this;window.scrollTo(0);if(this._input.val()==Mojo.utils.locale('common','search_force_hint'))
this._input.val('');if(Mojo.utils.isNone(this._input.val())){if(self._options.noinput()==false){return;}}
var param=$.extend(true,self._options.param,{search:this._input.val(),with_ranking:self._options.with_ranking});Mojo.ajax(self._options.url,param,function(response){self._options.onSearch(response,self._input.val());},function(){});},_getDefaultOptions:function(){return{onSearch:$.noop,url:'/force/search',param:{},with_ranking:0,noinput:function(){return false;}};},});})(window,jQuery);;(function(w,$,undefined){w.Mojo=w.Mojo||{};w.Mojo.com=w.Mojo.com||{};w.Mojo.com.ForceWarPreviewDialog=w.Mojo.ui.Dialog.extend({clsname:function(){return"com.ForceWarPreviewDialog";},init:function(data,options){this._data=data;this._super(undefined,options);this.element().addClass('mojo-com-forcewarpreviewdlg');this._addContent();this._addHandleButtons();},setPlayerName:function(name){if(name==undefined){name=this._options.attackerName;}
this.element().find(".player_name").html(name);},setOpponentName:function(name){if(name==undefined){name=this._options.defenderName;}
this.element().find(".opp_name").html(name);},setWinContents:function(winContents){if(winContents==undefined){winContents=this._options.winContents;}
if(Mojo.utils.isNone(winContents)==false){var ifwin=this.element().find(".ifwin");ifwin.find(".win-content").remove();if(!($.isArray(winContents))){winContents=[winContents];}
for(var index in winContents){var winContent=winContents[index];if(winContent.element instanceof Function){winContent=winContent.element();}
winContent.addClass("win-content");ifwin.append(winContent);}}},setLoseContents:function(loseContents){if(loseContents==undefined){loseContents=this._options.loseContents;}
if(Mojo.utils.isNone(loseContents)==false){var iflose=this.element().find(".iflose");iflose.find(".lose-content").remove();if(!($.isArray(loseContents))){loseContents=[loseContents];}
for(var index in loseContents){var loseContent=loseContents[index];if(loseContent.element instanceof Function){loseContent=loseContent.element();}
loseContent.addClass("lose-content");iflose.append(loseContent);}}},setTips:function(tips){if(Mojo.utils.isNone(tips)==false){this.element().find(".paragraph").html(tips+"<br>"+this._options.tips);}},_addContent:function(){var self=this;var _name=$('<div class="name"></div>').appendTo(this._content);var _player=$('<div class="player"></div>').appendTo(_name);$('<div class="player_icon"></div>').appendTo(_player);var _playerName=$('<div class="player_name"></div>').html(self._options.attackerName).appendTo(_player);var _vs=$('<div class="vs"></div>').html('VS').appendTo(_name);var _opp=$('<div class="opp"></div>').appendTo(_name);$('<div class="opp_icon"></div>').appendTo(_opp);var _oppName=$('<div class="opp_name"></div>').html(self._options.defenderName).appendTo(_opp);var _ifwin=$('<div class="ifwin"></div>').appendTo(this._content);var _win=$('<div class="win"></div>').html(Mojo.utils.locale('common','when win')).appendTo(_ifwin);if(Mojo.utils.isNone(self._options.winContents)==false){if(!($.isArray(self._options.winContents))){self._options.winContents=[self._options.winContents];}
for(var index in self._options.winContents){var winContent=self._options.winContents[index];if(winContent.element instanceof Function){winContent=winContent.element();}
winContent.addClass("win-content");_ifwin.append(winContent);}}
var _iflose=$('<div class="iflose"></div>').appendTo(this._content);var _lose=$('<div class="lose"></div>').html(Mojo.utils.locale('common','when lose')).appendTo(_iflose);if(Mojo.utils.isNone(self._options.loseContents)==false){if(!($.isArray(self._options.loseContents))){self._options.loseContents=[self._options.loseContents];}
for(var index in self._options.loseContents){var loseContent=self._options.loseContents[index];if(loseContent.element instanceof Function){loseContent=loseContent.element();}
loseContent.addClass("lose-content");_iflose.append(loseContent);}}
if(this._options.showtip==undefined){$("<div class='paragraph'></div>").html(Mojo.utils.locale('force','force_war_tip')).appendTo(this._content);}},_addHandleButtons:function(){var self=this;var _attackBtn=new Mojo.ui.Button('attack-btn',{special:'button-big-red',text:self._options.attackBtnText,click:function(){if(self._options.actionCallback instanceof Function){self._options.actionCallback(self);}},});this._footer.append(_attackBtn.element());this._footer.append((new Mojo.ui.Button('close-btn',{text:Mojo.utils.locale('common','close'),click:function(){self.close();if(self._options.closeCallback instanceof Function){self._options.closeCallback(self);}},})).element());},_getDefaultOptions:function(){return $.extend(true,this._super(),{attackBtnText:Mojo.utils.locale('force','forcewar_action'),title:Mojo.utils.locale('force','forcewar_preview'),tips:Mojo.utils.locale('force','force_war_tip'),attackerName:"",defenderName:"",winContents:undefined,loseContents:undefined,closeCallback:$.noop,actionCallback:$.noop});},});})(window,jQuery);;(function(w,$,undefined){w.Mojo=w.Mojo||{};w.Mojo.com=w.Mojo.com||{};w.Mojo.com.ForceElement=w.Mojo.Object.extend({clsname:function(){return"com.ForceElement";},init:function(data,options){this._data=data;if(options.showChooseButton){this._super('entity-'+data.id,options);}else{this._super(undefined,options);}
this.element().addClass('mojo-com-forceelement').addClass('box-inner');this._addContent();},_addContent:function(){var self=this;var forceTypeName=undefined;switch(parseInt(this._data.type,10)){case 1:forceTypeName=Mojo.utils.locale('force','force_free');break;case 2:forceTypeName=Mojo.utils.locale('force','force_alliance');break;case 3:forceTypeName=Mojo.utils.locale('force','force_slave');break;case 4:forceTypeName=Mojo.utils.locale('force','force_master');break;}
var elementTitle=$('<div class="element-title"></div>');$('<div class="level"></div>').appendTo(elementTitle).html(Mojo.utils.locale('force','levelinfo',{level:this._data.level}));$('<div class="forcetype"></div>').appendTo(elementTitle).html(forceTypeName);$('<div class="name"></div>').appendTo(elementTitle).html(this._data.name);elementTitle.appendTo(this.element());if(this._options.showRank){$('<div class="rank"></div>').appendTo(this.element()).html(Mojo.utils.locale('force','order',{order:this._data.order?this._data.order:'?'}));}
if(this._options.type=='forceinfo'){if(this._data.rank!=undefined){$('<div class="rank"></div>').appendTo(this.element()).html(Mojo.utils.locale('force','order',{order:this._data.rank}));}}
if(!this._options.showGetTaxedGrainContent){$('<div class="owner"></div>').appendTo(this.element()).html(Mojo.utils.locale('force','owner',{title:this._data.owner_title,name:this._data.owner_name}));if(!this._options.notShowForceMember){$('<div class="member"></div>').appendTo(this.element()).html(Mojo.utils.locale('force','member_count1',{now:this._data.member_num,max:this._data.member_num_limit}));}}else{var accumulated_grain=$('<div class="accumulated-grain"></div>').appendTo(this.element()).html('<div class="accumulated-grain-content">'+Mojo.utils.locale('relation','accumulated_grain')+'</div>');var gcLabel=new Mojo.ui.Label(undefined,{text:self._data.tax_buffer,classes:['fgrain'],});gcLabel.element().appendTo(accumulated_grain);var available_grain=$('<div class="available-grain"></div>').appendTo(this.element()).html('<div class="available-grain-content">'+Mojo.utils.locale('relation','available_grain')+'</div>');var gcLabel2=new Mojo.ui.Label(undefined,{text:self._data.tax_ready,classes:['fgrain'],});gcLabel2.element().appendTo(available_grain);}
if(this._options.type=='relation'){if(this._data.type==3&&!this._options.showGetTaxedGrainContent){this._freeRelation=$('<div class="ration"></div>').appendTo(this.element()).html(Mojo.utils.locale('relation','donate_and_taxed_ration')+this._data.donate_and_taxed_ration+'/'+this._data.tax_to_free);if(parseInt(this._data.donate_and_taxed_ration)>=parseInt(this._data.tax_to_free)){this._freeRelation.addClass('text-red');}
if(this._options.notShowForceMember){$('<div class="accumulated_grain"></div>').appendTo(this.element()).html(Mojo.utils.locale('relation','accumulated_grain')+this._data.tax_buffer);}
$('<div class="rate"></div>').appendTo(this.element()).html(Mojo.utils.locale('relation','taxed_rate',{rate:this._data.tax_ratio}));}else if(this._data.type==2){}else if(this._options.showGetTaxedGrainContent){$('<div class="rate"></div>').appendTo(this.element()).html(Mojo.utils.locale('relation','taxed_rate',{rate:this._data.tax_ratio}));}
if(this._options.showBattleStatusAndAssistBtn&&this._data.battle_status==1){var btn=new Mojo.ui.Button(undefined,{text:self._options.assistButtonText,classes:['go-button'],special:self._options.specialClass,click:function(){self._options.onBtnClick(self._data);},});var battleStatus=$("<div></div>");battleStatus.addClass('battleStatus');btn.element().append(battleStatus);this.element().append(btn.element());}
if(this._options.addGetTaxedButton){var btn=this._options.addGetTaxedButton(self._data);this.element().append(btn.element());}}
if(this._options.type=='election'){if(this._data.type==4){$('<div class="member"></div>').appendTo(this.element()).html(Mojo.utils.locale('relation','slave_count',{now:this._data.master_slave_num,max:this._data.master_slave_num_limit}));}else if(this._data.type==2){$('<div class="member"></div>').appendTo(this.element()).html(Mojo.utils.locale('relation','alliance_count',{now:this._data.alliance_friend_num,max:this._data.alliance_friend_num_limit}));}
if((this._data.type==4||this._data.type==2)&&this._data.id!=this._options.forceId){var btn=new Mojo.ui.Button(undefined,{text:Mojo.utils.locale('relation','conmmunication'),classes:['go-button'],special:self._options.specialClass,click:function(){self._options.onBtnClick(self._data);},});this.element().append(btn.element());}}
if(this._options.inDefence instanceof Function){if(this._options.inDefence(self._data)){$('<div class="inWar">'+this._options.inWarTxt+'</div>').appendTo(this.element());}}
if(this._options.showBtn){if(this._options.showForceRest&&this._data.is_avoiding!=undefined&&parseInt(this._data.is_avoiding)==1){this._avoidWarStatus=$('<div class="in-force-rest">'+Mojo.utils.locale("force","in_force_rest")+'</div>').appendTo(this.element());}else{var btn=new Mojo.ui.Button(undefined,{text:self._options.btnText,classes:['go-button'],special:self._options.specialClass,click:function(){self._options.onBtnClick(self._data);},});this.element().append(btn.element());}}
if(this._options.showChooseButton){this._chooseButton=new Mojo.ui.Button(undefined,{text:'',click:function(e){self._options.chooseClick(self._data);},});this._chooseButton.element().addClass('choose-button').addClass('combo').appendTo(this.element());}
if(this._options.showUniteRebelStatus){var msg='';if(this._data.role==1){msg=Mojo.utils.locale('relation','slave_unite_rebel_responsed');}else if(this._data.role==5){msg=Mojo.utils.locale('relation','slave_unite_rebel_waiting');}else if(this._data.role==6){msg=Mojo.utils.locale('relation','slave_unite_rebel_denied');}
$('<div class="unite-rebel-status-tag"></div>').appendTo(this.element()).html(msg);}
if(parseInt(this._data.type,10)==4&&this._data.slave_num!=undefined&&this._data.max_slave!=undefined){$('<div class="slavernum"></div>').appendTo(this.element()).html(Mojo.utils.locale('force','master_slave_num',{slavenum:this._data.slave_num,maxslavenum:this._data.max_slave}));}},_getDefaultOptions:function(){return{showSlaverExpire:false,showRank:false,showBtn:false,btnText:'',specialClass:'go-view-btn',onBtnClick:$.noop};},});})(window,jQuery);;(function(w,$,undefined){w.Mojo=w.Mojo||{};w.Mojo.com=w.Mojo.com||{};w.Mojo.com.ForceInfoDialog=w.Mojo.ui.Dialog.extend({clsname:function(){return"com.ForceInfoDialog";},init:function(data,userinfo,options){this._super("mojo-com-forceinfodlg",options);this._force=data;this._user=userinfo;this.element().addClass('mojo-com-forceinfodlg');this._paragraph=$("<div class='paragraph'></div>").appendTo(this._content);this._addContent();this._addButtons();this._refresh();},_addContent:function(){var name=$("<div class='name'></div>");name.html(this._force.name);name.appendTo(this._paragraph);var level=$("<div class='level'></div>");this._addItem(level,Mojo.utils.locale('force','info_level'),this._force.level);level.appendTo(this._paragraph);var owner=$("<div class='owner'></div>");this._addItem(owner,Mojo.utils.locale('force','info_owner'),this._force.owner_name);owner.appendTo(this._paragraph);var member=$("<div class='member'></div>");this._addItem(member,Mojo.utils.locale('force','info_member1'),this._force.member_num+'/'+this._force.member_num_limit);member.appendTo(this._paragraph);var board=$("<div class='board'></div>");$("<div class='h'></div>").appendTo(board).html(Mojo.utils.locale('force','info_board'));var notice=$("<div class='v'></div>").html(this._force.notice);board.append(notice);var self=this;board.appendTo(this._paragraph);if(Mojo.utils.isNone(self._user.partners)==true){return;}
var its_relation=undefined;switch(parseInt(this._force.type)){case 1:break;case 2:its_relation=Mojo.utils.locale('force','its_alliance');break;case 3:its_relation=Mojo.utils.locale('force','its_master');break;case 4:its_relation=Mojo.utils.locale('force','its_slave');break;}
this._list=new Mojo.com.ForceList("force-list",{type:'forceinfo',showBtn:false,refreshable:true,pageSize:3,scrollable:true,ids:this.data.str_data,loadFunc:function(start,count,orderParams){setTimeout(function(){self._list.appendData(self._user.partners);},0);},});this._paragraph.append($("<div class=''></div>").html(its_relation));this._paragraph.prependTo(this._list._list);this.element().addClass('special-dlg');this._list.element().appendTo(this._content);},_addButtons:function(){var self=this;var btnCount=0;if(this._options.showApplyBtn){this.applyBtn=new Mojo.ui.Button('apply-btn',{text:Mojo.utils.locale('force','join_apply'),special:'button-big-red',click:function(){self._applyForce();},disableClick:function(){Mojo.app.toast.show(Mojo.utils.locale('force','force_appling'));}});self.applyBtn.element().appendTo(this._footer);if(self._force.member_num==self._force.member_num_limit){self.applyBtn.disable(true);self.applyBtn._options.disableClick=function(){Mojo.app.toast.show(Mojo.utils.locale('force','member_full'));};}
btnCount+=1;}
if(0==btnCount&&this._options.leftBtnText){(new Mojo.ui.Button(undefined,{text:self._options.leftBtnText,disabled:self._options.leftBtnDisabled,special:'button-big-red',click:function(){if(self._options.leftBtnClick instanceof Function){self._options.leftBtnClick(self);}},disableClick:function(){if(self._options.leftBtnDisabledClick instanceof Function){self._options.leftBtnDisabledClick(self);}}})).element().appendTo(this._footer);btnCount+=1;}
if(this._options.rightBtnText){(new Mojo.ui.Button(undefined,{text:self._options.rightBtnText,disabled:self._options.rightBtnDisabled,click:function(){if(self._options.rightBtnClick instanceof Function){self._options.rightBtnClick(self);}},disableClick:function(){if(self._options.rightBtnDisabledClick instanceof Function){self._options.rightBtnDisabledClick(self);}}})).element().appendTo(this._footer);btnCount+=1;}
if(true===this._options.showCloseBtn&&btnCount<2){this.closeBtn=new Mojo.ui.Button('close-btn',{text:Mojo.utils.locale('ui','Close'),click:function(){self.close();},});this.closeBtn.element().appendTo(this._footer);btnCount+=1;}},_doApplyForce:function(value){var self=this;var param={force_id:self._force.id,message:value};for(var p in self._options.extraParam){param[p]=self._options.extraParam[p];}
Mojo.ajax('/force/apply',param,function(response){self._dialog.close();if(response.errorCode==0){Mojo.track.onEvent('24_401');Mojo.app.toast.show(Mojo.utils.locale('force','send_already'));self._options.callback();}else{var failDlg=new Mojo.ui.Dialog(undefined,{title:Mojo.utils.locale('force','force_apply_fail',{'__default__':''}),content:$('<div class="tip"></div>').html(response.errorMsg)});new Mojo.ui.Button(undefined,{text:Mojo.utils.locale('common','close'),click:function(){failDlg.close();}}).element().appendTo(failDlg._footer);failDlg.open();}},function(){});},_doPreviewApplyForce:function(){var self=this;var param={force_id:self._force.id,preview:1};Mojo.ajax('/force/apply',param,function(response){if(response.errorCode==0){self._dialog=new Mojo.com.MsgInputDialog({title:Mojo.utils.locale('force','join_apply_force'),defaultText:Mojo.utils.locale('force','join_slogen'),maxlen:100,leftBtnText:Mojo.utils.locale('force','send_apply'),leftBtnClick:function(value){self._doApplyForce(value);}});self._dialog.open();}else{var failDlg=new Mojo.ui.Dialog(undefined,{title:Mojo.utils.locale('force','force_apply_fail',{'__default__':''}),content:$('<div class="tip"></div>').html(response.errorMsg)});new Mojo.ui.Button(undefined,{text:Mojo.utils.locale('common','close'),click:function(){failDlg.close();}}).element().appendTo(failDlg._footer);failDlg.open();}},function(){});},_applyForce:function(){var self=this;self.close();if(self._options.eventStatus!=undefined){self._options.applyClickEvent();}
self._doPreviewApplyForce();},_addItem:function(ele,name,value){$("<div class='h'></div>").appendTo(ele).html(name);$("<div class='v'></div>").appendTo(ele).html(value);},_refresh:function(){var self=this;if(self._options.showApplyBtn==false){return;}
if(self._user.code==2){self.applyBtn.disable(true);self.applyBtn._options.disableClick=function(){self.close();var infoDlg=new Mojo.ui.Dialog(undefined,{title:Mojo.utils.locale('common','tips'),content:$('<div class="paragraph"></div>').html(Mojo.utils.locale('force','already_join_tip',{name:self._user.message}))});new Mojo.ui.Button(undefined,{text:Mojo.utils.locale('common','ok'),click:function(){Mojo.app.redirect('/force');}}).element().appendTo(infoDlg._footer);infoDlg.open();};}},_getDefaultOptions:function(){return $.extend(true,this._super(),{title:Mojo.utils.locale('force','info'),showApplyBtn:true,showCloseBtn:true,dlgType:0,zIndex:1101,confirmClick:$.noop,extraParam:{},callback:$.noop,eventStatus:undefined,applyClickEvent:$.noop,leftBtnText:undefined,leftBtnDisabled:false,leftBtnClick:undefined,leftBtnDisabledClick:undefined,rightBtnText:undefined,rightBtnDisabled:false,rightBtnClick:undefined,rightBtnDisabledClick:undefined});},});})(window,jQuery);;(function(w,$,undefined){w.Mojo=w.Mojo||{};w.Mojo.com=w.Mojo.com||{};w.Mojo.com.ForceList=w.Mojo.ui.ListPanel.extend({clsname:function(){return"com.ForceList";},init:function(id,options){this._super(id,options);this.element().addClass('mojo-com-forcelist');},_getDefaultOptions:function(){var self=this;return $.extend(true,this._super(),{type:'rand',targetForceId:undefined,loadFunc:function(start,count,orderParams){self._options.renderDatacallback();self._retrieveForces(start,count,orderParams);},drawFunc:function(data){return self._drawForce(data);},showMore:false,moreLabel:'',pageSize:10,scrollable:true,emptyLabel:Mojo.utils.locale('force','force_empty'),showBtn:true,btnText:Mojo.utils.locale('common','view'),onBtnClick:$.noop,renderDatacallback:$.noop,afterDataRender:$.noop});},_retrieveForces:function(start,count,orderParams){var self=this;var url=undefined;var params={start:start,count:count};if(self._options.type=='rand'){url='/force/forceListForJoin';}else if(self._options.type=='rank'){url='/force/ranking';if(start+count>100){Mojo.app.toast.show(Mojo.utils.locale('force','force_list_limit'));self._renderData([]);self._more.hide();self.resize();return;}}else if(self._options.type=='battle'){url='/force/battleTargets';if(this._options.targetForceId){params["targetForceId"]=this._options.targetForceId;}}else if(self._options.type=='relation'){if(this._options.masterForceId){params["master_force_id"]=this._options.masterForceId;url='/relation/slavelist';}
if(this._options.slaveForceId){params["slave_force_id"]=this._options.slaveForceId;url='/relation/siblingList';}
if(this._options.allianceForceId){params["alliance_force_id"]=this._options.allianceForceId;url='/relation/allianceList';}
if(this._options.uniteRebelSlaveForceId){url='/forceCrazy/battleResistUnionPartners';}
if(this._options.showGetTaxedGrainContent){url='/relation/collectList';}
if(this._options.targetForceId){params["target_force_id"]=this._options.targetForceId;}
if(this._options.showChooseButton){params["excludes"]=this._options.targetForceId;params["target_force_id"]=undefined;}
params=$.extend(true,params,self._options.params);if(orderParams!=undefined&&orderParams.typeId!=undefined&&orderParams.orderId!=undefined){params["type_id"]=orderParams.type_id;params["order_id"]=orderParams.order_id;}}else if(self._options.type=='allyableforce'){url='/forceCrazy/forceList';params["for"]='alliance';if(this._options.targetForceId){params["excludes"]=this._options.targetForceId;}
params=$.extend(true,params,self._options.params);}else if(self._options.type=='election'){url='/relation/electorList';if(this._options.electionForceId){params["election_force_id"]=this._options.electionForceId;}
if(this._options.electionId){params["election_id"]=this._options.electionId;}
if(this._options.targetForceId){params["target_force_id"]=this._options.targetForceId;}
params=$.extend(true,params,self._options.params);if(orderParams!=undefined&&orderParams.typeId!=undefined&&orderParams.orderId!=undefined){params["type_id"]=orderParams.type_id;params["order_id"]=orderParams.order_id;}}else if(self._options.type=='forceinfo'){url='/forceCrazy/forceInfo';if(this._options.ids){params["ids"]=this._options.ids;}}else if(self._options.type=='crazyforce'){if(self._options.listData){url=undefined;setTimeout(function(){self._renderData(self._options.listData);self._options.listData=undefined;},0);}else{url='/forceCrazy/forceList';params['for']=self._options.purpose;}}else if(self._options.type=='search'){url='/force/search';$.extend(true,params,self._options.forceSearchByLevelParams);}
if(url!=undefined){Mojo.ajax(url,params,function(response){if(response.errorCode==0){if(response.data==undefined){self._renderData(response.data);if(self._options.type=='rank'){Mojo.app.toast.show(Mojo.utils.locale('force','force_list_more'));self._more.hide();self.resize();}
return;}
if($.isArray(response.data)){self._renderData(response.data);}else if(response.data&&$.isArray(response.data.list)){self._renderData(response.data.list);}}else{if(self._options.erroCallback!=undefined&&self._options.erroCallback instanceof Function){self._options.erroCallback(response);}}},function(e){});}},_renderData:function(forces){var self=this;if(forces==undefined){forces=this._options.forceArray;}else if(this._options.forceArray!=undefined&&Array.isArray(this._options.forceArray)){forces=this._options.forceArray.concat(forces);}
this.appendData(forces,true);this._options.afterDataRender();if(this._options.alwaysMore==true||(this._options.showMore&&forces&&forces.length>=this._options.pageSize)){this._more.show();}
if(this._options.getEntityList!=undefined&&forces!=undefined){this._options.getEntityList(forces,forces.length==0);}
self.resize();if(this._options.callback!=undefined&&this._options.callback instanceof Function){this._options.callback(self,forces);}},_drawForce:function(data){var self=this;return new Mojo.com.ForceElement(data,{type:self._options.type,showRank:self._options.type=='rank'||self._options.showRank==true,showBtn:self._options.showBtn,showForceRest:self._options.showForceRest,btnText:self._options.btnText,forceId:self._options.electionForceId,showBattleStatusAndAssistBtn:self._options.showBattleStatusAndAssistBtn,showGetTaxedGrainContent:self._options.showGetTaxedGrainContent,notShowForceMember:self._options.notShowForceMember,addGetTaxedButton:self._options.addGetTaxedButton,assistButtonText:self._options.assistButtonText,specialClass:self._options.specialClass,onBtnClick:self._options.onBtnClick,callback:$.noop,showChooseButton:self._options.showChooseButton,showUniteRebelStatus:self._options.showUniteRebelStatus,inDefence:self._options.inDefence,chooseClick:function(forceData){self._options.chooseClick(forceData);},});},});})(window,jQuery);;(function(w,$,undefined){w.Mojo=w.Mojo||{};w.Mojo.com=w.Mojo.com||{};w.Mojo.com.ForceBaseProfile=w.Mojo.Object.extend({clsname:function(){return"com.ForceBaseProfile";},init:function(options){this._super('com-profile-base',options);this.element().addClass('mojo-com-profile-base');this.element().addClass('mojo-com-force-profile');this.element().append('<div class="left"></div><div class="center"></div><div class="right"></div>');this._addLeft();this._addCenter();this._addRight();var self=this;this._force={};this._player={};this._syncHandles=[];this._syncInterval=w.setInterval(function(){self.sync();},60000);this._restoreInterval=w.setInterval(function(){self._calcSp();self._calcAvoidWarTime();},1000);this.element().click(function(){Mojo.track.onEvent('04_021');(this._bpdlg=new Mojo.com.BaseProfileDialog({dataProvider:function(){return self._player;}})).open();this._bpdlg._scroll.refresh();});},updatePlayerDiff:function(player){for(var a in player){if(this._player.hasOwnProperty(a)&&this.isaN(this._player[a])&&this.isaN(player[a])){this._player[a]=parseInt(this._player[a])+parseInt(player[a]);}}},updateForceDiff:function(force){for(var a in force){if(this._force.hasOwnProperty(a)&&this.isaN(this._force[a])&&this.isaN(force[a])){this._force[a]=parseInt(this._force[a])+parseInt(force[a]);}}},isaN:function(v){return parseInt(v)!=NaN;},_getDefaultOptions:function(){return{refreshCallback:$.noop,getController:$.noop,profileUpdate:$.noop};},_addLeft:function(){var left=this.element().find('.left');this._name=$('<div class="name"></div>').appendTo(left);this._level=$('<div class="level">0</div>').appendTo(left);this._xp=new Mojo.ui.Progress(undefined,{classes:['xp'],labelTemplate:'#{divide}',});this._xp.element().appendTo(left);$('<div class="xp-border"></div>').appendTo(left);},_addCenter:function(){this._rm=new Mojo.ui.Label(undefined,{classes:['rm'],text:'0',});this._vm=new Mojo.ui.Label(undefined,{classes:['vm'],text:'0',});this.element().find('.center').append(this._rm.element()).append(this._vm.element());},_addRight:function(){this._grain=new Mojo.ui.Label(undefined,{classes:['grain'],text:''});this._sp=new Mojo.ui.Progress(undefined,{classes:['sp'],labelTemplate:'#{divide}',});this.element().find('.right').append(this._grain.element()).append(this._sp.element()).append($('<div class="sp-border"></div>'));},_refresh:function(){var self=this;this._name.html(self._player.name);this._level.html(self._player.level);this._xp.value({value:self._player.xp,max:self._player.next_xp});this._rm.text(self._player.rm);this._vm.text(self._player.vm);this._grain.text(self._player.grain);this._sp.value({value:self._player.sp,max:self._player.stamina});},data:function(data){var self=this;if(data==undefined){return;}
var force_info=data.force_info||{};force_info.force_chat=data.force_chat;var player_info=data.player_info||{};this._force=$.extend(true,this._force,force_info);this._player=$.extend(true,this._player,player_info);this._refresh();this._options.profileUpdate(this._force,this._player);var c=Mojo.page.Force.getController()._current;if(c!=undefined&&c._options.getComIndex()==2&&c.inbattle){return;}
if(!Mojo.utils.isNone(data.event)){var evt=data.event;var t=evt.type;if(t==15){var content=$('<div class="paragraph"></div>').html(Mojo.utils.locale('force','forcewar_notice_members1',{title:evt.title,ownername:evt.userName,forcename:evt.opponentForceName}));var dlg=new Mojo.com.CommonDialog(undefined,{classes:['mojo-com-forcemsgdlg'],title:Mojo.utils.locale('force','force_message'),content:content,leftBtnText:Mojo.utils.locale('ui','In War'),leftBtnClick:function(that){that.close();Mojo.page.Force.getController().switchTo(2);},rightBtnText:Mojo.utils.locale('ui','View More'),rightBtnClick:function(that){that.close();Mojo.page.Force.getController().switchTo(5);}});dlg.open();}else if(t==11){var content=$('<div class="paragraph"></div>').html(Mojo.utils.locale('force','forcewar_win_grain',{forcename:evt.opponentForceName,grain:evt.grainCount}));var dlg=new Mojo.com.CommonDialog(undefined,{title:Mojo.utils.locale('force','force_message'),content:content,leftBtnText:Mojo.utils.locale('ui','View More'),leftBtnClick:function(){dlg.close();Mojo.page.Force.getController().switchTo(5);},rightBtnText:Mojo.utils.locale('ui','Close'),rightBtnClick:function(){dlg.close();}});dlg.open();}else if(t==13){var content=$('<div class="paragraph"></div>').html(Mojo.utils.locale('force','forcewar_lose_grain',{forcename:evt.opponentForceName,grain:evt.grainCount}));var dlg=new Mojo.com.CommonDialog(undefined,{title:Mojo.utils.locale('force','force_message'),content:content,leftBtnText:Mojo.utils.locale('ui','Retaliate'),leftBtnClick:function(){dlg.close();Mojo.page.Force.getController().switchTo(2,{target_force_id:evt.attacker_id});},rightBtnText:Mojo.utils.locale('ui','View More'),rightBtnClick:function(){dlg.close();Mojo.page.Force.getController().switchTo(5);}});dlg.open();}else if(t==800||t==300||t==314||t==210||t==301||t==383||t==200){var dlg=new Mojo.com.CommonDialog(undefined,{classes:['mojo-com-forcemsgdlg'],title:evt.header,content:$('<div class="paragraph"></div>').html(evt.content),leftBtnText:Mojo.utils.locale('ui','In War'),leftBtnClick:function(that){that.close();Mojo.app.redirect('/force',{index:2});},rightBtnText:Mojo.utils.locale('common','close'),rightBtnClick:function(that){that.close();}});dlg.open();}else if(t==81){var dlg=new Mojo.com.CommonDialog(undefined,{classes:['mojo-com-forcemsgdlg'],title:evt.header,content:$('<div class="paragraph"></div>').html(evt.content),leftBtnText:Mojo.utils.locale('ui','In War2'),leftBtnClick:function(that){that.close();Mojo.app.redirect('/force',{index:1,selected:1});},rightBtnText:Mojo.utils.locale('common','close'),rightBtnClick:function(that){that.close();}});dlg.open();}}
return{player:self.player,force:self.force};},syncForce:function(callback){var self=this;Mojo.ajax('/force/forceProfile',{},function(response){if(response&&response.errorCode==0){var data={};data.force_info=response.data;self.data(data);for(var handleIndex in self._syncHandles){var syncHandleFunc=self._syncHandles[handleIndex];if(syncHandleFunc instanceof Function){syncHandleFunc({force_info:self._force});}}
if(callback instanceof Function){callback(response.data);}}else if(callback instanceof Function){callback(self.data());}},function(){if(callback instanceof Function){callback(self.data());}});},sync:function(callback){var self=this;Mojo.ajax('/force/index',{},function(response){if(response&&response.errorCode==0){self.data(response.data);for(var handleIndex in self._syncHandles){var syncHandleFunc=self._syncHandles[handleIndex];if(syncHandleFunc instanceof Function){syncHandleFunc(response.data);}}
if(callback instanceof Function){callback(response.data);}}else if(callback instanceof Function){callback(self.data());}},function(){if(callback instanceof Function){callback(self.data());}});},addSyncHandle:function(syncHandleFunc){this._syncHandles.push(syncHandleFunc);},_calcSp:function(){if(this._player.sp<this._player.stamina){if(this._player.sp_second<0){this._player.sp_second=this._player.sp_restore_pp;return;}
this._player.sp_second--;if(this._player.sp_second==0){this._player.sp_second=this._player.sp_restore_pp;this._player.sp++;this._refresh();}}},_calcAvoidWarTime:function(){if(this._player.avoid_war_time>0){this._player.avoid_war_time--;}},});})(window,jQuery);;(function(w,$,undefined){w.Mojo=w.Mojo||{};w.Mojo.com=w.Mojo.com||{};w.Mojo.com.ForceProfileDialog=w.Mojo.ui.Dialog.extend({clsname:function(){return"com.ForceProfileDialog";},init:function(force,player,options){var self=this;this._super(undefined,options);this._force=force;this._player=player;this.element().addClass('mojo-com-forceprofiledlg');this._paragraph=$('<div class="paragraph"></div>').appendTo(this._content);this._addContent();this._scroll=new Mojo.ui.Scroll(undefined,this._content,{direction:2,});this.element().append(this._scroll.element());this._addButtons();this._addChanllenge();this._addForceBuff();this._interval=w.setInterval(function(){self._refresh();},1000);},_addContent:function(){var self=this;this._addLabel('name',this._force.name);this._addLabel('profile_level',this._force.level);var update=parseInt(this._force.grain_for_next_level);this._addLabel('update_grain',update!=0?this._force.grain_for_next_level:Mojo.utils.locale('force','level_full'));this._addLabel('have_grain',{grain:self._force.grain,safe_grain:self._force.grain_protected});this._addLabel('count_member',this._force.member_num+"/"+this._force.member_num_limit);this._addLabel('force_owner',this._force.owner.name);if(this._force.vice_owner!=null&&this._force.vice_owner!=undefined){this._addLabel('force_vice_owner',this._force.vice_owner.name);}else{this._addLabel('force_vice_owner',Mojo.utils.locale('force','position_empty'));}
this._addLabel('count_officer_1',this._force.first_class_officer_num+"/"+this._force.first_class_officer_num_limit);this._addLabel('count_officer_2',this._force.second_class_officer_num+"/"+this._force.second_class_officer_num_limit);this._addLabel('count_officer_3',this._force.third_class_officer_num+"/"+this._force.third_class_officer_num_limit);},_addChanllenge:function(){this._chanllegecount=new Mojo.ui.Label(undefined,{text:Mojo.utils.locale('force','count_challenge')+this._force.challenge+"/"+this._force.challenge_limit}).element().appendTo(this._paragraph);this._chanllenge=$('<div class="chanllenge"></div>').appendTo(this._paragraph);var nextHtml=Mojo.utils.locale('force','next_chanllenge_get')+this._getNextSpTime();var fullHtml=Mojo.utils.locale('force','all_chanllenge_get')+this._getFullSpTime();this._chanllenge.html(nextHtml+"<br>"+fullHtml);this._grain=$("<div class='grain'></div>").appendTo(this._paragraph);var position=parseInt(this._player.position_id);var isincd=true;if(this._force.time_to_assign_grain<=0){this._grain.empty();isincd=false;}else{this._grain.html(Mojo.utils.locale('force','grain_share_cdtip')+this._formatCDTime(this._force.time_to_assign_grain));}
if(position==1&&isincd==true){this.grainBtn.disable(true);this.grainBtn._options.disableClick=function(){Mojo.app.toast.show(Mojo.utils.locale('force','graun_share_cd_no'));};}else{if(position==1){this.grainBtn.disable(false);}else{this.grainBtn.disable(true);this.grainBtn._options.disableClick=function(){Mojo.app.toast.show(Mojo.utils.locale('force','salary_only_owner'));};}}},_formatCDTime:function(sec){var str='';var dd=parseInt(sec/86400);var hh=parseInt((sec%86400)/3600);var mm=parseInt((sec%3600)/60);var ss=sec%60;if(dd>0){str=dd+Mojo.utils.locale('common','day')+hh+Mojo.utils.locale('common','hour');}else if(hh>0){str=hh+Mojo.utils.locale('common','hour')+mm+Mojo.utils.locale('common','minute');}else if(mm>0){str=mm+Mojo.utils.locale('common','minute')+ss+Mojo.utils.locale('common','second');}else{str=ss+Mojo.utils.locale('common','second');}
return str;},_refresh:function(){this._force=this._options.getData();this._grain.remove();this._chanllenge.remove();this._chanllegecount.remove();this._addChanllenge();if(this._forcebuff!=undefined&&this._forcebuffs!=undefined){this._forcebuff.remove();this._forcebuffs.remove();}
this._addForceBuff();},_getNextSpTime:function(){var str=undefined;if(this._force.challenge==this._force.challenge_limit){str=Mojo.utils.locale('common','has reached the maximum');}else{str=Mojo.utils.formatTime(this._force.challenge_second);}
return str;},_getFullSpTime:function(){var str=undefined;if(this._force.challenge==this._force.challenge_limit){str=Mojo.utils.locale('common','has reached the maximum');}else{str=Mojo.utils.formatTime((this._force.challenge_limit-this._force.challenge-1)*parseInt(this._force.cd_challange)+this._force.challenge_second);}
return str;},_addLabel:function(name,value){var self=this;var disp_text=undefined;if(typeof value=="object"){disp_text=Mojo.utils.locale('force',name,value);}else{disp_text=Mojo.utils.locale('force',name)+value;}
new Mojo.ui.Label(undefined,{text:disp_text,}).element().appendTo(this._paragraph);},_addButtons:function(){var self=this;this.updateBtn=new Mojo.ui.Button('update-btn',{special:'button-big-red',text:Mojo.utils.locale('force','update'),click:function(){self._updateForce();},disableClick:function(){Mojo.app.toast.show(Mojo.utils.locale('force','update_only_owner'));}});this.updateBtn.element().appendTo(this._footer);this.grainBtn=new Mojo.ui.Button('grain-btn',{text:Mojo.utils.locale('force','share_grain'),click:function(){self._shareGrain();},disableClick:function(){Mojo.app.toast.show(Mojo.utils.locale('force','salary_only_owner'));}});this.grainBtn.element().appendTo(this._footer);var position=parseInt(this._player.position_id);if(position!=1){this.updateBtn.disable(true);this.grainBtn.disable(true);}else{var update=parseInt(this._force.grain_for_next_level);if(update==0){this.updateBtn.disable(true);this.updateBtn._options.disableClick=function(){Mojo.app.toast.show(Mojo.utils.locale('force','level_full_tip'));};}}},_addForceBuff:function(){var self=this;if(this._force!=undefined&&this._force.buffs!=undefined&&this._force.buffs.title!=undefined&&this._force.buffs.title!=""){this._forcebuff=new Mojo.ui.Label(undefined,{text:Mojo.utils.locale('force','forcebuff')+this._force.buffs.title}).element().appendTo(this._paragraph);var forcebuffs='';$.each(this._force.buffs.list,function(i,f){forcebuffs+='&#149'+f.name+''+f.desc+"</br>";});this._forcebuffs=$("<span class='chanllenge'></span>").html(forcebuffs).appendTo(this._paragraph);}},_updateForce:function(){var self=this;self.updateBtn._options.disableClick=function(){};self.updateBtn.disable(true);Mojo.ajax('/force/levelUpPreview',{forceid:self._force.id},function(response){self.close();if(response.errorCode==0){new Mojo.com.ForceUpdateDialog(self._force,response.data,{getController:function(){return self._options.getController();}}).open();}},function(){});},_shareGrain:function(){this.close();var self=this;new Mojo.com.ForceGrainShareDlg(this._force,{getController:function(){return self._options.getController();}}).open();},_getDefaultOptions:function(){var self=this;return $.extend(true,this._super(),{title:Mojo.utils.locale('force','base_info'),dlgType:0,zIndex:1101,confirmClick:$.noop,getController:$.noop,close:function(){w.clearInterval(self._interval);},});},});})(window,jQuery);;(function(w,$,undefined){w.Mojo=w.Mojo||{};w.Mojo.com=w.Mojo.com||{};w.Mojo.com.BaseProfileDialog=w.Mojo.ui.Dialog.extend({clsname:function(){return"com.BaseProfileDialog";},init:function(options){this._super('com-profile-base-dialog',options);this.element().addClass('mojo-com-profile-base-dialog');var self=this;this._interval=w.setInterval(function(){self._refresh();},1000);this._tips=$('<div class="paragraph"></div>').appendTo(this._content);this._refresh();this._scroll=new Mojo.ui.Scroll(undefined,this._content,{direction:2,});this.element().append(this._scroll.element());this._footer.append((new Mojo.ui.Button(undefined,{special:'button-big-red',text:Mojo.utils.locale('common','Go Statistics'),click:function(){Mojo.app.redirect('/statistics',{},'event','04_022');},})).element());this._footer.append((new Mojo.ui.Button(undefined,{text:Mojo.utils.locale('common','close'),click:function(){self.close();},})).element());},_getDefaultOptions:function(){var self=this;return $.extend(true,this._super(),{dataProvider:$.noop,title:Mojo.utils.locale('ui','Base Informations'),close:function(){w.clearInterval(self._interval);}});},_refresh:function(){var data=this._options.dataProvider();this._tips.empty();this._genTooltip(data);},_genTooltip:function(data){new Mojo.ui.Label(undefined,{classes:['name'],text:Mojo.utils.locale('common','name')+data.name}).element().appendTo(this._tips);new Mojo.ui.Label(undefined,{classes:['playid'],text:Mojo.utils.locale('common','playerId')+data.id}).element().appendTo(this._tips);new Mojo.ui.Label(undefined,{classes:['level'],text:Mojo.utils.locale('common','level')+data.level}).element().appendTo(this._tips);if(data.xp>data.next_xp){data.xp=data.next_xp;}
new Mojo.ui.Label(undefined,{classes:['xp'],text:Mojo.utils.locale('common','xp')+data.xp+"/"+data.next_xp}).element().appendTo(this._tips);new Mojo.ui.Label(undefined,{classes:['rm'],text:Mojo.utils.locale('common','rm')+data.rm}).element().appendTo(this._tips);new Mojo.ui.Label(undefined,{classes:['vm'],text:Mojo.utils.locale('common','vm')+data.vm}).element().appendTo(this._tips);new Mojo.ui.Label(undefined,{classes:['grain'],text:Mojo.utils.locale('common','grain')+data.grain}).element().appendTo(this._tips);new Mojo.ui.Label(undefined,{classes:['ep'],text:Mojo.utils.locale('common','ep')+data.ep+"/"+data.energy}).element().appendTo(this._tips);var time4ep=Mojo.utils.locale('common','time for next ep')+this._genEpRestore(data)+"<br>"+Mojo.utils.locale('common','time for all ep')+this._genEpFullRestore(data)+(data.ep_percent>0?('<br>'+Mojo.utils.locale('common','acceleration for restore ep')+data.ep_percent+"%"):'');$("<span class='time-for-ep'></span>").appendTo(this._tips).html(time4ep);new Mojo.ui.Label(undefined,{classes:['sp'],text:Mojo.utils.locale('common','sp')+data.sp+"/"+data.stamina}).element().appendTo(this._tips);var time4sp=Mojo.utils.locale('common','time for next sp')+this._genSpRestore(data)+"<br>"+Mojo.utils.locale('common','time for all sp')+this._genSpFullRestore(data)+(data.sp_percent>0?('<br>'+Mojo.utils.locale('common','acceleration for restore sp')+data.sp_percent+"%"):'');$("<span class='time-for-sp'></span>").html(time4sp).appendTo(this._tips);new Mojo.ui.Label(undefined,{classes:['avoid_war_time'],text:Mojo.utils.locale('common','avoid war time',{avoid_war_time:Mojo.utils.formatTime(data.avoid_war_time)})}).element().appendTo(this._tips);if(data!=undefined&&data.buffs!=undefined&&data.buffs.title!=undefined&&data.buffs.title!=""){new Mojo.ui.Label(undefined,{classes:['userbuff'],text:Mojo.utils.locale('common','userbuff')+data.buffs.title,}).element().appendTo(this._tips);var userbuffs='';$.each(data.buffs.list,function(i,u){userbuffs+='&#149'+u.name+''+u.desc+"</br>";});$("<span class='userbuffs'></span>").html(userbuffs).appendTo(this._tips);}},_genSpRestore:function(data){var str=undefined;if(data.sp==data.stamina){str=Mojo.utils.locale('common','has reached the maximum');}else{str=Mojo.utils.formatTime(data.sp_second);}
return str;},_genSpFullRestore:function(data){var str=undefined;if(data.sp==data.stamina){str=Mojo.utils.locale('common','has reached the maximum');}else{str=Mojo.utils.formatTime((data.stamina-data.sp-1)*data.sp_restore_pp+data.sp_second);}
return str;},_genEpRestore:function(data){var str=undefined;if(data.ep==data.energy){str=Mojo.utils.locale('common','has reached the maximum');}else{str=Mojo.utils.formatTime(data.ep_second);}
return str;},_genEpFullRestore:function(data){var str=undefined;if(data.ep==data.energy){str=Mojo.utils.locale('common','has reached the maximum');}else{str=Mojo.utils.formatTime((data.energy-data.ep-1)*data.ep_restore_pp+data.ep_second);}
return str;},});})(window,jQuery);;(function(w,$,undefined){w.Mojo=w.Mojo||{};w.Mojo.com=w.Mojo.com||{};w.Mojo.com.ForceUpdateDialog=w.Mojo.ui.Dialog.extend({clsname:function(){return"com.ForceUpdateDialog";},init:function(data,preview,options){this._super(undefined,options);this._force=data;this._preview=preview;this.element().addClass('mojo-com-forceupdatedlg');this._paragraph=$("<div class='paragraph'></div>").appendTo(this._content);this._addContent();},title:function(titletext){if(this._options.noTitle==false){this.element().find('.title').html(titletext);}},_addContent:function(){this._grainEnouph();},_addButton:function(){var self=this;this.okBtn=new Mojo.ui.Button(undefined,{text:Mojo.utils.locale('common','ok'),special:'button-big-red',click:function(){self._confirmUpdate();}});this.okBtn.element().appendTo(this._footer);new Mojo.ui.Button(undefined,{text:Mojo.utils.locale('common','close'),click:function(){self.close();}}).element().appendTo(this._footer);},_grainNotEnouph:function(){var self=this;var infoDlg=new Mojo.ui.Dialog(undefined,{title:Mojo.utils.locale('common','tips'),content:$("<div class='paragraph'></div>").html(Mojo.utils.locale('force','grain_not_enouph')),deviceaware:true});new Mojo.ui.Button(undefined,{text:Mojo.utils.locale('force','internal'),special:'button-big-red',click:function(){infoDlg.close();self._options.getController().switchTo(1);}}).element().appendTo(infoDlg._footer);new Mojo.ui.Button(undefined,{text:Mojo.utils.locale('force','foreign'),click:function(){infoDlg.close();self._options.getController().switchTo(2);}}).element().appendTo(infoDlg._footer);infoDlg.open();},_grainEnouph:function(){this.title(Mojo.utils.locale('force','update_force'));var self=this;self._refresh();this._addButton();},_refresh:function(){var self=this;self._paragraph.empty();$('<div class="tip"></div>').appendTo(this._paragraph).html(Mojo.utils.locale('force','update_tip'));var preview=self._preview;this._addLabel('force_level',preview.level[0],preview.level[1]);if(preview.grain[0]!=preview.grain[1]){if(parseInt(preview.grain[1])<0){new Mojo.ui.Label(undefined,{text:Mojo.utils.locale('force','force_grain')+"<span>"+Mojo.utils.locale('force','lake_grain')+"</span>"}).element().appendTo(this._paragraph);}else{this._addLabel('force_grain',preview.grain[0],preview.grain[1]);}}
if(preview.member_num[0]!=preview.member_num[1]){this._addLabel('member_max',preview.member_num[0],preview.member_num[1]);}
if(preview.owner_title[0]!=preview.owner_title[1]){this._addLabel('owner_title',preview.owner_title[0],preview.owner_title[1]);}
if(preview.first_class_officer_num[0]!=preview.first_class_officer_num[1]){this._addLabel('count_officer_1',preview.first_class_officer_num[0],preview.first_class_officer_num[1]);}
if(preview.second_class_officer_num[0]!=preview.second_class_officer_num[1]){this._addLabel('count_officer_2',preview.second_class_officer_num[0],preview.second_class_officer_num[1]);}
if(preview.third_class_officer_num[0]!=preview.third_class_officer_num[1]){this._addLabel('count_officer_3',preview.third_class_officer_num[0],preview.third_class_officer_num[1]);}
if(preview.lodgment_num_limit[0]!=preview.lodgment_num_limit[1]){this._addLabel('position_count',preview.lodgment_num_limit[0],preview.lodgment_num_limit[1]);}},_confirmUpdate:function(){this.okBtn.disable(true);if(parseInt(this._preview.grain[1])<0){this.close();this._grainNotEnouph();return;}
var self=this;Mojo.ajax('/force/levelup',{force_id:this._force.id},function(response){if(response.errorCode==0){self.close();Mojo.track.onEvent('24_501');self._options.getController().sync();new Mojo.com.ForceLevelUpDialog(response,{}).open();}else{}},function(){});},_addLabel:function(name,value,nextvalue){var self=this;new Mojo.ui.Label(undefined,{text:Mojo.utils.locale('force',name)+value+"  <span>"+nextvalue+"</span>"}).element().appendTo(this._paragraph);},_getDefaultOptions:function(){return $.extend(true,this._super(),{title:Mojo.utils.locale('common','tips'),dlgType:0,zIndex:1101,confirmClick:$.noop,getController:$.noop,deviceaware:true});},});})(window,jQuery);;(function(w,$,undefined){w.Mojo=w.Mojo||{};w.Mojo.com=w.Mojo.com||{};w.Mojo.com.ForceLevelUpDialog=w.Mojo.ui.Dialog.extend({clsname:function(){return"com.ForceLevelUpDialog";},init:function(response,options){this._data=response.data;this._event=response.event;this._super(undefined,options);this.element().addClass('mojo-com-forcelevelupdlg');this.element().addClass('mojo-com-forcelevelupdlg-'+Mojo.app.data.userLanguage);this._platform=Mojo.app.getPlatform();this._addContent();this._addHandleButtons();},_addContent:function(){this._message=$('<div class="paragraph"></div>').appendTo(this._content);var force=this._data;$("<div class='info'></div>").appendTo(this._message).html(Mojo.utils.locale('force','leve_updated',{level:force.level[1]}));this._addLabel('force_level',force.level[0],force.level[1]);if(this._isDataChanged(force.member_num)){this._addLabel('member_max',force.member_num[0],force.member_num[1]);}
if(this._isDataChanged(force.owner_title)){this._addLabel('owner_title',force.owner_title[0],force.owner_title[1]);}
if(this._isDataChanged(force.first_class_officer_num)){this._addLabel('count_officer_1',force.first_class_officer_num[0],force.first_class_officer_num[1]);}
if(this._isDataChanged(force.second_class_officer_num)){this._addLabel('count_officer_2',force.second_class_officer_num[0],force.second_class_officer_num[1]);}
if(this._isDataChanged(force.third_class_officer_num)){this._addLabel('count_officer_3',force.third_class_officer_num[0],force.third_class_officer_num[1]);}
if(this._isDataChanged(force.lodgment_num_limit)){this._addLabel('position_count',force.lodgment_num_limit[0],force.lodgment_num_limit[1]);}},_isDataChanged:function(attr){if(attr&&attr.length>1){return attr[0]!=attr[1];}
return false;},_addLabel:function(name,value,newvalue){var self=this;new Mojo.ui.Label(undefined,{text:Mojo.utils.locale('force',name)+value+'  <span>'+newvalue+'</span>'}).element().appendTo(this._message);},_addHandleButtons:function(){var self=this;self._options.btnClick=function(){self.close();};var platformBtn=new Mojo.com.PlatformButton(self._event,self._options);this._footer.append(platformBtn.element());this._footer.append((new Mojo.ui.Button('close-btn',{text:Mojo.utils.locale('common','close'),click:function(){self.close();},})).element());},_getDefaultOptions:function(){return $.extend(true,this._super(),{noTitle:true,zIndex:1101,});},});})(window,jQuery);;;(function(w,$){w.Mojo=w.Mojo||{};w.Mojo.com=w.Mojo.com||{};w.Mojo.com.GrainShareConfirmDlg=w.Mojo.ui.Dialog.extend({init:function(data,options){this._super(undefined,options);this._data=data;this._paragraph=$("<div class='paragraph'></div>").appendTo(this._content);this._addContent();this._addButtons();},_addContent:function(){var l=Mojo.utils.locale;var s=this;new Mojo.ui.Label(undefined,{classes:['tips'],text:l('force','grain_share_confirm')}).element().appendTo(s._paragraph);s._addLabel('owner',l('force','info_owner'),s._data["info_owner"]);s._addLabel('vice_owner',l('force','info_vice_owner'),s._data["info_vice_owner"]);s._addLabel('first',l('force','officer_first'),s._data["officer_first"]);s._addLabel('second',l('force','officer_second'),s._data["officer_second"]);s._addLabel('third',l('force','officer_third'),s._data["officer_third"]);s._addLabel('member',l('force','info_member'),s._data["info_member"]);new Mojo.ui.Label(undefined,{classes:['cd'],text:l('force','grain_share_cd')}).element().appendTo(s._paragraph);},_addLabel:function(cls,text,val){var l=$("<div class='mem'></div>").appendTo(this._paragraph);var t=$("<div class='tit'></div>").html(text);var v=$("<div class='val'></div>").html(val);l.append(t).append(v);},_doShare:function(data){var self=this;Mojo.ajax("/force/assignGrain",{'owner':data["info_owner"],'vice_owner':data["info_vice_owner"],'first_class_officer':data["officer_first"],'second_class_officer':data["officer_second"],'third_class_officer':data["officer_third"],'member':data["info_member"],},function(response){self.close(true);if(response.errorCode==0){Mojo.track.onEvent('24_502');var infoDlg=new Mojo.ui.Dialog(undefined,{title:Mojo.utils.locale('common','tips'),classes:['tip-dialog'],content:$("<div class='paragraph'></div>").html(Mojo.utils.locale('force','grain_succ'))});new Mojo.ui.Button(undefined,{text:Mojo.utils.locale('common','close'),click:function(){infoDlg.close();}}).element().appendTo(infoDlg._footer);infoDlg.open();}else{var errDlg=new Mojo.ui.Dialog(undefined,{title:Mojo.utils.locale('common','tips'),classes:['tip-dialog'],content:$("<div class='paragraph'></div>").html(response.errorMsg)});new Mojo.ui.Button(undefined,{text:Mojo.utils.locale('common','close'),click:function(){errDlg.close();}}).element().appendTo(errDlg._footer);errDlg.open();}},function(){},{showWait:true});},_addButtons:function(){var self=this;new Mojo.ui.Button(undefined,{special:'button-big-red',text:Mojo.utils.locale('common','ok'),click:function(){self._doShare(self._data);}}).element().appendTo(this._footer);new Mojo.ui.Button(undefined,{text:Mojo.utils.locale('common','close'),click:function(){self.close();}}).element().appendTo(this._footer);},close:function(isSucc){this._super();this._options.afterClose(isSucc);},_getDefaultOptions:function(){return $.extend(true,this._super(),{afterClose:$.noop,noOverlay:true,title:Mojo.utils.locale('common','tips')});}});w.Mojo.com.ForceGrainShareDlg=w.Mojo.ui.Dialog.extend({init:function(data,options){this._super(undefined,options);this._force=data;this.element().addClass('mojo-com-forcegrainsharedlg');this._paragraph=$("<div class='paragraph'></div>").appendTo(this._content);this._addContent();this._addButtons();},_addContent:function(){var self=this;this._paragraph=$("<div class='paragraph'></div>").appendTo(this._paragraph);$('<div id="lastgrain" class="lastgrain"><div>').appendTo(this._paragraph).html(Mojo.utils.locale('force','last_grain')+this._force.grain);this._addInput('info_owner',1);this._addInput('info_vice_owner',Mojo.utils.isNone(this._force.vice_owner)?0:1);this._addInput('officer_first',this._force.first_class_officer_num);this._addInput('officer_second',this._force.second_class_officer_num);this._addInput('officer_third',this._force.third_class_officer_num);this._addInput('info_member',parseInt(this._force.member_num)-this._force.officer_num);this._paragraph.find('.shareitem .input input').click(function(){this.selectionStart=0;this.selectionEnd=this.value.length;});this._paragraph.find('.shareitem .input input').bind("change paste keyup input",function(){self._checkInput();});},_reset:function(){var self=this;self._invalid=false;self.okBtn.disable(false);self._paragraph.find('#lastgrain').removeClass('lake');self.okBtn.element().removeClass('err');},_checkInput:function(){var self=this;self._reset();var total=0;self._paragraph.find('.shareitem .input input').each(function(i,e){var v=$(e).val().trim();if(self._isValid(v)){var i=v==""?0:parseInt($(e).val(),10);var c=parseInt($(e).attr('c'),10);total=total+i*c;}else{self._invalid=true;return false;}});if(self._invalid){self.okBtn.disable(true);self.okBtn.element().addClass('err');}else{var last=self._force.grain-total;self._paragraph.find('#lastgrain').html(Mojo.utils.locale('force','last_grain')+last);if(last<0){self.okBtn.disable(true);self._paragraph.find('#lastgrain').addClass('lake');}
if(total==0){self.okBtn.disable(true);self.okBtn.element().addClass('err');}}},_isValid:function(v){var regex=/^\d{1,5}$/;return regex.test(v);},_addInput:function(label,count){var element=$("<div class='shareitem'></div>");$("<div class='label'></div>").html(Mojo.utils.locale('force',label)).appendTo(element);var inputarea=$("<div class='input'></div>");var _input=$("<input type='text' maxlength='5' value='0'/>");_input.attr('name',label);_input.attr('c',count);if(count==0)
_input.attr("disabled","disabled");_input.appendTo(inputarea);inputarea.html(inputarea.html()+Mojo.utils.locale('force','force_num',{'count':count}));inputarea.appendTo(element);element.appendTo(this._paragraph);},_isTotalValid:function(data){var i=0;for(var k in data){i=i+data[k];}
if(i>0){return true;}else{this.okBtn.disable(true);this.okBtn.element().addClass('err');return false;}},_addButtons:function(){var self=this;self.okBtn=new Mojo.ui.Button(undefined,{special:'button-big-red',text:Mojo.utils.locale('common','ok'),disableClick:function(){if(self.okBtn.element().hasClass('err')){if(self._invalid==true){Mojo.app.toast.show(Mojo.utils.locale('force','grain_input_err'));}else{Mojo.app.toast.show(Mojo.utils.locale('force','grain_not_input'));}}else{Mojo.app.toast.show(Mojo.utils.locale('force','grain_share_fail'));}},click:function(){self.okBtn.element().trigger("focus");self._shareGrainConfirm();}});self.okBtn.element().appendTo(this._footer);self.okBtn.disable(true);self.okBtn.element().addClass('err');new Mojo.ui.Button(undefined,{text:Mojo.utils.locale('common','close'),click:function(){self.close();}}).element().appendTo(this._footer);},_hideShareDlg:function(){this.element().hide();},_showShareDlg:function(){this.element().show();},_shareGrainConfirm:function(){var self=this;var data={};data["info_owner"]=self._paragraph.find('input[name="info_owner"]').val();data["info_vice_owner"]=self._paragraph.find('input[name="info_vice_owner"]').val();data["officer_first"]=self._paragraph.find('input[name="officer_first"]').val();data["officer_second"]=self._paragraph.find('input[name="officer_second"]').val();data["officer_third"]=self._paragraph.find('input[name="officer_third"]').val();data["info_member"]=self._paragraph.find('input[name="info_member"]').val();if(!self._isTotalValid(data)){return;}
self._hideShareDlg();var confirmDlg=new Mojo.com.GrainShareConfirmDlg(data,{afterClose:function(isSucc){if(isSucc){self._options.getController().sync();self.close();}else{self._showShareDlg();}}});confirmDlg.open(true);setTimeout(function(){Mojo.utils.center(confirmDlg.element());},100);},_getDefaultOptions:function(){return $.extend(true,this._super(),{title:Mojo.utils.locale('force','share_grain')});},});})(window,jQuery);;(function(w,$,undefined){w.Mojo=w.Mojo||{};w.Mojo.com=w.Mojo.com||{};w.Mojo.com.ErrorDialog=w.Mojo.ui.Dialog.extend({clsname:function(){return"com.ErrorDialog";},init:function(options){this._super(undefined,options);this.element().addClass('mojo-com-errdlg');var self=this;this._addContent();this._addHandleButtons();},_addContent:function(){this._content.html(this._options.errorMsg);},_addHandleButtons:function(){var self=this;this._footer.append((new Mojo.ui.Button(undefined,{text:Mojo.utils.locale('ui','Close'),click:function(){self.close();},})).element());},_getDefaultOptions:function(){return $.extend(true,this._super(),{title:'Error',errorCode:0,errorMsg:'',handle:$.noop,});},});})(window,jQuery);;(function(w,$,undefined){w.Mojo=w.Mojo||{};w.Mojo.com=w.Mojo.com||{};w.Mojo.com.TipsDialog=w.Mojo.ui.Dialog.extend({clsname:function(){return"com.TipsDialog";},init:function(options){this._super(undefined,options);this.element().addClass('mojo-com-tipsdlg');this._addContent();this._addHandleButtons();},_addContent:function(){var self=this;self._message=$('<div class="paragraph"></div>').html(self._options.message).appendTo(this._content);},_addHandleButtons:function(){var self=this;this._footer.append((new Mojo.ui.Button('close-btn',{special:'button-big-red',text:Mojo.utils.locale('ui',''),click:function(){self.close();},})).element());},_getDefaultOptions:function(){return $.extend(true,this._super(),{title:Mojo.utils.locale('common','tips'),message:'',zIndex:1100,deviceaware:true});},});})(window,jQuery);;(function(w,$,undefined){w.Mojo=w.Mojo||{};w.Mojo.com=w.Mojo.com||{};w.Mojo.com.HandleDialog=w.Mojo.ui.Dialog.extend({clsname:function(){return"com.HandleDialog";},init:function(options){this._super(undefined,options);this.element().addClass('mojo-com-tipsdlg');this._addContent();this._addHandleButtons();},setAlertMessage:function(msg){if(undefined===this._alertMessage){this._alertMessage=$('<div class="paragraph alert-message"></div>').appendTo(this._content);}
this._alertMessage.html(msg);},_addContent:function(){var self=this;this._message=$('<div class="paragraph"></div>').html(self._options.message).appendTo(this._content);if(this._options.alertMessage){this._alertMessage=$('<div class="paragraph alert-message"></div>').html(self._options.alertMessage).appendTo(this._content);}},_addHandleButtons:function(){var self=this;if(this._options.btn1!=null){this._footer.append((new Mojo.ui.Button(undefined,{special:'button-big-red',text:self._options.btn1,click:function(){self._options.handle1();self.close();},})).element());}
if(this._options.btn2!=null){this._footer.append((new Mojo.ui.Button(undefined,{text:self._options.btn2,click:function(){self._options.handle2();self.close();},})).element());}
if(this._options.btn1==null||this._options.btn2==null){this._footer.append((new Mojo.ui.Button('close-btn',{text:Mojo.utils.locale('common','close'),click:function(){self.close();},special:(self._options.btn1==null&&self._options.btn2==null)?'button-big-red':'',})).element());}},_getDefaultOptions:function(){return $.extend(true,this._super(),{title:Mojo.utils.locale('common','tips'),btn1:null,btn2:null,handle1:$.noop,handle2:$.noop,message:'',alertMessage:undefined,zIndex:1100,});},});})(window,jQuery);;(function(w,$,undefined){w.Mojo=w.Mojo||{};w.Mojo.com=w.Mojo.com||{};w.Mojo.com.Goods=w.Mojo.Object.extend({clsname:function(){return"com.Goods";},init:function(data,options){this._data=data;this._super('goods-'+data.id,options);this.element().addClass("mojo-com-goods").addClass("box-inner");this._goButtonLabelCat=options.goButtonLabelCat||'common';this._goButtonLabelKey=options.goButtonLabelKey||'buy';this._buyWarningTitleCat=options.buyWarningTitleCat||'mall';this._buyWarningTitleKey=options.buyWarningTitleKey||'buy_warning_title';this._buyWarningCat=options.buyWarningCat||'mall';this._buyWarningKey=options.buyWarningKey||'buy_warning_content';this._buyButtonLabelCat=options.buyButtonLabelCat||'mall';this._buyButtonLabelKey=options.buyButtonLabelKey||'sure_buy';this._levelInfo=options.levelInfo;this.hasColdDown=options.hasColdDown;this._coldDownWarning=options.coldDownWarning;this._forceBossWarning=options.forceBossWarning;this._exchangeClass=(options.exchangeClass!=undefined?options.exchangeClass:'go-buy-btn');this._card=undefined;this.element().append('<div class="goods-detail"></div>');var self=this;if(this._data.bought&&parseInt(this._data.bought)==1){this._hasbuy=$("<div class = 'has-buy'></div>").html(Mojo.utils.locale('mall','has_buy'));this.element().append(this._hasbuy);}else{this._goButton=new Mojo.ui.Button(undefined,{text:Mojo.utils.locale(self._goButtonLabelCat,self._goButtonLabelKey),classes:['go-button'],click:function(){if(self._data.id=='sp0105'||self._data.id=='sp0107'||self._data.id=='sp1111'||self._data.id=='sp2222'){var discount=parseInt((self._data.discount?self._data.discount:100));var price=self._data.vm;var dlg=new Mojo.com.GoodsBatchBuyDlg({title:Mojo.utils.locale(self._buyWarningTitleCat,self._buyWarningTitleKey),vm:self._options.getPlayerVm(),price:parseInt((discount*price)/100),onBuy:function(count){if(self._options.type=="secret_treasure"){self._options.onBuy(count,self);}else{self._options.onBuy(count);}},deviceaware:true});dlg.open();}else{var buyWarningDialog=new Mojo.ui.Dialog(undefined,{title:Mojo.utils.locale(self._buyWarningTitleCat,self._buyWarningTitleKey),content:$('<div class="tip">'+Mojo.utils.locale(self._buyWarningCat,self._buyWarningKey)+'</div>'),deviceaware:true});new Mojo.ui.Button(undefined,{text:Mojo.utils.locale(self._buyButtonLabelCat,self._buyButtonLabelKey),special:"button-big-red",click:function(){buyWarningDialog.close();if(self._options.onBuy instanceof Function){if(self._options.type=="secret_treasure"){self._options.onBuy(undefined,self);}else{self._options.onBuy();}}}}).element().appendTo(buyWarningDialog._footer);new Mojo.ui.Button(undefined,{text:Mojo.utils.locale('common','think_again'),special:'button-big-blue',click:function(){buyWarningDialog.close();}}).element().appendTo(buyWarningDialog._footer);buyWarningDialog.open();}},disableClick:function(){var status=parseInt(self._data.status||Mojo.utils.getSomething("gstatus"));if(status==5){Mojo.app.toast.show(self._forceBossWarning);}else{if(self.hasColdDown&&self.cd&&self.cd>0){Mojo.app.toast.show(self._coldDownWarning);}else if(self._levelInfo){Mojo.app.toast.show(self._levelInfo.warning);}}},special:self._exchangeClass});this.element().append(this._goButton.element());var status=parseInt(self._data.status||Mojo.utils.getSomething("gstatus"));if(status==5){if(parseInt(this._data.cold_down)<0){this._goButton.disable(true);}}else{if(this._levelInfo&&this._levelInfo.level<this._levelInfo.unlockLevel){this._goButton.disable(true);}}}
this._setCard();this._setDetail();this._setAdvertising();this._initEvent();},_setCard:function(){var self=this;new Mojo.com.SmallEntity(this._data.entity,{callback:function(card){self._card=card;card.element().addClass("image").prependTo(self.element());}});},_setDetail:function(){var self=this;$('<div></div>').addClass("goods-name").html(this._data.name).appendTo(this.element().find('.goods-detail'));$('<div></div>').addClass("goods-description").html(this._data.description).appendTo(this.element().find('.goods-detail'));if(this._levelInfo){$('<div></div>').addClass("level-info").appendTo(this.element().find('.goods-detail'));$('<div></div>').addClass("level-title").html(this._levelInfo.title).appendTo(this.element().find('.level-info'));$('<div></div>').addClass("level-number").html(this._levelInfo.unlockLevel).appendTo(this.element().find('.level-info'));}
var params={};if(self._options.priceTitle!=undefined){params.priceTitle=self._options.priceTitle;}
(new Mojo.com.Price(this._data,params)).element().appendTo(this.element().find(".goods-detail"));if(this.hasColdDown&&this._data.cold_down&&this._data.cold_down>0){this.cd=this._data.cold_down;this.showCd();}},getDataId:function(){return this._data.id;},showCd:function(){var self=this;if(self.cd==undefined||self.cd==0)return;this._goButton.disable(true);if(!self._lblCd){self._lblCd=new Mojo.ui.Label(undefined,{text:'',classes:['cd','text-red'],});self._lblCd.element().appendTo(self.element().find('.goods-detail'));}
self._lblCd.text(Mojo.utils.locale('common','in_cd')+self._formatCDTime(self.cd));self._lblCd.show();self._interval=w.setInterval(function(){if(self.cd!=undefined&&self.cd>1){self.cd--;self._lblCd.text(Mojo.utils.locale('common','in_cd')+self._formatCDTime(self.cd));}else{self.cd=0;w.clearInterval(self._interval);self._goButton.disable(false);self._lblCd.hide();}},1000);},disableButton:function(){this._goButton.disable(true);},_formatCDTime:function(sec){var str='';var dd=parseInt(sec/86400);var hh=parseInt((sec%86400)/3600);var mm=parseInt((sec%3600)/60);var ss=sec%60;if(dd>0){str=dd+Mojo.utils.locale('common','day')+hh+Mojo.utils.locale('common','hour');}else if(hh>0){str=hh+Mojo.utils.locale('common','hour')+mm+Mojo.utils.locale('common','minute');}else if(mm>0){str=mm+Mojo.utils.locale('common','minute')+ss+Mojo.utils.locale('common','second');}else{str=ss+Mojo.utils.locale('common','second');}
return str;},_setAdvertising:function(){var status=parseInt(this._data.status||Mojo.utils.getSomething("gstatus"));var advertising="";var advertisingStyle="";if(status==1){advertisingStyle="new-goods-flag";advertising=Mojo.utils.locale("mall",'new_goods_flag');}else if(status==2){advertisingStyle="hot-goods-flag";advertising=Mojo.utils.locale("mall",'hot_goods_flag');}else if(status==3&&parseInt(this._data.discount)<100){advertisingStyle="discount-goods-flag";advertising=Mojo.utils.locale("mall",'discount_goods_flag_new',{discount:parseInt(this._data.discount)/10});}else if(status==5&&parseInt(this._data.discount)<100){advertisingStyle="discount-goods-flag";advertising=Mojo.utils.locale("mall",'discount_goods_flag_new',{discount:parseInt(this._data.discount)/10});}
if(status>0){$('<div class="goods-advertising"></div>').addClass(advertisingStyle).html(advertising).appendTo(this.element());}},updateGoButtonStatus:function(level){if(level>=this._levelInfo.unlockLevel){this._goButton.disable(false);}},_getDefaultOptions:function(){return{click:undefined,onBuy:undefined};},_initEvent:function(){var self=this;this._card.element().bind("click",function(){if(self._options.click instanceof Function){if(self._options.type=="secret_treasure"){self._options.click(self);}else{self._options.click();}}});}});})(window,jQuery);;(function(w,$,undefined){w.Mojo=w.Mojo||{};w.Mojo.com=w.Mojo.com||{};w.Mojo.com.Entity=w.Mojo.Object.extend({clsname:function(){return"com.Entity";},init:function(id,data,options){this.data=data;this._super(id,options);},});})(window,jQuery);;(function(w,$,undefined){w.Mojo=w.Mojo||{};w.Mojo.com=w.Mojo.com||{};w.Mojo.com.LargeEntity=w.Mojo.com.Entity.extend({clsname:function(){return"com.LargeEntity";},init:function(data,options){this._super(undefined,data,options);this._entityEffectText={"attack_max":{text:Mojo.utils.locale('largeentity','attack'),unit:""},"attack_min":{text:Mojo.utils.locale('largeentity','attack'),unit:""},"defence_max":{text:Mojo.utils.locale('largeentity','defence'),unit:""},"defence_min":{text:Mojo.utils.locale('largeentity','defence'),unit:""},"xp_value":{text:Mojo.utils.locale('largeentity','effect_xp'),unit:""},"xp_percent":{text:Mojo.utils.locale('largeentity','effect_xp'),unit:"%"},"rm_value":{text:Mojo.utils.locale('largeentity','effect_rm'),unit:""},"rm_percent":{text:Mojo.utils.locale('largeentity','effect_rm'),unit:"%"},"vm_value":{text:Mojo.utils.locale('largeentity','effect_vm'),unit:""},"vm_percent":{text:Mojo.utils.locale('largeentity','effect_vm'),unit:"%"},"ep_percent":{text:Mojo.utils.locale('largeentity','effect_ep'),unit:"%"},"sp_percent":{text:Mojo.utils.locale('largeentity','effect_sp'),unit:"%"},"max_attack_percent":{text:Mojo.utils.locale('largeentity','effect_max_attack_pro'),unit:"%"},"max_defence_percent":{text:Mojo.utils.locale('largeentity','effect_max_defence_pro'),unit:"%"},"attack_max_percent":{text:Mojo.utils.locale('largeentity','effect_max_attack'),unit:"%"},"attack_min_percent":{text:Mojo.utils.locale('largeentity','effect_min_attack'),unit:"%"},"defence_max_percent":{text:Mojo.utils.locale('largeentity','effect_max_defence'),unit:"%"},"defence_min_percent":{text:Mojo.utils.locale('largeentity','effect_min_defence'),unit:"%"}};this.element().addClass('mojo-com-entity-large');this._row1=$('<div class="row"><div class="picture"></div></div>').appendTo(this.element());if(typeof data=='string'){var self=this;Mojo.ajax("/entity/detail",{id:data,pid:this._options.pid,eid:this._options.eid,rebirth_count:this._options.rebirthCount,},function(response){if(response&&response.errorCode===0){self.data=response.data;self._setPicture();self._refresh();}else{self.data=undefined;}
if(self._options.callback instanceof Function){self._options.callback(self);}},function(){self.data=undefined;if(self._options.callback instanceof Function){self._options.callback(self);}});}else if(typeof data=='object'){this._setPicture();this._refresh();if(this._options.callback instanceof Function){this._options.callback(this);}}},_getEntityEffectText:function(){for(var eattr in this._entityEffectText){if(this.data[eattr]&&this.data[eattr]>0){return this._entityEffectText[eattr].text+this.data[eattr]+this._entityEffectText[eattr].unit;}}
return"";},_setEntityEffectText:function(){if(this._options.showEntityEffect){this._skills.append('<div class="paragraph">'+this._getEntityEffectText()+'</div>');}},_setPicture:function(){if(this._options.showDescription){this._description=$('<div class="description mojo-com-entity-large--row--description">'+Mojo.utils.locale('ui','Introduction')+':<br>'+this.data.description+'</div>').appendTo(this._row1);}
this._skills=$('<div class="row skills"></div>').hide().appendTo(this.element());if(this._options.showSkill){this._skills.show();}
this._row1.find('.picture').append('<img src="'+this.data.large_image+'" class="mojo-com-entity-large--row--img">').append('<div class="border"></div>').append('<div class="name mojo-com-entity-large--row--picture--name">'+this.data.name+'</div>').append('<div class="type"></div>').append('<div class="attributes mojo-com-entity-large--row--picture--attributes"></div>');this._row1.find('.picture > .name').addClass('rebirth-'+(this.data.rebirth_sum>6?6:this.data.rebirth_sum));},_addAttributes:function(){if(parseInt(this.data.type_id)!=7&&parseInt(this.data.type_id)!=8&&parseInt(this.data.type_id)!=22&&this.data.level>0){this._row1.find('.attributes').append((this._xpProgress=new Mojo.ui.Progress(undefined,{value:this.data.xp,max:this.data.next_xp,labelTemplate:'',classes:['mojo-com-entity-large--row--picture--attributes--mojo-ui-progress'],})).element()).append('<div class="level mojo-com-entity-large--row--picture--attributes--level">'+this.data.level+'</div>');}
this._effects=$('<div class="effects mojo-com-entity-large--row--picture--attributes--effects"></div>').appendTo(this._row1.find('.attributes'));this.data.attack_max=parseInt(this.data.attack_max);this.data.attack_min=parseInt(this.data.attack_min);this.data.defence_max=parseInt(this.data.defence_max);this.data.defence_min=parseInt(this.data.defence_min);if(Mojo.utils.isWhat(this.data.type_id,"general")){if(this.data.attack_max>0){if(this.data.attack_max<this.data.attack_min)this.data.attack_max=this.data.attack_min;this._effects.append((new Mojo.ui.Label(undefined,{classes:['effect-attack','mojo-com-entity-large--row--picture--attributes--mojo-ui-label'],text:this.data.attack_min+'-'+this.data.attack_max,})).element());}
if(this.data.defence_max>0){if(this.data.defence_max<this.data.defence_min)this.data.defence_max=this.data.defence_min;this._effects.append((new Mojo.ui.Label(undefined,{classes:['effect-defence','mojo-com-entity-large--row--picture--attributes--mojo-ui-label'],text:this.data.defence_min+'-'+this.data.defence_max,})).element());}}else{if(this.data.attack_max>0){if(this.data.attack_max<this.data.attack_min)this.data.attack_max=this.data.attack_min;this._effects.append((new Mojo.ui.Label(undefined,{classes:['effect-attack','mojo-com-entity-large--row--picture--attributes--mojo-ui-label'],text:this.data.attack_min+'-'+this.data.attack_max,})).element());}
if(this.data.defence_max>0){if(this.data.defence_max<this.data.defence_min)this.data.defence_max=this.data.defence_min;this._effects.append((new Mojo.ui.Label(undefined,{classes:['effect-defence','mojo-com-entity-large--row--picture--attributes--mojo-ui-label'],text:this.data.defence_min+'-'+this.data.defence_max,})).element());}
if(this.data.xp_percent>0){this._effects.append((new Mojo.ui.Label(undefined,{classes:['effect-xp','mojo-com-entity-large--row--picture--attributes--mojo-ui-label'],text:this.data.xp_percent+'%',})).element());}
if(this.data.ep_percent>0){this._effects.append((new Mojo.ui.Label(undefined,{classes:['effect-ep','mojo-com-entity-large--row--picture--attributes--mojo-ui-label'],text:this.data.ep_percent+'%',})).element());}
if(this.data.sp_percent>0){this._effects.append((new Mojo.ui.Label(undefined,{classes:['effect-sp','mojo-com-entity-large--row--picture--attributes--mojo-ui-label'],text:this.data.sp_percent+'%',})).element());}
if(this.data.vm_percent>0){this._effects.append((new Mojo.ui.Label(undefined,{classes:['effect-vm','mojo-com-entity-large--row--picture--attributes--mojo-ui-label'],text:this.data.vm_percent+'%',})).element());}
if(this.data.max_attack_percent>0){this._effects.append((new Mojo.ui.Label(undefined,{classes:['effect-max-attack-percent','mojo-com-entity-large--row--picture--attributes--mojo-ui-label'],text:this.data.max_attack_percent+'%',})).element());}
if(this.data.max_defence_percent>0){this._effects.append((new Mojo.ui.Label(undefined,{classes:['effect-max-defence-percent','mojo-com-entity-large--row--picture--attributes--mojo-ui-label'],text:this.data.max_defence_percent+'%',})).element());}
if(this.data.attack_max_percent>0){this._effects.append((new Mojo.ui.Label(undefined,{classes:['effect-attack-max-percent','mojo-com-entity-large--row--picture--attributes--mojo-ui-label'],text:this.data.attack_max_percent+'%',})).element());}
if(this.data.attack_min_percent>0){this._effects.append((new Mojo.ui.Label(undefined,{classes:['effect-attack-min-percent','mojo-com-entity-large--row--picture--attributes--mojo-ui-label'],text:this.data.attack_min_percent+'%',})).element());}
if(this.data.defence_max_percent>0){this._effects.append((new Mojo.ui.Label(undefined,{classes:['effect-defence-max-percent','mojo-com-entity-large--row--picture--attributes--mojo-ui-label'],text:this.data.defence_max_percent+'%',})).element());}
if(this.data.defence_min_percent>0){this._effects.append((new Mojo.ui.Label(undefined,{classes:['effect-defence-min-percent','mojo-com-entity-large--row--picture--attributes--mojo-ui-label'],text:this.data.defence_min_percent+'%',})).element());}}},_refresh:function(){if(parseInt(this.data.type_id)===7||parseInt(this.data.type_id)===8||parseInt(this.data.type_id)===22){this._row1.find('.picture').addClass('bg-level-other').addClass('mojo-com-entity-large--row--picture');}else{this._row1.find('.picture').addClass('bg-level-'+(parseInt((this.data.level-1)/10)+1)).addClass('mojo-com-entity-large--row--picture');}
this._row1.find('.picture > .rarity').addClass('star-rarity-'+this.data.rarity_id);this._row1.find('.picture > .border').addClass('border-rarity-'+(this.data.rarity_id?this.data.rarity_id:"other")).addClass("mojo-com-entity-large--row--picture--border");if(this.data.group_id_1){this._row1.find('.picture > .type').addClass('type-gp-'+this.data.group_id_1).addClass('type-gp-'+this.data.group_id_1+'-'+Mojo.app.data.userLanguage).addClass("mojo-com-entity-large--row--picture--type").addClass("mojo-com-entity-large--row--picture--type"+'-'+Mojo.app.data.userLanguage);}else{var typeid=this.data.type_id;if(parseInt(typeid)===22)
typeid=7;this._row1.find('.picture > .type').addClass('type-'+typeid).addClass("mojo-com-entity-large--row--picture--type").addClass("mojo-com-entity-large--row--picture--type"+'-'+Mojo.app.data.userLanguage);}
if(Mojo.utils.isWhat(this.data.type_id,"minis")){var minisFlag=$('<div></div>').addClass("minis-flag").addClass("minis-flag"+'-'+Mojo.app.data.userLanguage).appendTo(this._row1.find(".picture"));if(Mojo.utils.isWhat(this.data.entity_type_id,"general")){minisFlag.addClass('minis-flag-type-gp-'+this.data.entity_group_id).addClass('minis-flag-type-gp-'+this.data.entity_group_id+'-'+Mojo.app.data.userLanguage).show();}else{minisFlag.addClass('minis-flag-type-'+this.data.entity_type_id).addClass('minis-flag-type-'+this.data.entity_type_id+'-'+Mojo.app.data.userLanguage).show();}}
this._addAttributes();if(this._options.showSkill&&this.data.skills){var skills="";for(var sid in this.data.skills){var skill=this.data.skills[sid];skills+='<div class="paragraph">'+skill.description+'</div>';}
this._skills.html(skills);}
if(Mojo.utils.isWhat(this.data.type_id,"mounts")||Mojo.utils.isWhat(this.data.type_id,"treasure")){this._setEntityEffectText();}
this.refresh();},refresh:function(){if(typeof this.data=='object'){if(this.data.is_max_level==1){this._xpProgress.value(0);}}},_getDefaultOptions:function(){return $.extend(true,this._super(),{pid:"",eid:"",rebirthCount:0,callback:undefined,showSkill:false,showDescription:true,showEntityEffect:true});},});})(window,jQuery);;(function(w,$,undefined){w.Mojo=w.Mojo||{};w.Mojo.com=w.Mojo.com||{};w.Mojo.com.Price=w.Mojo.Object.extend({clsname:function(){return"com.Price";},init:function(data,options){this._data=data;this._super(undefined,options);this.element().addClass("mojo-com-goods-price");this.element().append('<div class="price-title"></div>');this.element().append('<div class="icon"></div>');this.element().append('<div class="before"></div>');this.element().append('<div class="now"></div>');this._refresh();},_refresh:function(){if(this._options.showTitle===true){this.element().find(".price-title").html(this._options.priceTitle).show();}else{this.element().find(".price-title").hide();}
var discount=((this._data.discount?this._data.discount:100));var price=0;if(this._data&&this._data.money&&parseInt(this._data.money)>0){this.element().find(".icon").removeClass("goods-vm-price").removeClass("goods-grain-price").removeClass("goods-rm-price");this.element().addClass("payment-money-price");price=this._data.money;}else if(this._data&&this._data.rm&&parseInt(this._data.rm)>0){this.element().find(".icon").removeClass("goods-vm-price").removeClass("goods-grain-price").addClass("goods-rm-price");price=this._data.rm;}else if(this._data&&this._data.vm&&parseInt(this._data.vm)>0){this.element().find(".icon").removeClass("goods-rm-price").removeClass("goods-grain-price").addClass("goods-vm-price");price=this._data.vm;}else if(this._data&&this._data.grain&&parseInt(this._data.grain)>0){this.element().find(".icon").removeClass("goods-rm-price").removeClass("goods-vm-price").addClass("goods-grain-price");price=this._data.grain;}else{this.element().find('.icon').addClass('none');}
if(discount<100){this.element().find(".before").html(price);}
if(parseInt(this._data.rm)>0||parseInt(this._data.vm)>0||parseInt(this._data.grain)>0||parseInt(this._data.money)>0){this.element().find(".now").html(parseInt((discount*price)/100));}else{this.element().find(".now").html(Mojo.utils.locale('props','priceless'));}},_getDefaultOptions:function(){return{showTitle:true,priceTitle:Mojo.utils.locale('common','price_title'),};}});})(window,jQuery);;(function(w,$,undefined){w.Mojo=w.Mojo||{};w.Mojo.com=w.Mojo.com||{};w.Mojo.com.ForceExchangeList=w.Mojo.Object.extend({clsname:function(){return"com.ForceExchangeList";},init:function(id,options){this._super('com-force-exchange-list',options);this.element().addClass('mojo-com-forceexchangelist');this._hasLoaded=false;this._lastSelected=undefined;this._level=this._options.level;this._dataList=[];this._goodsList=[];this.baseProfile=w.Mojo.page.Force.getController().getPlayerProfile();var self=this;var params=(this._options.type?{type:this._options.type}:{});this._list=new Mojo.ui.ListPanel(undefined,{pageSize:20,scrollable:true,showMore:false,loadFunc:function(start,count){Mojo.ajax('/force/exchangelist',{type:3},function(response){if(response&&response.errorCode===0){var dataList=null;if(response.data.list&&response.data.list.length>0){dataList=[];for(var i in response.data.list){var item=response.data.list[i];if(!item.entities[0])continue;for(var j in item.entities){var entity=item.entities[j];dataList.push({'id':item.id,'unlock_level':item.unlock_level,'name':item.name,'description':item.description,'grain':item.grain,'discount':item.discount,'entity':entity,'status':item.status,'cold_down':item.cold_down,'rm':item.rm});}}}
self._dataList=dataList;self._list.appendData(dataList);}else{self._list.appendData(null);}
self._options.callback(response.data);},function(){self._list.appendData(null);});},drawFunc:function(data){var goods=new Mojo.com.Goods(data,{goButtonLabelCat:'force',goButtonLabelKey:'exchange',buyWarningTitleCat:'force',buyWarningTitleKey:'exchange_warning_title',buyWarningCat:'force',buyWarningKey:'exchange_warning_content',buyButtonLabelCat:'force',buyButtonLabelKey:'sure_exchange',priceTitle:(data.rm!=undefined&&parseInt(data.rm)!=0)?Mojo.utils.locale('force','cost_rm'):Mojo.utils.locale('force','cost_grain'),levelInfo:{title:(data.status!=undefined&&parseInt(data.status)==5)?Mojo.utils.locale('force','force_boss_challenge_exchange_reason'):self.locale('require_force_level'),unlockLevel:(data.status!=undefined&&parseInt(data.status)==5)?Mojo.utils.locale('force','force_boss_challenge_exchange_answer'):data.unlock_level,level:self._level,warning:self.locale('force_level_too_low')},hasColdDown:(data.status!=undefined&&parseInt(data.status)==5)?false:true,coldDownWarning:self.locale('force_exchange_unavailable'),forceBossWarning:self.locale('force_exchange_unavailable_forceboss'),exchangeClass:'go-exchange-btn',onBuy:function(){self._buyGoods(data);},click:function(){var entityDialog=new Mojo.ui.Dialog(undefined,{title:self.locale('exchange'),content:(new Mojo.com.LargeEntity(data.entity)).element()});(new Mojo.com.Price(data,{showTitle:true,})).element().addClass('price-tip').insertBefore(entityDialog._footer);var exchangeBtn=new Mojo.ui.Button(undefined,{text:self.locale('exchange'),special:'button-bg-red',click:function(){self._buyGoods(data);entityDialog.close();},disableClick:function(){if(data.status==5){Mojo.app.toast.show(self.locale('force_exchange_unavailable_forceboss'));}else{if(goods.hasColdDown&&goods.cd&&goods.cd>0){Mojo.app.toast.show(self.locale('force_exchange_unavailable'));}else if(goods._levelInfo){Mojo.app.toast.show(self.locale('force_level_too_low'));}}}});exchangeBtn.element().appendTo(entityDialog._footer);var closeBtn=new Mojo.ui.Button(undefined,{text:Mojo.utils.locale('common','close'),special:'button-bg-red',click:function(){entityDialog.close();}});closeBtn.element().appendTo(entityDialog._footer);if(self._level<data.unlock_level||goods.hasColdDown&&goods.cd>0){exchangeBtn.disable(true);}
if((data.status==5&&data.cold_down<0)||(data.status==5&&goods.cd<0)){exchangeBtn.disable(true);}
entityDialog.open();}});self._goodsList.push(goods);return goods;},onLoad:function(listPanel){if(self._hasLoaded===false){self._hasLoaded=true;}}});this.element().append(this._list.element());},_addGrainBar:function(){var self=this;this._grainBar=$('<div class="personal-grain-bar"></div>').appendTo(this._list._header);Mojo.ajax('/force/playerForce',{},function(response){if(response&&response.errorCode===0){self._grainBar.html(self.locale('personal_grain_amount',{amount:response.data.grain}));}},function(){});},_refreshGrainBar:function(playerForce){if(playerForce){w.Mojo.page.Force.getController().updatePlayerProfile(playerForce);}},_buyGoods:function(goods){var self=this;var entityId=goods.entity.id;Mojo.ajax('/force/exchange',{id:goods.id},function(response){if(response.errorCode==0){self._refreshGrainBar(response.data.player_force);Mojo.track.onBuy(goods.id,1,'remark',true);if(goods&&parseInt(goods.entity.type_id)==8){Mojo.gap.niudanAnimationPlay(goods.entity.rarity_id);var entity=response.data.entities[0];var t=Mojo.utils.locale('mall','open_minis_result');if(response.data.extra_entity){t=Mojo.utils.locale('mall','heaven_bless');}
var entityDetailDialog=new Mojo.ui.Dialog(undefined,{title:t,content:(new Mojo.com.LargeEntity(entity)).element()});var tip=undefined;if(response.data.extra_entity){tip=Mojo.utils.locale('mall','open_minis_tip2',{__default__:'~{{:name}}~',name:entity.name});}else if(parseInt(response.data.type)==2){tip=Mojo.utils.locale('mall','open_minis_tip1').replace(/\{\{name\}\}/g,entity.name);}else{tip=Mojo.utils.locale('mall','open_minis_tip').replace(/\{\{name\}\}/g,entity.name);}
$('<div></div>').addClass('tip').html(tip).appendTo(entityDetailDialog._content);if(response.data.extra_entity){entityDetailDialog.element().addClass("with-extra-entity");var extraDiv=$('<div class="extra-entity tip"></div>').appendTo(entityDetailDialog._content);$('<div class="txt"></div>').html(Mojo.utils.locale('mall','get',{__default__:''})).appendTo(extraDiv);$('<div class="txt name"></div>').html(response.data.extra_entity.name).appendTo(extraDiv);}
new Mojo.ui.Button(undefined,{text:Mojo.utils.locale('force','continue_exchange'),special:"button-big-red",click:function(){entityDetailDialog.close();}}).element().appendTo(entityDetailDialog._footer);new Mojo.ui.Button(undefined,{text:Mojo.utils.locale('mall','go_accept'),special:'button-big-blue',click:function(){entityDetailDialog.close();if(parseInt(response.data.type)==2){Mojo.app.redirect('/illustration',{selected:4});}else{Mojo.app.redirect('/entity');}}}).element().appendTo(entityDetailDialog._footer);setTimeout(function(){entityDetailDialog.open();},400);}else if(goods&&parseInt(goods.entity.type_id)==7){var entity=response.data.entities[0];var exchangeSuccessfulDialog=new Mojo.ui.Dialog(undefined,{title:self.locale('exchange_successful_title'),content:(new Mojo.com.LargeEntity(entity)).element()});var tip=$('<div class="tip">'+self.locale('exchange_successful_content2')+'</div>').appendTo(exchangeSuccessfulDialog._content);new Mojo.ui.Button(undefined,{text:self.locale('exchange_again'),special:"button-big-red",click:function(){exchangeSuccessfulDialog.close();if(self._options.onBuy instanceof Function){self._options.onBuy();}}}).element().appendTo(exchangeSuccessfulDialog._footer);new Mojo.ui.Button(undefined,{text:Mojo.utils.locale('mall','go_accept'),special:'button-big-blue',click:function(){exchangeSuccessfulDialog.close();Mojo.app.redirect('/mall',{selected:2});}}).element().appendTo(exchangeSuccessfulDialog._footer);exchangeSuccessfulDialog.open();}else{var entity=response.data.entities[0];var exchangeSuccessfulDialog=new Mojo.ui.Dialog(undefined,{title:self.locale('exchange_successful_title'),content:(new Mojo.com.LargeEntity(entity)).element()});var tip=$('<div class="tip">'+self.locale('exchange_successful_content')+'</div>').appendTo(exchangeSuccessfulDialog._content);new Mojo.ui.Button(undefined,{text:self.locale('exchange_again'),special:"button-big-red",click:function(){exchangeSuccessfulDialog.close();if(self._options.onBuy instanceof Function){self._options.onBuy();}}}).element().appendTo(exchangeSuccessfulDialog._footer);new Mojo.ui.Button(undefined,{text:Mojo.utils.locale('mall','go_accept'),special:'button-big-blue',click:function(){exchangeSuccessfulDialog.close();if(parseInt(response.data.type)==2){Mojo.app.redirect('/illustration',{selected:4});}else{Mojo.app.redirect('/entity');}}}).element().appendTo(exchangeSuccessfulDialog._footer);exchangeSuccessfulDialog.open();}
var data=response.data;if(data.cold_down&&data.cold_down>0){var goodsList=self._list.children();for(var i=0;i<goodsList.length;i++){var goodsItem=goodsList[i];if(goodsItem.getDataId()==goods.id){goodsItem.hasColdDown=true;goodsItem.cd=data.cold_down;goodsItem.showCd();}}}else if(data.cold_down&&data.cold_down<0){var goodsList=self._list.children();for(var i=0;i<goodsList.length;i++){var goodsItem=goodsList[i];if(goodsItem.getDataId()==goods.id){goodsItem.cd=data.cold_down;goodsItem.disableButton();}}}}else if(response.errorCode==130038){var exchangeFailedDialog=new Mojo.ui.Dialog(undefined,{title:self.locale('exchange_failed_title'),content:$('<div class="tip">'+self.locale('exchange_failed_content')+'</div>')});new Mojo.ui.Button(undefined,{text:Mojo.utils.locale('common','close'),special:'button-big-blue',click:function(){exchangeFailedDialog.close();}}).element().appendTo(exchangeFailedDialog._footer);exchangeFailedDialog.open();}else if(response.errorCode==130053){Mojo.app.toast.show(response.errorMsg);}else if(response.errorCode==130054){Mojo.app.toast.show(response.errorMsg);}else if(response.errorCode==130062){Mojo.app.toast.show(response.errorMsg);}else if(response.errorCode==10005){var rmFailedDialog=new Mojo.ui.Dialog(undefined,{title:self.locale('exchange_failed_title'),content:$('<div class="tip">'+self.locale('need_rm')+'</div>')});new Mojo.ui.Button(undefined,{text:Mojo.utils.locale('mall','go_payment'),special:"button-big-red",click:function(){rmFailedDialog.close();self._createPaymentDialog();}}).element().appendTo(rmFailedDialog._footer);new Mojo.ui.Button(undefined,{text:Mojo.utils.locale('common','close'),special:'button-big-blue',click:function(){rmFailedDialog.close();}}).element().appendTo(rmFailedDialog._footer);rmFailedDialog.open();}else if(response.errorCode==10101){var FailedDialog=new Mojo.ui.Dialog(undefined,{title:self.locale('exchange_failed_title'),content:$('<div class="tip">'+response.errorMsg+'</div>')});new Mojo.ui.Button(undefined,{text:Mojo.utils.locale('common','close'),special:'button-big-blue',click:function(){FailedDialog.close();}}).element().appendTo(FailedDialog._footer);FailedDialog.open();}else if(response.errorCode==130110){var t=Mojo.utils.locale('force','force_boss_challenge_exchange_fail');if(response.data!=undefined&&response.data.title!=undefined){t=response.data.title;}
(new Mojo.com.CommonDialog(undefined,{title:t,content:$('<div class="tip"></div>').html(response.errorMsg),leftBtnText:Mojo.utils.locale('common','close'),leftBtnClick:function(that){that.close();}})).open();}},function(response){self._refreshGrainBar();});},_createPaymentDialog:function(){if(Mojo.gap.isJailbreak){Mojo.app.redirect('/mall/recharge');return;}
var self=this;this._paymentList=new Mojo.ui.ListPanel('payment-listpanel',{scrollable:true,showMore:false,pageSize:20,loadFunc:function(){Mojo.ajax("/mall/RechargeList",{},function(response){if(response&&response.errorCode===0){self._paymentData=response.data.list;if(self._paymentAdvertising===undefined){self._paymentAdvertising=response.data.advertising;}
self._paymentList.appendData(response.data.list);}else{self._paymentList.appendData(null);}},function(){self._paymentList.appendData(null);});},drawFunc:function(data){return(new Mojo.com.PaymentElement(data,{advertising:(self._paymentAdvertising==undefined?{}:self._paymentAdvertising),click:function(p){switch(parseInt(p.money)){case 6:Mojo.track.onEvent('10_021');break;case 30:Mojo.track.onEvent('10_022');break;case 68:Mojo.track.onEvent('10_023');break;case 198:Mojo.track.onEvent('10_024');break;case 328:Mojo.track.onEvent('10_025');break;case 648:Mojo.track.onEvent('10_026');break;}
Mojo.gap.purchase(self.baseProfile.id,p.id);}}));},onLoaded:function(that){$("#payment-advertising").remove();$('<div id="payment-advertising" class="payment-advertising"></div>').html((self._paymentAdvertising==undefined?Mojo.utils.getSomething("advertising_content"):self._paymentAdvertising.content)).insertBefore(that.element());}});var paymentDialog=new Mojo.ui.Dialog('payment-dialog',{title:Mojo.utils.locale('common','recharge'),content:self._paymentList.element(),close:function(){self._paymentAdvertising=undefined;self._paymentList=undefined;}});paymentDialog.open();Mojo.track.onEvent('10_011');},profileUpdated:function(level){var self=this;if(self._dataList!=undefined&&level!=self._level){for(var i=0;i<self._dataList.length;i++){self._goodsList[i].updateGoButtonStatus(level);}}},refreshData:function(){},localeCat:function(){return'force';}});})(window,jQuery);;(function(w,$,undefined){w.Mojo=w.Mojo||{};w.Mojo.com=w.Mojo.com||{};w.Mojo.com.SmallEntity=w.Mojo.Object.extend({clsname:function(){return"com.SmallEntity";},init:function(data,options){this._data=data;this._super(undefined,options);this.element().addClass("mojo-com-entity-small");this.element().append('<div class="minis-flag"></div>');this._refresh();this._initEvent();},_refresh:function(){var self=this;if(this._data instanceof Object){this._setCard();}else if(this._data instanceof String){Mojo.ajax("/detail",{id:this._data,pid:this._options.pid},function(response){if(response&&response.errorCode===0){self._data=response.data;self._setCard();}});}
this._setMinisFlag();if(this._options.callback instanceof Function){this._options.callback(this);}},_setCard:function(){var self=this;$('<img />').addClass("card-image-url").bind("load",function(){self.element().find(".card-image-url").show();}).hide().prependTo(this.element()).attr({src:this._data.small_image});},_setMinisFlag:function(){if(this._data&&this._data.type_id&&Mojo.utils.isWhat(this._data.type_id,"minis")){if(Mojo.utils.isWhat(this._data.entity_type_id,"general")){this.element().find(".minis-flag").addClass('minis-flag-type-gp-'+this._data.entity_group_id).show();}else{this.element().find(".minis-flag").addClass('minis-flag-type-'+this._data.entity_type_id).show();}}else{this.element().find(".minis-flag").hide();}},_initEvent:function(){var self=this;this.element().bind("click",function(){if(self._options.click instanceof Function){self._options.click(self);}});}});})(window,jQuery);;(function(w,$,undefined){w.Mojo=w.Mojo||{};w.Mojo.com=w.Mojo.com||{};w.Mojo.com.BuyFailDialog=w.Mojo.ui.Dialog.extend({clsname:function(){return"com.BuyFailDialog";},init:function(options){this._super(undefined,options);this.element().addClass('mojo-com-buyfaildlg');this._addContent();this._addHandleButtons();},_addContent:function(){var self=this;this._message=$('<div class="paragraph"></div>').html(self._options.message).appendTo(this._content);},_addHandleButtons:function(){var self=this;if(this._options.useRm==true){this._footer.append((new Mojo.ui.Button(undefined,{text:Mojo.utils.locale('common','go_payment'),click:function(){Mojo.app.redirect('/mall',{selected:4});},special:'button-big-red',})).element());}else{this._footer.append((new Mojo.ui.Button(undefined,{text:Mojo.utils.locale('common','go_vm'),click:function(){Mojo.app.redirect('/mall',{selected:2});},special:'button-big-red',})).element());}
this._footer.append((new Mojo.ui.Button(undefined,{text:Mojo.utils.locale('common','close'),click:function(){self.close();},})).element());},_getDefaultOptions:function(){return $.extend(true,this._super(),{title:Mojo.utils.locale('common','buy_fail_title'),message:'',useRm:true,zIndex:1100,deviceaware:true});},});})(window,jQuery);;(function(w,$,undefined){w.Mojo=w.Mojo||{};w.Mojo.com=w.Mojo.com||{};w.Mojo.com.WeiboPublishDialog=w.Mojo.ui.Dialog.extend({clsname:function(){return"com.WeiboPublishDialog";},init:function(data,options){this._data=data;this._super(undefined,options);this.element().addClass('mojo-com-weibopublishdlg');this._addContent();this._addHandleButtons();},_addContent:function(){var self=this;var text=self._options.hintText;var lengthLimit=self._options.maxlength;if(self._options.appendix!=''){lengthLimit=lengthLimit-parseInt(self._options.appendix.length)-1;}
var lengthDisplay=lengthLimit;if(self._options.defaultText!=''){text=self._options.defaultText;lengthDisplay=lengthDisplay-parseInt(self._options.defaultText.length);}
var paragraph=$("<div class='paragraph'></div>").appendTo(this._content);self._bonus=$('<div class="bonus"></div>').html(Mojo.utils.locale('weibo','weibo bonus')).appendTo(paragraph);self._tip=$('<div class="words-tip"></div>').html(lengthDisplay).appendTo(paragraph);self._border=$('<div class="border"></div>').appendTo(paragraph);self._content=$('<form name="form" method="post" action=""><textarea name="textarea" maxlength="'+lengthLimit+'" id="message-content" cols="45" rows="5">'+text+'</textarea></form>').appendTo(self._border);self._textarea=this._content.find('textarea').focus(function(){if(this.value==self._options.hintText){this.value='';}});self._textarea.bind("input propertychange",function(){var maxLength=$(this).attr('maxlength');var v=$(this).val().length;if(v<=maxLength){self._tip.html(maxLength-v);return true;}else{$(this).val($(this).val().substring(0,maxLength));return false;}});},_addHandleButtons:function(){var self=this;self._sendBtn=new Mojo.ui.Button(undefined,{special:'button-big-red',text:Mojo.utils.locale('ui','Send'),click:function(){self._sendBtn.disable(true);var message=$("#message-content").val();if(message==self._options.hintText){message='';}
if(self._options.appendix!=''){message=message+' '+self._options.appendix;}
if(Mojo.utils.trim(message)==''){Mojo.app.toast.show(Mojo.utils.locale('weibo','Please input weibo content'));self._sendBtn.disable(false);return;}
Mojo.app.weibo.statusesUpdate({access_token:self._data.access_token,status:message,errorFunc:function(){Mojo.app.toast.show(Mojo.utils.locale('weibo','Send Success'));self.close();Mojo.ajax('/player/weiboPublish',{},function(result){Mojo.app.refreshCurrentProfile();self.afterPublish();});},successFunc:function(){Mojo.app.toast.show(Mojo.utils.locale('weibo','Send Success'));self.close();Mojo.ajax('/player/weiboPublish',{},function(result){Mojo.app.refreshCurrentProfile();self.afterPublish();});},failedFunc:function(){self.close();Mojo.ajax('/player/weiboPublish',{},function(result){self.afterPublish();});},});},});this._footer.append(self._sendBtn.element());this._footer.append((new Mojo.ui.Button(undefined,{text:Mojo.utils.locale('common','close'),click:function(){self.close();self.afterPublish();},})).element());},afterPublish:function(){},close:function(){this._super();window.scrollTo(0);},_getDefaultOptions:function(){return $.extend(true,this._super(),{title:Mojo.utils.locale('weibo','Send weibo'),maxlength:140,hintText:Mojo.utils.locale('weibo','Please input weibo content'),defaultText:'',appendix:'',zIndex:1100,});},});})(window,jQuery);(function(w,$,undefined){w.Mojo=w.Mojo||{};w.Mojo.com=w.Mojo.com||{};w.Mojo.com.FacebookFeedDialog=w.Mojo.ui.Dialog.extend({init:function(data,options){this._data=data;this._super(undefined,options);this.element().addClass('mojo-com-facebookfeeddlg');this._addContent();this._addHandleButtons();},_addContent:function(){var self=this;var text=self._options.hintText;if(self._options.defaultText!=''){text=self._options.defaultText;}
self._bonus=$('<div class="bonus"></div>').html(Mojo.utils.locale('facebook','weibo bonus')).appendTo(this._content);self._border=$('<div class="border"></div>').appendTo(this._content);self._content=$('<form name="form" method="post" action=""><textarea name="textarea" '+'" id="message-content" cols="45" rows="5">'+text+'</textarea></form>').appendTo(self._border);self._textarea=this._content.find('textarea').focus(function(){if(this.value==self._options.hintText){this.value='';}});},_addHandleButtons:function(){var self=this;self._sendBtn=new Mojo.ui.Button(undefined,{special:'button-big-red',text:Mojo.utils.locale('ui','Send'),click:function(){self._sendBtn.disable(true);var message=$("#message-content").val();if(message==self._options.hintText){message='';}
var linkUrl="";if(self._options.appendix!=''){linkUrl=self._options.appendix;}
if(Mojo.utils.trim(message)==''){Mojo.app.toast.show(Mojo.utils.locale('facebook','Please input weibo content'));self._sendBtn.disable(false);return;}
var params={caption:self._options.defaultTitle,name:self._options.defaultTitle,picture:self._getImgurl(),link:linkUrl,description:self._options.defaultText,access_token:self._data.access_token,actions:[{name:'go to sanguo',link:linkUrl}],};FB.api('/me/feed','post',params,function(response){if(response&&response.id){Mojo.ajax('/player/weiboPublish',{},function(result){Mojo.app.refreshCurrentProfile();});}else{}
self.close();});},});this._footer.append(self._sendBtn.element());this._footer.append((new Mojo.ui.Button(undefined,{text:Mojo.utils.locale('common','close'),click:function(){self.close();self.afterPublish();},})).element());},afterPublish:function(){},_getImgurl:function(){var loc=location.href;var a=loc.indexOf('/mojo');var b=loc.substring(0,a);var url=b+'/mojo/resources/classic/mobile/image/ui/icon.jpg';if(Mojo.app.data.userLanguage=='zh_tw'){url=b+'/mojo/resources/classic/mobile/image/ui/icon-tw.jpg';}
return url;},_getDefaultOptions:function(){return $.extend(true,this._super(),{title:Mojo.utils.locale('facebook','Send weibo'),hintText:Mojo.utils.locale('facebook','Please input feed content'),defaultTitle:'',defaultText:'',appendix:'',zIndex:1100,});},debugable:function(){return Mojo.utils.debug.vars.com.weibopublishdlg;},});})(window,jQuery);;(function(w,$,undefined){w.Mojo=w.Mojo||{};w.Mojo.com=w.Mojo.com||{};w.Mojo.com.WeiboExpireDialog=w.Mojo.ui.Dialog.extend({clsname:function(){return"com.WeiboExpireDialog";},init:function(options){this._super(undefined,options);this.element().addClass('mojo-com-weiboexpiredlg');this._addContent();this._addHandleButtons();},_addContent:function(){var self=this;self._message=$('<div class="paragraph"></div>').html(Mojo.utils.locale('weibo','expire message')).appendTo(this._content);},_addHandleButtons:function(){var self=this;this._footer.append((new Mojo.ui.Button('login-btn',{special:'button-big-red',text:Mojo.utils.locale('weibo','go login'),click:function(){Mojo.app.redirect('/settings',{selected:1},'event','04_056');self.close();},})).element());this._footer.append((new Mojo.ui.Button('close-btn',{text:Mojo.utils.locale('common','close'),click:function(){self.close();},})).element());},_getDefaultOptions:function(){return $.extend(true,this._super(),{title:Mojo.utils.locale('weibo','Your weibo account has expired!'),zIndex:1100,});},});})(window,jQuery);;(function(w,$,undefined){w.Mojo=w.Mojo||{};w.Mojo.com=w.Mojo.com||{};w.Mojo.com.WeiboBindDialog=w.Mojo.ui.Dialog.extend({clsname:function(){return"com.WeiboBindDialog";},init:function(options){this._super(undefined,options);this.element().addClass('mojo-com-weibobinddlg');this._addContent();this._addHandleButtons();},_addContent:function(){var self=this;self._message=$('<div class="paragraph"></div>').html(Mojo.utils.locale('weibo','bind message')).appendTo(this._content);},_addHandleButtons:function(){var self=this;this._footer.append((new Mojo.ui.Button('bind-btn',{special:'button-big-red',text:Mojo.utils.locale('weibo','go bind'),click:function(){self._redirectToSettings=1;Mojo.app.redirect('/settings',{selected:1},'event','04_056');self.close();},})).element());this._footer.append((new Mojo.ui.Button('close-btn',{text:Mojo.utils.locale('common','close'),click:function(){self.close();},})).element());},_close:function(){if(this._redirectToSettings==1){delete this._redirectToSettings;return false;}
if(this._options.level==120){this._showActiveBarrackDialog();}},_showActiveBarrackDialog:function(){var dlg=new Mojo.com.CommonDialog(undefined,{title:Mojo.utils.locale('common','barrack_active_dlg_title'),content:$('<div class="paragraph"></div>').html(Mojo.utils.locale('common','barrack_active_dlg_content')),leftBtnText:Mojo.utils.locale('common','go_look'),leftBtnClick:function(){Mojo.app.redirect('/package',{selected:-1});dlg.close();},rightBtnText:Mojo.utils.locale('common','close'),rightBtnClick:function(){dlg.close();}});dlg.open();},_getDefaultOptions:function(){var self=this;return $.extend(true,this._super(),{title:Mojo.utils.locale('weibo','bind title'),zIndex:1100,close:function(){self._close();}});},});})(window,jQuery);;(function(w,$,undefined){w.Mojo=w.Mojo||{};w.Mojo.com=w.Mojo.com||{};w.Mojo.com.FacebookExpireDialog=w.Mojo.ui.Dialog.extend({init:function(options){this._super(undefined,options);this.element().addClass('mojo-com-facebookexpiredlg');this._addContent();this._addHandleButtons();},_addContent:function(){var self=this;this._message=$('<div class="paragraph"></div>').html(self.locale('expire message')).appendTo(this._content);},_addHandleButtons:function(){var self=this;this._footer.append((new Mojo.ui.Button('login-btn',{special:'button-big-red',text:self.locale('go login'),click:function(){Mojo.app.redirect('/settings',{selected:1},'event','04_056');self.close();},})).element());this._footer.append((new Mojo.ui.Button('close-btn',{text:Mojo.utils.locale('common','close'),click:function(){self.close();},})).element());},_getDefaultOptions:function(){var self=this;return $.extend(true,this._super(),{title:self.locale('Your weibo account has expired!'),zIndex:1100,});},localeCat:function(){return'facebook';},debugable:function(){return Mojo.utils.debug.vars.com.facebookexpiredlg;},});})(window,jQuery);;(function(w,$,undefined){w.Mojo=w.Mojo||{};w.Mojo.com=w.Mojo.com||{};w.Mojo.com.FacebookBindDialog=w.Mojo.ui.Dialog.extend({init:function(options){this._super(undefined,options);this.element().addClass('mojo-com-facebookbinddlg');this._addContent();this._addHandleButtons();},_addContent:function(){var self=this;this._message=$('<div class="paragraph"></div>').html(self.locale('bind message')).appendTo(this._content);},_addHandleButtons:function(){var self=this;this._footer.append((new Mojo.ui.Button('bind-btn',{special:'button-big-red',text:self.locale('go bind'),click:function(){Mojo.app.redirect('/settings',{selected:1},'event','04_056');self.close();},})).element());this._footer.append((new Mojo.ui.Button('close-btn',{text:Mojo.utils.locale('common','close'),click:function(){self.close();},})).element());},_getDefaultOptions:function(){var self=this;return $.extend(true,this._super(),{title:self.locale('bind title'),zIndex:1100,});},localeCat:function(){return'facebook';},debugable:function(){return Mojo.utils.debug.vars.com.facebookbinddlg;},});})(window,jQuery);;(function(w,$,undefined){w.Mojo=w.Mojo||{};w.Mojo.com=w.Mojo.com||{};w.Mojo.com.PlatformButton=w.Mojo.ui.Button.extend({init:function(event,options){this._super(undefined,options);this._event=event;this.element().addClass('mojo-com-platformbtn');this._initData();this._addContent();},_initData:function(){var self=this;if(self._event!=undefined&&self._event!=null){for(var index in self._event){if(self._event[index].name=='weibo.create'||self._event[index].name=='facebook.create'){self._options.access_token=self._event[index].data.access_token;self._options.defaultText=self._event[index].data.content;self._options.expire=self._event[index].expire;self._options.appendix=self._event[index].data.download_url;self._options.defaultTitle=self._event[index].data.title;}}}},_addContent:function(){var self=this;self._platform=Mojo.app.getPlatform();if(Mojo.app.getPlatform()=='facebook')
self.element().find('.icon').addClass('fb');var txt=(self._platform=='sina'?Mojo.utils.locale('weibo','Send weibo'):Mojo.utils.locale('facebook','Send weibo'));self.text(txt);var weibocontent=self._options.defaultText||self._options.content;var weibotitle=self._options.defaultTitle||self._options.title;var appendixtxt=self._options.appendix||self._options.download_url;self.click(function(){self._options.btnClick();Mojo.ajax('/player/weiboToken',{},function(response){if(response.errorCode==0){var access_token='';if(response.data){access_token=response.data.token;}
if(access_token!=null&&access_token!=''){if(self._options.expire==1){if(self._platform=='facebook'){(new Mojo.com.FacebookExpireDialog()).open(true);}else{(new Mojo.com.WeiboExpireDialog()).open(true);}}else{if(self._platform=='facebook'){(new Mojo.com.FacebookFeedDialog({access_token:access_token},{defaultText:weibocontent,appendix:appendixtxt,defaultTitle:weibotitle})).open(true);}else{(new Mojo.com.WeiboPublishDialog({access_token:access_token},{defaultText:weibocontent,appendix:appendixtxt})).open(true);}}}else{if(self._platform=='facebook'){(new Mojo.com.FacebookBindDialog()).open(true);}else{(new Mojo.com.WeiboBindDialog({showGoBindDialog:self._options.showGoBindDialog,level:self._options.level})).open(true);}}}
self._options.levelUpBtnClick();},function(){},{showWait:true});});},_getDefaultOptions:function(){return $.extend(true,this._super(),{text:'',special:'button-big-red',btnClick:$.noop,levelUpBtnClick:$.noop,icon:Mojo.app.getPlatform()=='facebook',textWrap:Mojo.app.getPlatform()=='facebook'});},debugable:function(){return Mojo.utils.debug.vars.com.platformbtn;},});})(window,jQuery);;(function(w,$,undefined){w.Mojo=w.Mojo||{};w.Mojo.com=w.Mojo.com||{};w.Mojo.com.ForceFilterDialog=w.Mojo.ui.Dialog.extend({clsname:function(){return"com.EntityFilterDialog";},init:function(options){this._super(undefined,options);this.element().addClass('mojo-com-force-filter');var self=this;this._addContent();this._addHandleButtons();},_addContent:function(){var self=this;this._entityFilterPanel=this.element();if($(document.body).find('.mojo-com-entity-filter').length>0){this.element().show();this._typeFilter=this.element().children("."+self._options.typeFilterId).first();this._rarityFilter=this.element().children("."+self._options.rarityFilterId).first();this._orderFilter=this.element().children("."+self._options.orderFilterId).first();}else{this.element().show();this._typeFilter=$('<div class="typeFilter"><div class="entityType">'+Mojo.utils.locale('force','order_condition')+'</div></div>').appendTo(this._entityFilterPanel);this._orderFilter=$('<div class="orderFilter"><div class="entityOrder">'+Mojo.utils.locale('force','order_force')+'</div></div>').appendTo(this._entityFilterPanel);this._typeFilter=this._entityFilterPanel.children("."+self._options.typeFilterId).first();Mojo.utils.center(this._entityFilterPanel);}
this._typeArray=this._options.typeId.toString().split(',');this._createFilter();if($(document.body).find('#tip-dialog').length==0)$(this._tipDialog).appendTo(document.body);},_addHandleButtons:function(){var self=this;this._footer.append((this._okButton=new Mojo.ui.Button(undefined,{text:Mojo.utils.locale('common','ok'),click:function(){self._options.callback(self._options.typeFilterSelected,self._options.orderFilterSelected);self.close();},special:'button-big-red'})).element());},_removeFilters:function(){var self=this;this._typeFilter.find("."+self._options.filterElementClass).remove();this._orderFilter.find("."+self._options.filterElementClass).remove();},_createFilter:function(){var self=this;if(Mojo.app.data.entityCategory.types.length==0||Mojo.app.data.entityCategory.orders.length==0){if((self._options.filterUrl==undefined||self._options.filterUrl=='')&&self._options.filterDataSource!=undefined){Mojo.app.data.forceCategory=self._options.filterDataSource;self._removeFilters();self._addFilter();return;}
Mojo.ajax(self._options.filterUrl,{},function(result){if(result.errorCode==0){Mojo.app.data.forceCategory=result.data;self._removeFilters();self._addFilter();}else{self._showDialog(result);}});}else{self._removeFilters();self._addFilter();}},_addFilter:function(){var self=this;if(self._options.type==='all'){if(self._options.typeId.length>1){self._options.typeId=1;}
for(var i in Mojo.app.data.forceCategory.types){if(Mojo.app.data.forceCategory.types[i].id=='6'||Mojo.app.data.forceCategory.types[i].id=='7'||Mojo.app.data.forceCategory.types[i].id=='8'){continue;}
self._filter=$('<div></div>').attr("id","type-"+Mojo.app.data.forceCategory.types[i].id).addClass(self._options.filterElementClass).appendTo(self._typeFilter).data({id:Mojo.app.data.forceCategory.types[i].id}).html('<div class="radio"></div>'+Mojo.app.data.forceCategory.types[i].name).click(function(){self._filterElements=self._typeFilter.find("."+self._options.filterElementClass);self._filterElements.removeClass(self._options.filterSelectedClass).eq($(this).index()).addClass(self._options.filterSelectedClass);self._filterElements.find('.radio').removeClass('radio-selected-class');$(this).find('.radio').addClass('radio-selected-class');self._options.typeFilterSelected=$(this).data('id');});if(self._options.typeId==Mojo.app.data.forceCategory.types[i].id){self._filter.addClass(self._options.filterSelectedClass);self._filter.find('.radio').addClass('radio-selected-class');self._options.typeFilterSelected=Mojo.app.data.forceCategory.types[i].id;}}
if(self._options.orderId==0){self._options.orderId=1;}
for(var k in Mojo.app.data.forceCategory.orders){if(Mojo.app.data.forceCategory.orders[k].id=='5'||Mojo.app.data.forceCategory.orders[k].id=='6')
continue;self._filter=$('<div></div>').attr("id","order-"+Mojo.app.data.forceCategory.orders[k].id).addClass(self._options.filterElementClass).appendTo(self._orderFilter).data({id:Mojo.app.data.forceCategory.orders[k].id}).html('<div class="radio"></div>'+Mojo.app.data.forceCategory.orders[k].name).click(function(){self._filterElements=self._orderFilter.find("."+self._options.filterElementClass);self._filterElements.removeClass(self._options.filterSelectedClass).eq($(this).index()).addClass(self._options.filterSelectedClass);self._filterElements.find('.radio').removeClass('radio-selected-class');$(this).find('.radio').addClass('radio-selected-class');self._options.orderFilterSelected=$(this).data('id');});if(self._options.orderId==Mojo.app.data.forceCategory.orders[k].id){self._filter.addClass(self._options.filterSelectedClass);self._filter.find('.radio').addClass('radio-selected-class');self._options.orderFilterSelected=Mojo.app.data.forceCategory.orders[k].id;}}}},_isInArray:function(v,arr){for(var i=0;i<arr.length;i++){if(v==arr[i])return true;}
return false;},_updateArray:function(v,arr){var tmp=[],flag=true;for(var i=0;i<arr.length;i++){if(v==arr[i])flag=false;else if(arr[i]!='')tmp.push(arr[i]);}
if(flag==true)tmp.push(v);return tmp;},_updateOrder:function(){var self=this;if(self._options.orderId==0){self._options.orderId=1;}},_showDialog:function(result){var dialog=new Mojo.com.ErrorDialog(undefined,{errorMsg:result.errorMsg});dialog.open(true);},_showTipDialog:function(text){var tipDialog=new Mojo.com.TipsDialog({message:text,zIndex:1010});tipDialog.open(true);},_getDefaultOptions:function(){return $.extend(true,this._super(),{typeId:0,type:'all',mainCardMode:true,mainCardId:0,rarityId:0,orderId:0,isRebirth:false,filterUrl:'/force/filter',title:Mojo.utils.locale('force','order_condition'),callback:$.noop,typeFilterSelected:0,rarityFilterSelected:0,orderFilterSelected:0,entityFilterClass:'mojo-com-entity-filter',filtersClass:'filters',filterClass:'filter',typeFilterId:'typeFilter',rarityFilterId:'rarityFilter',orderFilterId:'orderFilter',filterElementClass:'filterElement',filterSelectedClass:'filterSelected',filterDisabledClass:'filterDisabled',okButtonClass:'okButton',okButtonDisabledClass:'okButtonDisabled',cancelButtonClass:'cancelButton',cancelButtonDisabledClass:'cancelButtonDisabled',});},});})(window,jQuery);;(function(w,$,undefined){w.Mojo=w.Mojo||{};w.Mojo.com=w.Mojo.com||{};w.Mojo.com.ForceAssignTitleDialog=w.Mojo.ui.Dialog.extend({clsname:function(){return"com.ForceAssignTitleDialog";},init:function(data,options){this._data=data;this._super('com-forceassigntitledialog',options);this.element().addClass('mojo-com-forceassigntitledialog');var self=this;this._addHeader();this._addList();},_addHeader:function(){this._tips=$('<div class="paragraph"></div>').appendTo(this._content);var title='';if(this._data.title!=undefined&&this._data.title!=''){title='[<span class="official">'+this._data.title+'</span>]';}
this._header=$('<div class="header"></div>').html(Mojo.utils.locale('force','select_assign_title',{honor:title,name:this._data.name}));this._header.appendTo(this._tips);},_addList:function(){var self=this;this._list=new Mojo.ui.ListPanel('forceassigntitle-listpanel',{scrollable:true,showMore:false,pageSize:10,loadFunc:function(){Mojo.ajax('/forceCrazy/SobriquetList',{type:self._options.type},function(result){if(result&&result.errorCode==0){self.data=result.data;if(self.data!=undefined){$.each(self.data,function(i,d){self._list.appendData(d);});}else{self._list.appendData(null);}}else{self.close();Mojo.app.toast.show(result.errorMsg);}},function(){});},drawFunc:function(data){return(new Mojo.com.ForceTitle(data,{closeBack:function(){self.close();},OnClickFunc:function(){Mojo.ajax('/forceCrazy/distributSobriquet',{'ids':self._options.playerId,'sid':data.id,},function(result){if(result&&result.errorCode==0){var dlg=new Mojo.ui.Dialog(undefined,{title:Mojo.utils.locale('common','assign_title'),content:$('<div class="tip"></div>').html(result.data.dis_result),close:function(){self._options.callback();},});(new Mojo.ui.Button(undefined,{text:Mojo.utils.locale('common','close'),click:function(){dlg.close();}})).element().appendTo(dlg._footer);dlg.open(true);}else{var t=Mojo.utils.locale('force','cannot_allocatetitle');if(result.data!=undefined&&result.data.title!=undefined)
t=result.data.title;var dlg=new Mojo.ui.Dialog(undefined,{title:t,content:$('<div class="tip"></div>').html(result.errorMsg),});(new Mojo.ui.Button(undefined,{text:Mojo.utils.locale('common','close'),click:function(){dlg.close();}})).element().appendTo(dlg._footer);dlg.open(true);}},function(){});},}));},});this._list.element().appendTo(this._content);},_getDefaultOptions:function(){return $.extend(true,this._super(),{title:Mojo.utils.locale('common','assign_title'),type:2,playerId:'',});},});})(window,jQuery);;(function(w,$,undefined){w.Mojo=w.Mojo||{};w.Mojo.com=w.Mojo.com||{};w.Mojo.com.ForceTitle=w.Mojo.Object.extend({clsname:function(){return"com.forcetitle";},init:function(data,options){this._data=data;this._super(undefined,options);this.element().addClass('mojo-com-forcetitle').addClass('box-inner');var self=this;if(this._options.showTitle){this._FBtitleDiv=$('<div></div>').addClass("force-buff-title").appendTo(this.element());}
if(this._options.showAssignCount){this._FBascountDiv=$('<div></div>').addClass("force-buff-ascount").appendTo(this.element());}
if(this._options.showHr){$('<hr>').appendTo(this.element());}
if(this._options.showBuffs){this._BuffsDiv=$('<div></div>').addClass("force-buff-buffs").appendTo(this.element());}
if(this._options.showBtn){this._BtnDiv=$('<div></div>').addClass("force-buff-btn").appendTo(this.element());}
this.refresh();},refresh:function(data){if(data===undefined){data=this._data;}
this._addAttributes(data);},_addAttributes:function(data){var self=this;if(this._options.showTitle){this._FBtitleDiv.html(data.name);}
if(this._options.showAssignCount){this._FBascountDiv.html(Mojo.utils.locale('force','can_as_title_count')+(data.permit_num-data.num)+'/'+data.permit_num);}
if(this._options.showBuffs){var buffs='';$.each(data.buffs,function(i,b){buffs+=b.name+":"+b.desc+"<br/>";});this._BuffsDiv.html(buffs);}
if(this._options.showBtn){if(Mojo.utils.isNone(this._options.btn_text)==false){var disabled=true;if(data.num<data.permit_num){disabled=false;}
var Btn=new Mojo.ui.Button(undefined,{text:self._options.btn_text,classes:self._options.goBtnClass,special:self._options.goSpecialClass,disabled:disabled,click:function(){self._options.OnClickFunc();self._options.closeBack();},disableClick:function(){Mojo.app.toast.show(Mojo.utils.locale('force','no_allocatebuff'));}}).element().appendTo(this._BtnDiv);}}},_getDefaultOptions:function(){return{showTitle:true,showAssignCount:true,showHr:true,showBuffs:true,showBtn:true,btn_text:Mojo.utils.locale('force','assignbuff'),goBtnClass:['go-button'],goSpecialClass:'go-assign-btn',closeBack:$.noop,OnClickFunc:$.noop,};},});})(window,jQuery);;(function(w,$,undefined){w.Mojo=w.Mojo||{};w.Mojo.com=w.Mojo.com||{};w.Mojo.com.CrazyForceWar=w.Mojo.Object.extend({clsname:function(){return"com.CrazyForceWar";},init:function(options){this._super(undefined,options);var self=this;this._timer=undefined;this._forceSearch=undefined;this._helping=undefined;this._expire=undefined;this._attackerId=undefined;this._defenderId=undefined;this._forceSearch=undefined;this._forceOpponentListPanel=undefined;this._forceBattleHandle=undefined;this._isAssist=false;$.extend(true,this,this._options);if(this.action=='assistSlave'||this.action=='assistAlliance'){this._isAssist=true;this._assistType=this.action;}
this._forcePage=this.parent._options.getController();if(this.inBattle==true){self._forceWarAjax("/forceCrazy/battleStatus",{type:self.battleType,force_id:self.partnerIds},function(response){if(response.errorCode==0){if(response.data.attacker){switch(parseInt(response.data.type)){case 1:self.action='usurp';break;case 2:self.action='rebel';break;case 3:self.action='uniterebel';break;}
self._counting=response.data.counting;self._attLimit=response.data.eta.attacker;self._defLimit=response.data.eta.defender;self._attackerId=response.data.attacker.id;self._defenderId=response.data.defender.id;self._expire=response.data.eta.total;self._createCrazyforceBattle();self._usurpBattleStatusUpdate(response.data);}else{Mojo.app.redirect('/force');}}else if(response.errorCode==190701&&response.data!=undefined){self._createCrazyForceMarch(response.data);}else{Mojo.app.redirect('/force');}});}else{if(self.action=='alliance'){var param={};param['for']=self.action;param['fpreviewor']=1;Mojo.ajax('/forceCrazy/forceList',param,function(response){if(response.errorCode==0){Mojo.app.redirect('/relation',{index:17});}else{self._createFailedDlg(response);self.parent._crazyForceWar=undefined;}},function(){},{showWait:true});}else{var param={};param["for"]=self.action;Mojo.ajax('/forceCrazy/forceList',param,function(response){if(response.errorCode==0){self._createForceSearch(response.data);}else{self._createFailedDlg(response);self.parent._crazyForceWar=undefined;}},function(){},{showWait:true});}}},_getDefaultOptions:function(){return{inBattle:false,isAttacking:false,action:undefined,battleType:'attack',partnerIds:undefined,opponentName:undefined,opponentId:undefined,interval:10,backBtnClick:undefined,updateChallange:$.noop,};},pause:function(){var self=this;clearTimeout(self._forceBattleHandle);},_isForceOwner:function(isViceOwner){var isOwner=false;var player=this._forcePage.getPlayerProfile();var force=this._forcePage.getForceProfile();if(this.battleType=='defence'){if(force.id!=this._defenderId){isOwner=false;return isOwner;}}
if(Mojo.utils.isNone(player)){var self=this;this._forcePage.sync(function(){player=self._forcePage.getPlayerProfile();if(player&&player.position_id==1){isOwner=true;}else if(isViceOwner==true&&player&&player.position_id==2){isOwner=true;}});}else{if(player.position_id==1){isOwner=true;}
if(isViceOwner==true&&player.position_id==2){isOwner=true;}}
return isOwner;},_forceWarAjax:function(url,params,success,fail){var self=this;Mojo.ajax(url,params,function(response){if(response&&response.errorCode===0){if(response.data&&response.data.result){clearTimeout(self._forceBattleHandle);self.inbattle=false;self._showForceWarResultDialog(response.data.result,function(){Mojo.app.redirect('/force');});}else if(response.data!=undefined&&success instanceof Function){success(response);}}else{if(response.data&&response.data.prev){clearTimeout(self._forceBattleHandle);self.inbattle=false;self._showForceWarResultDialog(response.data.prev,function(){Mojo.app.redirect('/force');},response);}else if(success instanceof Function){success(response);}}},function(){if(fail instanceof Function){fail();}});},_fromArrayToString:function(array,isPlayer,noAnd){if(Array.isArray(array)==false)return array;var str="";var icount=0;var flag=0;for(var index in array){var word=array[index];icount+=1;if(word==this._forcePage.getForceProfile().name)continue;if(isPlayer){if(icount==array.length){str+=Mojo.utils.formatPlayerName(word);}else if(icount%2==0){str+=Mojo.utils.formatPlayerName(word)+",<br/>";}else{str+=Mojo.utils.formatPlayerName(word)+", ";}}else{if(flag!=0){str+="";}else if(!noAnd){str+=Mojo.utils.locale('common','and');}
str+=""+word+"";flag=1;}}
return str;},_showForceWarResultDialog:function(result,callback,response){var title=undefined;var content=undefined;var players=undefined;var outcome='_win';var sibling=undefined;this.opponentName=result.attacker;switch(parseInt(result.type)){case 1:this.action='usurp';break;case 2:this.action='rebel';break;case 3:this.action='uniterebel';var noAnd=false;if(this.battleType=='defence'){noAnd=true;}
this.opponentName=this._fromArrayToString(result.attacker,false,noAnd);break;}
if(result.contribute){players=this._fromArrayToString(result.contribute,true);}
if(this.battleType=='defence'){if(result.status==1){outcome='_lose';}}else{if(result.status==2||(this.action=='usurp'&&result.status==4)){outcome='_lose';}
sibling=this._fromArrayToString(result.attacker,false);this.opponentName=result.defender;}
if(result.status==1||result.status==2){if(this._isAssist==true){title=this.locale('assist'+outcome);content=$('<div class="tip"></div> ').html(this.locale(this._assistType+outcome+'_content',{sibling:result.defender,opponent_force:this.opponentName}));}else{title=Mojo.utils.locale('force',this.action+'_'+this.battleType+outcome);content=$('<div class="tip"></div>').html(Mojo.utils.locale('force',this.action+'_'+this.battleType+outcome+'_content',{'sibling':sibling,'players':players,'opponent_force':this.opponentName}));}}else if(result.status==3){title=Mojo.utils.locale('force','forcewar_retreat');if(this.action=='uniterebel'&&this.battleType=='defence'){content=$('<div class="tip"></div>').html(Mojo.utils.locale('force','uniterebel_'+this.battleType+'_retreat_answer',{opponent_force:this.opponentName}));}else{content=$('<div class="tip"></div>').html(Mojo.utils.locale('force','crazywar_'+this.battleType+'_retreat_answer',{action:this.locale(this.action),opponent_force:this.opponentName}));}}else if(result.status==4){title=Mojo.utils.locale('force',this.action+'_'+this.battleType+outcome);content=$('<div class="tip"></div>').html(Mojo.utils.locale('force',this.action+'_'+this.battleType+'_disband',{'sibling':sibling}));}else if(result.status==5){title=this.locale(this.action)+this.locale('over');content=$('<div class="tip"></div>').html(this.locale('usurp_'+this.battleType+'_terminated'));}else{title=response.data.title;content=$('<div class="tip"></div>').html(response.errorMsg);}
(new Mojo.com.CommonDialog(undefined,{title:title,content:content,rightBtnText:Mojo.utils.locale('common','close'),rightBtnClick:function(that){that.close();},close:function(){if(callback instanceof Function){callback();}}})).open();this._forcePage.getProfile().sync();},_actionForCapitulate:function(){var self=this;new Mojo.com.ForceNoticeDialog({},{title:Mojo.utils.locale('force','capitulate'),hintText:Mojo.utils.locale('force','capture_default_message'),hasDefaultMsg:true,maxlength:100,subhead:self.locale('capitulate_subhead'),beforeend:self.locale('capitulate_beforeend'),okBtnText:Mojo.utils.locale('force','capitulate'),okBtnClick:function(that){that.close();Mojo.ajax('/forceCrazy/relationCapture',{target_id:self.opponentId,message:that.getContent()},function(response){if(response.errorCode==0){(new Mojo.com.CommonDialog(undefined,{title:self.locale('capitulate'),content:$('<div class="tip"></div>').html(self.locale('capitulate_declaration',{name:self.opponentName})),rightBtnText:Mojo.utils.locale('common','close'),rightBtnClick:function(that){that.close();}})).open();}else{self._createFailedDlg(response);}},function(){},{showWait:true});}}).open();},_drawDefenceElement:function(data){var btnDisabled=true;var self=this;if(self._isForceOwner()==true){btnDisabled=false;}
return(new Mojo.com.ForceWarElement(data,{btnText:Mojo.utils.locale('force','forcewar_change'),btnDisabled:btnDisabled,disableClickCallback:function(){Mojo.app.toast.show(Mojo.utils.locale('force','forcewar_only_owner_change_defender'));},clickCallback:function(forceWarElement){var selectedForceMemberElement=undefined;var forcePage=self._forcePage;forcePage.hideCurrent();self.pause();var forceMember=new Mojo.com.ForceMember({showAssistTabs:true,showHeader:true,showSearch:false,showOrder:false,getController:function(){return forcePage;},forceMemberListOptions:{loadFunc:function(l,s,p,that){if(p!=undefined){self._helpflag=true;}else{self._helpflag=false;}
if(Mojo.utils.isNone(forceMember)==true){self._helping=0;}else{self._helping=forceMember._getTabsId();}
Mojo.ajax("/force/battleMembers",{start:l,count:s,helping:(self._helpflag?p:self._helping)},function(response){if(response&&response.errorCode===0){forceMember._setResponseData(response.data);forceMember._addHelperTabs(response.data);that.appendData(response.data.list);if(response.data.list!=undefined&&response.data.list.length==that._options.pageSize){that._more.show();}else{that._more.hide();}
that.resize();}},function(){},{showWait:true});}},backCallback:function(){forceMember.element().remove();forcePage.showCurrent();self._refreshForceBattleStatus();if(selectedForceMemberElement!=undefined){forceWarElement._data.defender={};$.extend(true,forceWarElement._data.defender,selectedForceMemberElement._data);forceWarElement.refresh();self._helperId=(forceMember._getTabsId())<=0?0:(selectedForceMemberElement._data.force.id);Mojo.ajax("/force/battleChangeDefender",(self._helperId?{lodgment_id:data.id,defender_id:selectedForceMemberElement._data.id,helper:self._helperId}:{lodgment_id:data.id,defender_id:selectedForceMemberElement._data.id}),function(response){forceWarElement._data.defender={};$.extend(true,forceWarElement._data.defender,response.data);forceWarElement.refresh();Mojo.track.onEvent('24_701');},function(){forceWarElement.refresh();},{showWait:true});}},forceMemberElementOptions:{showAttack:false,showDefence:true,showOffer:false,showLogin:false,showLevel:true,showHr:false,goBtnClass:['choose-button','radio'],goSpecialClass:'',subClass:'warClass',goBtnText:"",clickFunc:function(forceMemberElement){forceMember.element().find(".radio-selected-class").removeClass("radio-selected-class");forceMemberElement.element().find(".choose-button").addClass("radio-selected-class");selectedForceMemberElement=forceMemberElement;forceMember._backBtn.text(Mojo.utils.locale('common','ok'));}}});forceMember.element().appendTo(forcePage.element());}}));},_createCrazyforceBattle:function(){if(Mojo.utils.isNone(this.parent._forceBattlePanel)==false&&this.battleType=='attack'){this.parent._forceBattlePanel.element().children().remove();}
var needShowMore=false;if(this._isForceOwner(true)){needShowMore=true;}
var self=this;this._forceOpponentListPanel=new Mojo.ui.ListPanel("forcewar-opponent-listpanel",{scrollable:true,showMore:needShowMore,alwaysMore:needShowMore,pageSize:20,moreLabel:Mojo.utils.locale('force','summon'),moreClick:function(that){new Mojo.com.ForceNoticeDialog({},{title:Mojo.utils.locale('force','usurp_war_help_title'),hintText:Mojo.utils.locale('common','default_text'),maxlength:100,subhead:self.locale('usurp_war_help_subhead'),okBtnClick:function(that){that.close();Mojo.ajax("/force/sendWarToMember",{content:that.getContent(),type:self.action=='uniterebel'?'urmember':self.action,isDefender:self.battleType=='defence'?1:undefined},function(response){Mojo.app.toast.show(Mojo.utils.locale('common','suggestion_has_send'));},function(){},{showWait:true});}}).open();},loadFunc:function(s,l,p,that){},drawFunc:function(data){var btnDisabled=false;if(self.battleType=='defence'&&data.captured==undefined){btnDisabled=true;}
if(data.captured){if(data.captured.defence_min||data.captured.friend==1){btnDisabled=true;}}
var fwe=(new Mojo.com.ForceWarElement(data,{showForce:true,showDefence:true,showHr:false,showNonRMBPlayerAssistBtn:true,btnText:Mojo.utils.locale('force','forcewar_battle_action'),btnSpecial:"go-attack-btn",btnDisabled:btnDisabled,disableClickCallback:function(that){Mojo.app.toast.show(Mojo.utils.locale('force','has_captured'));},clickCallback:function(forceWarElement){var capturedPreviewDialog=new Mojo.com.ForceWarPreviewDialog(undefined,{attackBtnText:Mojo.utils.locale('force','forcewar_battle_action'),title:Mojo.utils.locale('force','forcewar_battle_preview'),tips:self.locale('usurp_battle_tip'),attackerName:self._forcePage.getPlayerProfile().name,defenderName:(data.defender?data.defender.name:"?"),actionCallback:function(that){that.close();self._forceWarAjax("/forceCrazy/battleFightingAttack",{type:self.battleType,lodgment_id:data.id,force_id:self.partnerIds},function(response){if(response&&response.errorCode===0){var resultTitle="";var resultTip="";var reversedTip="";var leftBtnText="";var rightBtnText=Mojo.utils.locale('common','close');var fight=response.data.attack;if(fight.player){if(parseInt(fight.player.sp)==NaN){fight.player.sp=0;}
Mojo.page.Force.getController().updatePlayerProfile({sp:fight.player.sp});Mojo.page.Force.getController().diffPlayer({grain:fight.results.grain});}
if(fight!=undefined){var leftBtnDisabled=false;var playerLevel=self._forcePage.getPlayerProfile().level;if(fight.status==1){self._refreshForceBattleStatus(true);forceWarElement.element().addClass("has-captured");forceWarElement._elementButton.disable(true);leftBtnText=Mojo.utils.locale('package','package_switch');resultTitle=Mojo.utils.locale('force','capture_win');if(fight['switch']==1){reversedTip=self.locale(self.action+'_'+self.battleType+'er_win_momentum');}
if(fight.defender==undefined){if(playerLevel<105){leftBtnDisabled=true;leftBtnText=undefined;}
resultTip=Mojo.utils.locale('force','win_lodgment_without_defender',{'lodgment':data.name})+reversedTip;}else{if(playerLevel<105){leftBtnText=Mojo.utils.locale('battle','formation detail');}else{rightBtnText=Mojo.utils.locale('battle','formation detail');}
var defendername=Mojo.utils.formatPlayerName(fight.defender);resultTip=Mojo.utils.locale('force','win_lodgment_with_defender',{'defendername':defendername,'lodgment':data.name})+reversedTip;}}else{forceWarElement.element().removeClass("has-captured");forceWarElement._elementButton.disable(false);leftBtnText=Mojo.utils.locale('force','capture_again');resultTitle=Mojo.utils.locale('force','capture_lose');rightBtnText=Mojo.utils.locale('battle','formation detail');var defendername=Mojo.utils.formatPlayerName(fight.defender);resultTip=Mojo.utils.locale('force','lose_lodgment_defender',{'defendername':defendername,'lodgment':data.name});if(fight.defender==undefined){rightBtnText=Mojo.utils.locale('common','close');}}
var dlgContent=$('<div class="tip"><div class="fight-result">'+resultTip+'</div></div>');var offer=$('<div class="fight-offer"></div>');new Mojo.ui.Label(undefined,{classes:['grain'],text:"+"+fight.results.grain}).element().appendTo(offer);new Mojo.ui.Label(undefined,{classes:['contribute'],text:Mojo.utils.locale('force','offer1')+"+"+fight.results.contribute}).element().appendTo(offer);offer.appendTo(dlgContent);var onCloseFunc=function(battleDetail){(new Mojo.com.CommonDialog(undefined,{title:resultTitle,content:dlgContent,leftBtnText:leftBtnText,leftBtnDisabled:leftBtnDisabled,leftBtnClick:function(that){if(fight.status==1){if(playerLevel>=105){Mojo.app.redirect('/package');}else{that.hide();(new Mojo.com.BattleDetailDialog(battleDetail,{pid:fight.defender.id,pkMode:true,vm:'+0',xp:'+0',entity:null,close:function(){that.show();},})).open(true);}}else{that.close();forceWarElement.doClick();}},rightBtnText:rightBtnText,rightBtnClick:function(that){if(fight.defender!=undefined||(fight.status==1&&playerLevel<105)){that.close();}else{that.hide();(new Mojo.com.BattleDetailDialog(battleDetail,{pid:fight.defender.id,pkMode:true,vm:'+0',xp:'+0',entity:null,close:function(){that.show();},})).open(true);}}})).open();};if(fight.defender==undefined){onCloseFunc(undefined);}else{Mojo.ajax('/battle/Detail',{type:'ForceBattleFighting'},function(result){if(result.errorCode==0){Mojo.ui.BattleAnimation.onclose=function(){onCloseFunc(result.data);};Mojo.ui.BattleAnimation.openBattle(result);}},function(){},{showWait:true});}}}else{(new Mojo.com.CommonDialog(undefined,{title:response.data?response.data.title:Mojo.utils.locale('force','forcewar_tip_title'),content:$('<div class="tip"></div>').html(response.errorMsg),leftBtnText:Mojo.utils.locale('common','ok'),leftBtnClick:function(that){that.close();}})).open();}},function(){},{showWait:true});}});Mojo.ajax("/forceCrazy/battleFightingAttack",{type:self.battleType,lodgment_id:data.id,force_id:self.partnerIds,preview:1},function(response){if(response&&response.errorCode===0){var current=response.data;if(current!=undefined){capturedPreviewDialog.setPlayerName(current.attacker.name);if(current.defender){capturedPreviewDialog.setOpponentName(current.defender.name);}else{capturedPreviewDialog.setOpponentName("?");}
var winContent=$('<div><div class="lodgment-name">'+Mojo.utils.locale('force','capture_lodgment',{'name':data.name})+'</div></div>');var offer=$('<div class="capture-offer"></div>');new Mojo.ui.Label(undefined,{classes:['grain'],text:"+"+current.result.win.grain}).element().appendTo(offer);new Mojo.ui.Label(undefined,{classes:['contribute'],text:Mojo.utils.locale('force','offer1')+" +"+current.result.win.contribute}).element().appendTo(offer);offer.appendTo(winContent);capturedPreviewDialog.setWinContents(winContent);var loseoffer=$('<div class="capture-offer"></div>');new Mojo.ui.Label(undefined,{classes:['grain'],text:"+"+current.result.lose.grain}).element().appendTo(loseoffer);new Mojo.ui.Label(undefined,{classes:['contribute'],text:Mojo.utils.locale('force','offer1')+" +"+current.result.lose.contribute}).element().appendTo(loseoffer);capturedPreviewDialog.setLoseContents($("<div></div>").append(loseoffer));}
capturedPreviewDialog.open();}else if(response&&response.errorCode==10003&&Mojo.utils.isNone(response.data)==false){(new Mojo.com.NeedBuyDialog(undefined,{title:Mojo.utils.locale('force','forcewar_tip_title'),goods:response.data.props,stamina:response.data.stamina,restoreCount:response.data.sp,allRestoreText:Mojo.utils.locale('common','time for all sp'),allRestoreTime:response.data.sp_restore_pp,nextRestoreText:Mojo.utils.locale('common','time for next sp'),nextRestoreTime:response.data.sp_second,restoreText:response.errorMsg,needBuyTip:response.errorMsg,useBtnClick:function(that,result){that.close();if(result&&result.errorCode===0){Mojo.page.Force.getController().updatePlayerProfile({sp:result.data.player.sp});Mojo.app.toast.show(Mojo.utils.locale('common','add_sp',{name:that._options.goods.goods_name,value:result.data.value}));}},buyBtnClick:function(that,result){Mojo.page.Force.getController().updatePlayerProfile({rm:result.data.player.rm,vm:result.data.player.vm});}})).open();}else{self._createFailedDlg(response);}},function(){},{showWait:true});},nonRMBClickCallback:function(forceWarElement,buffType){self._nonRMBClickCallback(data,forceWarElement,buffType,0);}}));return fwe;}});this._forceOpponentListPanel.element().addClass('non-rmb-player');if(self.battleType=='defence'){this.parent._tabs.setPanel(1,this._forceOpponentListPanel);}else{this._forceOpponentListPanel._element.appendTo(this.parent._forceBattlePanel.element());}
if(needShowMore){this._forceOpponentListPanel._more.element().removeClass('more').addClass('button-big-red');}
if(self._isForceOwner(true)){if(self.battleType=='attack'){self._createRetreatButton();this._retreatBtn.element().addClass('footer-btn').appendTo(this._forceOpponentListPanel._list);}}
this._addHeaderToListPanel();this._refreshForceBattleStatus();this.inbattle=true;},_nonRMBClickCallback:function(data,forceWarElement,buffType,re_buff){var self=this;Mojo.ajax("/forceCrazy/battleLodgmentBuff",{type:self.battleType,lodgment_id:data.id,force_id:self.partnerIds,buff:buffType,re_buff:re_buff},function(response){if(response&&response.errorCode===0){if(response.data.player){if(parseInt(response.data.player.sp)==NaN){response.data.player.sp=0;}
Mojo.page.Force.getController().updatePlayerProfile({sp:response.data.player.sp});Mojo.page.Force.getController().diffPlayer({grain:5});}
if(response.data.value!=undefined){self._refreshForceBattleStatus(true);var contribute=response.data.value;if(buffType=='decr'){contribute='-'+contribute;}else if(buffType=='incr'){contribute='+'+contribute;}
Mojo.app.toast.show(Mojo.utils.locale('force','non_rmb_player_assist_result',{name:data.name,percent:contribute}));}
setTimeout(function(){self._nonRMBClickCallback(data,forceWarElement,buffType,1);},200);}else if(response&&response.errorCode==10200&&Mojo.utils.isNone(response.data)==false){Mojo.ajax('/entity/Use',{id:response.data.props.id},function(result){if(result.errorCode==0){self._nonRMBClickCallback(data,forceWarElement,buffType,1);}else{Mojo.app.toast.show(result.errorMsg);}},function(){self._useBtn.disable(false);},{showWait:true});}else if(response&&response.errorCode==200082||response.errorCode==200088||response.errorCode==200089||response.errorCode==200083){self._nonRMBClickCallback(data,forceWarElement,buffType,1);}else{self._createFailedDlg(response);}},function(){},{showWait:true});},_addHeaderToListPanel:function(){var self=this;var attackForce='.left';var defenceForce='.left';if(self.battleType=='defence'){attackForce='.right';}else{defenceForce='.right';}
this._forceBattleStatus=$("<div></div>").addClass("page-tips  forcewar-battle-notice").appendTo(this._forceOpponentListPanel._header);this._forceBattleCountdown=$('<div></div>').addClass('progress-box').appendTo(this._forceOpponentListPanel._header).click(function(){new Mojo.com.ExplanationDialog(undefined,{title:self.locale(self.action)+Mojo.utils.locale('common','explanation'),picture:'battle-progress',explanation:self.locale(self.action+'_'+self.battleType+'_explanation')}).open();});this._forceBattleCountdown.append('<div class="left"></div><div class="right"></div>');this._ownForceTip=$('<div class="ownforce-tip"></div>').appendTo(this._forceBattleCountdown.find('.left'));var attackSide=this._forceBattleCountdown.find(attackForce);this._attackCountdown=new Mojo.ui.Progress(undefined,{classes:['countdown'],labelTemplate:'',});this._attackTime=$('<div class="attack-time"></div>').appendTo(this._attackCountdown.element());this._attackCountdown.element().appendTo(attackSide);$('<div class="countdown-border"></div>').appendTo(attackSide);var defenceSide=this._forceBattleCountdown.find(defenceForce);this._defenceCountdown=new Mojo.ui.Progress(undefined,{classes:['countdown'],labelTemplate:'',});this._defenceTime=$('<div class="defence-time"></div>').appendTo(this._defenceCountdown.element());this._defenceCountdown.element().appendTo(defenceSide);$('<div class="countdown-border"></div>').appendTo(defenceSide);},_usurpTargetForce:function(){var self=this;Mojo.ajax('/forceCrazy/battleUsurp',{preview:0,defender_id:self.opponentId},function(response){if(response.errorCode==0){self._forceSearch.element().remove();self._forcePage.showCurrent();if(self.parent._forceBattlePanel){self._forceWarAjax('/forceCrazy/battleStatus',{type:self.battleType,force_id:self.partnerIds},function(response){if(response&&response.errorCode===0){self._createCrazyforceBattle();}else if(response.errorCode==190701&&response.data!=undefined){self._createCrazyForceMarch(response.data);}else{clearTimeout(self._forceBattleHandle);}},function(){});}else{self.parent.refresh();}
new Mojo.com.CommonDialog(undefined,{title:Mojo.utils.locale('force','usurp'),content:$('<div class="tip"></div>').html(Mojo.utils.locale('force','usurp_war_tip',{opponent_force:self.opponentName})),classes:['rebel-start-dialog'],rightBtnText:Mojo.utils.locale('common','close'),rightBtnClick:function(that){that.close();},}).open();self._forcePage.getProfile().sync();}else if(response.errorCode==190110){(new Mojo.com.CommonDialog(undefined,{title:self.locale('lake_grain'),content:$('<div class="paragraph"></div>').html(self.locale('grain_not_enouph')),leftBtnText:Mojo.utils.locale('common','go_neizheng'),leftBtnClick:function(that){that.close();Mojo.app.redirect('/force',{index:1});},rightBtnText:Mojo.utils.locale('common','close'),rightBtnClick:function(that){that.close();}})).open();}else if(response.errorCode==200065){(new Mojo.com.NeedBuyDialog(undefined,{title:Mojo.utils.locale('force','forcewar_tip_title'),goods:response.data.props,stamina:response.data.cp_total,restoreCount:response.data.cp_current,allRestoreText:Mojo.utils.locale('force','all_chanllenge_get'),allRestoreTime:response.data.cp_restore_pp,nextRestoreText:Mojo.utils.locale('force','next_chanllenge_get'),nextRestoreTime:response.data.cp_second,restoreText:response.errorMsg,needBuyTip:response.errorMsg,useBtnClick:function(that,result){if(result&&result.errorCode===0){Mojo.page.Force.getController().diffForce({challenge:parseInt(result.data.challenge)});self._options.updateChallange();Mojo.app.toast.show(Mojo.utils.locale('common','add_cp',{name:that._options.goods.goods_name,value:result.data.challenge}));}},buyBtnClick:function(that,result){Mojo.page.Force.getController().updatePlayerProfile({rm:result.data.player.rm,vm:result.data.player.vm});}})).open();}else{self._createFailedDlg(response);}},function(){},{showWait:true});},_createCrazyForceMarch:function(data){var self=this;var expireTime=parseInt(data.wait);this.opponentName=(this.battleType=='attack')?data.defender.name:data.attacker.name;if(Mojo.utils.isNone(this.parent._forceBattlePanel)==false&&this.battleType=='attack'){this.parent._forceBattlePanel.element().children().remove();}
switch(parseInt(data.type)){case 1:this.action='usurp';break;case 2:this.action='rebel';break;case 3:this.action='uniterebel';break;}
this._CrazyForceMarchPanel=new Mojo.com.CrazyForceMarchPanel({expireTime:expireTime,opponentName:self.opponentName,action:self.action,battleType:self.battleType,partnerIds:self.partnerIds,},{isForceOwner:function(isViceOwner){return self._isForceOwner(isViceOwner);},createFailedDlg:function(data){self._createFailedDlg(data);},createCrazyforceBattle:function(){self._createCrazyforceBattle();},forceWarAjax:function(url,params,success,fail){self._forceWarAjax(url,params,success,fail);}});if(self.battleType=='defence'){this.parent._tabs.setPanel(1,this._CrazyForceMarchPanel);this.parent._tabs.element().find('ul > li').eq(1).append($("<div class='battleStatus'></div>"));}else{this._CrazyForceMarchPanel._element.appendTo(this.parent._forceBattlePanel.element());this.parent._tabs.element().find('ul > li').eq(0).append($("<div class='battleStatus'></div>"));}
this._refreshForceBattleStatus();this.inMarch=true;},_showBattleTipDialog:function(previewData){var self=this;var usurpTipDlg=new Mojo.com.CommonDialog(undefined,{title:Mojo.utils.locale('force','usurp'),content:$('<div class="paragraph"></div>').html(self.locale('usurp_tip')),classes:['usurp-tip-dialog'],leftBtnText:self.locale('usurp'),leftBtnClick:function(that){that.close();self._usurpTargetForce();},rightBtnText:Mojo.utils.locale('common','close'),rightBtnClick:function(that){that.close();}});var grainCost=$('<div class="cost-grain"></div>').html('<div class="cg-content">'+self.locale('grain_cost')+'</div>').appendTo(usurpTipDlg._content);var gcLabel=new Mojo.ui.Label(undefined,{text:previewData.grain,classes:['fgrain'],});gcLabel.element().appendTo(grainCost);var challengeCost=$('<div class="cost-challenge"></div>').html('<div class="cc-content">'+self.locale('challenge_cost')+'</div>').appendTo(usurpTipDlg._content);var ccLabel=new Mojo.ui.Label(undefined,{text:previewData.challenge,classes:['challenge'],});ccLabel.element().appendTo(challengeCost);$("<div class='tips'></div>").html(self.locale('force_war_tip3')).appendTo(usurpTipDlg._content);usurpTipDlg.open();},_actionForUsurp:function(){var self=this;Mojo.ajax('/forceCrazy/battleUsurp',{preview:1,defender_id:self.opponentId},function(response){if(response.errorCode==0){self._showBattleTipDialog(response.data);}else{self._createFailedDlg(response);}},function(){},{showWait:true});},_createForceSearch:function(forceList){var self=this;var temp={};temp["excludes"]=self._forcePage.getForceProfile().id;temp["for"]=self.action;this._forcePage.hideCurrent();this._forceSearch=new Mojo.com.ForceSearch('forcewar-forcesearch',{backCallback:function(){if(self.backBtnClick instanceof Function){self.backBtnClick();}else{self._forceSearch.element().remove();self._forcePage.showCurrent();self.parent._crazyForceWar=undefined;}},forceSearchParams:temp,forceListOptions:{type:self.targetForceId?'forceinfo':'crazyforce',purpose:self.action,ids:self.targetForceId,listData:forceList,btnText:Mojo.utils.locale('force',self.action),showForceRest:true,moreLabel:Mojo.utils.locale('force','refresh'),onBtnClick:function(data){self.opponentId=data.id;self.opponentName=data.name;switch(self.action){case'capture':Mojo.ajax('/forceCrazy/relationCapture',{target_id:data.id,preview:1},function(response){if(response.errorCode==0){self._actionForCapitulate();}else{self._createFailedDlg(response);}},function(){},{showWait:true});break;case'usurp':self._actionForUsurp();break;}},inDefence:function(data){if(data.fighting<0){this.showBtn=false;switch(data.fighting){case-1:this.inWarTxt=self.locale('be_usurp');break;case-2:this.inWarTxt=self.locale('be_rebel');break;case-3:this.inWarTxt=self.locale('be_uniterebel');break;}
return true;}}}});this._forceSearch.element().appendTo(self._forcePage.element());},_createFailedDlg:function(errorData){var self=this;var t=errorData.data?errorData.data.title:self.locale('forcewar_tip_title');var msg=errorData.errorMsg;if(Mojo.utils.isNone(msg)||msg==''){msg=Mojo.utils.locale('common','action_error');}
var lBtnTxt=undefined;var lBtnClkFun=undefined;switch(errorData.errorCode){case 200080:case 200086:lBtnTxt=Mojo.utils.locale('common','go_neizheng');lBtnClkFun=function(that){that.close();Mojo.app.redirect('/force',{index:1});};msg=errorData.errorMsg;break;case 130204:lBtnTxt=Mojo.utils.locale('common','go_neizheng');lBtnClkFun=function(that){that.close();Mojo.app.redirect('/force',{index:1});};msg=errorData.errorMsg+"<br>"+self.locale('force_contribute_not_enough',{force_level:this._forcePage.getForceProfile().level,contribute:errorData.data.contribute});break;case 190101:t=self.locale('force_level_not_enough');msg=self.locale('force_level_not_enough_msg');break;case 194005:case 200014:case 200030:lBtnTxt=self.locale('forcewar_defense');lBtnClkFun=function(that){that.close();if(self.parent._tabs){self.parent._tabs._select(1);}else{self._forcePage.switchTo(2,{refresh:1,selected:1});}};break;case 200012:case 200015:case 200018:case 200027:case 200028:lBtnTxt=self.locale('relation');lBtnClkFun=function(that){that.close();Mojo.app.redirect('/relation');};break;case 200021:lBtnTxt=self.locale('forcewar_battle');lBtnClkFun=function(that){that.close();self._forcePage.switchTo(2,{refresh:1});};break;case 200085:if(Mojo.utils.isNone(t)||t==''){t=Mojo.utils.locale('force',''+self.action+'_fail');}
if(Mojo.utils.isNone(msg)||msg==''){msg=Mojo.utils.locale('force',''+self.action+'_fail_forcerest');}
break;default:break;}
(new Mojo.com.CommonDialog(undefined,{title:t,content:$("<div class='tip'></div>").html(msg),leftBtnText:lBtnTxt,leftBtnClick:lBtnClkFun,rightBtnText:Mojo.utils.locale('common','close'),rightBtnClick:function(that){that.close();},})).open();},_usurpBattleStatusUpdate:function(battleData){var self=this;var forceLodgmentsCount=battleData.amount.total;var turningPoint=undefined;if(this.action=='uniterebel'){turningPoint=Math.ceil(battleData.amount.total/2);}else if(this.action=='rebel'){if(this.battleType=='defence'){turningPoint=battleData.amount.total;}else{turningPoint=1;}}else{if(this.battleType=='defence'){turningPoint=1;}else{turningPoint=battleData.amount.total;}}
var forceCapturedCount=battleData.amount.captured;if(self.battleType=='defence'){forceCapturedCount=battleData.amount.total-forceCapturedCount;self.opponentName=battleData.attacker.name;}else{self.opponentName=battleData.defender.name;}
self._forceOpponentListPanel.element().find('.mojo-com-forcewarelement').remove();self._forceOpponentListPanel._children=[];self._forceOpponentListPanel.appendData(battleData.lodgments);var notice='usurp_war_notice';if(self.battleType=='defence'){if(self._isAssist){notice='usurp_assist_notice';}else{notice='usurp_def_notice';}}
var statusHtml=Mojo.utils.locale('force',notice,{opponent_force:self.opponentName,battle_schedule:forceCapturedCount+'/'+forceLodgmentsCount});self._forceBattleStatus.html(statusHtml);if(self._ownTimeIsCount==true){self._ownForceTip.html(self.locale('turning_point_condition')+forceCapturedCount+'/'+turningPoint);}
self._attackTime.html(Mojo.utils.formatTime(battleData.eta.attacker));self._defenceTime.html(Mojo.utils.formatTime(battleData.eta.defender));self._attackCountdown.value({value:battleData.eta.attacker,max:self._expire.attacker});self._defenceCountdown.value({value:battleData.eta.defender,max:self._expire.defender});},_refreshForceBattleStatus:function(forceUpdate){var self=this;if(forceUpdate!=true){if(self._counting==1){if(self._attLimit>0){self._attLimit-=1;}
if(self.battleType=='attack'){self._ownTimeIsCount=true;}else{self._ownTimeIsCount=false;if(self._attLimit<=0){self._ownForceTip.html(Mojo.utils.locale('ui','PK Win'));}else{self._ownForceTip.html(self.locale('time_tip_for_own_battle',{time:Mojo.utils.formatSecTime(self._attLimit)}));}}
self._timer=self._attLimit;self._attackTime.html(Mojo.utils.formatTime(self._attLimit));self._attackCountdown.value({value:self._attLimit,max:self._expire.attacker});}else if(self._counting==2){if(self._defLimit>0){self._defLimit-=1;}
if(self.battleType=='defence'){self._ownTimeIsCount=true;}else{self._ownTimeIsCount=false;if(self._defLimit<=0){self._ownForceTip.html(Mojo.utils.locale('ui','PK Win'));}else{self._ownForceTip.html(self.locale('time_tip_for_own_battle',{time:Mojo.utils.formatSecTime(self._defLimit)}));}}
self._timer=self._defLimit;self._defenceTime.html(Mojo.utils.formatTime(self._defLimit));self._defenceCountdown.value({value:self._defLimit,max:self._expire.defender});}}
if(forceUpdate==true||self._timer==undefined||self._timer%self._options.interval==0){self._forceWarAjax('/forceCrazy/battleStatus',{type:self.battleType,force_id:self.partnerIds},function(response){if(response&&response.errorCode===0){if(Mojo.utils.isNone(response.data)==false){self._counting=response.data.counting;self._attLimit=response.data.eta.attacker;self._defLimit=response.data.eta.defender;self._attackerId=response.data.attacker.id;self._defenderId=response.data.defender.id;self._expire=response.data.eta.total;self._usurpBattleStatusUpdate(response.data);}}else{clearTimeout(self._forceBattleHandle);}},function(){});}
if(forceUpdate!=true){self._forceBattleHandle=setTimeout(function(){self._refreshForceBattleStatus();},1000);}},_createRetreatButton:function(){var self=this;this._retreatBtn=new Mojo.ui.Button(undefined,{text:self.locale('forcewar_retreat'),click:function(){if(self._isForceOwner(true)==false){if(self.action=='uniterebel'){Mojo.app.toast.show(Mojo.utils.locale('force','uniterebel_retreat_tip'));}else{Mojo.app.toast.show(Mojo.utils.locale('force','forcewar_retreat_tip'));}
return;}
(new Mojo.com.CommonDialog(undefined,{title:Mojo.utils.locale('force','forcewar_retreat'),content:$('<div class="tip"></div>').html(Mojo.utils.locale('force','crazywar_retreat_question',{forcename:self.opponentName,action:self.locale(self.action)})),leftBtnText:Mojo.utils.locale('force','forcewar_retreat'),leftBtnClick:function(that){that.close();self._forceWarAjax("/forceCrazy/battleSurrender",{},function(response){if(response.errorCode!=0){self._createFailedDlg(response);}});},rightBtnText:Mojo.utils.locale('common','close'),rightBtnClick:function(that){that.close();}})).open();}});},localeCat:function(){return'force';},_getUrlParam:function(name){var reg=new RegExp("(^|&)"+name+"=([^&]*)(&|$)");var r=window.location.search.substr(1).match(reg);if(r!=null)return unescape(r[2]);return null;},});})(window,jQuery);;(function(w,$,undefined){w.Mojo=w.Mojo||{};w.Mojo.com=w.Mojo.com||{};w.Mojo.com.ScrollPanel=w.Mojo.Object.extend({init:function(id,options){this._super(id,options);this.element().addClass('mojo-ui-listpanel');this._children=[];this._hasLoaded=false;var self=this;this._header=$('<div class="header"></div>').appendTo(this.element());this._list=$('<div class="list"></div>');this._scroll=new Mojo.ui.Scroll(undefined,this._list,{direction:2});this.element().append(this._scroll.element());this._footer=$('<div class="footer"></div>').appendTo(this.element());},_getDefaultOptions:function(){return{refreshable:false,emptyLabel:null,onLoaded:undefined,direction:2,};},_addChild:function(child){if(child!=undefined&&child!=null){this._list.append(child.element().addClass("mojo-ui-listpanel-child"));this._children.push(child);}},appendData:function(data){var self=this;setTimeout(function(){if(self._options.refreshable==true){self.initial();}
if(data!=undefined&&data!=null){if(Array.isArray(data)){$.each(data,function(i,d){self._addChild(d);});}else{self._addChild(data);}
if(self._hasLoaded===false&&self._options.onLoaded instanceof Function){self._options.onLoaded(self);}
self._hasLoaded=true;}
self._list.find('.empty').remove();if(self._children.length==0&&self._options.emptyLabel!=null){self._list.append('<div class="empty">'+self._options.emptyLabel+"</div>");}
self.rebinding();self.resize();},10);},remove:function(index){this._list.children().eq(index).remove();},removeAll:function(){this._hasLoaded=false;this._list.empty();},clsname:function(){return"ui.ListPanel";},child:function(index){return this._children[index];},children:function(){return this._children;},resize:function(){if(this._options.direction!=1){var top=this.element().offset().top;var scrollTop=top+this._header.outerHeight(true);var scrollBottom=this._footer.outerHeight(true);var h=this.element().height()-this._header.outerHeight(true)-this._footer.outerHeight(true);var w=this.element().width();this._scroll._window.css({'top':scrollTop+"px",'bottom':scrollBottom+"px",'height':h+"px",'width':w+"px"});}
this._scroll.refresh();},initial:function(){this._scroll.initial();}});})(window,jQuery);;(function(w,$,undefined){w.Mojo=w.Mojo||{};w.Mojo.com=w.Mojo.com||{};w.Mojo.com.RelationBaseMenuElement=w.Mojo.Object.extend({clsname:function(){return"com.RelationBaseMenuElement";},init:function(options){this._super(undefined,options);this.element().addClass("mojo-com-relationmenuelement").addClass("relation-no-box-inner");this.elementId=options.elementId;this._buttonLabel=options.buttonLabel;this._buttonClickFun=options.buttonClickFun;this._elementName=options.elementName;this._elementDescription=options.elementDescription;this._elementDynamicInfo=options.elementDynamicInfo;this._cold_down=options.cold_down;this._messageRemindCount=options.messageRemindCount;this._buttonClickInfo=options.buttonClickInfo;this.hasColdDown=options.hasColdDown;this._coldDownWarning=options.coldDownWarning;this._imgClass=options.imgClass;this._exchangeClass=options.exchangeClass;this._hasHr=options.hasHr;this._descriptionImgClass=options.descriptionImgClass;this._count=undefined;this._setIcon();this._setButton();this._setDetail();if(this._hasHr==true){$('<hr>').appendTo(this.element());}},_setIcon:function(){var self=this;this._icon=$("<div class='icon'></div>").addClass(this._imgClass);this._icon.append("<div class='help'></div>");var dlgtitle=self._elementName;var dlgdesc=self._elementDescription;if(this.elementId=='fun-enroll'){dlgtitle=Mojo.utils.locale('relation','election_title');dlgdesc='';}
this._icon.click(function(){var infoDlg=new Mojo.ui.Dialog(undefined,{title:dlgtitle+Mojo.utils.locale('ui','Introduction'),classes:['relaion-tip-dialog']});new Mojo.ui.Button(undefined,{text:Mojo.utils.locale('common','close'),click:function(){infoDlg.close();}}).element().appendTo(infoDlg._footer);$('<div class="paragraph"></div>').html(dlgdesc).appendTo(infoDlg._content);if(self._descriptionImgClass!=undefined){$('<div class="cartoon"></div>').addClass(self._descriptionImgClass).appendTo(infoDlg._content);}
infoDlg.open();});this._icon.appendTo(this.element());},_setButton:function(){var self=this;this._goButton=new Mojo.ui.Button(undefined,{text:self._buttonLabel,click:self._buttonClickFun,disableClick:function(){if(self._buttonClickInfo.isClickable==false){Mojo.app.toast.show(self._buttonClickInfo.warning);}else if(self.hasColdDown&&self.cd&&self.cd>0){if(self.elementId=='fun-askforquit'){Mojo.app.toast.show(Mojo.utils.locale('relation','slave_ask_for_quit_cooldownwarning',{time:self._formatCDTime(self.cd)}));return;}
if(self.elementId=='fun-donateration'||self.elementId=='fun-alliancedonate'){Mojo.app.toast.show(Mojo.utils.locale('relation','can_not_donate_in_cd'));return;}
Mojo.app.toast.show(self._coldDownWarning);}else{Mojo.app.toast.show(self._coldDownWarning);}},special:self._exchangeClass,});this.element().append(this._goButton.element());this._count=$("<div class='count'></div>");this._goButton.element().append(self._count);if(this._buttonClickInfo&&this._buttonClickInfo.isClickable==false){this._goButton.disable(true);this._count.hide();}else if(this._buttonClickInfo&&this._buttonClickInfo.isClickable==true){this._goButton.disable(false);this.updateButtonNotice(this._messageRemindCount);}},_setDetail:function(){var self=this;this.element().append('<div class="goods-detail"></div>');this._elementNameDiv=$('<div></div>').addClass("goods-name").html(this._elementName).appendTo(this.element().find('.goods-detail'));this._dynamicinfo=$('<div></div>').addClass("goods-dynamicinfo").html(this._elementDynamicInfo||'').appendTo(this.element().find('.goods-detail'));this._elementDescriptionDiv=$('<div></div>').addClass("goods-description").html(this._elementDescription).appendTo(this.element().find('.goods-detail'));if(self.elementId=='fun-free'){self._freeRelationDesc();}else if(this._buttonClickInfo&&this._buttonClickInfo.isClickable==true&&this.hasColdDown&&this._cold_down&&this._cold_down>0){this.cd=this._cold_down;this.showCd();}},_freeRelationDesc:function(){var self=this;if(!self._lblCd){self._lblCd=new Mojo.ui.Label(undefined,{text:'',classes:['cd','free-relation'],});self._lblCd.element().insertBefore(self.element().find('.goods-description'));}
if(parseInt(self._options.relationInfo.slave_has_taxed)>=parseInt(self._options.relationInfo.tax_to_free)){self._lblCd.element().addClass('text-red');}else{this._goButton.disable(true);}
self._lblCd.text(Mojo.utils.locale('relation','free_expiretax')+self._options.relationInfo.slave_has_taxed+'/'+self._options.relationInfo.tax_to_free);},showCd:function(){var self=this;if(self.cd==undefined||self.cd==0)return;this._goButton.disable(true);if(this._buttonClickInfo.slave_unite_rebel_status!=undefined&&this._buttonClickInfo.slave_unite_rebel_status==1){this._goButton.disable(false);}
if(!self._lblCd){self._lblCd=new Mojo.ui.Label(undefined,{text:'',classes:['cd','text-red'],});self._lblCd.element().insertBefore(self.element().find('.goods-description'));}
self._lblCd.text(Mojo.utils.locale('common','in_cd')+self._formatCDTime(self.cd));self._lblCd.show();self._interval=w.setInterval(function(){if(self.cd!=undefined&&self.cd>1){self.cd--;self._lblCd.text(Mojo.utils.locale('common','in_cd')+self._formatCDTime(self.cd));}else{self.cd=0;w.clearInterval(self._interval);self._goButton.disable(false);self._lblCd.hide();}},1000);},_formatCDTime:function(sec){var str='';var dd=parseInt(sec/86400);var hh=parseInt((sec%86400)/3600);var mm=parseInt((sec%3600)/60);var ss=sec%60;if(dd>0){str=dd+Mojo.utils.locale('common','day')+hh+Mojo.utils.locale('common','hour');}else if(hh>0){str=hh+Mojo.utils.locale('common','hour')+mm+Mojo.utils.locale('common','minute');}else if(mm>0){str=mm+Mojo.utils.locale('common','minute')+ss+Mojo.utils.locale('common','second');}else{str=ss+Mojo.utils.locale('common','second');}
return str;},disableButtonStatus:function(level){this._goButton.disable(false);},undisableButtonStatus:function(level){this._goButton.disable(true);},updateButtonNotice:function(count){if(count!=0){if(count<10){this._count.html(count);}else{this._count.html("N");}
this._count.show();}else{this._count.hide();}},_getDefaultOptions:function(){return $.extend(true,this._super(),{zIndex:1300});},update:function(params){if(params.buttonClickInfo!=undefined&&params.buttonClickInfo!=null){this._buttonClickInfo=params.buttonClickInfo;if(this._buttonClickInfo.isClickable==false){this._goButton.disable(true);this._count.hide();}else if(this._buttonClickInfo.isClickable==true){if(this.cd<=0||this.cd==undefined)
this._goButton.disable(false);if(params.messageRemindCount!=undefined&&params.messageRemindCount!=null){this.updateButtonNotice(params.messageRemindCount);}
if(params.code_down!=undefined&&params.code_down!=null&&params.code_down>0&&(this.cd<=0||this.cd==undefined)){this.cd=params.code_down;if(params.buttonClickInfo.slave_unite_rebel_status!=undefined){this._buttonClickInfo.slave_unite_rebel_status=params.buttonClickInfo.slave_unite_rebel_status;}
this.showCd();}}}
if(params.elementDynamicInfo!=undefined&&params.elementDynamicInfo!=null){this._dynamicinfo.html(params.elementDynamicInfo);}
if(params.elementName!=undefined&&params.elementName!=null){this._elementNameDiv.html(params.elementName);}
if(params.elementDescription!=undefined&&params.elementDescription!=null){this._elementDescriptionDiv.html(params.elementDescription);}
if(params.buttonLebel!=undefined&&params.buttonLebel!=null){this._goButton.text(params.buttonLebel);}
if(this.elementId=='fun-free'){this._options.relationInfo=params.code_down;this._freeRelationDesc();}},_initEvent:function(){var self=this;}});})(window,jQuery);;(function(w,$,undefined){w.Mojo=w.Mojo||{};w.Mojo.com=w.Mojo.com||{};w.Mojo.com.ExplanationDialog=w.Mojo.ui.Dialog.extend({clsname:function(){return"com.ExplanationDialog";},init:function(id,options){this._super(id,options);this.element().addClass("mojo-com-explanationdialog");this._addContent();this._addButton();},_getDefaultOptions:function(){return $.extend(true,this._super(),{title:Mojo.utils.locale('common','explanation'),picture:undefined,explanation:undefined});},_addContent:function(){var paragraph=$("<div class='paragraph'></div>").html(Mojo.utils.locale('force','explanation_content'));paragraph.appendTo(this._content);$("<div class='picture'></div>").addClass(this._options.picture).appendTo(this._content);$("<div class='paragraph'></div>").html(this._options.explanation).appendTo(this._content);},_addButton:function(){var self=this;this._footer.append((new Mojo.ui.Button('close-btn',{text:Mojo.utils.locale('ui','Close'),click:function(){self.close();}})).element());}});})(window,jQuery,undefined);;(function(w,$,undefined){w.Mojo=w.Mojo||{};w.Mojo.com=w.Mojo.com||{};w.Mojo.com.ForceEnemyMember=w.Mojo.ui.Dialog.extend({clsname:function(){return"com.ForceEnemyMember";},init:function(options){this._super('com-force-member',options);this.element().addClass('mojo-com-forceenemymember');this.forceMemberList=undefined;this._forceProfile=this._options.getController().getForceProfile();this._playerProfile=this._options.getController().getPlayerProfile();this._createList();},_addTabs:function(){this._tabs=new Mojo.ui.Tabs('tabs-enemymember');this._tabs.addTab(this._options.forceName);this.element().append(this._tabs.element());this._panel=this._tabs.element().find('.panel').addClass('box-outter');},_addHeader:function(){this._header=new Mojo.ui.Label(undefined,{text:Mojo.utils.locale('force','member_count')+this._forceProfile.member_num+'/'+this._forceProfile.member_num_limit,classes:['enemymember-count'],});if(this._options.showHeader){this._header.element().appendTo(this.forceMemberList._header);}},update:function(data){var self=this;if(data!=undefined&&data.player_num!=this._forceProfile.member_num){this._header.text(Mojo.utils.locale('force','member_count')+data.player_num+'/'+data.player_num_limit);}
for(var i=0;i<data.list.length;i++){if(this._playerProfile.id==data.list[i].id){if(this._playerProfile.position_id!=data.list[i].position_id){this._options.getController().sync(function(){self._forceProfile=self._options.getController().getForceProfile();self._playerProfile=self._options.getController().getPlayerProfile();});break;}}}},_createList:function(){var self=this;var member={id:this._playerProfile.id,position_id:parseInt(this._playerProfile.position_id),member_count:parseInt(this._forceProfile.member_num),forceProfile:this._forceProfile};var forceMemberListOptions={type:'member',member:member,refreshCallback:function(){self.refresh();},updateCallback:function(data){self.update(data);}};if(Mojo.utils.isNone(this._options.forceMemberElementOptions)==false){forceMemberListOptions["forceMemberElementOptions"]=this._options.forceMemberElementOptions;}
if(Mojo.utils.isNone(this._options.forceMemberListOptions)==false){$.extend(true,forceMemberListOptions,this._options.forceMemberListOptions);}
this.forceMemberList=new Mojo.com.ForceMemberList(undefined,forceMemberListOptions);this.forceMemberList.element().appendTo(this._content);},_addButton:function(){var self=this;this._backBtn=new Mojo.ui.Button(undefined,{text:Mojo.utils.locale('common','back'),click:function(){if(self._options.backCallback instanceof Function){self._options.backCallback(self);}},classes:['force-back-btn'],});this._backBtn.element().appendTo(this.element());},_addCloseButton:function(){var self=this;this.closeBtn=new Mojo.ui.Button('close-btn',{text:Mojo.utils.locale('ui','Close'),click:function(){self.close();},});this.closeBtn.element().appendTo(this._footer);},refresh:function(){var self=this;this._options.getController().sync(function(){self._profileUpdate();});},_profileUpdate:function(){this._forceProfile=this._options.getController().getForceProfile();this.forceMemberList.element().remove();this._createList();this._addHeader();},_getDefaultOptions:function(){var self=this;return $.extend(true,this._super(),{backCallback:function(){self.element().hide();self._options.getController().switchToHome();},forceMemberElementOptions:undefined,forceMemberListOptions:undefined,title:undefined,});},localeCat:function(){return'force';},});})(window,jQuery);;(function(w,$,undefined){w.Mojo=w.Mojo||{};w.Mojo.com=w.Mojo.com||{};w.Mojo.com.BattlePreviewDialog=w.Mojo.ui.Dialog.extend({clsname:function(){return"com.BattlePreviewDialog";},init:function(data,options){this._data=data;this._super(undefined,options);this.element().addClass('mojo-com-battlepreviewdlg');this._addContent();this._addHandleButtons();},_addContent:function(){var self=this;this._name=$('<div class="name"></div>').appendTo(this._content);this._player=$('<div class="player"></div>').appendTo(this._name);$('<div class="player_icon"></div>').appendTo(this._player);this._playerName=$('<div class="player_name"></div>').html(self._data.player_name).appendTo(this._player);this._vs=$('<div class="vs"></div>').html('VS').appendTo(this._name);this._opp=$('<div class="opp"></div>').appendTo(this._name);$('<div class="opp_icon"></div>').appendTo(this._opp);this._oppName=$('<div class="opp_name"></div>').html(self._data.opponent_name).appendTo(this._opp);if(self._data.info==null||self._data.info==undefined){this._ifwin=$('<div class="ifwin"></div>').appendTo(this._content);this._win=$('<div class="win"></div>').html(Mojo.utils.locale('common','when win')).appendTo(this._ifwin);this._ifwin.append((new Mojo.ui.Label(undefined,{classes:['winxp'],text:self._data.win_xp,})).element());this._ifwin.append((new Mojo.ui.Label(undefined,{classes:['winvm'],text:self._data.win_vm,})).element());this._iflose=$('<div class="iflose"></div>').appendTo(this._content);this._lose=$('<div class="lose"></div>').html(Mojo.utils.locale('common','when lose')).appendTo(this._iflose);this._iflose.append((new Mojo.ui.Label(undefined,{classes:['losexp'],text:self._data.lose_xp,})).element());this._iflose.append((new Mojo.ui.Label(undefined,{classes:['losevm'],text:self._data.lose_vm,})).element());if(this._options.atackBtnText==Mojo.utils.locale('battle','action')){$("<div></div>").addClass('tips').appendTo(this._content).html(Mojo.utils.locale('battle','battle_tip'));}else{$("<div></div>").addClass('tips').appendTo(this._content).html(Mojo.utils.locale('rob','rob_tip'));}
if(self._data.entity_rate!=null&&self._data.entity_rate!=undefined&&self._data.entity_rate!=''){this._rate=$('<div class="rate"></div>').html(self._data.entity_rate).appendTo(this._ifwin);}else if(!self._options.pk_mode&&self._options.entity_id==''){this._rate=$('<div class="rate"></div>').html(Mojo.utils.locale('battle','win_message_06')).appendTo(this._ifwin);}}else{this._resultInfo=$('<div class="info"></div>').html(self._data.info).appendTo(this._content);}},_addHandleButtons:function(){var self=this;if(self._data.info==null||self._data.info==undefined){this._attackBtn=new Mojo.ui.Button('attack-btn',{special:'button-big-red',text:self._options.atackBtnText,click:function(){self._attackBtn.disable(true);if(self._options.pk_mode){Mojo.ajax('/friend/Pk',{friend_id:self._options.opponent_id,},function(result){if(result.errorCode==0){(new Mojo.com.BattleResultDialog(result.data,{opponent_id:self._options.opponent_id,opponent_name:self._options.opponent_name,pk_mode:true,type:self._options.type,})).open(true);self.close();}else{(new Mojo.com.TipsDialog({title:Mojo.utils.locale('common','tips'),message:result.errorMsg,})).open(true);self.close();}},function(){},{showWait:true,});}else{if(self._options.entity_id!=''){Mojo.track.onEvent('07_041');Mojo.ajax('/battle/Rob',{opponent_id:self._options.opponent_id,entity_id:self._options.entity_id,message_id:self._options.message_id,},function(result){if(result.errorCode==0){if(result.data.win==1){Mojo.track.onEvent('07_042');self._options.callback(self._options.entity_id,result.data.entity.valid,result.data.entity.medium_image);}else{Mojo.track.onEvent('07_043');self._options.callback(self._options.entity_id,0,'');}
self._options.fightProfile.data(result.data.player);self.close();var dlgtitle='';if(result.data.win==1){dlgtitle=Mojo.utils.locale('battle','battle_result_formation_title_win');}else if(result.data.win==0){dlgtitle=Mojo.utils.locale('battle','battle_result_formation_title_lose');}
setTimeout(function(){Mojo.ajax('/battle/Detail',{oid:self._options.opponent_id},function(response){if(response.errorCode==0){Mojo.ui.BattleAnimation.onclose=function(){var brdlg=new Mojo.com.BattleResultDialog(result.data,{prevDlg_atackBtnText:Mojo.utils.locale('rob','rob'),prevDlg_title:Mojo.utils.locale('rob','rob result preview'),opponent_id:self._options.opponent_id,opponent_name:self._options.opponent_name,entity_id:self._options.entity_id,message_id:self._options.message_id,fightProfile:self._options.fightProfile,callback:function(entity_id,entity_valid,entity_img){self._options.callback(entity_id,entity_valid,entity_img);},show_detail_first:true,rBtnClickCallback:function(that){var detailDlg=new Mojo.com.BattleDetailDialog(response.data,{title:dlgtitle,pid:self._options.opponent_id,entityId:self._options.entity_id,vm:result.data.vm,xp:result.data.xp,entity:result.data.entity,show_detail_first:true,close:function(){that.show();},});detailDlg.open();}});brdlg.open(true);};Mojo.ui.BattleAnimation.openBattle(response);}else{}},function(){},{showWait:true});},100);}else{(new Mojo.com.TipsDialog({title:Mojo.utils.locale('common','tips'),message:result.errorMsg,})).open(true);self.close();}},function(){},{showWait:true,});}else{if(self._options.type=='fight'){Mojo.track.onEvent('08_031');}else if(self._options.type=='enemy'){Mojo.track.onEvent('08_061');}
Mojo.ajax('/battle/Attack',{opponent_id:self._options.opponent_id,message_id:self._options.message_id,from:self._options.from},function(result){if(result.errorCode==0){if(self._options.fightProfile){self._options.fightProfile.data(result.data.player);}else if(self._options.forceProfile){self._options.forceProfile.updatePlayerProfile(result.data.player);}
self.close();var dlgtitle='';if(result.data.win==1){dlgtitle=Mojo.utils.locale('battle','battle_result_formation_title_win');}else if(result.data.win==0){dlgtitle=Mojo.utils.locale('battle','battle_result_formation_title_lose');}
setTimeout(function(){Mojo.ajax('/battle/Detail',{oid:self._options.opponent_id},function(response){if(response.errorCode==0){Mojo.ui.BattleAnimation.onclose=function(){var brdlg2=new Mojo.com.BattleResultDialog(result.data,{prevDlg_atackBtnText:Mojo.utils.locale('battle','action'),prevDlg_title:Mojo.utils.locale('battle','battle result preview'),opponent_id:self._options.opponent_id,opponent_name:self._options.opponent_name,message_id:self._options.message_id,fightProfile:self._options.fightProfile,forceProfile:self._options.forceProfile,type:self._options.type,show_detail_first:true,rBtnClickCallback:function(that){var detailDlg2=new Mojo.com.BattleDetailDialog(response.data,{title:dlgtitle,pid:self._options.opponent_id,vm:result.data.vm,xp:result.data.xp,show_detail_first:true,close:function(){that.show();},});detailDlg2.open();}});brdlg2.open(true);};Mojo.ui.BattleAnimation.openBattle(response);}else{}},function(){},{showWait:true});},500);}else{self.close();if(result.errorCode==160003){var dlg=new Mojo.com.CommonDialog(undefined,{title:Mojo.utils.locale('common','capacify_lack'),content:$('<div class="paragraph"></div>').html(Mojo.utils.locale('common','capacify_lack_tip')),leftBtnText:Mojo.utils.locale('common','go_intensify'),leftBtnClick:function(){Mojo.app.redirect('/intensify');},rightBtnText:Mojo.utils.locale('common','go_sale'),rightBtnClick:function(){Mojo.app.redirect('/entity',{selected:3});},close:function(){Mojo.app.redirect('/home');}});dlg.open();}else if(result.errorCode==30100){(new Mojo.com.TipsDialog({title:Mojo.utils.locale('battle','battle_fail_title'),message:Mojo.utils.locale('battle','battle_fail_content'),})).open(true);self.close();}else{(new Mojo.com.TipsDialog({title:Mojo.utils.locale('common','tips'),message:result.errorMsg,})).open(true);}}},function(){},{showWait:true,});}}},});this._footer.append(this._attackBtn.element());}
this._footer.append((new Mojo.ui.Button('close-btn',{text:Mojo.utils.locale('common','close'),click:function(){self.close();},})).element());},_getDefaultOptions:function(){return $.extend(true,this._super(),{atackBtnText:Mojo.utils.locale('battle','action'),title:Mojo.utils.locale('battle','battle result preview'),opponent_id:'',opponent_name:'',entity_id:'',message_id:'',pk_mode:false,type:'',callback:$.noop,fightProfile:null,from:''});},});})(window,jQuery);;(function(w,$,undefined){w.Mojo=w.Mojo||{};w.Mojo.com=w.Mojo.com||{};w.Mojo.com.BattleResultDialog=w.Mojo.ui.Dialog.extend({clsname:function(){return"com.BattleResultDialog";},init:function(data,options){this._data=data;this._super(undefined,options);this.element().addClass('mojo-com-battleresultdlg');this._addContent();if(this._options.show_detail_first==true){this._addHandleButtons2();}else{this._addHandleButtons();}},_addContent:function(){var self=this;if(self._data.win==1){self._options.title=Mojo.utils.locale('battle','battle_result_title_win');if(self._options.entity_id!=''){self._options.title=Mojo.utils.locale('battle','battle_result_title_rob_win');if(self._data.entity.valid==1){if(self._data.friend_name!=undefined){$('<div class="tip"></div>').html(Mojo.utils.locale('battle','win_message_07',{name:self._options.opponent_name,bonus:self._data.entity.name,frdname:self._data.friend_name})).appendTo(this._content);}else{if(Math.random()>0.5){$('<div class="tip"></div>').html(Mojo.utils.locale('battle','win_message_01',{name:self._options.opponent_name,bonus:self._data.entity.name})).appendTo(this._content);}else{$('<div class="tip"></div>').html(Mojo.utils.locale('battle','win_message_02',{name:self._options.opponent_name,bonus:self._data.entity.name})).appendTo(this._content);}}
this._content.append('<div class="reward"></div>');this._entity=new Mojo.com.LargeEntity(self._data.entity);this._content.prepend(this._entity.element());}else if(self._data.entity.valid==0){$('<div class="tip"></div>').html(Mojo.utils.locale('battle','win_message_04',{bonus:self._data.entity.name})).appendTo(this._content);this._content.append('<div class="reward"></div>');}else if(self._data.entity.valid==-1){$('<div class="tip"></div>').html(Mojo.utils.locale('battle','win_message_05',{name:self._options.opponent_name,bonus:self._data.entity.name})).appendTo(this._content);this._content.append('<div class="reward"></div>');}}else{if(self._data.bonus!=undefined&&self._data.bonus!=null){if(self._options.type=='fight'){Mojo.track.onEvent('08_032');}else{Mojo.track.onEvent('08_062');}
if(Math.random()>0.5){$('<div class="tip"></div>').html(Mojo.utils.locale('battle','win_message_01',{name:self._options.opponent_name,bonus:self._data.bonus.name})).appendTo(this._content);}else{$('<div class="tip"></div>').html(Mojo.utils.locale('battle','win_message_02',{name:self._options.opponent_name,bonus:self._data.bonus.name})).appendTo(this._content);}
this._content.append('<div class="reward"></div>');this._entity=new Mojo.com.LargeEntity(self._data.bonus);this._content.prepend(this._entity.element());}else{$('<div class="tip"></div>').html(Mojo.utils.locale('battle','win_message_03',{name:self._options.opponent_name})).appendTo(this._content);this._content.append('<div class="reward"></div>');}}
this._xp=self._data.xp;this._vm=self._data.vm;if(self._options.pk_mode==true){this._xp='+0';this._vm='+0';}
if(this._xp!=undefined&&this._xp!=null){this._content.find('.reward').append((new Mojo.ui.Label(undefined,{classes:['xp'],text:self._xp,})).element());}
if(this._vm!=undefined&&this._vm!=null){this._content.find('.reward').append((new Mojo.ui.Label(undefined,{classes:['vm'],text:self._vm,})).element());}}else{if(self._options.entity_id!=''){self._options.title=Mojo.utils.locale('battle','battle_result_title_rob_lose');}else{if(self._options.type=='fight'){Mojo.track.onEvent('08_033');}else{Mojo.track.onEvent('08_063');}
self._options.title=Mojo.utils.locale('battle','battle_result_title_lose');}
$('<div class="tip"></div>').html(Mojo.utils.locale('battle','lose_message')).appendTo(this._content);this._content.append('<div class="reward"></div>');this._xp=self._data.xp;this._vm=self._data.vm;if(self._options.pk_mode==true){this._xp='+0';this._vm='-0';}
this._content.find('.reward').append((new Mojo.ui.Label(undefined,{classes:['xp'],text:self._xp,})).element());this._content.find('.reward').append((new Mojo.ui.Label(undefined,{classes:['vm'],text:self._vm,})).element());}
this._title.html(this._options.title);},_addHandleButtons:function(){var self=this;if(self._options.entity_id!=''&&self._data.entity!=null&&self._data.entity.valid!=-1){}else{if(self._options.tutorial_mode||(self._options.pk_mode==false&&self._data.times>=3)){}else{this._footer.append((this._attackBtn=new Mojo.ui.Button('attack-btn',{special:'button-big-red',text:Mojo.utils.locale('common','attack_again'),click:function(){if(self._options.pk_mode){(new Mojo.com.BattlePreviewDialog({win_xp:'+0',win_vm:'+0',lose_xp:'+0',lose_vm:'-0',info:undefined,},{opponent_id:self._options.opponent_id,opponent_name:self._options.opponent_name,pk_mode:true,})).open(true);self.close();}else{if(self._options.entity_id!=''){Mojo.ajax('/battle/preview',{opponent_id:self._options.opponent_id,entity_id:self._options.entity_id,message_id:self._options.message_id,},function(result){if(result.errorCode==0){if(result.data.win==1){self._options.callback(self._options.entity_id,result.data.entity.valid,result.data.entity.medium_image);}else{self._options.callback(self._options.entity_id,0,'');}
self._options.fightProfile.data(result.data.player);(new Mojo.com.BattlePreviewDialog(result.data,{title:self._options.prevDlg_title,atackBtnText:self._options.prevDlg_atackBtnText,opponent_id:self._options.opponent_id,opponent_name:self._options.opponent_name,message_id:self._options.message_id,entity_id:self._options.entity_id,fightProfile:self._options.fightProfile,callback:function(entity_id,entity_valid,entity_img){self._options.callback(entity_id,entity_valid,entity_img);},})).open(true);self.close();}else if(result.errorCode==10003){self.hide();(new Mojo.com.SpDialog(result.data,{title:Mojo.utils.locale('common','no enough stamina'),message:result.errorMsg,fightProfile:self._options.fightProfile,close:function(){self.show();},})).open(true);}else{self.hide();(new Mojo.com.TipsDialog({title:Mojo.utils.locale('common','tips'),message:result.errorMsg,close:function(){self.show();},})).open(true);}},function(){},{showWait:true});}else{Mojo.ajax('/battle/preview',{opponent_id:self._options.opponent_id,message_id:self._options.message_id,},function(result){if(result.errorCode==0){(new Mojo.com.BattlePreviewDialog(result.data,{title:self._options.prevDlg_title,atackBtnText:self._options.prevDlg_atackBtnText,opponent_id:self._options.opponent_id,opponent_name:self._options.opponent_name,message_id:self._options.message_id,fightProfile:self._options.fightProfile,forceProfile:self._options.forceProfile,})).open(true);self.close();}else if(result.errorCode==10003){self.hide();(new Mojo.com.SpDialog(result.data,{title:Mojo.utils.locale('common','no enough stamina'),message:result.errorMsg,fightProfile:self._options.fightProfile,close:function(){self.show();},})).open(true);}else if(result.errorCode==30100){(new Mojo.com.TipsDialog({title:Mojo.utils.locale('battle','battle_fail_title'),message:Mojo.utils.locale('battle','battle_fail_content'),})).open(true);self.close();}else{self.hide();(new Mojo.com.TipsDialog({title:Mojo.utils.locale('common','tips'),message:result.errorMsg,close:function(){self.show();},})).open(true);}},function(){},{showWait:true});}}},})).element());}}
if(this._options.tutorial_mode===false){this._footer.append((this._detailBtn=new Mojo.ui.Button('detail-btn',{text:Mojo.utils.locale('battle','formation detail'),click:function(){if(self._options.pk_mode){Mojo.ajax('/battle/Detail',{type:'pk',oid:self._options.opponent_id},function(result){if(result.errorCode==0){self.hide();(new Mojo.com.BattleDetailDialog(result.data,{pid:self._options.opponent_id,pkMode:true,vm:'+0',xp:'+0',entity:null,close:function(){self.show();},})).open(true);}else{}},function(){},{showWait:true});}else{if(self._options.entity_id!=''){if(self._data.win==1){}else{Mojo.track.onEvent('07_044');}
Mojo.ajax('/battle/detail',{oid:self._options.opponent_id},function(result){if(result.errorCode==0){self.hide();(new Mojo.com.BattleDetailDialog(result.data,{pid:self._options.opponent_id,entityId:self._options.entity_id,vm:self._data.vm,xp:self._data.xp,entity:self._data.entity,close:function(){self.show();},})).open(true);}else{}},function(){},{showWait:true});}else{if(self._data.win==1){}else if(self._options.type=='fight'){Mojo.track.onEvent('08_034');}else{Mojo.track.onEvent('08_064');}
Mojo.ajax('/battle/detail',{oid:self._options.opponent_id},function(result){if(result.errorCode==0){self.hide();(new Mojo.com.BattleDetailDialog(result.data,{pid:self._options.opponent_id,vm:self._data.vm,xp:self._data.xp,close:function(){self.show();},})).open(true);}else{}},function(){},{showWait:true});}}},special:((self._options.entity_id!=''&&self._data.entity!=null&&self._data.entity.valid!=-1)?'button-big-red':''),})).element());}
if(self._options.entity_id!=''&&self._data.entity!=null&&self._data.entity.valid!=-1){this._footer.append((new Mojo.ui.Button('close-btn',{text:Mojo.utils.locale('ui','Close'),click:function(){if(self._options.tutorial_mode===true){self.close();Mojo.app.redirect('/rob');}else{self.close();}},})).element());}else{if(self._options.tutorial_mode===true||(self._options.pk_mode==false&&self._data.times>=3)){this._footer.append((new Mojo.ui.Button('close-btn',{text:Mojo.utils.locale('ui','Close'),click:function(){self.close();if(self._options.tutorial_mode===true){Mojo.app.redirect('/battle');}},})).element());}else{}}
if(self._data.win==0){this._detailBtn.element().addClass('button-big-red');this._attackBtn.element().removeClass('button-big-red');this._footer.append(this._attackBtn.element());}},_addHandleButtons2:function(){var self=this;if(self._options.entity_id!=''&&self._data.entity!=null&&self._data.entity.valid!=-1){}else{if(self._options.tutorial_mode||(self._options.pk_mode==false&&self._data.times>=3)){this._footer.append((this._attackBtn=new Mojo.ui.Button('close-btn',{text:Mojo.utils.locale('battle','formation detail'),click:function(){self.hide();if(self._options.rBtnClickCallback instanceof Function){self._options.rBtnClickCallback(self);}},})).element());}else{this._footer.append((this._attackBtn=new Mojo.ui.Button('attack-btn',{special:'button-big-red',text:Mojo.utils.locale('common','attack_again'),click:function(){if(self._options.pk_mode){(new Mojo.com.BattlePreviewDialog({win_xp:'+0',win_vm:'+0',lose_xp:'+0',lose_vm:'-0',info:undefined,},{opponent_id:self._options.opponent_id,opponent_name:self._options.opponent_name,pk_mode:true,})).open(true);self.close();}else{if(self._options.entity_id!=''){Mojo.ajax('/battle/preview',{opponent_id:self._options.opponent_id,entity_id:self._options.entity_id,message_id:self._options.message_id,},function(result){if(result.errorCode==0){if(result.data.win==1){self._options.callback(self._options.entity_id,result.data.entity.valid,result.data.entity.medium_image);}else{self._options.callback(self._options.entity_id,0,'');}
self._options.fightProfile.data(result.data.player);(new Mojo.com.BattlePreviewDialog(result.data,{title:self._options.prevDlg_title,atackBtnText:self._options.prevDlg_atackBtnText,opponent_id:self._options.opponent_id,opponent_name:self._options.opponent_name,message_id:self._options.message_id,entity_id:self._options.entity_id,fightProfile:self._options.fightProfile,callback:function(entity_id,entity_valid,entity_img){self._options.callback(entity_id,entity_valid,entity_img);},})).open(true);self.close();}else if(result.errorCode==10003){self.hide();(new Mojo.com.SpDialog(result.data,{title:Mojo.utils.locale('common','no enough stamina'),message:result.errorMsg,fightProfile:self._options.fightProfile,close:function(){self.show();},})).open(true);}else{self.hide();(new Mojo.com.TipsDialog({title:Mojo.utils.locale('common','tips'),message:result.errorMsg,close:function(){self.show();},})).open(true);}},function(){},{showWait:true});}else{Mojo.ajax('/battle/preview',{opponent_id:self._options.opponent_id,message_id:self._options.message_id,},function(result){if(result.errorCode==0){(new Mojo.com.BattlePreviewDialog(result.data,{title:self._options.prevDlg_title,atackBtnText:self._options.prevDlg_atackBtnText,opponent_id:self._options.opponent_id,opponent_name:self._options.opponent_name,message_id:self._options.message_id,fightProfile:self._options.fightProfile,forceProfile:self._options.forceProfile,})).open(true);self.close();}else if(result.errorCode==10003){self.hide();(new Mojo.com.SpDialog(result.data,{title:Mojo.utils.locale('common','no enough stamina'),message:result.errorMsg,fightProfile:self._options.fightProfile,close:function(){self.show();},})).open(true);}else if(result.errorCode==30100){(new Mojo.com.TipsDialog({title:Mojo.utils.locale('battle','battle_fail_title'),message:Mojo.utils.locale('battle','battle_fail_content'),})).open(true);self.close();}else{self.hide();(new Mojo.com.TipsDialog({title:Mojo.utils.locale('common','tips'),message:result.errorMsg,close:function(){self.show();},})).open(true);}},function(){},{showWait:true});}}},})).element());}}
if(this._options.tutorial_mode===false){if(self._data.times>=3){this._footer.append((this._detailBtn=new Mojo.ui.Button('close-btn',{text:Mojo.utils.locale('ui','Close'),click:function(){self.close();},})).element());}else{this._footer.append((this._detailBtn=new Mojo.ui.Button('close-btn',{text:Mojo.utils.locale('battle','formation detail'),click:function(){self.hide();if(self._options.rBtnClickCallback instanceof Function){self._options.rBtnClickCallback(self);}},})).element());}}},_getDefaultOptions:function(){return $.extend(true,this._super(),{prevDlg_atackBtnText:Mojo.utils.locale('battle','action'),prevDlg_title:Mojo.utils.locale('battle','battle result preview'),title:Mojo.utils.locale('battle','battle_result_title'),opponent_id:'',opponent_name:'',entity_id:'',message_id:'',pk_mode:false,tutorial_mode:false,fightProfile:null,type:'',zIndex:1003,callback:$.noop,deviceaware:true});},});})(window,jQuery);;(function(w,$,undefined){w.Mojo=w.Mojo||{};w.Mojo.com=w.Mojo.com||{};w.Mojo.com.SpDialog=w.Mojo.ui.Dialog.extend({clsname:function(){return"com.SpDialog";},init:function(data,options){this._data=data;this._super(undefined,options);this.element().addClass('mojo-com-spdlg');var self=this;this._message=$('<div class="paragraph"></div>').appendTo(this._content);self._goods=$('<div class="goods"></div>').appendTo(this._content);self._card=$('<div class="card"></div>').appendTo(self._goods);self._img=$('<img></img>').attr('src',''+this._data.props.goods_small_image).appendTo(self._card);this._count=$('<div class="count"></div>').html(this._data.props.count).appendTo(self._card);self._name=$('<div class="name"></div>').html(this._data.props.goods_name).appendTo(self._goods);self._desc=$('<div class="desc"></div>').html(this._data.props.goods_description).appendTo(self._goods);self._price=$('<div class="price"></div>').appendTo(self._goods);self._priceTitle=$('<div class="price-title"></div>').html(Mojo.utils.locale('common','price in mall')).appendTo(self._price);self._priceIcon=$('<div class="price-icon"></div>').appendTo(self._price);self._priceValue=$('<div class="price-value"></div>').appendTo(self._price);if(this._data.props.goods_vm>0){self._priceValue.html(this._data.props.goods_vm);}else{self._priceValue.html(this._data.props.goods_rm);}
this._interval=w.setInterval(function(){self._calcSp();self._refresh();},1000);this._addHandleButtons();$("<div class='tip'></div>").text(Mojo.utils.locale("common","not enough sp")).appendTo(this.element());this._refresh();Mojo.track.onEvent('18_000');},_refresh:function(){this._count.html(this._data.props.count);this._message.html(this._genSptip(this._data));if(this._data.props.count<=0){this._useBtn.disable(true);}else{this._useBtn.disable(false);}},_genSptip:function(data){var str=""+this._options.message+"<br>"+
Mojo.utils.locale('common','time for next sp')+this._genSpRestore(data)+"<br>"+
Mojo.utils.locale('common','time for all sp')+this._genSpFullRestore(data)+"<br>";return str;},_genSpRestore:function(data){var str='';if(data.sp==data.stamina){str=Mojo.utils.locale('common','has reached the maximum');}else{str=Mojo.utils.formatTime(data.sp_second);}
return str;},_genSpFullRestore:function(data){var str='';if(data.sp==data.stamina){str=Mojo.utils.locale('common','has reached the maximum');}else{str=Mojo.utils.formatTime((data.stamina-data.sp-1)*data.sp_restore_pp+data.sp_second);}
return str;},_calcSp:function(){if(this._data.sp<this._data.stamina){this._data.sp_second--;if(this._data.sp_second<0){this._data.sp_second=this._data.sp_restore_pp;this._data.sp++;}}},_addBuyBtn:function(){var self=this;self._buyBtn=(new Mojo.ui.Button('buy-btn',{text:Mojo.utils.locale('common','buy'),click:function(){self.hide();var buyWarningDialog=new Mojo.ui.Dialog(undefined,{title:Mojo.utils.locale('common','buy_warning_title'),content:$('<div class="tip">'+Mojo.utils.locale('common','buy_warning_content')+'</div>'),deviceaware:true});new Mojo.ui.Button(undefined,{text:Mojo.utils.locale('common','sure_buy'),special:"button-big-red",click:function(){buyWarningDialog.close();self.show();Mojo.track.onEvent('18_001');Mojo.ajax('/mall/Buy',{id:self._data.props.goods_id,},function(result){self._buyBtn.disable(false);if(result.errorCode==0){self._data.props.count=parseInt(self._data.props.count)+1;self._data.props.id=result.data.entities[0].player_entity_id;self._refresh();Mojo.app.toast.show(Mojo.utils.locale("common","buy sp succ"));if(self._options.forceProfile){self._options.forceProfile.updatePlayerProfile(result.data.player);}}else{(new Mojo.com.BuyFailDialog({message:result.errorMsg,})).open(true);}});self._buyBtn.disable(true);}}).element().appendTo(buyWarningDialog._footer);new Mojo.ui.Button(undefined,{text:Mojo.utils.locale('common','think_again'),special:'button-big-blue',click:function(){buyWarningDialog.close();self.show();}}).element().appendTo(buyWarningDialog._footer);buyWarningDialog.open(true);}}));this._footer.append(self._buyBtn.element());},_addUseBtn:function(){var self=this;this._useBtn=(new Mojo.ui.Button('use-btn',{text:Mojo.utils.locale('common','use'),special:'button-big-red',click:function(){Mojo.track.onEvent('18_002');Mojo.ajax('/entity/Use',{id:self._data.props.id,},function(result){if(result.errorCode==0){self._data.sp_second=result.data.player.sp_second;self._data.sp_restore_pp=result.data.player.sp_restore_pp;self._data.sp=result.data.player.sp;self._data.stamina=result.data.player.stamina;self._data.props.count=parseInt(self._data.props.count)-1;self._refresh();if(self._options.fightProfile){self._options.fightProfile.spRefresh(self._data.sp);}else if(self._options.forceProfile){self._options.forceProfile.updatePlayerProfile(result.data.player);}
Mojo.app.toast.show(Mojo.utils.locale('common','add_sp',{name:self._data.props.goods_name}));if(result.data.player.sp>=result.data.player.stamina){w.clearInterval(self._interval);self.close();}}else{}},function(){},{showWait:true});},}));this._footer.append(this._useBtn.element());},_addHandleButtons:function(){this._addUseBtn();this._addBuyBtn();},_getDefaultOptions:function(){var self=this;return $.extend(true,this._super(),{title:Mojo.utils.locale('common','no enough stamina'),message:'',zIndex:1021,close:function(){w.clearInterval(self._interval);},fightProfile:null,});},});})(window,jQuery);;(function(w,$,undefined){w.Mojo=w.Mojo||{};w.Mojo.com=w.Mojo.com||{};w.Mojo.com.CrazyForceMarchPanel=w.Mojo.Object.extend({clsname:function(){return"com.crazyforcemarchpanel";},init:function(data,options){this._super('com-crazyforce-march-panel',options);var self=this;self._data=data;this.element().addClass('com-relation-free-panel');this._forceProfile=Mojo.page.Force.getController().getForceProfile();this._playerProfile=Mojo.page.Force.getController().getPlayerProfile();this._elementsList=[];this._list=new Mojo.com.ScrollPanel(undefined);this.element().append(this._list.element());this._addHeader();this._marchExpireTime=undefined;this._showExpire();this._list.appendData(this._marchExpireTime);this._elementsList.push(this._marchExpireTime);var march_content=undefined;if(this._data.battleType=='attack'){march_content="<br/><br/>"+Mojo.utils.locale("force","march_content_"+self._data.action+'_attack',{forcename:self._data.opponentName});}else{march_content="<br/><br/>"+Mojo.utils.locale("force","march_content_"+self._data.action+'_defence');}
this._marchContent=new Mojo.ui.Label(undefined,{text:march_content,classes:['march-content'],});this._list.appendData(this._marchContent);this._elementsList.push(this._marchContent);if(self._options.isForceOwner(true)){if(self._data.battleType=='attack'){this._createRetreatButton();this._list.appendData(this._retreatBtn);this._elementsList.push(this._retreatBtn);}}
self._updateinterval=w.setInterval(function(){self._updateStatus();},30000);},_addHeader:function(){var self=this;this._forceWarNoticeDiv=new Mojo.ui.Label(undefined,{classes:['page-tips'],});if(this._data.battleType=="attack"){Mojo.page.Force.getController().sync(function(){self._forceProfile=Mojo.page.Force.getController().getForceProfile();self._forceWarNoticeDiv.text(Mojo.utils.locale('force','forcewar_no_battle',{challenge:self._forceProfile.challenge,challenge_limit:self._forceProfile.challenge_limit}));self._list._header.append(self._forceWarNoticeDiv.element());});}else{self._forceWarNoticeDiv.text(Mojo.utils.locale('force','forcewar_march_header'));}},_updateChallange:function(that,data){if(that._forceWarNoticeDiv!=undefined){var force=data.force_info;that._forceWarNoticeDiv.html(Mojo.utils.locale('force','forcewar_no_battle',{challenge:force.challenge,challenge_limit:force.challenge_limit}));}},_showExpire:function(){var self=this;var march_expiretime="march_expiretime_"+self._data.action+"_"+self._data.battleType;if(Mojo.utils.isNone(self._marchExpireTime)){self._marchExpireTime=new Mojo.ui.Label(undefined,{classes:['march-time'],});}else{w.clearInterval(self._showinterval);}
self._marchExpireTime.text("<br/>"+Mojo.utils.locale("force",march_expiretime,{expiretime:self._formatExpireTime(self._data.expireTime),forcename:self._data.opponentName}));self._showinterval=w.setInterval(function(){if(self._data.expireTime!=undefined&&self._data.expireTime>1){self._data.expireTime--;self._marchExpireTime.text("<br/>"+Mojo.utils.locale("force",march_expiretime,{expiretime:self._formatExpireTime(self._data.expireTime),forcename:self._data.opponentName}));}else{self._data.expireTime=0;w.clearInterval(self._showinterval);self._marchExpireTime.text("<br/>"+Mojo.utils.locale("force",march_expiretime,{expiretime:self._formatExpireTime(self._data.expireTime),forcename:self._data.opponentName}));self._updateStatus();w.clearInterval(self._showinterval);w.clearInterval(self._updateinterval);}},1000);},_updateStatus:function(){var self=this;var partnerIds=Mojo.utils.getSomething("partnerId",false);self._options.forceWarAjax('/forceCrazy/battleStatus',{type:self._data.battleType,force_id:partnerIds},function(response){w.clearInterval(self._showinterval);if(response&&response.errorCode==0){w.clearInterval(self._updateinterval);self._options.createCrazyforceBattle();}else if(response.errorCode==190701){self._data.expireTime=response.data.wait;self._showExpire();}else if(response.errorMsg!=undefined&&response.data.title!=undefined){w.clearInterval(self._updateinterval);(new Mojo.com.CommonDialog(undefined,{title:response.data.title,content:$("<div class='tip'></div>").html(response.errorMsg),rightBtnText:Mojo.utils.locale('common','close'),rightBtnClick:function(that){that.close();Mojo.app.redirect('/force',{index:2});},})).open();}},function(){});},_formatExpireTime:function(sec){var str='';var dd=parseInt(sec/86400);var hh=parseInt((sec%86400)/3600);var mm=parseInt((sec%3600)/60);var ss=sec%60;if(dd>0){str=dd+Mojo.utils.locale('common','day')+hh+Mojo.utils.locale('common','hour');}else if(hh>0){str=hh+Mojo.utils.locale('common','hour')+mm+Mojo.utils.locale('common','minute');}else if(mm>0){str=mm+Mojo.utils.locale('common','minute')+ss+Mojo.utils.locale('common','second');}else{str=ss+Mojo.utils.locale('common','second');}
return str;},_createRetreatButton:function(){var self=this;this._retreatBtn=new Mojo.ui.Button(self._data.action+"-march-retreat-btn",{text:self.locale('forcewar_retreat'),click:function(){if(self._options.isForceOwner(true)==false){if(self.action=='uniterebel'){Mojo.app.toast.show(Mojo.utils.locale('force','uniterebel_retreat_tip'));}else{Mojo.app.toast.show(Mojo.utils.locale('force','forcewar_retreat_tip'));}
return;}
(new Mojo.com.CommonDialog(undefined,{title:Mojo.utils.locale('force','forcewar_retreat'),content:$('<div class="tip"></div>').html(Mojo.utils.locale('force','crazywar_retreat_question',{forcename:self._data.opponentName,action:self.locale(self._data.action)})),leftBtnText:Mojo.utils.locale('force','forcewar_retreat'),leftBtnClick:function(that){that.close();self._options.forceWarAjax("/forceCrazy/battleSurrender",{},function(response){var sucesscontent=undefined;if(response.errorCode==0){if(self._data.battleType=="attack"){sucesscontent=Mojo.utils.locale('force',"crazywar_attack_retreat_answer",{action:self.locale(self._data.action)});}else{sucesscontent=Mojo.utils.locale('force',"crazywar_defence_retreat_answer",{forcename:self._data.opponentName});}
(new Mojo.com.CommonDialog(undefined,{title:Mojo.utils.locale('force','forcewar_retreat'),content:$('<div class="tip"></div>').html(sucesscontent),rightBtnText:Mojo.utils.locale('common','close'),rightBtnClick:function(that){that.close();Mojo.app.redirect('/force',{index:1});}})).open();}else{self._options.createFailedDlg(response);}});},rightBtnText:Mojo.utils.locale('common','close'),rightBtnClick:function(that){that.close();}})).open();}});},localeCat:function(){return'force';}});})(window,jQuery);;;(function(w,$){w.Mojo=w.Mojo||{};w.Mojo.com=w.Mojo.com||{};w.Mojo.com.ForceRestDialog=w.Mojo.ui.Dialog.extend({init:function(data,options){this._super(undefined,options);this._forceData=data;this.element().addClass('mojo-com-forcerestdlg');this._paragraph=$("<div class='paragraph'></div>").appendTo(this._content);this._addContent();this._addButtons();},_addContent:function(){var self=this;$('<div id="adjust_time_tips1" class="adjust-time-tips1"><div>').appendTo(this._paragraph).html(self.locale('adjust_times_tips1'));this._addInput();$('<div id="adjust_time_tips2" class="adjust-time-tips2"><div>').appendTo(this._paragraph).html(self.locale('adjust_times_tips2'));this._paragraph.find('.shareitem .input input').click(function(){this.selectionStart=0;this.selectionEnd=this.value.length;});this._paragraph.find('.shareitem .input input').bind("change paste keyup input",function(){self._checkInput();});},_reset:function(){var self=this;self._invalid=false;self.okBtn.disable(false);self.okBtn.element().removeClass('err');},_checkInput:function(){var self=this;self._reset();var endTime=0;self._paragraph.find('.shareitem .input input').each(function(i,e){var v=$(e).val().trim();if(self._isValid(v)){var value=v==""?0:parseInt(v);endTime=value+10;if(endTime>=24){endTime=Mojo.utils.locale("force","nextday")+(endTime-24);}}else{self._invalid=true;return;}});if(self._invalid){self.okBtn.disable(true);self.okBtn.element().addClass('err');}else{self._adjustEndTime.element().html(Mojo.utils.locale("force","until")+endTime+Mojo.utils.locale("force","hour"));}},_isValid:function(v){var regex=/^([0-9]|[1-4]\d)$/;if(v!=""&&regex.test(v)&&parseInt(v)>=0&&parseInt(v)<=23){return true;}
return false;},_addInput:function(){var self=this;var input_value=undefined;if(this._forceData.from!=undefined){input_value=parseInt(this._forceData.next);}
var inputarea=$("<div class='input'></div>").append($("<div class='fromlabel'></div>").html(self.locale("from")));var _input=$("<input id = 'inputtext' type='text' maxlength='6' value='"+input_value+"'/>").attr('name','adjust_time_input').appendTo(inputarea);inputarea.append($("<div class='label'></div>").html(self.locale("hour")));self._adjustEndTime=new Mojo.ui.Label("adjust-end-time");inputarea.append(self._adjustEndTime.element());var restEndTime=undefined;var restEndText=undefined;restEndTime=parseInt(this._forceData.next)+10;if(restEndTime>=24){restEndTime=restEndTime-24;}
if(parseInt(restEndTime)<=parseInt(self._forceData.next)){restEndText=Mojo.utils.locale("force","until")+Mojo.utils.locale("force","nextday")+restEndTime+Mojo.utils.locale("force","hour");}else{restEndText=Mojo.utils.locale("force","until")+restEndTime+Mojo.utils.locale("force","hour");}
self._adjustEndTime.element().html(restEndText);var element=$("<div class='shareitem'></div>").append(inputarea).appendTo(this._paragraph);},_addButtons:function(){var self=this;self.okBtn=new Mojo.ui.Button(undefined,{special:'button-big-red',text:Mojo.utils.locale('force','adjust'),disableClick:function(){if(self.okBtn.element().hasClass('err')){if(self._invalid==true){Mojo.app.toast.show(self.locale('adjust_time_input_err'));}else{Mojo.app.toast.show(self.locale('adjust_time_input_update'));}}else{}},click:function(){self.okBtn.element().trigger("focus");self._setRestTime();}});self.okBtn.element().appendTo(this._footer);self.okBtn.disable(true);self.okBtn.element().addClass('err');var closeBtn=new Mojo.ui.Button(undefined,{text:Mojo.utils.locale('common','close'),click:function(){self.close();}});closeBtn.element().appendTo(this._footer);},_setRestTime:function(){var self=this;var taxdata=self._paragraph.find('input[name="adjust_time_input"]').val().trim();var callBackData={};callBackData['next']=taxdata;this._content.append('<div class="waiting"></div>');this.okBtn.disable(true);Mojo.ajax("/forceCrazy/avoidingWar",{'start':taxdata,},function(response){if(response.errorCode==0){self.close();new Mojo.com.CommonDialog(undefined,{title:Mojo.utils.locale('force','adjust_times_title'),classes:['tip-dialog'],content:$("<div class='tip'></div>").html(self.locale("set_resttime_sucess")),rightBtnText:Mojo.utils.locale('common','close'),rightBtnClick:function(that){that.close();self._options.callBackFunc(callBackData);},close:function(){self._options.callBackFunc(callBackData);},}).open();}else{var errDlg=new Mojo.ui.Dialog(undefined,{title:Mojo.utils.locale('force','adjust_times_title'),classes:['tip-dialog'],content:$("<div class='paragraph'></div>").html(response.errorMsg),});new Mojo.ui.Button(undefined,{text:Mojo.utils.locale('common','close'),click:function(){errDlg.close();}}).element().appendTo(errDlg._footer);errDlg.open();}},function(){},{showWait:true});},_getDefaultOptions:function(){return $.extend(true,this._super(),{title:Mojo.utils.locale('force','adjust_times_title')});},localeCat:function(){return'force';}});})(window,jQuery);;(function(w,$,undefined){w.Mojo=w.Mojo||{};w.Mojo.com=w.Mojo.com||{};w.Mojo.com.PaymentElement=w.Mojo.Object.extend({clsname:function(){return"com.PaymentElement";},init:function(data,options){this._data=data;this._super(undefined,options);this._rmLabel=undefined;this._moneyLabel=undefined;this.element().addClass("mojo-com-payment-element").addClass("box-inner");if(parseInt(this._data.type)==0){this.element().addClass('payment-award');}else{this.element().addClass(Mojo.utils.getSomething("advertising")||this._options.advertising.status);}
if(this._data.sub_id&&((''+this._data.sub_id).indexOf('month_ticket')>=0)){this.element().addClass('vip-recharge month-ticket-recharge');if('super_month_ticket'==this._data.sub_id){this.element().addClass('super-month-ticket');}}
if(this._data.sub_id&&(this._data.sub_id.toString().indexOf('vip_recharge')>=0)){this.element().addClass('vip-recharge');}
this._nameDiv=$('<div class="name"></div>').appendTo(this.element());this._prepaidDiv=$('<div class="prepaid"></div>').appendTo(this.element());this._advPrepaidDiv=$('<div class="advertising-prepaid"></div>').appendTo(this.element());this._descriptionDiv=$('<div class="description"></div>').appendTo(this.element());this._refresh();},_refresh:function(){var self=this;if(parseInt(this._data.type)==0){if(Mojo.utils.isNone(this._data.name)==false){this._nameDiv.html(this._data.name);}}
if(Mojo.utils.isNone(this._data.description)==false){this._descriptionDiv.html(this._data.description);}
this._rmLabel=new Mojo.ui.Label(undefined,{text:this._data.rm});this._rmLabel.element().addClass("payment-rm-price").appendTo(this.element().find(".prepaid"));$('<div class="need"></div>').html("=").appendTo(this.element().find(".prepaid"));this._moneyLabel=new Mojo.ui.Label(undefined,{text:this._data.money});this._moneyLabel.element().addClass("payment-money-price").appendTo(this.element().find(".prepaid"));var btnTxt=Mojo.utils.locale('common','buy');var btnDisable=false;if(parseInt(this._data.type)==0){if(parseInt(this._data.status)==1){btnTxt=Mojo.utils.locale('mall','has_buy');btnDisable=true;}else if((''+this._data.sub_id).indexOf('month_ticket')>=0&&this._data.player_ticket&&parseInt(this._data.player_ticket.buy_status)>=3){if(3==parseInt(this._data.player_ticket.status)){btnTxt=Mojo.utils.locale('mall','wait_buy_result');}else{btnTxt=Mojo.utils.locale('mall','has_buy');}
btnDisable=true;}else if(this._data.sub_id.toString().indexOf('vip_recharge')>=0&&3==parseInt(this._data.status)){btnTxt=Mojo.utils.locale('mall','wait_buy_result');btnDisable=true;}}
if(false==this._options.isRechargeSelf){btnTxt=Mojo.utils.locale('mall','to_recharge_friend',{'__default__':''});}
var buyBtn=(new Mojo.ui.Button(undefined,{text:btnTxt,special:"button-small-red",disabled:btnDisable,click:function(){if(parseInt(self._data.type)==0){buyBtn.disable(true);buyBtn.text(Mojo.utils.locale('mall','wait_buy_result'));}
if(self._options.click instanceof Function){self._options.click(self._data,self);}},disableClick:function(){if((''+self._data.sub_id).indexOf('month_ticket')>=0&&parseInt(self._data.player_ticket.buy_status)==4){Mojo.app.toast.show(Mojo.utils.locale('mall','month_ticket_has_buy',{'__default__':'~{{:days}}~','days':self._data.player_ticket.buy_days}));}}}));buyBtn.element().addClass("payment-btn").appendTo(this.element());if(this._data.sub_id&&this._data.sub_id.toString().indexOf('vip_recharge')>=0){var showAllVipRechargeBtn=new Mojo.ui.Button(undefined,{text:Mojo.utils.locale('mall','show_all_vip_recharge',{'__default__':''}),click:function(){$('#payment-dialog').hide();(new Mojo.com.VipRechargeListDialog(self._data.viplist,{close:function(){$('#payment-dialog').show();}})).open(true);}});showAllVipRechargeBtn.element().addClass("show-all-vip-recharge").appendTo(this.element());}
this._setAdvertising();},_setAdvertising:function(){var advertising=this._options.advertising.status;var discountMoney=this._data.discount_money;advertising=Mojo.utils.getSomething("advertising")||advertising;discountMoney=Mojo.utils.getSomething("discount")||discountMoney;if(advertising=="first"||advertising=="first_discount"){this._rmLabel.element().addClass("payment-before-price");new Mojo.ui.Label(undefined,{text:parseInt((this._data.rm)*(isNaN(parseFloat(this._options.advertising.value))?1:parseFloat(this._options.advertising.value)))}).element().addClass("payment-rm-new-price").appendTo(this.element().find(".advertising-prepaid"));}
if(advertising=="discount"||advertising=="first_discount"){this._moneyLabel.element().addClass("payment-before-price");new Mojo.ui.Label(undefined,{text:discountMoney}).element().addClass("payment-money-new-price").appendTo(this.element().find(".advertising-prepaid"));}},_getDefaultOptions:function(){return{isRechargeSelf:true,click:undefined,advertising:{}};}});})(window,jQuery);(function(w,$,undefined){w.Mojo=w.Mojo||{};w.Mojo.com=w.Mojo.com||{};w.Mojo.com.VipRechargeListDialog=w.Mojo.ui.Dialog.extend({clsname:function(){return"com.VipRechargeListDialog";},init:function(data,options){this._data=data;this._super(undefined,options);this.element().addClass('mojo-com-viprechargelistdialog');this.refreshList();this.refreshButton();var self=this;setTimeout(function(){if(self.list){self.list.resize();}},0);},refreshList:function(){var self=this;this.list=(new Mojo.ui.ListPanel(undefined,{scrollable:true,showMore:false,pageSize:200,loadFunc:function(len,count,params,that){$('<div class="vip-recharge-tip box-inner"></div>').html(Mojo.utils.locale('mall','vip_recharge_tip',{'__default__':''})).appendTo(that._list);that.appendData(self._data);},drawFunc:function(recharge){var rechargeObj=new Mojo.Object();rechargeObj.element().addClass('box-inner vip-recharge-element');$('<div class="image"><img src="'+recharge.small_image+'" /></div>').appendTo(rechargeObj.element());var info=$('<div class="recharge-info"></div>').appendTo(rechargeObj.element());$('<div class="recharge-name"></div>').html(recharge.name).appendTo(info);$('<div class="recharge-description"></div>').html(recharge.description).appendTo(info);var price=$('<div class="price"></div>').appendTo(info);$('<div class="price-title"></div>').html(Mojo.utils.locale('common','price_title')).appendTo(price);var moneyLabel=new Mojo.ui.Label(undefined,{text:recharge.money});moneyLabel.element().addClass("payment-money-price").appendTo(price);return rechargeObj;}}));this.list.element().appendTo(this._content);},refreshButton:function(){var self=this;(new Mojo.ui.Button(undefined,{text:Mojo.utils.locale('common','close'),click:function(){self.close();}})).element().appendTo(this._footer);},_getDefaultOptions:function(){return $.extend(true,this._super(),{title:Mojo.utils.locale('mall','vip_recharge_list_dialog_title',{'__default__':''})});}});})(window,jQuery);;(function(w,$,undefined){w.Mojo=w.Mojo||{};w.Mojo.com=w.Mojo.com||{};w.Mojo.com.ForceChallengePanel=w.Mojo.Object.extend({clsname:function(){return"com.ForceChallengePanel";},init:function(options){this._super('com-force-challenge-panel',options);this.element().addClass('com-force-challenge-panel');var self=this;this._playerProfile=this._options.getController().getPlayerProfile();this._forceProfile=this._options.getController().getForceProfile();this._elementsList=[];this._PRE_CHALLENGE_CODE=230001;this._IN_CHALLENGE_CODE=230002;this._CHALLENGE_FINISH_CODE=230300;this._createChallengePanel();},pause:function(){var self=this;clearTimeout(self._forceBattleHandle);},_createChallengePanel:function(){var self=this;self._forceWarAjax("/forceBoss/index",{msgid:0},function(response){if(response&&response.errorCode==self._PRE_CHALLENGE_CODE){self._data=response.data;self._createPreChallengePanel();}else if(response&&response.errorCode==self._IN_CHALLENGE_CODE){self._data=response.data;self._persistenceData=response.data;self._createInChallengePanel();}},function(){});},_addHeader:function(){this._header=$("<div class='page-tips'></div>");this._header.appendTo(this._content._header);},_createPreChallengePanel:function(){var self=this;if(this._content!=undefined){this._content.element().remove();}
this._content=new Mojo.Object(undefined,{classes:['pre-challenge-panel']});this._content._header=$('<div class="header"></div>').appendTo(this._content.element());this.element().append(this._content.element());this._addHeader();if(parseInt(self._data.challenge.free)>0){this._header.html(Mojo.utils.locale('force','force_boss_challenge_limit',{num:self._data.challenge.free}));}else{this._header.html(Mojo.utils.locale('force','force_boss_challenge_limit2',{num:self._data.limit}));}
var preContent=$('<div class="mojo-com-forceboss-challenge-pre-content"></div>').appendTo(this._content.element());this._bossNameAndLevel=new Mojo.Object(undefined,{classes:['com-force-challenge-boss-name']});this._bossNameAndLevel.element().html(Mojo.utils.locale('force','force_boss_name_level',{name:self._data.boss.name,level:self._data.boss.level}));preContent.append(this._bossNameAndLevel.element());this._detailButton=new Mojo.ui.Button('detail-btn',{text:Mojo.utils.locale('force','force_boss_challenge_detail'),click:function(){new Mojo.com.ForceBossChallengeDetailDialog({"detail":Mojo.utils.locale('force','force_boss_challenge_detail_content'),}).open();},});preContent.append(this._detailButton.element());this._bossImage=new Mojo.Object(undefined,{classes:['com-force-challenge-boss-img']});$('<img />').addClass("card-image-url").bind("load",function(){self._bossImage.element().find(".card-image-url").show();}).hide().appendTo(this._bossImage.element()).attr({src:self._data.boss.image});$('<img />').bind("load",function(){}).hide().appendTo(this._bossImage.element()).attr({src:self._data.boss.large_image});preContent.append(this._bossImage.element());this._bossInformation=new Mojo.Object(undefined,{classes:['com-force-challenge-boss-information']});this._bossInformation.element().html(Mojo.utils.locale('force','force_boss_challenge_profile',{name:self._data.boss.name,time:self._data.duration,num:self._data.boss.life,defencemin:self._data.boss.defence.min,defencemax:self._data.boss.defence.max,skill:self._data.boss.skill}));preContent.append(this._bossInformation.element());this._challengeButton=new Mojo.ui.Button('challenge-btn',{text:Mojo.utils.locale('force','force_boss_challenge_start'),special:'button-big-red',click:function(){var dlg=new Mojo.com.ForceBossChallengePreviewDialog({challenge_num:self._data.challenge.free,challenge_rm:self._data.challenge.rm,challenge_vm:self._data.challenge.vm,niudanlist:self._data.rewards,niudanId:self._data.rewards[0].id,callback:function(niudanId){if((self._data.challenge.free>0&&parseInt(self._playerProfile.vm)<parseInt(self._data.challenge.vm))||(self._data.challenge.free==0&&parseInt(self._playerProfile.rm)<parseInt(self._data.challenge.rm))){var failDialog=new Mojo.ui.Dialog(undefined,{title:Mojo.utils.locale('force',"force_boss_challenge_lack_title")});if(self._data.challenge.free>0){$('<div class="tip"></div>').html(Mojo.utils.locale('force',"force_boss_challenge_lack_vm")).appendTo(failDialog._content);new Mojo.ui.Button(undefined,{text:Mojo.utils.locale('mall','go_vm'),special:"button-big-red",click:function(){failDialog.close();Mojo.app.redirect("/mall",{selected:2});}}).element().appendTo(failDialog._footer);}else if(self._data.challenge.free==0){$('<div class="tip"></div>').html(Mojo.utils.locale('force',"force_boss_challenge_lack_rm")).appendTo(failDialog._content);new Mojo.ui.Button(undefined,{text:Mojo.utils.locale('mall','go_payment'),special:"button-big-red",click:function(){failDialog.close();Mojo.app.redirect("/mall",{selected:4});}}).element().appendTo(failDialog._footer);}
new Mojo.ui.Button(undefined,{text:Mojo.utils.locale('common','close'),special:"button-big-blue",click:function(){failDialog.close();}}).element().appendTo(failDialog._footer);failDialog.open();return;}
var skip_cd=0;if(self._data.challenge.free==0){skip_cd=1;}
self._forceWarAjax("/forceBoss/challenge",{niudan_id:niudanId,skip_cd:skip_cd},function(response){if(response&&response.errorCode===0){self._createChallengePanel();new Mojo.com.CommonDialog(undefined,{title:Mojo.utils.locale('force','force_boss_challenge_start5'),content:$('<div class="tip"></div>').html(Mojo.utils.locale('force','force_boss_challenge_tip_content').replace('{{:opponent_force}}',self._data.boss.name)),leftBtnText:Mojo.utils.locale('force','usurp_war_help'),leftBtnClick:function(that){that.close();new Mojo.com.ForceNoticeDialog({},{title:Mojo.utils.locale('force','force_boss_challenge_start5'),hasDefaultMsg:true,hintText:Mojo.utils.locale('force','force_boss_challenge_hint_text'),okBtnClick:function(that){that.close();Mojo.ajax("/forceBoss/callingMember",{content:that.getContent()},function(response){Mojo.app.toast.show(Mojo.utils.locale('common','suggestion_has_send'));});}}).open();},rightBtnText:Mojo.utils.locale('common','close'),rightBtnClick:function(that){that.close();},}).open();self._options.getController().getProfile().sync();}else{if(response.errorCode==230201){var t=Mojo.utils.locale('force','forcewar_tip_title');if(response.data!=undefined&&response.data.title!=undefined){t=response.data.title;}
(new Mojo.com.CommonDialog(undefined,{title:t,content:$('<div class="tip"></div>').html(response.errorMsg),leftBtnText:Mojo.utils.locale('common','ok'),leftBtnClick:function(that){that.close();Mojo.app.redirect('/force',{index:1,selected:1});}})).open();}else{if(Mojo.utils.isNone(response.errorMsg)||response.errorMsg==''){response.errorMsg=Mojo.utils.locale('common','action_error');}
(new Mojo.com.CommonDialog(undefined,{title:response.data?response.data.title:Mojo.utils.locale('force','forcewar_tip_title'),content:$('<div class="tip"></div>').html(response.errorMsg),leftBtnText:Mojo.utils.locale('common','ok'),leftBtnClick:function(that){that.close();}})).open();}}});}});dlg.open();},disableClick:function(){if(parseInt(self._playerProfile.position_id)>3){Mojo.app.toast.show(Mojo.utils.locale('force','force_boss_challenge_no_right'));}else if(self._data.limit==0){Mojo.app.toast.show(Mojo.utils.locale('force','force_boss_challenge_no_right2'));}}});preContent.append(this._challengeButton.element());this._rm=new Mojo.ui.Label(undefined,{classes:['rm'],text:'0',});this._rm.text(self._data.challenge.rm);if(parseInt(self._data.challenge.free)==0&&self._data.limit>0){this._challengeButton.element().append(this._rm.element());if(parseInt(self._data.challenge.rm)<10){this._challengeButton.element().addClass("challenge-button-with-rm1");}else if(parseInt(self._data.challenge.rm)<100){this._challengeButton.element().addClass("challenge-button-with-rm2");}else if(parseInt(self._data.challenge.rm)<1000){this._challengeButton.element().addClass("challenge-button-with-rm3");}else if(parseInt(self._data.challenge.rm)<10000){this._challengeButton.element().addClass("challenge-button-with-rm4");}else if(parseInt(self._data.challenge.rm)<100000){this._challengeButton.element().addClass("challenge-button-with-rm5");}else{this._challengeButton.element().addClass("challenge-button-with-rm");}}
if(parseInt(self._playerProfile.position_id)>3||self._data.limit==0){self._challengeButton.disable(true);}},_createInChallengePanel:function(){var self=this;if(this._content!=undefined){this._content.element().remove();}
this._content=new Mojo.Object(undefined,{classes:['in-challenge-panel']});this._content._header=$('<div class="header"></div>').appendTo(this._content.element());this.element().append(this._content.element());this._addHeader();if(parseInt(self._data.challenge.free)>0){this._header.html(Mojo.utils.locale('force','force_boss_challenge_limit',{num:self._data.challenge.free}));}else{this._header.html(Mojo.utils.locale('force','force_boss_challenge_limit2',{num:self._data.limit}));}
this._bossImage=new Mojo.Object(undefined,{classes:['com-force-challenge-boss-img']});this._content.element().append(this._bossImage.element());this._bossNameAndLevel=new Mojo.Object(undefined,{classes:['com-force-challenge-boss-name']});this._bossNameAndLevel.element().html(Mojo.utils.locale('force','force_boss_name_level2',{name:self._data.boss.name,level:self._data.boss.level}));this._bossImage.element().append(this._bossNameAndLevel.element());this._bossLeft=new Mojo.Object(undefined,{classes:['com-force-challenge-boss-left']});this._bossLeft.element().html(Mojo.utils.locale('force','force_boss_left',{num:self._data.battle.left,wholenum:self._data.boss.life}));this._bossImage.element().append(this._bossLeft.element());this._bossFleeTime=new Mojo.Object(undefined,{classes:['com-force-challenge-boss-flee-time']});this._bossImage.element().append(this._bossFleeTime.element());this._challengeProgress=new Mojo.ui.Progress(undefined,{classes:['xp'],labelTemplate:'#{divide}',});this._challengeProgress.element().appendTo(this._bossImage.element());$('<div class="challenge-progress-border"></div>').appendTo(this._bossImage.element());this._channel=new Mojo.com.ForceBossMsgChannel('force_boss_msg_channel',{bossName:self._data.boss.name});this._content.element().append(this._channel.element());this._channel.appendChatMessages(this._data.list,this._data.time);var c=this._channel.getLatestChat();if(c==null){this._defaultMsg=$('<div class="challenge-default-msg"></div>').html(Mojo.utils.locale('force','force_boss_challenge_attack_default_msg')).appendTo(this._channel.element());}
this._bossAttackCD=new Mojo.Object(undefined,{classes:['com-force-challenge-boss-attack-cd']});this._content.element().append(this._bossAttackCD.element());if(this._data.battle.attack.free>0&&(this._cd==undefined||this._cd<=0)){this._bossAttackCD.element().html(Mojo.utils.locale('force','force_boss_challenge_freetimes',{times:self._data.battle.attack.free}));}
this._challengeButton=new Mojo.ui.Button('challenge-btn',{text:Mojo.utils.locale('force','force_boss_challenge_start4'),special:'button-big-red',click:function(){if(self._data.battle.attack.cost!=undefined&&parseInt(self._data.battle.attack.cost)>0){var content=$('<div class="paragraph"></div>');$('<div class="mojo-com-forceboss-attack-preview-header"></div>').html(Mojo.utils.locale('force','force_boss_challenge_attack_rm')).appendTo(content);$('<div class="mojo-com-forceboss-attack-preview-cost"></div>').html(Mojo.utils.locale('force','force_boss_challenge_attack_preview_cost')).appendTo(content);this._rm=new Mojo.ui.Label(undefined,{classes:['rm'],text:'0',});this._rm.text(self._data.battle.attack.cost);this._rm.element().appendTo(content);var dlg=new Mojo.com.CommonDialog(undefined,{title:Mojo.utils.locale('force','force_boss_challenge_attack_preview_not'),content:content,classes:['force-boss-challenge-dlg-with-label'],leftBtnText:Mojo.utils.locale('force','force_boss_challenge_attack_preview_speedup'),leftBtnClick:function(that){that.close();if(parseInt(self._playerProfile.rm)<parseInt(self._data.battle.attack.cost)){var failDialog=new Mojo.ui.Dialog(undefined,{title:Mojo.utils.locale('force',"force_boss_challenge_speed_fail_title")});$('<div class="tip"></div>').html(Mojo.utils.locale('force',"force_boss_challenge_lack_rm")).appendTo(failDialog._content);new Mojo.ui.Button(undefined,{text:Mojo.utils.locale('mall','go_payment'),special:"button-big-red",click:function(){failDialog.close();Mojo.app.redirect("/mall",{selected:4});}}).element().appendTo(failDialog._footer);failDialog.open();}else{self._attackBoss(1,1);}},rightBtnText:Mojo.utils.locale('common','close'),rightBtnClick:function(that){that.close();},});dlg.open();}else{self._attackBoss(1,0);}},disableClick:function(){if(self._cd>0){Mojo.app.toast.show(Mojo.utils.locale('force','force_boss_challenge_cd_content'));}}});this._content.element().append(this._challengeButton.element());this._refreshForceBossStatus();},_attackBoss:function(is_preview,is_skip_cd){var self=this;self._forceWarAjax("/forceBoss/attack",{preview:is_preview,skip_cd:is_skip_cd},function(response){if(response&&response.errorCode===0){response.data.opponent_army=['huangjinjun.png'];var capturedPreviewDialog=new Mojo.com.ForceWarPreviewDialog(undefined,{attackBtnText:Mojo.utils.locale('force','force_boss_challenge_start4'),title:Mojo.utils.locale('force','forcewar_battle_preview'),attackerName:self._options.getController().getPlayerProfile().name,defenderName:self._persistenceData.boss.name,showtip:false,actionCallback:function(that){that.close();var c=self._channel.getLatestChat();var mid=0;if(c!=null){mid=c.id;}
Mojo.ajax("/forceBoss/attack",{preview:0,msgid:mid,skip_cd:is_skip_cd},function(result){if(result&&result.errorCode===0){var resultTitle="";var resultTip="";if(result.data.player){if(parseInt(result.data.player.sp)==NaN){result.data.player.sp=0;}
Mojo.page.Force.getController().updatePlayerProfile({sp:result.data.player.sp,rm:result.data.player.rm});Mojo.page.Force.getController().diffPlayer({grain:result.data.rewards.grain});}
self._refreshForceBossStatus(true);var resultDlg=undefined;var dlgtitle='';if(result.data.status==1){dlgtitle=Mojo.utils.locale('battle','battle_result_formation_title_win');}else if(result.data.status==2){dlgtitle=Mojo.utils.locale('battle','battle_result_formation_title_lose');}
setTimeout(function(){Mojo.ajax('/battle/Detail',{},function(res){if(res.errorCode==0){res.data.defender.player.level=self._persistenceData.boss.level;Mojo.ui.BattleAnimation.onclose=function(){if(result.data.rewards.entity!=undefined){resultDlg=self._showAwardResult(result,res,dlgtitle);}else{resultDlg=self._showGrainAwardResult(result,res,dlgtitle);}
resultDlg.open();};Mojo.ui.BattleAnimation.openBattle(res);}else{}},function(){},{showWait:true});},500);}else if(result.errorCode===self._CHALLENGE_FINISH_CODE){clearTimeout(self._forceBattleHandle);var dlgtitle='';if(result.data.status==1){dlgtitle=Mojo.utils.locale('battle','battle_result_formation_title_win');}else if(result.data.status==2){dlgtitle=Mojo.utils.locale('battle','battle_result_formation_title_lose');}
setTimeout(function(){Mojo.ajax('/battle/Detail',{},function(res){if(res.errorCode==0){res.data.defender.player.level=self._persistenceData.boss.level;Mojo.ui.BattleAnimation.onclose=function(){var resultDlg2=self._showForceWarResultDialog(result,function(){Mojo.app.redirect('/force',{index:1,selected:1});},res,dlgtitle);};Mojo.ui.BattleAnimation.openBattle(res);}else{}},function(){},{showWait:true});},500);}else if(result.errorCode===230202){var t=Mojo.utils.locale('force','forcewar_tip_title');if(result.data!=undefined&&result.data.title!=undefined){t=result.data.title;}
(new Mojo.com.CommonDialog(undefined,{title:t,content:$('<div class="tip"></div>').html(result.errorMsg),leftBtnText:Mojo.utils.locale('force','force_boss_challenge_attack_reattack'),leftBtnClick:function(that){that.close();self._attackBoss(1,1);},rightBtnText:Mojo.utils.locale('common','close'),rightBtnClick:function(that){that.close();}})).open();}else{var t=Mojo.utils.locale('force','forcewar_tip_title');if(result.data!=undefined&&result.data.title!=undefined){t=result.data.title;}
(new Mojo.com.CommonDialog(undefined,{title:t,content:$('<div class="tip"></div>').html(result.errorMsg),leftBtnText:Mojo.utils.locale('common','close'),leftBtnClick:function(that){that.close();}})).open();}},function(){},{showWait:true});Mojo.track.onEvent('24_703');}});var winContent=$('<div><div class="win-time">'+Mojo.utils.locale('force','force_boss_challenge_attack_preview_win')+'</div></div>');var loseContent=$('<div><div class="lose-time">'+Mojo.utils.locale('force','force_boss_challenge_attack_preview_lose')+'</div></div>');capturedPreviewDialog.setWinContents(winContent);capturedPreviewDialog.setLoseContents(loseContent);capturedPreviewDialog.open();}else if(response&&response.errorCode==10003&&Mojo.utils.isNone(response.data)==false){(new Mojo.com.NeedBuyDialog(undefined,{title:Mojo.utils.locale('force','forcewar_tip_title'),goods:response.data.props,stamina:response.data.stamina,restoreCount:response.data.sp,allRestoreText:Mojo.utils.locale('common','time for all sp'),allRestoreTime:response.data.sp_restore_pp,nextRestoreText:Mojo.utils.locale('common','time for next sp'),nextRestoreTime:response.data.sp_second,restoreText:response.errorMsg,needBuyTip:response.errorMsg,useBtnClick:function(that,result){that.close();if(result&&result.errorCode===0){Mojo.page.Force.getController().updatePlayerProfile({sp:result.data.player.sp});Mojo.app.toast.show(Mojo.utils.locale('common','add_sp',{name:that._options.goods.goods_name,value:result.data.value}));}},buyBtnClick:function(that,result){Mojo.page.Force.getController().updatePlayerProfile({rm:result.data.player.rm,vm:result.data.player.vm});}})).open();}else{var t=Mojo.utils.locale('force','forcewar_tip_title');if(response.data!=undefined&&response.data.title!=undefined){t=response.data.title;}
(new Mojo.com.CommonDialog(undefined,{title:t,content:$('<div class="tip"></div>').html(response.errorMsg),leftBtnText:Mojo.utils.locale('common','close'),leftBtnClick:function(that){that.close();}})).open();}},function(){},true);},_showAwardResult:function(result,res,dlgtitle){var self=this;var resultDlg=undefined;if(result&&result.errorCode===0){var entity=result.data.rewards.entity;resultDlg=new Mojo.ui.Dialog(undefined,{title:Mojo.utils.locale('force','force_boss_challenge_reward'),content:(new Mojo.com.LargeEntity(entity)).element(),classes:['force-boss-challenge-dlg-with-label']});var tip=$('<div></div>').addClass('tip').appendTo(resultDlg._content);tip.html(Mojo.utils.locale('force','force_boss_challenge_reward_des',{num:result.data.killed,name:self._persistenceData.boss.name}));var tip2=$('<div></div>').addClass('tip').appendTo(resultDlg._content);tip2.html(Mojo.utils.locale('force','force_boss_challenge_reward_get'));this._grain=new Mojo.ui.Label(undefined,{classes:['grain'],text:'0',});this._grain.text(result.data.rewards.grain);this._grain.element().appendTo(tip2);new Mojo.ui.Button(undefined,{text:Mojo.utils.locale('force','formation detail'),click:function(){resultDlg.element().hide();var detailDlg=new Mojo.com.BattleDetailDialog(res.data,{title:dlgtitle,pid:self._options.opponent_id,pkMode:true,vm:'+0',xp:'+0',show_detail_first:true,entity:null,non_show_base_def:true,close:function(){resultDlg.element().show();}});detailDlg.open(true);},special:'button-big-red',}).element().appendTo(resultDlg._footer);new Mojo.ui.Button(undefined,{text:Mojo.utils.locale('common','close'),click:function(){resultDlg.close();},}).element().appendTo(resultDlg._footer);}
return resultDlg;},_showGrainAwardResult:function(result,res,dlgtitle){var self=this;var resultDlg=undefined;if(result&&result.errorCode===0){var content=$('<div class="tip"></div>');var title=Mojo.utils.locale('force','force_boss_challenge_reward');var temp=$('<div class="tip"></div>').html(Mojo.utils.locale('force','force_boss_challenge_reward_des',{num:result.data.killed,name:self._persistenceData.boss.name})).appendTo(content);if(result.data.killer==1){title=Mojo.utils.locale('force','force_boss_challenge_reward_killboss');temp.html(Mojo.utils.locale('force','force_boss_challenge_reward_des2',{level:self._persistenceData.boss.level,name:self._persistenceData.boss.name}));}
var tip2=$('<div></div>').addClass('tip').appendTo(content);tip2.html(Mojo.utils.locale('force','force_boss_challenge_reward_get'));this._grain=new Mojo.ui.Label(undefined,{classes:['grain'],text:'0',});this._grain.text(result.data.rewards.grain);this._grain.element().appendTo(tip2);resultDlg=new Mojo.com.CommonDialog(undefined,{title:title,content:content,classes:['force-boss-challenge-dlg-with-label'],leftBtnText:Mojo.utils.locale('force','formation detail'),leftBtnClick:function(that){that.hide();var detailDlg=new Mojo.com.BattleDetailDialog(res.data,{title:dlgtitle,pid:self._options.opponent_id,pkMode:true,vm:'+0',xp:'+0',show_detail_first:true,entity:null,non_show_base_def:true,close:function(){that.show();}});detailDlg.open(true);},rightBtnText:Mojo.utils.locale('common','close'),rightBtnClick:function(that){that.close();},});}
return resultDlg;},_refreshForceBossStatus:function(forceUpdate){var self=this;if(self._forceBattleTime!=undefined){self._forceBattleTime-=1;}
if(self._cd!=undefined){self._cd-=1;}
var c=self._channel.getLatestChat();var mid=0;if(c!=null){mid=c.id;}
if(forceUpdate==true||self._forceBattleTime==undefined||self._cd==undefined||self._forceBattleTime%self._options.interval==0){self._forceWarAjax("/forceBoss/index",{msgid:mid},function(response){if(response&&response.errorCode===self._IN_CHALLENGE_CODE){if(Mojo.utils.isNone(response.data)==false){self._data=response.data;self._forceBattleTime=self._data.battle.timeout;self._cd=self._data.battle.attack.timeout;self._bossLeft.element().html(Mojo.utils.locale('force','force_boss_left',{num:self._data.battle.left,wholenum:self._persistenceData.boss.life}));self._challengeProgress.value({value:self._data.battle.left,max:self._persistenceData.boss.life});if(self._forceBattleTime!=undefined){self._bossFleeTime.element().html(Mojo.utils.locale('force','force_boss_flee_time',{time:self._formatCDTime(self._forceBattleTime)}));}else{clearTimeout(self._forceBattleHandle);self._createChallengePanel();}
if(self._cd!=undefined&&self._cd>0){self._bossAttackCD.element().html(Mojo.utils.locale('force','force_boss_challenge_cd',{time:self._formatCDTime(self._cd)}));self._challengeButton.disable(true);if(self._data.battle.attack.cost!=undefined&&parseInt(self._data.battle.attack.cost)>0){if(self._rm==undefined){self._rm=new Mojo.ui.Label(undefined,{classes:['rm'],text:'0',});}
self._rm.text(self._data.battle.attack.cost);self._challengeButton.text(Mojo.utils.locale('force','force_boss_challenge_start3'));self._challengeButton.element().append(self._rm.element());if(parseInt(self._data.battle.attack.cost)<10){self._challengeButton.element().addClass("challenge-button-with-rm1");}else if(parseInt(self._data.battle.attack.cost)<100){self._challengeButton.element().addClass("challenge-button-with-rm2");}else if(parseInt(self._data.battle.attack.cost)<1000){self._challengeButton.element().addClass("challenge-button-with-rm3");}else if(parseInt(self._data.battle.attack.cost)<10000){self._challengeButton.element().addClass("challenge-button-with-rm4");}else if(parseInt(self._data.battle.attack.cost)<100000){self._challengeButton.element().addClass("challenge-button-with-rm5");}else{self._challengeButton.element().addClass("challenge-button-with-rm");}}}else{self._challengeButton.disable(false);if(self._data.battle.attack.cost!=undefined&&parseInt(self._data.battle.attack.cost)>0){if(self._rm==undefined){self._rm=new Mojo.ui.Label(undefined,{classes:['rm'],text:'0',});}
self._rm.text(self._data.battle.attack.cost);self._challengeButton.text(Mojo.utils.locale('force','force_boss_challenge_start3'));self._challengeButton.element().append(self._rm.element());if(parseInt(self._data.battle.attack.cost)<10){self._challengeButton.element().addClass("challenge-button-with-rm1");}else if(parseInt(self._data.battle.attack.cost)<100){self._challengeButton.element().addClass("challenge-button-with-rm2");}else if(parseInt(self._data.battle.attack.cost)<1000){self._challengeButton.element().addClass("challenge-button-with-rm3");}else if(parseInt(self._data.battle.attack.cost)<10000){self._challengeButton.element().addClass("challenge-button-with-rm4");}else if(parseInt(self._data.battle.attack.cost)<100000){self._challengeButton.element().addClass("challenge-button-with-rm5");}else{self._challengeButton.element().addClass("challenge-button-with-rm");}}
self._bossAttackCD.element().html('');if(self._data.battle.attack.free>0){self._bossAttackCD.element().html(Mojo.utils.locale('force','force_boss_challenge_freetimes',{times:self._data.battle.attack.free}));}}
var d=self._channel.getLatestChat();var mid2=0;if(d!=null){mid2=d.id;}
if(mid==mid2){self._channel.appendChatMessages(self._data.list,self._data.time);}
var e=self._channel.getLatestChat();if(e!=null&&self._defaultMsg!=undefined){self._defaultMsg.remove();self._defaultMsg=undefined;}}else{clearTimeout(self._forceBattleHandle);self._createChallengePanel();}}},function(){clearTimeout(self._forceBattleHandle);self._createChallengePanel();});}
if(self._forceBattleTime!=undefined){self._bossFleeTime.element().html(Mojo.utils.locale('force','force_boss_flee_time',{time:self._formatCDTime(self._forceBattleTime)}));}
if(self._cd!=undefined&&self._cd>0){self._bossAttackCD.element().html(Mojo.utils.locale('force','force_boss_challenge_cd',{time:self._formatCDTime(self._cd)}));self._challengeButton.disable(true);}else{self._challengeButton.disable(false);if(self._data.battle.attack.cost!=undefined&&parseInt(self._data.battle.attack.cost)>0){if(self._rm==undefined){self._rm=new Mojo.ui.Label(undefined,{classes:['rm'],text:'0',});}
self._rm.text(self._data.battle.attack.cost);self._challengeButton.text(Mojo.utils.locale('force','force_boss_challenge_start3'));self._challengeButton.element().append(self._rm.element());if(parseInt(self._data.battle.attack.cost)<10){self._challengeButton.element().addClass("challenge-button-with-rm1");}else if(parseInt(self._data.battle.attack.cost)<100){self._challengeButton.element().addClass("challenge-button-with-rm2");}else if(parseInt(self._data.battle.attack.cost)<1000){self._challengeButton.element().addClass("challenge-button-with-rm3");}else if(parseInt(self._data.battle.attack.cost)<10000){self._challengeButton.element().addClass("challenge-button-with-rm4");}else if(parseInt(self._data.battle.attack.cost)<100000){self._challengeButton.element().addClass("challenge-button-with-rm5");}else{self._challengeButton.element().addClass("challenge-button-with-rm");}}
self._bossAttackCD.element().html('');if(self._data.battle.attack.free>0){self._bossAttackCD.element().html(Mojo.utils.locale('force','force_boss_challenge_freetimes',{times:self._data.battle.attack.free}));}}
if(forceUpdate!=true){self._forceBattleHandle=setTimeout(function(){self._refreshForceBossStatus();},1000);}},_forceWarAjax:function(url,params,success,fail,ashowWait){var self=this;if(ashowWait==undefined){ashowWait=false;}
Mojo.ajax(url,params,function(response){if(response.errorCode===self._CHALLENGE_FINISH_CODE){clearTimeout(self._forceBattleHandle);self._showForceWarResultDialog(response,function(){Mojo.app.redirect('/force',{index:1,selected:1});});}else{if(success instanceof Function){success(response);}}},function(){if(fail instanceof Function){fail();}},{showWait:ashowWait});},_showForceWarResultDialog:function(result,callback,res,dlgtitle){var self=this;var resultDlg=undefined;var content=$('<div class="tip"></div>');var title="";var rightBtnText=Mojo.utils.locale('common','close');var rightBtnClick=function(that){that.close();};if(res!=undefined&&dlgtitle!=undefined){rightBtnText=Mojo.utils.locale('force','formation detail');rightBtnClick=function(that){that.hide();(new Mojo.com.BattleDetailDialog(res.data,{title:dlgtitle,pid:self._options.opponent_id,pkMode:true,vm:'+0',xp:'+0',show_detail_first:true,entity:null,non_show_base_def:true,close:function(){that.show();}})).open(true);};}
if(result.data.status==1){if(result.data.rewards!=undefined){title=Mojo.utils.locale('force','force_boss_challenge_final_win');var temp=$('<div class="paragraph"></div>').appendTo(content);if(result.data.killer==1){temp.html(Mojo.utils.locale('force','force_boss_challenge_final_des2',{level:result.data.boss.level,name:result.data.boss.name,num:result.data.rewards.grain.a,num2:result.data.rewards.grain.k}));}else{temp.html(Mojo.utils.locale('force','force_boss_challenge_final_des1',{killername:result.data.killer,level:result.data.boss.level,name:result.data.boss.name,num:result.data.rewards.grain.a}));}
var sumgrain=0;if(result.data.rewards.grain.k!=undefined){sumgrain=parseInt(result.data.rewards.grain.a)+parseInt(result.data.rewards.grain.k);}else{sumgrain=result.data.rewards.grain.a;}
var grainObj={id:"d08",name:Mojo.utils.locale('force','force_boss_challenge_final_win_grain'),count:sumgrain,small_image:"\/mojo\/resources\/classic\/mobile\/image\/entity\/23\/small\/player_grain.png"};if(Array.isArray(result.data.rewards.entities)){for(var i=result.data.rewards.entities.length;i>0;i--){result.data.rewards.entities[i]=result.data.rewards.entities[i-1];}
result.data.rewards.entities[0]=grainObj;}else{result.data.rewards.entities=[];result.data.rewards.entities[0]=grainObj;}
if(result.data.rewards.entities!=undefined){var _award=$('<div class="awards"></div>');_award.appendTo(content);var _award2=undefined;if(result.data.rewards.entities.length>4){_award.addClass("awards1");_award2=$('<div class="awards2"></div>');_award2.appendTo(content);}
var _card=undefined;$.each(result.data.rewards.entities,function(i,a){if(result.data.rewards.entities>4&&i<Math.floor(result.data.rewards.entities.length/2)){_card=$('<div class="card-gift image"></div>');_card.appendTo(_award);}else if(result.data.rewards.entities.length>4&&i>=Math.floor(result.data.rewards.entities.length/2)){_card=$('<div class="card-gift image"></div>');_card.appendTo(_award2);}else if(result.data.rewards.entities.length<=4){_card=$('<div class="card-gift image"></div>');_card.appendTo(_award);}
if(a.rarity_id!=undefined){if(parseInt(a.rarity_id+"")==1)
$('<div class = "tip">'+Mojo.utils.locale('illustration','rarity_notice')+'</div>').appendTo(_card);if(parseInt(a.rarity_id+"")==2)
$('<div class = "tip">'+Mojo.utils.locale('illustration','rarity_notice2')+'</div>').appendTo(_card);if(parseInt(a.rarity_id+"")==3)
$('<div class = "tip">'+Mojo.utils.locale('illustration','rarity_notice3')+'</div>').appendTo(_card);if(parseInt(a.rarity_id+"")==4)
$('<div class = "tip">'+Mojo.utils.locale('illustration','rarity_notice4')+'</div>').appendTo(_card);}
self._setCard(a,_card);if(a.count>1){_card.append('<div class="count">'+a.count+'</div>');}
_card.append('<div class="name">'+a.name+'</div>');});}
$('<div class="tip"></div>').html(Mojo.utils.locale('force','force_boss_challenge_final_des3')).appendTo(content);resultDlg=new Mojo.com.CommonDialog(undefined,{title:title,content:content,classes:['force-boss-challenge-dlg-with-label'],close:function(){if(callback instanceof Function){callback();}},leftBtnText:Mojo.utils.locale('force','force_boss_challenge_final_goexchange'),leftBtnClick:function(that){Mojo.app.redirect('/force',{index:3});},rightBtnText:rightBtnText,rightBtnClick:function(that){rightBtnClick(that);},});}else{title=Mojo.utils.locale('force','force_boss_challenge_final_win');var temp=$('<div class="tip"></div>').html(Mojo.utils.locale('force','force_boss_challenge_final_des5',{killername:result.data.killer,level:result.data.boss.level,name:result.data.boss.name,num:result.data.grain})).appendTo(content);resultDlg=new Mojo.com.CommonDialog(undefined,{title:title,content:content,classes:['force-boss-challenge-dlg-with-label'],close:function(){if(callback instanceof Function){callback();}},leftBtnText:Mojo.utils.locale('force','force_boss_challenge_final_goexchange'),leftBtnClick:function(that){Mojo.app.redirect('/force',{index:3});},rightBtnText:rightBtnText,rightBtnClick:function(that){rightBtnClick(that);},});}}else{title=Mojo.utils.locale('force','force_boss_challenge_final_lose');var temp=$('<div class="tip"></div>').html(Mojo.utils.locale('force','force_boss_challenge_final_des4',{level:result.data.boss.level,name:result.data.boss.name})).appendTo(content);resultDlg=new Mojo.com.CommonDialog(undefined,{title:title,content:content,close:function(){if(callback instanceof Function){callback();}},rightBtnText:rightBtnText,rightBtnClick:function(that){rightBtnClick(that);},});}
resultDlg.open();},_setCard:function(item,_car){var self=this;var se=new Mojo.com.SmallEntity(item,{callback:function(card){_car.append(card.element());},click:function(){}});return se;},_getDefaultOptions:function(){return{backCallback:$.noop,interval:10};},_formatCDTime:function(sec){var str='';var dd=parseInt(sec/86400);var hh=parseInt((sec%86400)/3600);var mm=parseInt((sec%3600)/60);var ss=sec%60;if(dd>0){str=dd+Mojo.utils.locale('common','day')+hh+Mojo.utils.locale('common','hour');}else if(hh>0){str=hh+Mojo.utils.locale('common','hour')+mm+Mojo.utils.locale('common','minute');}else if(mm>0){str=mm+Mojo.utils.locale('common','minute')+ss+Mojo.utils.locale('common','second');}else{str=ss+Mojo.utils.locale('common','second');}
return str;},localeCat:function(){return'force';}});})(window,jQuery);;(function(w,$,undefined){w.Mojo=w.Mojo||{};w.Mojo.com=w.Mojo.com||{};w.Mojo.com.ForceBossChallengeDetailDialog=w.Mojo.ui.Dialog.extend({clsname:function(){return"com.ElectionDetailDlg";},init:function(options){this._super(undefined,options);this.element().addClass('mojo-com-forceboss-challenge-detail-dlg');var self=this;this._initContent();this._addButtons();},open:function(force){this._super(force);this._panel.resize();},_initContent:function(){var self=this;this._panel=new Mojo.ui.ListPanel('mojo-com-forceboss-challenge-detail-listpanel',{scrollable:true,showMore:false,pageSize:20,loadFunc:function(count,pagesize,params){setTimeout(function(){self._panel.appendData(self._options.detail);},100);},drawFunc:function(data){return(new Mojo.com.ForceBossChallengeDetail(data,{that:self,}));}});this._panel.element().appendTo(this._content);},_addButtons:function(){var self=this;this._footer.append((new Mojo.ui.Button('close-btn',{text:Mojo.utils.locale('common','close'),click:function(){self.close();},})).element());},_getDefaultOptions:function(){return $.extend(true,this._super(),{title:Mojo.utils.locale('force','force_boss_challenge_detail_dlg'),detail:undefined,});}});})(window,jQuery);(function(w,$,undefined){w.Mojo=w.Mojo||{};w.Mojo.com=w.Mojo.com||{};w.Mojo.com.ForceBossChallengeDetail=w.Mojo.Object.extend({clsname:function(){return"com.ForceBossChallengeDetail";},init:function(data,options){this._data=data;this._super(undefined,options);this.element().addClass("mojo-com-forceboss-challenge-detail");this._contentDiv=$('<div></div>').addClass("mojo-com-forceboss-challenge-detail-content").appendTo(this.element());this.refresh();},refresh:function(data){if(data===undefined){data=this._data;}
this.setContent(data);},setContent:function(data){this._contentDiv.html(data);}});})(window,jQuery);;(function(w,$,undefined){w.Mojo=w.Mojo||{};w.Mojo.com=w.Mojo.com||{};w.Mojo.com.ForceBossChallengePreviewDialog=w.Mojo.ui.Dialog.extend({clsname:function(){return"com.ForceBossChallengePreviewDialog";},init:function(options){this._super(undefined,options);this.element().addClass('mojo-com-forceboss-challenge-preview-dlg');var self=this;this._initContent();this._addButtons();},open:function(force){this._super(force);this._niudanScroll.refresh();},_initContent:function(){var self=this;$('<div class="mojo-com-forceboss-challenge-preview-header"></div>').html(Mojo.utils.locale('force','force_boss_challenge_preview_header')).appendTo(this._content);$('<div class="mojo-com-forceboss-challenge-preview-cost"></div>').html(Mojo.utils.locale('force','force_boss_challenge_preview_cost')).appendTo(this._content);if(parseInt(self._options.challenge_num)==0){this._rm=new Mojo.ui.Label(undefined,{classes:['rm'],text:'0',});this._rm.text(self._options.challenge_rm);this._rm.element().appendTo(this._content);}else{this._vm=new Mojo.ui.Label(undefined,{classes:['vm'],text:'0',});this._vm.text(self._options.challenge_vm);this._vm.element().appendTo(this._content);}
var chooseDiv=$('<div class="mojo-com-forceboss-challenge-preview-choose"></div>').appendTo(this._content);$('<div class="mojo-com-forceboss-challenge-preview-choose-niudan"></div>').html(Mojo.utils.locale('force','force_boss_challenge_preview_choose_niudan')).appendTo(chooseDiv);this._niudanList=$('<div class="mojo-com-forceboss-challenge-preview-choose-niudan-list"></div>');this._niudanScroll=new Mojo.ui.Scroll(undefined,this._niudanList,{direction:2});this._niudanScroll.element().appendTo(chooseDiv);for(var k in self._options.niudanlist){self._filter=$('<div></div>').attr("id","order-"+self._options.niudanlist[k].id).addClass("niudanElement").addClass("box-inner").appendTo(self._niudanList).data({id:self._options.niudanlist[k].id}).html('<div class="radio"></div>'+self._options.niudanlist[k].name).click(function(){self._niudanElements=self._niudanList.find(".niudanElement");self._niudanElements.removeClass("filterSelected").eq($(this).index()).addClass("filterSelected");self._niudanElements.find('.radio').removeClass('radio-selected-class');$(this).find('.radio').addClass('radio-selected-class');self._options.niudanSelected=$(this).data('id');});if(self._options.niudanId==self._options.niudanlist[k].id){self._filter.addClass("filterSelected");self._filter.find('.radio').addClass('radio-selected-class');self._options.niudanSelected=self._options.niudanlist[k].id;}}},_addButtons:function(){var self=this;this._footer.append((new Mojo.ui.Button('challenge-btn',{text:Mojo.utils.locale('force','force_boss_challenge_start2'),special:'button-big-red',click:function(){self.close();self._options.callback(self._options.niudanSelected);},})).element());this._footer.append((new Mojo.ui.Button('close-btn',{text:Mojo.utils.locale('common','close'),click:function(){self.close();},})).element());},_getDefaultOptions:function(){return $.extend(true,this._super(),{title:Mojo.utils.locale('force','force_boss_challenge_start'),detail:undefined,});}});})(window,jQuery);;(function(w,$,undefined){w.Mojo=w.Mojo||{};w.Mojo.com=w.Mojo.com||{};w.Mojo.com.ForceBossMsgChannel=w.Mojo.Object.extend({clsname:function(){return"com.ChatChannel";},init:function(id,options){this._super(id,options);this.element().addClass('mojo-com-chat-channel');this._list=$('<div class="list"></div>');this._scroller=new Mojo.ui.Scroll(undefined,this._list,{direction:2});this.element().append(this._scroller.element());this._chatList=[];this._lastSend=this._localLastSend();},_localLastSend:function(time){var key='chat-channel-cold-'+this._options.channelId;if(time==undefined||time==null){if(sessionStorage[key]!=undefined){return sessionStorage[key];}
return 0;}
sessionStorage[key]=time;},_getDefaultOptions:function(){var self=this;return $.extend(true,this._super(),{cold:1000,channelId:0,max:1000,});},getLatestChat:function(){if(this._chatList.length==0){return null;}
return this._chatList[this._chatList.length-1];},_addChatMessage:function(data){this._chatList.push(data);this._list.append((this._createChat(data)).element());if(this._chatList.length>this._options.max){this._chatList.shift();this._list.children().eq(0).remove();}
this._scroller.refresh();},_refreshTime:function(nowtime){var self=this;$.each(this.element().find(".mojo-com-chat-message"),function(i,e){var timestamp=$(e).find(".send-timestamp").text();var distance=parseInt(nowtime)-parseInt(timestamp);if(distance<0)distance=1;$(e).find(".send-time1").html(Mojo.utils.locale('force','force_boss_challenge_msg_content2',{time:self._formatCDTime(distance)}));});},_formatCDTime:function(sec){var str='';var dd=parseInt(sec/86400);var hh=parseInt((sec%86400)/3600);var mm=parseInt((sec%3600)/60);var ss=sec%60;if(dd>0){str=dd+Mojo.utils.locale('common','day');}else if(hh>0){str=hh+Mojo.utils.locale('common','hour');}else if(mm>0){str=mm+Mojo.utils.locale('common','minute');}else{str=ss+Mojo.utils.locale('common','second');}
return str;},_createChat:function(data){var self=this;return new Mojo.com.ForceBossMessage(data,{callback:function(uid){},channelId:self._options.channelId});},appendChatMessages:function(data,nowtime){if(Array.isArray(data)){for(var i=data.length-1;i>=0;i--){data[i].boss=this._options.bossName;this._addChatMessage(data[i]);}
if(data.length>0){this._scroller.scrollTo(0,this._list.height());}}else{this._addChat(data);this._scroller.scrollTo(0,this._list.height());}
this._refreshTime(nowtime);this._scroller.refresh();},notifySend:function(){this._lastSend=Date.now();this._localLastSend(this._lastSend);}});})(window,jQuery);;(function(w,$,undefined){w.Mojo=w.Mojo||{};w.Mojo.com=w.Mojo.com||{};w.Mojo.com.ForceBossMessage=w.Mojo.Object.extend({clsname:function(){return"com.ForceBossMessage";},init:function(data,options){this.data=data;this._super(undefined,options);var self=this;this.element().addClass('mojo-com-chat-message');var type="default";if(data.type!=undefined){type=data.type;}
var honor='';if(data.forceTitle!=undefined&&data.forceTitle!=''){honor='[<span class="official">'+data.forceTitle+'</span>]';}
this.element().html('<span class="send-timestamp"></span>'+'<span class="send-content">'+Mojo.utils.locale('force','force_boss_challenge_msg_content',{name:honor+data.player,boss:data.boss,num:data.killed})+'</span><span class="send-time1"></span>');this.element().find('.send-timestamp').html(data.time).hide();},_getSendTime:function(time){var d=new Date(time);var year=d.getFullYear();var month=d.getMonth()+1;var date=d.getDate();var hours=d.getHours();var minutes=d.getMinutes();return year+'-'+month+'-'+date+' '+(hours<10?'0'+hours:hours)+':'+(minutes<10?'0'+minutes:minutes);},_getDefaultOptions:function(){return{callback:$.noop,channelId:0};},});})(window,jQuery);